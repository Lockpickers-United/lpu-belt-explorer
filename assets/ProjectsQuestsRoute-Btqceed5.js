import{d as h,r as n,F as N,j as e,R as D,au as F,W as z,U as T,u as A,L as B,N as L,h as W,T as Y,D as I,e as O}from"./index-BQPSHt-y.js";import{p as R}from"./filterFields-CDapcEYJ.js";import{u as V}from"./usePageTitle-CfLEvQW0.js";import{D as P}from"./DataContext-SoHoRWzx.js";import{r as Q}from"./index-DiZJIvmS.js";import{u as _}from"./useData-BicGQrXt.js";import{a as G}from"./dataUrls-DVxTtpO-.js";import{f as U}from"./filterEntriesAdvanced-DfEnL2In.js";import{e as H}from"./entryName-B0GDtbAs.js";import{s as S}from"./searchEntriesForText-BWemAJZh.js";import{D as q}from"./DataTableSort-w-Fx8LF9.js";import{S as J}from"./SearchBox-CPaEFPkQ.js";import{V as K}from"./ViewFilterButtons-Bz6brLXv.js";import{p as X}from"./sortFields-CZ4oDFSx.js";import{A as Z}from"./AdvancedFilters-CVMrJk6Z.js";import{E as M,S as $,Y as ee,a as te}from"./ErrorOutline-CK_e7azB.js";import{P as re}from"./PhotoCamera-Co8x8f3Z.js";import"./stringUtils-BsiQ3MZ5.js";import"./ArrowDropDown-kXOl746e.js";import"./TableRow-CUUxnKAU.js";import"./Search-CUF27Vl9.js";import"./useFormControl-CGBQFKFv.js";import"./Select-BhK4qPLr.js";import"./Sort-y5RPZgbZ.js";import"./TextField-DOoP1nzY.js";import"./FilterAlt-Cv5Ie6xy.js";import"./HighlightOff-BojrJVR4.js";import"./Box-Bhx3fjN_.js";import"./LockListContext-CL8vv98G.js";import"./ToggleButtonGroup-5PMtJw7q.js";import"./setDeep-J6HEwWhX.js";import"./AddCircle-D30S5YZ_.js";import"./Cancel-Cngv3efI.js";import"./ChoiceButtonGroup-DGZqxDzm.js";import"./Collapse-CeH1bPXY.js";function oe({children:r,profile:u}){var b;const{data:o,loading:l,error:p,_errorMessage:x}=_({urls:se}),v=h((b=o==null?void 0:o.metadata)==null?void 0:b.updatedDateTime).format("MM/DD/YY HH:mm"),{filters:k,advancedFilterGroups:y}=n.useContext(N),{search:j,sort:d,expandAll:w}=k,c=n.useMemo(()=>{var t;return o&&!l&&!p?(t=o==null?void 0:o.allProjectsEvidence)==null?void 0:t.evidence:[]},[o,p,l]),s=n.useMemo(()=>c==null?void 0:c.map(t=>{let f;try{f=new URL(t.evidenceUrl).hostname}catch{}return{...t,pickerName:t.displayName||t.tabName,tierName:ie[t.tier],dateText:h(t.date).format("MM/DD/YY"),source:t.unclaimed?"Dan Sheet":"Scorecard",validLink:!!f,fuzzy:Q([H(t,"long")].concat([t.discipline,t.displayName,t.tabName]).join(",")),score:1}}),[c]),i=S(j,[...s]),g=n.useMemo(()=>{const t=U({advancedFilterGroups:y(),entries:s}),f=S(j,[...t]);return d?f.sort((a,m)=>{if(d==="popularity")return m.collectionSaves-a.collectionSaves||m.views-a.views||a.fuzzy.localeCompare(m.fuzzy);if(d==="alphaAscending")return a.fuzzy.localeCompare(m.fuzzy);if(d==="alphaDescending")return m.fuzzy.localeCompare(a.fuzzy);if(d==="recentlyUpdated")return Math.floor(h(m.lastUpdated).valueOf()/3600)-Math.floor(h(a.lastUpdated).valueOf()/3600)||a.fuzzy.localeCompare(m.fuzzy);if(d==="dateAdded")return Math.floor(h(m.dateAdded).valueOf()/3600*24)-Math.floor(h(a.dateAdded).valueOf()/3600*24)||a.fuzzy.localeCompare(m.fuzzy)}):f},[y,s,j,d]),C=n.useCallback(t=>c.find(f=>f.id===t),[c]),E=n.useMemo(()=>({allEntries:c,mappedEntries:s,visibleEntries:g,searchedEntries:i,getEntryFromId:C,expandAll:w,profile:u,updateTime:v}),[c,s,g,i,C,w,u,v]);return e.jsx(P.Provider,{value:E,children:r})}const se={allProjectsEvidence:G},ie={T1:"Tier 1",T2:"Tier 2",T3:"Tier 3",T4:"Tier 4",T5:"Tier 5"};function ae({evidenceUrl:r,handleChange:u=()=>{}}){const o=n.useCallback(p=>{p.preventDefault(),p.stopPropagation();const x=window.open(r,"_blank","noopener,noreferrer");x&&(x.opener=null)},[r]);let l=e.jsx($,{style:{width:20,height:20}});return r.match(/(https|http):\/\/.*(youtu.be|youtube.com)/)?l=e.jsx(ee,{style:{width:20,height:20}}):r.match(/(https|http):\/\/.*discord.com/)?l=e.jsx(te,{style:{width:20,height:20}}):r.match(/(https|http):\/\/.*imgur.com/)&&(l=e.jsx(re,{style:{width:20,height:20}})),e.jsxs(D.Fragment,{children:[F(r)&&e.jsx(z,{title:"View Documentation",arrow:!0,disableFocusListener:!0,children:e.jsx(T,{style:{width:40,height:40},onClick:o,children:l})}),!!r&&!F(r)&&e.jsx(z,{title:"Documentation link is not valid",arrow:!0,disableFocusListener:!0,children:e.jsx(T,{style:{width:40,height:40},onClick:u,children:e.jsx(M,{style:{width:22,height:22,color:"#c07b32"}})})}),!r&&e.jsx(z,{title:"Documentation link is missing",arrow:!0,disableFocusListener:!0,children:e.jsx(T,{style:{width:40,height:40},onClick:u,children:e.jsx(M,{style:{width:22,height:22,color:"#e55940"}})})})]})}function ne(){const{visibleEntries:r=[],updateTime:u}=n.useContext(P),{isMobile:o}=A(),l=n.useCallback(s=>{const i=window.open(s,"_blank","noopener,noreferrer");i&&(i.opener=null)},[]),p=[...r],x=[{id:"pickerName",align:"left",name:"Picker Name"},{id:"discipline",align:"left",name:"Discipline"},{id:"tier",align:"center",name:"Tier"},{id:"date",align:"center",name:"Date"},{id:"source",align:"left",name:"Source"},{id:"evidenceUrl",align:"center",name:"Evidence"}],v="pickerName",k="100%",y={columns:x,rows:p,defaultSort:v,sortable:!0,wrap:!1},j=n.useCallback((s,i,g)=>s==="evidenceUrl"?e.jsx(ae,{evidenceUrl:i}):s==="date"?h(i).format("MM/DD/YY"):s==="discipline"&&F(g)?e.jsx(B,{onClick:()=>l(g),style:{color:"#fff",fontWeight:500},children:i}):i,[l]),d=e.jsxs(D.Fragment,{children:[e.jsx(J,{label:"Projects",extraFilters:[{key:"tab",value:"search"}],keepOpen:!1,entryCount:r.length}),e.jsx(K,{sortValues:X,advancedEnabled:!0,extraFilters:[],entryType:"Project",compactMode:!1,resetAll:!0,expandAll:!1}),!o&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}})]}),w=void 0,c={maxWidth:700,marginLeft:"auto",marginRight:"auto"};return e.jsxs(D.Fragment,{children:[e.jsx(L,{title:"Projects",extras:d}),e.jsxs("div",{style:{margin:8,paddingBottom:22},children:[e.jsx(Z,{}),e.jsxs("div",{style:c,children:[e.jsx("div",{style:{margin:"24px 8px"},children:"The page contains most of our approved projects: those in Scorecards and those entered in the Dan Sheet prior to Sept, 2024. Intended for internal use, many of the links to original requests lead to pages accessible by Black Belts only. (This page not yet optimized for mobile devices.)"}),e.jsx(q,{tableData:y,tableWidth:k,linkFunction:j,linkColumnId:"evidenceUrl",largeFontSize:"0.90rem"}),e.jsxs("div",{style:{margin:"24px 8px",textAlign:"center",fontSize:"0.8rem",color:"#999"},children:["Updated: ",u]})]})]}),e.jsx(W,{extras:void 0,before:w}),e.jsx(Y,{feature:"projectsQuests"})]})}function Qe(){const{lockCollection:r}=n.useContext(I);return V("Projects & Quests"),e.jsx(O,{filterFields:R,children:e.jsx(oe,{profile:r,children:e.jsx(ne,{})})})}export{Qe as default};
