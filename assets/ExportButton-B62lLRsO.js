import{r as c,X as Q,j as e,W as ne,U as ie,$ as mt,bf as ft,R as re,A as gt,D as yt,u as vt,B as W,bb as Ct,L as te,ak as jt,a8 as Z,at as H,a4 as X}from"./index-BQPSHt-y.js";import{L as kt}from"./Link-sQXUE7Hm.js";import{e as se}from"./entryName-B0GDtbAs.js";import{C as bt}from"./Cancel-Cngv3efI.js";import{D as wt}from"./Dialog-CXnOIfAB.js";import{Z as St}from"./Zoom-BS27N-td.js";import{s as It}from"./sanitizeValues-R1sQVcWF.js";import{T as Lt}from"./TextField-DOoP1nzY.js";import{M as Mt}from"./index-D8k9bEq4.js";import{r as _t}from"./index-BdkceGff.js";import{r as Nt}from"./index-nTkBdc_a.js";import{C as Oe}from"./Collapse-CeH1bPXY.js";import{d as $e,F as oe,C as Vt}from"./download-ARi8rI0U.js";import{L as Rt}from"./List-DhDOa6dw.js";import"./filterEntriesAdvanced-DfEnL2In.js";import{D as Et}from"./DataContext-SoHoRWzx.js";import"./index-DiZJIvmS.js";import{C as Tt}from"./ContentCopy-DR8Zt7YC.js";function no({entry:s,nameType:r}){const n=c.useCallback(async()=>{const d=se(s,r).replace(/[\s/]/g,"_").replace(/\W/g,""),h=`https://share.lpubelts.com/?id=${s.id}&name=${d}`;await navigator.clipboard.writeText(h),Q("Link to entry copied to clipboard.")},[s,r]);return e.jsx(ne,{title:"Copy Link to Entry",arrow:!0,disableFocusListener:!0,children:e.jsx(ie,{onClick:n,children:e.jsx(kt,{})})})}function zt({dialogContent:s,open:r,handleClose:n,width:v=350,dark:d=!0}){const h=u=>{u.stopPropagation(),u.preventDefault()};return e.jsx(wt,{open:r,onClose:n,sx:{".MuiDialog-paper":{backgroundColor:"transparent",backgroundImage:"none",padding:"12px",margin:"0px 0px 20px 0px",width:v},"& .MuiBackdrop-root":{backgroundColor:d?"rgba(0, 0, 0, 0.65)":"rgba(0, 0, 0, 0.5)",backdropFilter:d?"blur(0.75px)":"none"}},children:e.jsx(St,{in:r,timeout:{enter:250,exit:250},children:e.jsxs("div",{children:[n&&e.jsx("div",{onClick:n,style:{display:"flex",flexGrow:1,justifyContent:"flex-end",marginBottom:-15,marginRight:-10},children:e.jsx(ie,{style:{padding:0,color:"#eee",backgroundColor:"#333"},onClick:n,children:e.jsx(bt,{})})}),e.jsx("div",{onClick:h,style:{backgroundColor:"#666",borderRadius:4,boxShadow:"0px 11px 15px -7px rgba(0,0,0,0.4),0px 24px 38px 3px rgba(0,0,0,0.28),0px 9px 46px 8px rgba(0,0,0,0.24)"},children:s})]})})})}var Y={},qe;function Dt(){if(qe)return Y;qe=1,Object.defineProperty(Y,"__esModule",{value:!0});var s=mt(),r=ft(),n=function(){return n=Object.assign||function(t){for(var o,i=1,l=arguments.length;i<l;i++)for(var a in o=arguments[i])Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a]);return t},n.apply(this,arguments)};function v(t,o,i){for(var l,a=0,m=o.length;a<m;a++)!l&&a in o||(l||(l=Array.prototype.slice.call(o,0,a)),l[a]=o[a]);return t.concat(l||Array.prototype.slice.call(o))}function d(t){var o=t.size,i=o===void 0?25:o,l=t.SVGstrokeColor,a=l===void 0?"currentColor":l,m=t.SVGstorkeWidth,C=m===void 0?0:m,k=t.SVGclassName,x=k===void 0?"star-svg":k,w=t.SVGstyle;return s.jsx("svg",n({className:x,style:w,stroke:a,fill:"currentColor",strokeWidth:C,viewBox:"0 0 24 24",width:i,height:i,xmlns:"http://www.w3.org/2000/svg"},{children:s.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}))}function h(t,o){switch(o.type){case"PointerMove":return n(n({},t),{hoverValue:o.payload,hoverIndex:o.index});case"PointerLeave":return n(n({},t),{ratingValue:t.ratingValue,hoverIndex:0,hoverValue:null});case"MouseClick":return n(n({},t),{valueIndex:t.hoverIndex,ratingValue:o.payload});default:return t}}var u="style-module_starRatingWrap__q-lJC",N="style-module_simpleStarRating__nWUxf",f="style-module_fillIcons__6---A",_="style-module_emptyIcons__Bg-FZ",g="style-module_tooltip__tKc3i";function L(){return typeof window<"u"&&window.matchMedia("(pointer: coarse)").matches||"ontouchstart"in window||typeof navigator<"u"&&navigator.maxTouchPoints>0}return(function(t,o){o===void 0&&(o={});var i=o.insertAt;if(typeof document<"u"){var l=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",i==="top"&&l.firstChild?l.insertBefore(a,l.firstChild):l.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}})(".style-module_starRatingWrap__q-lJC{display:inline-block;touch-action:none}.style-module_simpleStarRating__nWUxf{display:inline-block;overflow:hidden;position:relative;touch-action:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;vertical-align:middle;white-space:nowrap}.style-module_fillIcons__6---A{display:inline-block;overflow:hidden;position:absolute;top:0;white-space:nowrap}.style-module_emptyIcons__Bg-FZ{display:inline-block}.style-module_tooltip__tKc3i{background-color:#333;border-radius:5px;color:#fff;display:inline-block;padding:5px 15px;vertical-align:middle}"),Y.Rating=function(t){var o,i,l=t.onClick,a=t.onPointerMove,m=t.onPointerEnter,C=t.onPointerLeave,k=t.initialValue,x=k===void 0?0:k,w=t.iconsCount,b=w===void 0?5:w,T=t.size,A=T===void 0?40:T,F=t.readonly,V=F!==void 0&&F,O=t.rtl,z=O!==void 0&&O,B=t.customIcons,$=B===void 0?[]:B,j=t.allowFraction,S=j!==void 0&&j,Ue=t.style,le=t.className,Ke=le===void 0?"react-simple-star-rating":le,ae=t.transition,Ze=ae!==void 0&&ae,ce=t.allowHover,de=ce===void 0||ce,ue=t.disableFillHover,pe=ue!==void 0&&ue,he=t.fillIcon,He=he===void 0?null:he,xe=t.fillColor,Xe=xe===void 0?"#ffbc0b":xe,me=t.fillColorArray,Ye=me===void 0?[]:me,Qe=t.fillStyle,fe=t.fillClassName,et=fe===void 0?"filled-icons":fe,ge=t.emptyIcon,tt=ge===void 0?null:ge,ye=t.emptyColor,ot=ye===void 0?"#cccccc":ye,nt=t.emptyStyle,ve=t.emptyClassName,st=ve===void 0?"empty-icons":ve,Ce=t.allowTitleTag,it=Ce===void 0||Ce,je=t.showTooltip,rt=je!==void 0&&je,ke=t.tooltipDefaultText,lt=ke===void 0?"Your Rate":ke,be=t.tooltipArray,q=be===void 0?[]:be,at=t.tooltipStyle,we=t.tooltipClassName,ct=we===void 0?"react-simple-star-rating-tooltip":we,Se=t.SVGclassName,Ie=Se===void 0?"star-svg":Se,Le=t.titleSeparator,dt=Le===void 0?"out of":Le,Me=t.SVGstyle,_e=t.SVGstorkeWidth,Ne=_e===void 0?0:_e,Ve=t.SVGstrokeColor,Re=Ve===void 0?"currentColor":Ve,Ee=r.useReducer(h,{hoverIndex:0,valueIndex:0,ratingValue:x,hoverValue:null}),J=Ee[0],I=J.ratingValue,y=J.hoverValue,ee=J.hoverIndex,Te=J.valueIndex,U=Ee[1];r.useEffect((function(){x&&U({type:"MouseClick",payload:0})}),[x]);var R=r.useMemo((function(){return S?2*b:b}),[S,b]),D=r.useMemo((function(){return x>R?0:S||Math.floor(x)===x?Math.round(x/b*100):2*Math.ceil(x)*10}),[S,x,b,R]),ze=r.useMemo((function(){return(S?2*x-1:x-1)||0}),[S,x]),G=r.useCallback((function(p){return b%2!=0?p/2/10:p*b/100}),[b]),De=function(p){for(var E=p.clientX,M=p.currentTarget.children[0].getBoundingClientRect(),pt=M.left,ht=M.right,xt=M.width,Fe=z?ht-E:E-pt,K=R,Be=Math.round(xt/R),P=0;P<=R;P+=1)if(Fe<=Be*P){K=P===0&&Fe<Be?0:P;break}var Pe=K-1;K>0&&(U({type:"PointerMove",payload:100*K/R,index:Pe}),a&&y&&a(G(y),Pe,p))},Ge=function(p){y&&(U({type:"MouseClick",payload:y}),l&&l(G(y),ee,p))},ut=r.useMemo((function(){if(de){if(pe){var p=I&&I||D;return y&&y>p?y:p}return y&&y||I&&I||D}return I&&I||D}),[de,pe,y,I,D]);r.useEffect((function(){q.length>R&&console.error("tooltipArray Array length is bigger then Icons Count length.")}),[q.length,R]);var We=r.useCallback((function(p){return y&&p[ee]||I&&p[Te]||x&&p[ze]}),[y,ee,I,Te,x,ze]),Ae=r.useMemo((function(){return y&&G(y)||I&&G(I)||x&&G(D)}),[y,G,I,x,D]);return s.jsxs("span",n({className:u,style:{direction:"".concat(z?"rtl":"ltr")}},{children:[s.jsxs("span",n({className:"".concat(N," ").concat(Ke),style:n({cursor:V?"":"pointer"},Ue),onPointerMove:V?void 0:De,onPointerEnter:V?void 0:function(p){m&&m(p),L()&&De(p)},onPointerLeave:V?void 0:function(p){L()&&Ge(),U({type:"PointerLeave"}),C&&C(p)},onClick:V?void 0:Ge,"aria-hidden":"true"},{children:[s.jsx("span",n({className:"".concat(_," ").concat(st),style:n({color:ot},nt)},{children:v([],Array(b)).map((function(p,E){var M;return s.jsx(r.Fragment,{children:((M=$[E])===null||M===void 0?void 0:M.icon)||tt||s.jsx(d,{SVGclassName:Ie,SVGstyle:Me,SVGstorkeWidth:Ne,SVGstrokeColor:Re,size:A})},E)}))})),s.jsx("span",n({className:"".concat(f," ").concat(et),style:n((o={},o[z?"right":"left"]=0,o.color=We(Ye)||Xe,o.transition=Ze?"width .2s ease, color .2s ease":"",o.width="".concat(ut,"%"),o),Qe),title:it?"".concat(Ae," ").concat(dt," ").concat(b):void 0},{children:v([],Array(b)).map((function(p,E){var M;return s.jsx(r.Fragment,{children:((M=$[E])===null||M===void 0?void 0:M.icon)||He||s.jsx(d,{SVGclassName:Ie,SVGstyle:Me,SVGstorkeWidth:Ne,SVGstrokeColor:Re,size:A})},E)}))}))]})),rt&&s.jsx("span",n({className:"".concat(g," ").concat(ct),style:n((i={},i[z?"marginRight":"marginLeft"]=20,i),at)},{children:(q.length>0?We(q):Ae)||lt}))]}))},Y}var Gt=Dt();function Wt({ratings:s,dimension:r,onChange:n,size:v=24,emptyColor:d="#ccc",readonly:h=!1,fillColor:u,style:N,allowFraction:f=!0}){const _=c.useCallback(g=>{n({rating:g,dimension:r})},[r,n]);return e.jsx("div",{style:{display:"flex",placeItems:"center",marginTop:4,...N},children:e.jsx(Gt.Rating,{onClick:_,size:v,initialValue:s&&s[r],ratingValue:s&&s[r],emptyColor:d,readonly:h,fillColor:u,allowFraction:f})})}function Je({ratingDimensions:s,ratings:r,onRatingChange:n=()=>{},size:v,allowFraction:d=!1,readonly:h=!1,fontSize:u="1.0rem",paddingData:N=5,backgroundColor:f,fillColor:_,emptyColor:g="#777",fontWeight:L=500}){const t=Object.keys(s).map(o=>({ratingArea:s[o]||o,rating:e.jsx(Wt,{ratings:r,onChange:n,dimension:o,readonly:h,size:v,fontSize:u,allowFraction:d,fillColor:_,emptyColor:g,style:{marginLeft:5,marginTop:4}})}));return e.jsx(re.Fragment,{children:e.jsx("div",{style:{display:"flex",justifyContent:"space-between"},children:t.map((o,i)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:`${N}px`,backgroundColor:i%2===0?f:"transparent",marginRight:i<t.length-1?15:0},children:[e.jsx("div",{style:{fontSize:u,fontWeight:L,color:"#ddd"},children:o.ratingArea}),e.jsx("div",{children:o.rating})]},i))})})}function so({entry:s}){const{isLoggedIn:r}=c.useContext(gt),{userLockNotes:n,updateProfileField:v}=c.useContext(yt),d=r?n[s.id]:{},h=typeof d=="string"?d||"":d&&d.notes||"",u=c.useCallback(async j=>{await v("userLockNotes",j),f(!1)},[v]),[N,f]=c.useState(!1),_=c.useCallback(()=>{f(!0)},[]),g=c.useCallback(()=>{f(!1),t(h)},[h]),[L,t]=c.useState(h),[o,i]=c.useState((d==null?void 0:d.ratings)||{}),[l,a]=c.useState(!1);c.useEffect(()=>{t(h||"")},[h]);const m=c.useCallback(j=>{t(It(j.target.value,{profanityOK:!0,urlsOK:!0}))},[]),C=c.useCallback(({dimension:j,rating:S})=>{i({...o,[j]:S}),a(!0)},[o]),k=c.useCallback(async()=>{const j={...n,[s.id]:{notes:L||""}};Object.keys(o).length>0&&(j[s.id].ratings=o),await u(j).catch(S=>{console.error("Error updating notes:",S)}),g(),a(!1)},[n,s.id,L,o,u,g]),x=c.useCallback(async()=>{const j={...n};delete j[s.id],await u(j).catch(S=>{console.error("Error removing notes:",S)}),g(),i({}),a(!1)},[s.id,g,u,n]),{isMobile:w,flexStyle:b}=vt(),T={fontSize:"1.0rem",fontWeight:400,marginBottom:5,paddingLeft:2,color:"#fff"},A=w?"0.85rem":"0.9rem",F=w?5:8,V=h.split(`
`).length,O=V>F?Math.min(V,12):F,z=w?5:10,B={Difficulty:"Difficulty",Fun:"Fun"},$=e.jsx("div",{style:{display:"flex"},children:r?e.jsxs("div",{style:{flexGrow:1,maxWidth:550,padding:10},children:[e.jsxs("div",{style:{marginTop:10,display:"flex"},children:[e.jsx("div",{style:{...T,flexGrow:1,fontWeight:700},children:"My Notes"}),e.jsxs("div",{style:{...T,color:"#aaa",fontSize:"0.85rem"},children:[L.length||0,"/1200"]})]}),e.jsx(Lt,{type:"text",name:"notes",multiline:!0,fullWidth:!0,rows:O,value:L,onChange:m,id:"notes",color:"info",style:{},placeholder:"Add your own private notes about this lock, visible only to you.",variant:"outlined",autoFocus:!0,inputProps:{maxLength:1200,style:{fontSize:A}}}),e.jsx("div",{style:{display:"flex",marginTop:5},children:e.jsx(Je,{ratingDimensions:B,onRatingChange:C,ratings:o,emptyColor:"#555",fontSize:"0.85rem",size:20,paddingData:0})}),e.jsxs("div",{style:{flexGrow:1,textAlign:"right",marginTop:8},children:[e.jsx(W,{variant:"text",size:"small",onClick:g,children:"Cancel"}),e.jsx(W,{variant:"text",size:"small",onClick:k,color:"success",children:"Save"})]})]}):e.jsxs("div",{style:{flexGrow:1,padding:"40px 20px",placeItems:"center"},children:[e.jsxs("div",{style:{...T,marginBottom:15,fontWeight:700,textAlign:"center"},children:["Please sign in to add your",e.jsx("br",{}),"own private notes for locks."]}),e.jsx("div",{style:{width:210},children:e.jsx(Ct,{onClick:g})})]})});return e.jsxs(re.Fragment,{children:[Object.keys(d||{}).length>0?e.jsxs("div",{style:{fontWeight:700,marginTop:15},children:[e.jsxs("div",{style:{display:"flex"},children:[e.jsx("span",{style:{},children:"My private notes  "}),e.jsx(te,{style:{fontWeight:400,color:"#2bb259"},onClick:_,children:"edit"})," • ",e.jsx(te,{style:{fontWeight:400,color:"#2bb259"},onClick:x,children:"remove"})]}),e.jsxs("div",{style:{fontSize:A,marginLeft:z,fontWeight:400},children:[e.jsx(Mt,{remarkPlugins:[Nt],rehypePlugins:[[_t,{target:"_blank",rel:["nofollow","noopener","noreferrer"]}]],children:h}),!h&&e.jsx("div",{style:{height:8}}),e.jsxs("div",{style:{display:b,height:32,justifyContent:"flex-start",alignItems:"center"},children:[e.jsx(Je,{ratingDimensions:B,onRatingChange:C,ratings:o,readonly:!1,fontSize:"0.85rem",size:19,paddingData:0}),l&&!w&&e.jsx(W,{variant:"text",size:"small",onClick:k,color:"success",children:"Save"}),e.jsx(Oe,{in:l&&w,style:{},children:e.jsxs("div",{style:{display:"flex",flexGrow:1,width:"100%",justifyContent:"center"},children:[e.jsx(W,{variant:"text",size:"small",onClick:g,style:{color:"#777"},children:"Cancel"}),e.jsx(W,{variant:"text",size:"small",onClick:k,color:"success",children:"Save"})]})})]}),e.jsx(Oe,{in:l&&w,style:{textAlign:"right"},children:e.jsx("div",{style:{height:22}})})]})]}):e.jsx("div",{style:{fontWeight:700,marginTop:15},children:e.jsx(te,{style:{fontWeight:600,color:"#2bb259",textDecoration:"none",cursor:"pointer"},onClick:_,children:"Add your own private notes"})}),e.jsx(zt,{dialogContent:$,open:N,handleClose:g,width:w?350:550})]})}function io({text:s,entries:r}){const[n,v]=c.useState(null),d=!!n,h=c.useCallback(t=>v(t.currentTarget),[]),u=c.useCallback(()=>v(null),[]),{visibleEntries:N}=c.useContext(Et),f=r||N,_=c.useCallback(()=>{const t=JSON.stringify(f);u(),$e("lpubeltsData.json",t),Q("Current lock entries downloaded as lpubeltsData.json")},[u,f]),g=c.useCallback(()=>{const o=f.map(i=>({id:i.id,make:i.makeModels.map(l=>l.make).join(","),model:i.makeModels.map(l=>l.model).join(","),version:i.version,belt:i.belt,name:se(i),versionText:i.version?" ("+i.version+")":""})).map(i=>"* "+i.name+i.versionText).join(`
`);u(),navigator.clipboard.writeText(o).then(),Q("Current lock entries copied to clipboard.")},[u,f]),L=c.useCallback(()=>{const t=["id","name","version","belt","notes"],o=f.map(m=>({id:m.id,make:m.makeModels.map(C=>C.make).join(","),model:m.makeModels.map(C=>C.model).join(","),version:m.version,belt:m.belt,name:se(m),notes:m.personalNotes})),i=t.join(","),l=o.map(m=>t.map(C=>m[C]).map(C=>{const k=`${C??""}`.replace(/"/g,'""');return/(\s|,|")/.test(k)?`"${k}"`:k}).join(",")).join(`
`),a=`${i}
${l}`;u(),$e("lpubeltsData.csv",a),Q("Current lock entries downloaded as lpubeltsData.csv")},[u,f]);return e.jsxs(re.Fragment,{children:[s?e.jsx(ne,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(W,{variant:"outlined",size:"small",onClick:h,style:{color:"#ddd",borderColor:"#aaa"},startIcon:e.jsx(oe,{}),children:"Export"})}):e.jsx(ne,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(ie,{onClick:h,children:e.jsx(oe,{})})}),e.jsxs(jt,{anchorEl:n,open:d,onClose:u,children:[!s&&e.jsxs(Z,{disabled:!0,children:[e.jsx(H,{children:e.jsx(oe,{fontSize:"small"})}),e.jsx(X,{children:"Export"})]}),e.jsxs(Z,{onClick:g,children:[e.jsx(H,{children:e.jsx(Tt,{fontSize:"small"})}),e.jsx(X,{children:"Copy to clipboard"})]}),e.jsxs(Z,{onClick:L,children:[e.jsx(H,{children:e.jsx(Rt,{fontSize:"small"})}),e.jsx(X,{children:"CSV"})]}),e.jsxs(Z,{onClick:_,children:[e.jsx(H,{children:e.jsx(Vt,{fontSize:"small"})}),e.jsx(X,{children:"JSON"})]})]})]})}export{no as C,so as E,io as a};
