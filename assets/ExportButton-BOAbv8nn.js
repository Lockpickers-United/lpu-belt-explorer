import{r as a,X as j,j as e,R as M,W as v,B as g,U as y,ak as z,a8 as c,at as d,a4 as p}from"./index-DEGBTbGQ.js";import{d as E,F as C,C as B}from"./download-30_DJji1.js";import{L as N}from"./List-UsPdffG9.js";import"./filterEntriesAdvanced-CqSR_p37.js";import{D as $}from"./DataContext-BFjPc8m3.js";import"./index-ZxkTfsrQ.js";import{e as f}from"./entryName-O7o5a_nG.js";import{C as J}from"./ContentCopy-DbuFDjIm.js";function G({text:h,entries:I}){const[u,b]=a.useState(null),S=!!u,k=a.useCallback(t=>b(t.currentTarget),[]),n=a.useCallback(()=>b(null),[]),{visibleEntries:w}=a.useContext($),l=I||w,D=a.useCallback(()=>{const t=JSON.stringify(l);n(),E("lpubeltsData.json",t),j("Current lock entries downloaded as lpubeltsData.json")},[n,l]),T=a.useCallback(()=>{const x=l.map(o=>({id:o.id,make:o.makeModels.map(i=>i.make).join(","),model:o.makeModels.map(i=>i.model).join(","),version:o.version,belt:o.belt,name:f(o),versionText:o.version?" ("+o.version+")":""})).map(o=>"* "+o.name+o.versionText).join(`
`);n(),navigator.clipboard.writeText(x).then(),j("Current lock entries copied to clipboard.")},[n,l]),F=a.useCallback(()=>{const t=["id","name","version","belt","notes"],x=l.map(s=>({id:s.id,make:s.makeModels.map(r=>r.make).join(","),model:s.makeModels.map(r=>r.model).join(","),version:s.version,belt:s.belt,name:f(s),notes:s.personalNotes})),o=t.join(","),i=x.map(s=>t.map(r=>s[r]).map(r=>{const m=`${r??""}`.replace(/"/g,'""');return/(\s|,|")/.test(m)?`"${m}"`:m}).join(",")).join(`
`),L=`${o}
${i}`;n(),E("lpubeltsData.csv",L),j("Current lock entries downloaded as lpubeltsData.csv")},[n,l]);return e.jsxs(M.Fragment,{children:[h?e.jsx(v,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(g,{variant:"outlined",size:"small",onClick:k,style:{color:"#ddd",borderColor:"#aaa"},startIcon:e.jsx(C,{}),children:"Export"})}):e.jsx(v,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(y,{onClick:k,children:e.jsx(C,{})})}),e.jsxs(z,{anchorEl:u,open:S,onClose:n,children:[!h&&e.jsxs(c,{disabled:!0,children:[e.jsx(d,{children:e.jsx(C,{fontSize:"small"})}),e.jsx(p,{children:"Export"})]}),e.jsxs(c,{onClick:T,children:[e.jsx(d,{children:e.jsx(J,{fontSize:"small"})}),e.jsx(p,{children:"Copy to clipboard"})]}),e.jsxs(c,{onClick:F,children:[e.jsx(d,{children:e.jsx(N,{fontSize:"small"})}),e.jsx(p,{children:"CSV"})]}),e.jsxs(c,{onClick:D,children:[e.jsx(d,{children:e.jsx(B,{fontSize:"small"})}),e.jsx(p,{children:"JSON"})]})]})]})}export{G as E};
