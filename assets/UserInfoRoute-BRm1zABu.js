import{r as a,A as tt,D as et,a6 as ct,F as ot,S as ht,ao as xt,aE as jt,j as t,d as ut,B as Z,h as yt,e as mt,N as gt}from"./index-DVSFr6OD.js";import{c as kt}from"./dataUrls-DkJe4Pqg.js";import{a as Ct,b as vt}from"./ScorecardListContext-CU9sQV8W.js";import{L as st}from"./LoadingDisplay-dvENjB_5.js";import{u as _}from"./useData-CR5OB6H1.js";import{L as pt,A as Lt}from"./LocalizationProvider-Cl2JOyyJ.js";import{T as ft}from"./TextField-CGjTFXh-.js";import{M as bt}from"./MustBeLoggedIn-CHrUpVWO.js";import"./DataContext-ks8A5s2j.js";import"./index-DV9PfA0w.js";import"./filterEntriesAdvanced-B_LinbMH.js";import"./Box-B2w4cE7H.js";import"./CircularProgress-oLZiTwzA.js";import"./Select-B2ePLM0t.js";import"./useFormControl-DTv-C_uL.js";function Dt(){var M,$,K,V,G,H,J,Q,X,Y;const{user:s,userClaims:x}=a.useContext(tt),{getProfile:j,getPickerActivity:o}=a.useContext(et),{admin:g}=a.useContext(ct),{filters:b={},addFilters:l}=a.useContext(ot),{uid:h,name:D}=b,{scoredActivity:A,bbCount:I,danPoints:w,eligibleDan:B,nextDanPoints:U,nextDanLocks:S,uniqueLocks:P,maxBelt:N}=a.useContext(ht),[c,k]=a.useState(s==null?void 0:s.uid),[C,v]=a.useState(h||(s==null?void 0:s.uid)||"");a.useEffect(()=>{const d=h||(s==null?void 0:s.uid)||"";v(d),d!==c&&k(d)},[h,s,c]);const nt=a.useCallback(async()=>{var d;try{const i=await j(c);if(i){const f=i.displayName&&!i.privacyAnonymous?(d=i==null?void 0:i.displayName)!=null&&d.toLowerCase().endsWith("s")?`${i.displayName}'`:`${i.displayName}'s`:"Anonymous";document.title=`LPU Belt Explorer - ${f} User Info`}if((s==null?void 0:s.uid)!==c){const f=await o(c);return{profile:i,...xt(f)}}else return{profile:i,scoredActivity:A,bbCount:I,danPoints:w,eligibleDan:B,nextDanPoints:U,nextDanLocks:S,uniqueLocks:P,maxBelt:N}}catch(i){return console.error("Error loading profile and activity.",i),null}},[j,c,s,o,A,I,w,B,U,S,P,N]),{data:r={},loading:u,error:p}=_({loadFn:nt}),e=a.useMemo(()=>r?r.profile:{},[r]);a.useEffect(()=>{s&&!h&&l([{key:"uid",value:s.uid}],!0),e&&!D&&l([{key:"name",value:encodeURIComponent(e==null?void 0:e.displayName)}],!0)},[l,b,D,e,h,s]);const dt=r?r.scoredActivity:[],E=r?r.bbCount:0,F=r?r.danPoints:0,R=r?r.eligibleDan:0,W=r?r.nextDanPoints:0,O=r?r.nextDanLocks:0,z=r?r.uniqueLocks:0,T=r?r.scoredActivity.filter(d=>d.collectionDB==="awards").map(d=>jt[d.matchId]).filter(d=>d.awardType==="belt").sort((d,i)=>d.rank-i.rank):[],y=r?T[T.length-1]:{},m=_({url:kt}),rt=m.data?m.data.blackBeltOnly.listStats.recordedLocks.topItems:[],it=m.data?m.data.allUsers.listStats.recordedLocks.topItems:[],at=void 0,L={fontWeight:700,backgroundColor:"#333",padding:2,textAlign:"left",marginTop:10},n={fontWeight:700,paddingRight:10},q=a.useCallback(()=>{const i=(C||"").trim()||(s==null?void 0:s.uid)||"";l([{key:"uid",value:i},{key:"name",value:void 0}],!0),k(i)},[C,l,s]),lt=a.useCallback(()=>{const d=(s==null?void 0:s.uid)||"";v(d),l([{key:"uid",value:d},{key:"name",value:void 0}],!0),k(d)},[l,s]);return u||p?null:t.jsx(Ct,{cardActivity:dt,cardBBCount:E,cardDanPoints:F,cardEligibleDan:R,cardNextDanPoints:W,cardNextDanLocks:O,cardUniqueLocks:z,cardMaxBelt:y,popularLocks:it,popularLocksBB:rt,children:t.jsx(vt,{children:t.jsxs(pt,{adapterLocale:ut.locale(),dateAdapter:Lt,children:[u&&t.jsx(st,{}),!u&&r&&!p&&t.jsxs("div",{style:{minWidth:"320px",height:"100%",padding:20,backgroundColor:"#000",marginLeft:"auto",marginRight:"auto",justifyItems:"center",fontSize:"0.95rem"},children:[g&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[t.jsx(ft,{label:"View user by UID",variant:"outlined",size:"small",value:C,onChange:d=>v(d.target.value),onKeyDown:d=>{d.key==="Enter"&&q()},style:{flex:1,minWidth:360}}),t.jsx(Z,{variant:"contained",color:"secondary",size:"small",onClick:q,children:"Load"}),t.jsx(Z,{variant:"text",color:"inherit",size:"small",onClick:lt,children:"Reset to me"})]}),t.jsxs("table",{id:"userInfo",children:[t.jsx("thead",{children:t.jsxs("tr",{style:L,children:[t.jsx("th",{children:"Parameter"}),t.jsx("th",{children:"Value"})]})}),t.jsxs("tbody",{children:[t.jsx("tr",{style:{height:10}}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"display name"}),t.jsx("td",{children:e==null?void 0:e.displayName})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"user id"}),t.jsx("td",{children:c})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"user claims"}),t.jsx("td",{children:x.join(", ")})]}),(e==null?void 0:e.admin)&&t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"profile.admin"}),t.jsx("td",{children:"true"})]}),t.jsx("tr",{style:{height:10}}),t.jsx("tr",{children:t.jsx("td",{style:L,colSpan:2,children:"SCORECARD"})}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"blackBeltAwarded"}),t.jsx("td",{children:e!=null&&e.blackBeltAwardedAt?"true":""})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"cardMaxBelt"}),t.jsx("td",{children:y==null?void 0:y.name})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"cardBBCount"}),t.jsx("td",{children:E})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"cardDanPoints"}),t.jsx("td",{children:F})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"cardEligibleDan"}),t.jsx("td",{children:R})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"cardNextDanPoints"}),t.jsx("td",{children:W})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"cardNextDanLocks"}),t.jsx("td",{children:O})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"cardUniqueLocks"}),t.jsx("td",{children:z})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"projects"}),t.jsx("td",{children:(M=e==null?void 0:e.projects)==null?void 0:M.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"tabClaimed"}),t.jsx("td",{children:e==null?void 0:e.tabClaimed})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"redditUsername"}),t.jsx("td",{children:e==null?void 0:e.redditUsername})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"discordUsername"}),t.jsx("td",{children:e==null?void 0:e.discordUsername})]}),t.jsx("tr",{style:{height:10}}),t.jsx("tr",{children:t.jsx("td",{style:L,colSpan:2,children:"LOCK COLLECTION"})}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"any"}),t.jsx("td",{children:($=e==null?void 0:e.any)==null?void 0:$.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"own"}),t.jsx("td",{children:(K=e==null?void 0:e.own)==null?void 0:K.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"picked"}),t.jsx("td",{children:(V=e==null?void 0:e.picked)==null?void 0:V.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"recorded"}),t.jsx("td",{children:(G=e==null?void 0:e.recorded)==null?void 0:G.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"wishlist"}),t.jsx("td",{children:(H=e==null?void 0:e.wishlist)==null?void 0:H.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"safelocksAny"}),t.jsx("td",{children:(J=e==null?void 0:e.safelocksAny)==null?void 0:J.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"safelocksCracked"}),t.jsx("td",{children:(Q=e==null?void 0:e.safelocksCracked)==null?void 0:Q.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"safelocksOwn"}),t.jsx("td",{children:(X=e==null?void 0:e.safelocksOwn)==null?void 0:X.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"safelocksWishlist"}),t.jsx("td",{children:(Y=e==null?void 0:e.safelocksWishlist)==null?void 0:Y.length})]})]})]})]}),!u&&(!r||p)&&t.jsx("div",{style:{minWidth:"320px",height:"100%",padding:20,backgroundColor:"#000",marginLeft:"auto",marginRight:"auto",justifyItems:"center",fontSize:"0.95rem",textalign:"center"},children:"no user"}),t.jsx(yt,{before:at})]})})})}function qt(){const{authLoaded:s,isLoggedIn:x,user:j}=a.useContext(tt),{dbLoaded:o}=a.useContext(et),g=!s||!o?"Loading...":"User Info";return t.jsxs(mt,{filterFields:[],children:[t.jsx(gt,{title:g}),(!s||!o)&&t.jsx(st,{}),s&&!x&&t.jsx(bt,{actionText:"view user information"}),s&&x&&o&&t.jsx(Dt,{user:j})]})}export{qt as default};
