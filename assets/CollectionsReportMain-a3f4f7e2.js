import{r as w,d as L,j as e,ai as S,u as A,aj as W,ak as z}from"./index-55b1d90f.js";import{L as H}from"./LoadingDisplay-b6502bb8.js";import{u as q}from"./useData-6d8d2e06.js";import{u as I}from"./usePageTitle-f818f1c1.js";import{u as k}from"./useWindowSize-ddd79567.js";import{C as U,a as P,b as O,c as Y,d as E,e as F,T as $}from"./TopLocks-229e6d79.js";import{e as G}from"./dataUrls-29ba4993.js";import{A as J}from"./AdminStatsTable-9eee2972.js";import{B as K}from"./nivo-bar.es-d0667e85.js";import{p as Q}from"./adminChartDefaults-e02caa29.js";import{c as V,d as X,T as Z,a as C,b as T,e as _}from"./TableRow-b96a9326.js";import{L as B}from"./Link-c5c5d4e3.js";import"./LPU-c3fa7122.js";import"./LinearProgress-ae469504.js";import"./useDocumentTitle-9d5712c3.js";import"./nivo-line.es-82278c78.js";import"./nivo-legends.es-595aaf85.js";import"./index-e45f583c.js";const ee=({data:t})=>{const o=w.useMemo(()=>{const{dailyAwardsTableData:n}=t,x=n.data.map(s=>s.date),c=L(x.reduce((s,l)=>l>s?l:s)),u=L("2024-10-25"),p=c.subtract(14,"day")>u?c.subtract(14,"day"):u;return{title:"",columns:n.columns,data:n.data.filter(s=>L(s.date).isAfter(p))}},[t]),m="100%",d=".83rem";return e.jsx("div",{style:{width:"100%"},children:e.jsx(J,{tableData:o,tableWidth:m,fontSize:d})})},te=({data:t})=>{const{maxBeltCounts:o}=t,m=S.map(i=>i.rank>20?null:{id:i.name,label:i.makeModels[0].model,count:o[i.id]||0,value:o[i.id]||0}).filter(i=>i),{width:d}=k(),n=d<=360,x=d<=395,c=d<=428,u=d<=820,p=n?180:x?190:c?200:u?240:250,s={top:0,right:20,bottom:80,left:50},l=["#d5d5d5","#d8d801","#ed7d01","#389700","#0090de","#634b9f","#9d5918","#ba0303","#1a1a1a","#373737","#baba12","#baba12","#baba12","#baba12","#baba12","#baba12","#baba12","#baba12","#baba12","#baba12","#baba12","#baba12","#baba12","#baba12","#baba12","#baba12","#baba12","#baba12"],h=["#000","#000","#000","#000","#000","#000","#000","#000","#ddd","#000","#000","#000","#000","#000","#000","#000","#000","#000","#000","#000","#000","#000","#000","#000","#000","#000","#000","#000","#000","#000","#000"];return e.jsx("div",{style:{height:p,width:"100%"},children:e.jsx(K,{data:m,margin:s,padding:.15,colors:i=>l[i.index%l.length],labelTextColor:i=>h[i.index%h.length],animate:!0,enableLabel:!0,labelSkipHeight:1,axisLeft:{tickSize:5,tickPadding:5,tickRotation:0,format:","},enableTotals:!0,axisBottom:{tickRotation:-45},enableGridY:!1,theme:Q,isInteractive:!1})})},ae=({tableData:t,tableWidth:o,tableHeight:m,fontSize:d,wrap:n,sortable:x,sort:c,setSort:u,ascending:p,setAscending:s,linkFunction:l})=>{A();const h=n?"inherit":"nowrap";t.columns.filter(a=>(a==null?void 0:a.id)&&(a==null?void 0:a.align));const[i,f]=w.useState(!1);t.columns.map(a=>(a==null?void 0:a.id)==="dateString"&&!i?f(!0):null),t.columns=i?t.columns.filter(a=>a.id!=="date"):t.columns;const y=w.useCallback(a=>{a!==c?(u(a),s(!0)):s(!p)},[p,s,u,c]);return e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.3rem",margin:"10px"},children:t.title}),e.jsx(V,{id:"statsTable",style:{padding:"0px 0px 0px 4px",width:o,marginLeft:"auto",marginRight:"auto",height:m},component:W,elevation:2,children:e.jsxs(X,{size:"small",stickyHeader:!!m,children:[e.jsx(Z,{children:e.jsx(C,{children:t.columns.map((a,g)=>e.jsx(T,{sx:{textAlign:a.align,fontSize:d,lineHeight:"1.1rem",padding:"8px",backgroundColor:"#111",color:"#fff"},component:"th",scope:"row",children:x&&a.id!=="index"&&e.jsx("div",{children:e.jsx(B,{onClick:()=>y(a.id),style:{color:c===a.id?"#fff":"#bbb"},children:a.name})})||e.jsx("div",{children:a.name})},g+1))})}),e.jsx(_,{children:t.data.map((a,g)=>e.jsx(C,{index:g,sx:{"&:nth-of-type(even) td, &:nth-of-type(even) th":{backgroundColor:"#191919"},"td, th":{}},children:t.columns.map((j,v)=>e.jsx(T,{sx:{textAlign:j.align,fontSize:d,whiteSpace:h,padding:"8px",border:0,color:"#eee"},component:"th",scope:"row",children:l(j.id,a[j.id]?a[j.id].toLocaleString():"")},v+1))},g))})]})})]})},se=({data:t})=>{const{awardsDisplayNames:o}=t,m=A(),d=!0,[n,x]=w.useState("acquired"),[c,u]=w.useState(!0),p=Object.keys(o).filter(r=>r).map(r=>({displayName:o[r].displayName,acquired:o[r].acquired,maxAward:S[o[r].maxAward].makeModels[0].model.replace(" Belt",""),beltName:S[o[r].maxAward].name.replace(" Belt",""),userId:r})).sort((r,b)=>{switch(n){case"acquired":return L(r[n]).valueOf()-L(b[n]).valueOf()||r.displayName.localeCompare(b.displayName);case"maxAward":return z(r.beltName,b.beltName);case"displayName":return r[n].localeCompare(b[n]);default:return r.displayName.localeCompare(b.displayName)}}),l=(c?p:p.reverse()).map((r,b)=>({...r,index:b+1})),h=w.useCallback((r,b)=>{const M=l.find(R=>R.displayName===b);return r==="displayName"?e.jsx(B,{onClick:()=>m(`/profile/${M.userId}/scorecard`),style:{color:"#fff"},children:b}):b},[m,l]);console.log("rows",l);const i={columns:[{name:"#",align:"center",id:"index"},{name:"Display Name",align:"left",id:"displayName"},{name:"Belt/Dan",align:"center",id:"maxAward"},{name:"Acquisition Date",align:"center",id:"acquired"}],data:l},{width:f}=k(),y=f<=360,a=f<=395,g=f<=428,j=f<=560,v=f<=820,N=y?".8rem":a?".85rem":".9rem",D="80%";return e.jsx(ae,{tableData:i,tableWidth:D,fontSize:N,sortable:d,sort:n,setSort:x,ascending:c,setAscending:u,linkFunction:h})};function Le(){I("Collection Report");const{data:t,loading:o,error:m}=q({url:G}),d=o?"--":"(updated: "+L(t.metadata.updatedDateTime).format("MM/DD/YY hh:mm")+` ${t.metadata.timezone})`,x=["listUsers","wishlistLocks","recordedLocks","scorecardLocks","pickedLocks","ownLocks"].reduce((h,i)=>{if(!t)return{};const f=t.dailyTableData.data.map(y=>({x:y.date,y:y[i]}));return h[i]={data:f,id:i},h},{}),{width:c}=k(),p=c<560?"8px 8px 32px 8px":"24px 24px 32px 24px",s={margin:"46px 0px 18px 0px",width:"100%",textAlign:"center",color:"#fff"},l={margin:"0px 0px 36px 0px",width:"100%",textAlign:"center",color:"#fff"};return o?e.jsx(H,{}):m?null:e.jsxs("div",{style:{minWidth:"320px",maxWidth:900,height:"100%",padding:p,backgroundColor:"#292929",marginLeft:"auto",marginRight:"auto",fontSize:"1.5rem",lineHeight:.8},children:[e.jsxs("div",{style:l,children:["Collections Summary",e.jsx("br",{}),e.jsx("span",{style:{fontSize:"0.85rem"},children:d})]}),e.jsx(U,{data:t}),e.jsx("div",{style:s,children:"Awards Summary"}),e.jsx(ee,{data:t}),e.jsx("div",{style:s,children:"Import Users by Belt"}),e.jsx(te,{data:t}),e.jsx("div",{style:s,children:"Import Users"}),e.jsx(se,{data:t}),e.jsx("div",{style:s,children:"List Users"}),e.jsx(P,{data:x}),e.jsx("div",{style:s,children:"List Locks by Date"}),e.jsx(O,{data:x}),e.jsx("div",{style:s,children:"Average Items Per List"}),e.jsx(Y,{data:t}),e.jsx("div",{style:s,children:"List Saves by Belt Ranking"}),e.jsx(E,{data:t}),e.jsx("div",{style:s,children:"Last 14 Days"}),e.jsx(F,{data:t}),e.jsx("div",{style:s,children:"Top Locks"}),e.jsx($,{data:t})]})}export{Le as default};
