import{r as t,u as N,b as H,j as e,L as K,B as S,X as k,D as G,A as M,R as X,e as _,N as J}from"./index-CABy1jrz.js";import{u as Q}from"./usePageTitle-B9r_pUuh.js";import{L as V}from"./LoadingDisplay-DeqVGTch.js";import{p as Z,c as ee}from"./postData-CTF7wkQ8.js";import{n as te}from"./dataUrls-CThgH6Wi.js";import{R as ne}from"./RaflPotSearchBox-CtgPXA2n.js";import{R as oe}from"./RaffleContext-Jq1t1_XZ.js";import{C as ie}from"./Checkbox-C1Io4A-n.js";import{C as se}from"./Collapse-CQFT_go9.js";import{T as a}from"./TextField-CArMZHwu.js";import{D as C}from"./Dialog-COiBi0j4.js";import"./Box-Bl-NST7j.js";import"./CircularProgress-DoeADkQH.js";import"./index-xsH4HHeE.js";import"./Search-DQFrsctb.js";import"./useFormControl-DbdBgyU5.js";import"./Select-zl_NM3N0.js";import"./useData-BC0fhSLd.js";import"./index-DNwQ6Bn2.js";import"./setDeep-J6HEwWhX.js";import"./SwitchBase-DFvUjpZp.js";function ae({profile:p,user:x}){const{allPots:m=[]}=t.useContext(oe),[g,f]=t.useState(void 0),[R,u]=t.useState(!1),[r,y]=t.useState(void 0),[n,j]=t.useState({}),[v,h]=t.useState({}),[d,W]=t.useState(!1),[L,w]=t.useState(""),[b,D]=t.useState(!1),[P,T]=t.useState(!1),s=t.useCallback(i=>{const{name:o,value:l}=i.target;j({...n,[o]:l}),T(!0)},[n]),A=t.useCallback(i=>{h(i);const o=m.find(l=>l.id===i.lockId);s({target:{name:"contributedBy",value:(o==null?void 0:o.contributedBy.join(", "))||""}})},[m,s]),B=async i=>{i.preventDefault(),u(!0);const o={...n,displayName:n.discordUsername||n.redditUsername||(p==null?void 0:p.displayName)||"unknown"},l=new FormData;Object.keys(o).forEach(c=>{l.append(c,o[c])}),l.append("subjectText",`Pot info submitted for ${v.lockFullName} by ${o.displayName||"unknown"}`),l.append("potName",v.lockFullName),l.append("potId",v.lockId);const q=`${te}/email-form`;try{const c=await Z({user:x,url:q,formData:l,snackBars:!1,timeoutDuration:2e4});k("Submit successful",{variant:"success"}),f(c)}catch(c){y(ee(c)),k(`Error creating request: ${c}`,{variant:"error",autoHideDuration:3e3})}finally{u(!1),j(o)}},z=t.useCallback(()=>{j({}),h({}),D(!b),u(!1),f(void 0),y(void 0)},[b]),I=t.useCallback(()=>{u(!1),f(void 0),y(void 0)},[]),U=t.useCallback(()=>{W(!d),h([])},[d]),F=t.useCallback(i=>{const{value:o}=i.target;w(o),h({lockFullName:o,lockName:o,lockId:"NOTINLIST"})},[]),O=d?.5:1,{flexStyle:E}=N(),Y={color:"#bbb",textDecoration:"underline",cursor:"pointer",fontWeight:500,"&:hover":{color:"#fff"}},$=H();return e.jsxs("div",{style:{maxWidth:800,padding:0,marginLeft:"auto",marginRight:"auto",marginTop:16,marginBottom:46,paddingLeft:8},children:[e.jsxs("div",{style:{fontSize:"1.7rem",fontWeight:600,marginBottom:20},children:["Pot Info  | ",e.jsx(K,{onClick:()=>$("/rafl/photos"),sx:Y,children:"Photos"})]}),e.jsx("form",{action:null,encType:"multipart/form-data",method:"post",onSubmit:B,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16,width:500},children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:500,margin:"0px 0px 0px"},children:"Select Pot"}),e.jsx("div",{style:{opacity:O},children:e.jsx(ne,{handleChangeLock:A,allEntries:m,disabled:d,reset:b})}),e.jsxs("div",{style:{marginTop:0},children:[e.jsx(ie,{onChange:U,color:"info",size:"small",id:"notInList",checked:d})," Submit photos for a pot not on the site."]}),e.jsxs(se,{in:d,style:{},children:[e.jsx("span",{style:{fontSize:"0.9rem"},children:"Pot Name"}),e.jsx("br",{}),e.jsx(a,{type:"text",id:"altLockName",name:"altLockName",value:L,style:{width:400,marginBottom:25},onChange:F,color:"info"})]}),e.jsx(a,{label:"Contributed by",name:"contributedBy",value:n.contributedBy||"",onChange:s,color:"info",fullWidth:!0}),e.jsx(a,{label:"Title",name:"title",value:n.title||"",onChange:s,color:"info",fullWidth:!0}),e.jsx(a,{label:"Pot contents",name:"potContents",value:n.potContents||"",onChange:s,fullWidth:!0,multiline:!0,color:"info",minRows:5}),e.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[e.jsx("div",{style:{minWidth:220},children:e.jsxs(a,{label:"Number of winners",name:"numberOfWinners",value:n.numberOfWinners||"",onChange:s,fullWidth:!0,select:!0,color:"info",SelectProps:{native:!0},children:[e.jsx("option",{"aria-label":"None",value:""}),Array.from({length:20},(i,o)=>o+1).map(i=>e.jsx("option",{value:i,children:i},i))]})}),e.jsx(a,{label:"Country",name:"country",value:n.country||"",onChange:s,fullWidth:!0,color:"info",style:{minWidth:260}})]}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:500,marginTop:10},children:"Shipping Info"}),e.jsxs(a,{label:"Shipping type",name:"shippingType",value:n.shippingType||"",onChange:s,fullWidth:!0,select:!0,color:"info",SelectProps:{native:!0},children:[e.jsx("option",{"aria-label":"None",value:""}),e.jsx("option",{value:"Digital prize",children:"Digital prize"}),e.jsx("option",{value:"International shipping included",children:"International shipping included"}),e.jsx("option",{value:"Split international shipping",children:"Split international shipping"}),e.jsx("option",{value:"Domestic only",children:"Domestic only"}),e.jsx("option",{value:"Winner pays international shipping",children:"Winner pays international shipping"})]}),n.shippingType==="Split international shipping"&&e.jsx(a,{label:"How much will you contribute to intl shipping?",name:"splitShippingAmount",value:n.splitShippingAmount||"",onChange:s,color:"info",style:{width:360}}),e.jsxs(a,{label:"Ships to US?",name:"shipsToUS",value:n.shipsToUS||"",onChange:s,fullWidth:!0,select:!0,color:"info",SelectProps:{native:!0},children:[e.jsx("option",{"aria-label":"None",value:""}),e.jsx("option",{value:"Yes",children:"Yes"}),e.jsx("option",{value:"Yes, buyer pays shipping + fees",children:"Yes, buyer pays shipping + fees"}),e.jsx("option",{value:"No",children:"No"})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("div",{style:{marginRight:50,width:300},children:e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:600},children:"Contact Info"})}),e.jsxs("div",{style:{display:E},children:[e.jsxs("div",{style:{marginRight:20},children:[e.jsx("div",{style:{fontSize:"1rem"},children:"Discord Username"}),e.jsx(a,{type:"text",name:"discordUsername",style:{width:200},onChange:s,value:n.discordUsername||"",color:"info"})]}),e.jsxs("div",{style:{marginRight:40},children:[e.jsx("div",{style:{fontSize:"1rem"},children:"AND/OR Reddit Username"}),e.jsx(a,{type:"text",name:"redditUsername",style:{width:200},onChange:s,value:n.redditUsername||"",color:"info"})]})]})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:e.jsx(S,{disabled:!P,type:"submit",variant:"contained",color:"success",children:"Submit"})})]})}),e.jsx(C,{open:R,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:.7}}},children:e.jsx("div",{style:{width:320,textAlign:"center",padding:30},children:e.jsx(V,{})})}),e.jsx(C,{open:!!g&&!r,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:.7}}},children:e.jsx("div",{style:{display:"flex"},children:e.jsxs("div",{style:{backgroundColor:"#444",marginLeft:"auto",marginRight:"auto",padding:40},children:[e.jsx("div",{style:{fontSize:"1.7rem",fontWeight:500,marginBottom:10,textAlign:"center"},children:"Submitted Successfully!"}),e.jsx("div",{style:{width:"100%",textAlign:"center"},children:e.jsx(S,{onClick:z,variant:"contained",color:"info",style:{marginLeft:"auto",marginRight:"auto"},children:"OK"})})]})})}),e.jsx(C,{open:!!r,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:.7}}},children:e.jsx("div",{style:{display:"flex"},children:e.jsxs("div",{style:{backgroundColor:"#444",marginLeft:"auto",marginRight:"auto",padding:40},children:[e.jsxs("div",{style:{fontSize:"1.7rem",fontWeight:500,marginBottom:20,textAlign:"center"},children:["Something went wrong.",e.jsx("br",{}),"Please try again later.",e.jsx("br",{})]}),e.jsxs("div",{style:{fontSize:"0.95rem",fontWeight:400,marginBottom:20,textAlign:"center"},children:[r==null?void 0:r.message,e.jsx("br",{}),"(Error code ",r==null?void 0:r.status,")"]}),e.jsx("div",{style:{width:"100%",textAlign:"center"},children:e.jsx(S,{onClick:I,variant:"contained",color:"error",style:{marginLeft:"auto",marginRight:"auto"},children:"OK"})})]})})})]})}function Le(){const{isMobile:p}=N(),{lockCollection:x}=t.useContext(G),{user:m}=t.useContext(M);Q("RAFL Pot Info");const g=e.jsx(X.Fragment,{children:!p&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}})});return e.jsxs(_,{children:[e.jsx(J,{title:"RAFL Pot Info",extras:g}),e.jsx(ae,{profile:x,user:m})]})}export{Le as default};
