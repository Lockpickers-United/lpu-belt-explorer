import{r as o,d as b,X as U,j as e,W,B as F,U as re,aj as ae,ak as T,at as V,a4 as H,D as O,R as w,b8 as de,P as ce,bO as ue,u as K,L as I,b as me,F as Q,Q as J,aA as fe,A as pe,N as Z,bb as xe,h as ee,e as he,T as ge}from"./index-CEbi-kOy.js";import{f as te,g as je}from"./filterFields-CzdKl1Kg.js";import{A as Ce}from"./AdminToolButtons-D82oLDkj.js";import{R as z}from"./RaffleContext-CJ9mUFkj.js";import{D as N}from"./DataContext-K_rCEOMQ.js";import{A as be}from"./AdvancedFilters-Ck9LYZJk.js";import{N as ve}from"./NoEntriesCard-D_pIHZON.js";import{R as Ae}from"./RaffleSearchBar-ClK7DMg3.js";import{b as Ee}from"./sortFields-JfaKIsUc.js";import{d as oe,F as X,C as Se}from"./download-CB2JY-HT.js";import{L as ke}from"./List-BwnIn7uv.js";import{C as De}from"./ContentCopy-j1dC3QOX.js";import{E as Re}from"./ExpandMore-BWq_wkMQ.js";import{C as Fe}from"./CopyLinkToRaflPotButton-BLxqysGH.js";import{F as _}from"./FieldValue-0ILlpD2-.js";import{B as Te}from"./BeltStripe-CBD9W3do.js";import{D as we}from"./Dialog-C4_CjMh-.js";import{S as le}from"./ScopedDialog-qAVLVqeY.js";import{T as ye}from"./TextField-CutxazB6.js";import{B as Le}from"./Box-Dq1GgrVn.js";import{A as Ie,a as We,b as Ne}from"./AccordionSummary-rRnhCnVF.js";import{A as Me}from"./AccordionActions-Bn2k9ltx.js";import{u as Be}from"./usePageTitle-C-UVnWLA.js";import{R as Oe}from"./RaffleEntryForm-uBPwmgCg.js";import{R as se}from"./RaffleHeader-DYBSEv7I.js";import{L as ze}from"./LoadingDisplay-BroRyBFn.js";import{r as Pe}from"./index-CR0HyL-6.js";import{a as $e,s as ne}from"./setDeep-J6HEwWhX.js";import{s as q}from"./searchEntriesForText-ernfOT6p.js";import{f as ie}from"./filterEntriesAdvanced-pqq4BRej.js";import"./EmojiEvents-BingAlj9.js";import"./useData-DO-rpLyT.js";import"./dataUrls-DVxTtpO-.js";import"./ViewFilterButtons-Je-kWHzH.js";import"./Sort-COSRVcpf.js";import"./Search-CnQuSSy6.js";import"./useFormControl-Dd8iBNXU.js";import"./Select-Cfjdq8yl.js";import"./FilterAlt-Bi8wxCXH.js";import"./entryName-ibwlP-8V.js";import"./HighlightOff-D7YV5N3N.js";import"./LockListContext-Cob3syyH.js";import"./ToggleButtonGroup-Bd78ML5t.js";import"./AddCircle-DqIvxzbE.js";import"./Cancel-CW4OSXjz.js";import"./ChoiceButtonGroup-DtX05CHs.js";import"./Collapse-DxyC267_.js";import"./SearchBox-BBmaxNBN.js";import"./Link-BSkSI2g2.js";import"./Zoom-7Oy5VYkP.js";import"./RaffleSubHead-BqZkQyQs.js";import"./RaffleAutocompleteBox-CxhXeSNb.js";import"./SignInDetect-CZGqqWlZ.js";import"./Cached-IenmrubG.js";import"./CircularProgress-bAoKJDbZ.js";import"./index-B9ygI19o.js";import"./stringUtils-BsiQ3MZ5.js";function Ge({text:t}){const[m,f]=o.useState(null),c=!!m,l=o.useCallback(i=>f(i.currentTarget),[]),u=o.useCallback(()=>f(null),[]),C=b().format("YYYY-MM-DD"),{raffleAdminRole:j}=o.useContext(z),{visibleEntries:p=[]}=o.useContext(N),v=o.useCallback(()=>{const i=JSON.stringify(p);u(),oe(`raffleEntries${C}.json`,i),U("Current RAFL entries downloaded as raffleEntries.json")},[C,u,p]),R=o.useCallback(()=>{const k=p.map(d=>{const A=d.pots.filter(x=>d.potsWon.includes(x.itemId)).map(x=>x.itemTitle);return{id:d.id,username:d.username,platform:d.platform,createdAt:d.createdAt,potNames:d.potNames.join(", "),donations:d.donations.map(x=>x.charity.itemTitle).join(", "),totalDonation:d.totalDonation,wonPots:A.join(", ")}}).map(d=>{let A=`${d.username} (${d.platform}) - $${d.totalDonation}
  POTS: ${d.potNames}
  DONATIONS: ${d.donations}
`;return d.wonPots.length>0&&(A+=`  POTS WON: ${d.wonPots}
`),A}).join(`
`);u(),navigator.clipboard.writeText(k).then(()=>{U("Current RAFL entries copied to clipboard.")})},[u,p]),S=o.useCallback(()=>{const i=p.map(x=>{const g=x.pots.filter(h=>x.potsWon.includes(h.itemId)).map(h=>h.itemTitle);return{id:x.id,username:x.username,platform:x.platform,totalDonation:`$${x.totalDonation}`,createdAt:b(x.createdAt).format("MM-DD-YYYY"),potNames:x.potNames.join(", "),donations:x.donations.map(h=>h.charity.itemTitle).join(", "),wonPots:g.join(", ")}}),k=Object.keys(i[0]).join(","),d=i.map(x=>Object.keys(i[0]).map(g=>x[g]).map(g=>{const h=`${g??""}`.replace(/"/g,'""');return/(\s|,|")/.test(h)?`"${h}"`:h}).join(",")).join(`
`),A=`${k}
${d}`;u(),oe("raffleEntries.csv",A),U("Current RAFL entries downloaded as raffleEntries.csv")},[u,p]);return e.jsxs("div",{children:[t?e.jsx(W,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{variant:"outlined",size:"small",onClick:l,style:{color:"#ddd",borderColor:"#aaa"},startIcon:e.jsx(X,{}),children:"Export"})}):e.jsx(W,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(re,{onClick:l,children:e.jsx(X,{})})}),e.jsxs(ae,{anchorEl:m,open:c,onClose:u,children:[!t&&e.jsxs(T,{disabled:!0,children:[e.jsx(V,{children:e.jsx(X,{fontSize:"small"})}),e.jsx(H,{children:"Export"})]}),e.jsxs(T,{onClick:R,children:[e.jsx(V,{children:e.jsx(De,{fontSize:"small"})}),e.jsx(H,{children:"Copy to clipboard"})]}),e.jsxs(T,{onClick:S,children:[e.jsx(V,{children:e.jsx(ke,{fontSize:"small"})}),e.jsx(H,{children:"CSV"})]}),j&&e.jsxs(T,{onClick:v,children:[e.jsx(V,{children:e.jsx(Se,{fontSize:"small"})}),e.jsx(H,{children:"JSON"})]})]})]})}function Ye({entry:t}){const{updateRaffleEntry:m,deleteRaffleEntry:f}=o.useContext(O),{statusLabels:c}=o.useContext(N),[l,u]=w.useState(null),C=!!l,j=g=>{u(g.currentTarget)},p=()=>{u(null)},v=o.useCallback(g=>{if(!g||g===t.status)return;const h={...t,status:g};g==="approved"?h.approvedAt=b().toISOString():g==="rejected"&&(h.rejectedAt=b().toISOString()),m(h).then(()=>{console.log("Entry status updated to",g)}).catch(y=>{console.error("Error updating entry status:",y)}),p()},[t,m]),R=t.status==="pending",S=t.status==="approved",i=t.status==="issues",k=t.status==="rejected",[d,A]=w.useState(!1),x=()=>{A(!1)};return e.jsxs(w.Fragment,{children:[e.jsx(W,{title:"Change Entry Status",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{variant:"contained",size:"small",endIcon:e.jsx(de,{}),onClick:j,style:{backgroundColor:c[t.status].backgroundColor,marginRight:0},children:t.status})}),e.jsx(ae,{open:C,anchorEl:l,onClose:p,children:e.jsxs(ce,{direction:"column",style:{minWidth:100},children:[e.jsx(T,{style:{color:R?"#fff":c.pending.backgroundColor},onClick:()=>v("pending"),disabled:R,children:"Pending"}),e.jsx(T,{style:{color:S?"#fff":c.approved.backgroundColor},onClick:()=>v("approved"),disabled:S,children:"Approved"}),e.jsx(T,{style:{color:i?"#fff":c.issues.backgroundColor},onClick:()=>v("issues"),disabled:i,children:"Issues"}),e.jsx(T,{style:{color:k?"#fff":c.rejected.backgroundColor},onClick:()=>v("rejected"),disabled:k,children:"Rejected"})]})}),e.jsxs(we,{open:d,onClose:x,children:[e.jsxs("div",{style:{padding:20,textAlign:"center"},children:["You cannot undo delete.",e.jsx("br",{}),"Are you sure?"]}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(F,{style:{marginBottom:10,color:"#000"},variant:"contained",onClick:()=>f(t).then(()=>A(!1)),edge:"start",color:"error",children:"Delete"})})]})]})}function Ve({entry:t,containerRef:m}){const{deleteRaffleEntry:f}=o.useContext(O),[c,l]=o.useState(!1),u=o.useCallback(()=>{l(!1)},[]),C=e.jsxs("div",{style:{textAlign:"center",fontWeight:700,fontSize:"1.1rem",padding:40},children:["You cannot undo delete.",e.jsx("br",{}),"Are you sure?",e.jsx("br",{}),e.jsx("br",{}),e.jsx(F,{style:{marginBottom:10,color:"#111"},variant:"contained",onClick:()=>f(t).then(()=>l(!1)),edge:"start",color:"error",children:"Delete"})]}),{isMobile:j}=ue();return e.jsxs(w.Fragment,{children:[e.jsx(W,{title:"Change Entry Status",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{variant:"text",size:"small",onClick:()=>l(!0),style:{color:"#e50808",margin:"0px 0px 0px 15px"},children:"Delete Entry"})}),e.jsx(le,{open:c,dialogContent:C,handleClose:u,containerRef:m,position:{top:80},centerX:!0,width:j?350:550})]})}function He({entry:t,containerRef:m}){var x;const{updateRaffleEntry:f}=o.useContext(O),[c,l]=o.useState(!1),u=o.useCallback(()=>{l(!0)},[]),C=o.useCallback(()=>{l(!1),p(t.notes||"")},[t.notes]),[j,p]=o.useState(t.notes||"");o.useEffect(()=>{p(t.notes||"")},[t.notes]);const v=g=>{p(g.target.value)},R=o.useCallback(()=>{const g={...t,notes:j||""};f(g,!1).then(()=>{console.log("Notes updated successfully")}).catch(h=>{console.error("Error updating notes:",h)}),C()},[t,C,j,f]),S=o.useCallback(()=>{const g={...t,notes:""};f(g,!1).then(()=>{}).catch(h=>{console.error("Error removing notes:",h)}),C()},[t,C,f]),{isMobile:i}=K(),k={fontSize:"1.0rem",fontWeight:400,marginBottom:5,paddingLeft:2,color:"#fff"},d=i?"0.95rem":"1.0rem",A=e.jsx("div",{style:{display:"flex"},children:e.jsxs("div",{style:{flexGrow:1,maxWidth:550,padding:10},children:[e.jsxs("div",{style:{marginTop:10,display:"flex"},children:[e.jsx("div",{style:{...k,flexGrow:1,fontWeight:700},children:"Entry Notes"}),e.jsxs("div",{style:{...k,color:"#aaa",fontSize:"0.85rem"},children:[j.length||0,"/1200"]})]}),e.jsx(ye,{type:"text",name:"notes",multiline:!0,fullWidth:!0,rows:3,value:j,onChange:v,id:"notes",color:"info",style:{},placeholder:"Add additional notes about this entry",variant:"outlined",autoFocus:!0,InputProps:{style:{fontSize:d}},slotProps:{htmlInput:{maxLength:1200}}}),e.jsxs("div",{style:{flexGrow:1,textAlign:"right",marginTop:8},children:[e.jsx(F,{variant:"text",size:"small",onClick:C,children:"Cancel"}),e.jsx(F,{variant:"text",size:"small",onClick:R,color:"success",children:"Save"})]})]})});return e.jsxs(Le,{sx:{position:"relative",overflow:"hidden",isolation:"isolate"},children:[((x=t.notes)==null?void 0:x.length)>0?e.jsxs("div",{style:{fontWeight:700,marginTop:15},children:[e.jsxs("div",{style:{display:"flex"},children:[e.jsx("span",{style:{marginTop:-.6},children:"Notes  "}),e.jsx(I,{style:{fontWeight:400,color:"#2bb259"},onClick:u,children:"edit"})," • ",e.jsx(I,{style:{fontWeight:400,color:"#2bb259"},onClick:S,children:"remove"})]}),e.jsx("div",{style:{fontSize:d,marginLeft:10,fontWeight:400,fontStyle:"italic"},children:t.notes})]}):e.jsx("div",{style:{fontWeight:700,marginTop:15},children:e.jsx(I,{style:{fontWeight:600,color:"#2bb259"},onClick:u,children:"Add notes"})}),e.jsx(le,{open:c,dialogContent:A,handleClose:C,containerRef:m,position:{top:80},centerX:!0,width:i?350:550})]})}function Ke({entry:t,expanded:m,onExpand:f,setEditEntryId:c}){var B,Y;const{raffleAdminRole:l}=o.useContext(z),{expandAll:u,statusLabels:C}=o.useContext(N),{updateRaffleEntry:j}=o.useContext(O),p=me(),{filters:v}=o.useContext(Q),{sort:R}=v||{},[S,i]=o.useState(!1),k={maxWidth:700,marginLeft:"auto",marginRight:"auto"},d=o.useRef(null);o.useEffect(()=>{if(m&&d&&!S&&!u){console.log("entry",t);const r=window.innerWidth<=600?70:74;i(!0),setTimeout(()=>{window.scrollTo({left:0,top:d.current.offsetTop-r,behavior:m?"auto":"smooth"})},m?0:100)}else m||i(!1)},[m,t,S,u]);const A=o.useCallback((s,r)=>{f&&f(r?t==null?void 0:t.id:!1)},[t==null?void 0:t.id,f]),x=b(t==null?void 0:t.updatedAt).valueOf()-b(t==null?void 0:t.createdAt).valueOf()>6e4,g=o.useCallback(s=>{const r=window.open(s,"_blank","noopener,noreferrer");r&&(r.opener=null)},[]),h=o.useCallback(s=>{p(s)},[p]),y=o.useCallback(s=>{if(!l)return;const r=t.donations.map((a,D)=>D===s?{...a,approved:!a.approved}:a),n={...t,donations:r};j(n).then(()=>{console.log("Donation approval toggled")}).catch(a=>{console.error("Error updating donation approval:",a)})},[t,l,j]),{isMobile:E,flexStyle:P}=K(),$=E?"12px 0px 8px 0px":"12px 0px 8px 8px",M=E?"0.95rem":"1.0rem",L=E?2:10,G={no:{backgroundColor:"#333",color:"#aaa"},yes:{backgroundColor:"#aaa",color:"#fff"}};return e.jsxs(Ie,{expanded:m,onChange:A,style:k,ref:d,children:[e.jsxs(We,{expandIcon:e.jsx(Re,{}),sx:{".MuiAccordionSummary-content":{margin:"6px 0px"}},children:[e.jsx(Te,{value:C[t.status].entryColor}),e.jsxs("div",{style:{display:P,alignItems:"center",flexGrow:1},children:[e.jsxs("div",{style:{margin:$,display:"flex",flexGrow:1,fontWeight:600,color:((B=t.potsWon)==null?void 0:B.length)>0?"#2bb259":"#fff"},children:[t==null?void 0:t.username," ",e.jsxs("span",{style:{fontWeight:400,color:"#777",marginLeft:8},children:["(",t.platform.toLowerCase(),")"]}),((Y=t.potsWon)==null?void 0:Y.length)>0&&e.jsx("span",{style:{fontWeight:600,color:"#2bb259",marginLeft:12},children:"Winner"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[e.jsx(_,{name:"Submitted",value:e.jsx(J,{style:{fontSize:"0.95rem",lineHeight:1.25},children:b(t==null?void 0:t.createdAt).format("MMM DD")}),style:{marginRight:20}}),R==="updatedAt"&&e.jsx(_,{name:"Updated",value:e.jsx(J,{style:{fontSize:"0.95rem",lineHeight:1.25},children:b(t==null?void 0:t.updatedAt).format("MMM DD")}),textStyle:x?{}:{color:"#777"},style:{marginRight:30}}),e.jsx(_,{name:"Donations",value:e.jsxs(J,{style:{fontSize:"0.95rem",lineHeight:1.25},children:["$ ",Intl.NumberFormat().format(t.totalDonation)]}),textStyle:t.totalDonation!==t.allocatedTickets?{color:"#f33"}:{},style:{marginRight:20}})]})]})]}),m&&e.jsxs(w.Fragment,{children:[e.jsxs(Ne,{sx:{padding:"0px 16px 0px 16px",margin:"0px 10px"},children:[e.jsxs("div",{style:{textAlign:"right",margin:"0px 0px 10px 0px",fontWeight:700},children:["Entry Status  ",e.jsx(Ye,{entry:t})]}),e.jsx("div",{style:{fontWeight:500,fontSize:"0.8rem"},children:"DONATIONS"}),t.donations.map((s,r)=>{var n,a;return e.jsxs("div",{style:{display:"flex",flexGrow:1,alignItems:"center",fontSize:M,marginLeft:L,marginBottom:4},children:[e.jsx("div",{style:{fontWeight:500,flexGrow:1},children:((n=s.charity)==null?void 0:n.itemFullTitle)||((a=s.charity)==null?void 0:a.itemTitle)||"No Charity Selected"}),E?e.jsx(W,{title:"My Collection",arrow:!0,disableFocusListener:!0,children:e.jsx(re,{variant:"outlined",color:"inherit",onClick:()=>g(s.receipt),style:{marginRight:10},children:e.jsx(fe,{fontSize:"small"})})}):e.jsxs("div",{style:{display:"flex"},children:[s.receipt&&e.jsxs("span",{children:["Receipt: ",e.jsx(I,{style:{color:"#ccc",textDecoration:"underline",cursor:"pointer"},onClick:()=>g(s.receipt),children:(s.receipt.match(/^(?:https?:\/\/)?([^/?#]+)/i)||[])[1]}),"  "]}),s.amount>0&&e.jsxs("span",{style:{marginRight:6},children:["Donation: $ ",Intl.NumberFormat().format(s.amount)]})]}),e.jsx(F,{style:{minWidth:20,padding:"0px 5px",...G[s.approved?"yes":"no"]},onClick:()=>y(r),variant:"contained",children:"OK"})]},r)}),e.jsx("div",{style:{fontWeight:500,fontSize:"0.8rem",marginTop:10},children:"POTS"}),t.pots.map((s,r)=>e.jsxs("div",{style:{display:"flex",flexGrow:1,fontSize:M,marginLeft:10},children:[e.jsxs("div",{style:{fontWeight:500,marginBottom:4,flexGrow:1},children:[e.jsx(I,{style:{color:"#fff",textDecoration:"none",cursor:"pointer"},onClick:()=>h(`/rafl/?id=${s.itemId}`),children:(s==null?void 0:s.itemFullTitle)||(s==null?void 0:s.itemTitle)||"No Pot Selected"}),s.winner&&e.jsx(I,{style:{color:"#2bb259",fontWeight:700,marginLeft:12},onClick:()=>h(`/rafl/?id=${s.itemId}`),children:"Winner"})]}),e.jsx("div",{style:{marginBottom:4},children:(s==null?void 0:s.tickets)>0&&e.jsxs("span",{style:{marginRight:12},children:["Tickets: ",Intl.NumberFormat().format(s.tickets)]})})]},r)),e.jsx(He,{entry:t,containerRef:d}),e.jsxs("div",{style:{fontSize:"0.9rem",fontWeight:400,marginTop:10,textAlign:"right"},children:["Last updated: ",b(t==null?void 0:t.updatedAt).format("MMM DD")]}),e.jsx("div",{style:{textAlign:"center",margin:"15px 0px 5px 0px"},children:e.jsx(W,{title:"Edit Entry",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{variant:"contained",size:"small",onClick:()=>{c(t.id)},style:{backgroundColor:"#2bb259",color:"#000",padding:"6px 14px"},children:"EDIT ENTRY"})})})]}),e.jsxs(Me,{disableSpacing:!0,children:[e.jsx("div",{style:{display:"flex",flexGrow:1},children:e.jsx(Ve,{entry:t,containerRef:d})}),e.jsx(Fe,{entry:t})]})]})]})}const Ue=w.memo(Ke,(t,m)=>{const f=Object.keys(t.entry),c=Object.keys(m.entry);if(f.length!==c.length)return!1;for(let l=0;l<f.length;l++)if(f[l]!==c[l]||t.entry[f[l]]!==m.entry[c[l]])return!1;return t.expanded===m.expanded&&t.onExpand===m.onExpand});function Je({editEntryId:t,setEditEntryId:m}){const{filters:f}=o.useContext(Q),[c,l]=o.useState(f.id),{visibleEntries:u,expandAll:C}=o.useContext(N),{summary:j}=o.useContext(z);console.log("summary",j),Be("RAFL Admin - Submitted Entries");const p=o.useDeferredValue(c),v=o.useCallback(i=>{l(i)},[]),{isMobile:R}=K(),S=R?{maxWidth:700,marginLeft:"auto",marginRight:"auto",padding:8}:{maxWidth:700,marginLeft:"auto",marginRight:"auto",padding:"12px 12px 12px 12px"};return e.jsxs("div",{style:{paddingBottom:32},children:[e.jsx("div",{style:{...S,paddingBottom:0,backgroundColor:"#333"},children:e.jsx("div",{style:{padding:"4px 4px 4px 4px"},children:e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:500,marginTop:1,marginBottom:0},children:"Submitted RAFL Entries"})})}),e.jsx(Ae,{label:"Raffle Entries",sortValues:Ee,entryCount:u.length}),e.jsx(be,{}),u.length===0&&e.jsx(ve,{label:"Rafl Entries"}),u.map(i=>e.jsx(Ue,{entry:i,onExpand:v,expanded:i.id===p||!!C,editId:t,setEditEntryId:m},i.id)),e.jsx("div",{style:{marginLeft:"auto",marginRight:"auto",textAlign:"center",justifyItems:"center",marginTop:30},children:e.jsx(Ge,{text:!0})})]})}function Xe({children:t}){const m=o.useContext(N),{entriesLoaded:f,allRaffleEntries:c,winnerData:l}=o.useContext(O),{allPots:u}=o.useContext(z),{filters:C,advancedFilterGroups:j}=o.useContext(Q),{search:p,id:v,tab:R,name:S,sort:i,image:k,preview:d,single:A,expandAll:x,...g}=C||{},h=o.useMemo(()=>Object.keys(l).reduce((s,r)=>(l[r].map(n=>{$e(s,[n.entryId],r)}),s),{}),[l]),y=.3,E=o.useMemo(()=>{let s={},r={};return c==null||c.forEach(n=>{n.donations.forEach(a=>{ne(s,[n.id],a.charity.itemFullTitle)},[]),n.pots.forEach(a=>{var D;ne(r,[n.id],a.itemTitle),(D=h[n.id])!=null&&D.includes(a.itemId)&&(a.winner=!0)},[])},{}),c.map(n=>{var a;return{...n,charities:s[n.id]||[],potNames:r[n.id]||[],content:[n.notes&&n.notes.length>0&&"Has Notes",n.donations.every(D=>D.approved)?"All Donations OK":"Donations not OK"].filter(Boolean),potsWon:h[n.id]||[],potWinner:((a=h[n.id])==null?void 0:a.length)>0?"Won Pots":"No Wins",fuzzy:Pe([n.username,...s[n.id],...r[n.id]].join(","))}})},[c,h]),P=o.useMemo(()=>E.reduce((s,r)=>(r.pots.forEach(n=>{s.push({username:r.username,entryId:r.id,platform:r.platform,potId:n.itemId,potTickets:n.tickets})}),s),[]),[E]),$=o.useMemo(()=>q(p,[...E],y),[E,p]),M=o.useMemo(()=>{if(!f)return[];const s=ie({advancedFilterGroups:j(),entries:E}),r=q(p,[...s],y);return i?r.sort((n,a)=>{var D;return i==="updatedAt"?b(n.updatedAt).isBefore(b(a.updatedAt))?1:-1:i==="status"?te(n.status,a.status):i==="username"?(D=n.username)==null?void 0:D.localeCompare(a.username):i==="totalDonation"?a.totalDonation-n.totalDonation:b(n.createdAt).isBefore(b(a.createdAt))?1:-1}):r.sort((n,a)=>b(n.createdAt).isBefore(b(a.createdAt))?1:-1)},[j,f,E,p,i]),L=o.useMemo(()=>u.map(s=>{const r=P.filter(n=>n.potId===s.id);return r.length>0&&(s.entrants=r),s},[]),[u,P]),G=o.useMemo(()=>{const s=ie({advancedFilterGroups:j(),entries:E}),r=q(p,[...s],y);return i?r.sort((n,a)=>{var D;return i==="updatedAt"?b(n.updatedAt).isBefore(b(a.updatedAt))?1:-1:i==="status"?te(n.status,a.status):i==="username"?(D=n.username)==null?void 0:D.localeCompare(a.username):i==="totalDonation"?a.totalDonation-n.totalDonation:b(n.createdAt).isBefore(b(a.createdAt))?1:-1}):r.sort((n,a)=>n.potNumber-a.potNumber)},[j,E,p,i]),B=o.useCallback(s=>L.find(r=>r.id===s),[L]),Y=o.useMemo(()=>({...m,allEntries:c,searchedEntries:$,visibleEntries:M,mappedPotEntries:L,visiblePotEntries:G,getPotFromId:B,expandAll:x,statusLabels:_e}),[m,c,$,M,L,G,B,x]);return e.jsx(N.Provider,{value:Y,children:t})}const _e={pending:{entryColor:"Blue",backgroundColor:"#3e71bd",textColor:"#fff"},approved:{entryColor:"Green",backgroundColor:"#34732f",textColor:"#fff"},issues:{entryColor:"Orange",backgroundColor:"#e16936",textColor:"#fff"},rejected:{entryColor:"Red",backgroundColor:"#c52323",textColor:"#fff"}};function eo(){const{raffleAdmin:t,setRaffleAdminRole:m}=o.useContext(z),{authLoaded:f,isLoggedIn:c}=o.useContext(pe);o.useEffect(()=>{t&&m(!0)});const{isMobile:l}=K(),[u,C]=o.useState(null),j=e.jsxs(w.Fragment,{children:[!l&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}}),e.jsx(Ce,{})]});if(!f)return e.jsx(ze,{message:"Loading..."});if(f&&!t)return e.jsxs(w.Fragment,{children:[e.jsx(Z,{title:"RAFL Admin",extras:j}),e.jsx(se,{page:"RAFL Admin"}),e.jsxs("div",{style:{padding:20},children:[!c&&e.jsx("div",{children:"Please log in to access this page."}),c&&!t&&e.jsx("div",{children:"Sorry, you do not have access to this page."}),e.jsx("div",{children:e.jsx(xe,{})})]}),e.jsx(ee,{})]});const p=l?8:0,v={maxWidth:700,marginLeft:"auto",marginRight:"auto",paddingLeft:p,paddingRight:p};return e.jsx(he,{filterFields:je,children:e.jsx(Xe,{children:e.jsxs("div",{style:v,children:[e.jsx(Z,{title:"RAFL Admin",extras:j}),e.jsx(se,{page:"entries"}),t&&!u&&e.jsx(Je,{editEntryId:u,setEditEntryId:C}),t&&!!u&&e.jsx(Oe,{editEntryId:u,setEditEntryId:C}),e.jsx(ee,{}),e.jsx(ge,{feature:"raflAdmin"})]})})})}export{eo as default};
