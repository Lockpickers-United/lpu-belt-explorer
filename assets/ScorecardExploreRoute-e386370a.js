import{j as i,r as w,aL as Jt,$ as Ze,R as Te,F as Qe,au as Ue,u as zt,b as Kt,J as ct,I as dt,ac as Qt,aj as en,d as ut,as as tn,bN as nn,bO as rn,D as on,N as ln,e as sn,a0 as an,h as cn,T as dn}from"./index-e87f8ca7.js";import{L as un}from"./LoadingDisplay-2344ee8b.js";import{u as hn}from"./useData-4bbfc019.js";import{u as fn}from"./usePageTitle-f15eb818.js";import{_ as pn,d as gn,a as mn,l as yn}from"./lockStats-c30c427e.js";import{E as bn}from"./ErrorMessage-e4bcdb8f.js";import{b as Ge,a as vn}from"./chartDefaults-bfd54756.js";import{L as ye}from"./Link-11e48b16.js";import{D as Tt,f as xn}from"./DataContext-cf6b8e88.js";import{r as ht}from"./index-4b2ec534.js";import{e as ft}from"./entryName-3ab11215.js";import{B as kn}from"./BeltStripeMini-b393a49a.js";import{a as Wt,b as je,c as pt,d as gt,T as Cn,e as mt}from"./TableRow-5d5cdf40.js";import{V as Bn}from"./ViewFilterButtons-fc3ceb47.js";import{b as jn}from"./sortFields-b1bde6f9.js";import{F as wn,I as Ln,S as Sn}from"./Select-69a54d16.js";import{C as On}from"./Collapse-bf3bbbf1.js";import{r as Mn}from"./nivo-legends.es-f511e2f0.js";import{b as Pn,g as et,j as zn,q as Tn,k as Wn,e as An,T as yt,d as bt,f as En,h as vt,l as Dn,M as $n,n as In,o as Fn,L as tt,z as At,r as Rn}from"./nivo-colors-6f134e67.js";import{k as Pe,bG as _n,u as Et}from"./_createSet-71fc1d31.js";import{a as Nn}from"./_baseClone-3fd5b2fe.js";import{a as Ye}from"./adminChartDefaults-c1f0e13b.js";import{b as Hn}from"./filterFields-787aff4d.js";import{c as Un}from"./collectionStatsById-8def94ca.js";import{b as Gn,c as Yn,p as Vn,a as qn,s as Xn,d as Zn,o as Jn,e as Kn,f as Qn}from"./dataUrls-88e95518.js";import"./LPU-c3fa7122.js";import"./LinearProgress-865fbac0.js";import"./useDocumentTitle-56036f40.js";import"./line-c9c3db6d.js";import"./path-a545ef0e.js";import"./Sort-5fd595d5.js";import"./Chip-e74059e5.js";import"./FilterAlt-1f55115c.js";import"./Box-68c7a76b.js";import"./LockListContext-37e1a261.js";import"./ToggleButtonGroup-0a56fb47.js";import"./Cancel-e2f78900.js";import"./index-92c7f5db.js";import"./rankingRequestData-d3ef79e5.js";function xt(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let o of e)(o=t(o,++n,e))!=null&&(r<o||r===void 0&&o>=o)&&(r=o)}return r}function Dt(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let o of e)(o=t(o,++n,e))!=null&&(r>o||r===void 0&&o>=o)&&(r=o)}return r}function Ve(e,t){let r=0;if(t===void 0)for(let n of e)(n=+n)&&(r+=n);else{let n=-1;for(let o of e)(o=+t(o,++n,e))&&(r+=o)}return r}function me(e){return function(){return e}}const Je=Math.PI,Ke=2*Je,ae=1e-6,er=Ke-ae;function $t(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function tr(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return $t;const r=10**t;return function(n){this._+=n[0];for(let o=1,a=n.length;o<a;++o)this._+=Math.round(arguments[o]*r)/r+n[o]}}class nr{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?$t:tr(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,o){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+o}`}bezierCurveTo(t,r,n,o,a,c){this._append`C${+t},${+r},${+n},${+o},${this._x1=+a},${this._y1=+c}`}arcTo(t,r,n,o,a){if(t=+t,r=+r,n=+n,o=+o,a=+a,a<0)throw new Error(`negative radius: ${a}`);let c=this._x1,d=this._y1,u=n-t,s=o-r,m=c-t,C=d-r,g=m*m+C*C;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(g>ae)if(!(Math.abs(C*u-s*m)>ae)||!a)this._append`L${this._x1=t},${this._y1=r}`;else{let S=n-c,y=o-d,A=u*u+s*s,M=S*S+y*y,L=Math.sqrt(A),P=Math.sqrt(g),v=a*Math.tan((Je-Math.acos((A+g-M)/(2*L*P)))/2),h=v/P,W=v/L;Math.abs(h-1)>ae&&this._append`L${t+h*m},${r+h*C}`,this._append`A${a},${a},0,0,${+(C*S>m*y)},${this._x1=t+W*u},${this._y1=r+W*s}`}}arc(t,r,n,o,a,c){if(t=+t,r=+r,n=+n,c=!!c,n<0)throw new Error(`negative radius: ${n}`);let d=n*Math.cos(o),u=n*Math.sin(o),s=t+d,m=r+u,C=1^c,g=c?o-a:a-o;this._x1===null?this._append`M${s},${m}`:(Math.abs(this._x1-s)>ae||Math.abs(this._y1-m)>ae)&&this._append`L${s},${m}`,n&&(g<0&&(g=g%Ke+Ke),g>er?this._append`A${n},${n},0,1,${C},${t-d},${r-u}A${n},${n},0,1,${C},${this._x1=s},${this._y1=m}`:g>ae&&this._append`A${n},${n},0,${+(g>=Je)},${C},${this._x1=t+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(t,r,n,o){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+o}h${-n}Z`}toString(){return this._}}function rr(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new nr(t)}function or(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ir(e){return e[0]}function lr(e){return e[1]}function kt(e,t){var r=me(!0),n=null,o=Pn,a=null,c=rr(d);e=typeof e=="function"?e:e===void 0?ir:me(e),t=typeof t=="function"?t:t===void 0?lr:me(t);function d(u){var s,m=(u=or(u)).length,C,g=!1,S;for(n==null&&(a=o(S=c())),s=0;s<=m;++s)!(s<m&&r(C=u[s],s,u))===g&&((g=!g)?a.lineStart():a.lineEnd()),g&&a.point(+e(C,s,u),+t(C,s,u));if(S)return a=null,S+""||null}return d.x=function(u){return arguments.length?(e=typeof u=="function"?u:me(+u),d):e},d.y=function(u){return arguments.length?(t=typeof u=="function"?u:me(+u),d):t},d.defined=function(u){return arguments.length?(r=typeof u=="function"?u:me(!!u),d):r},d.curve=function(u){return arguments.length?(o=u,n!=null&&(a=o(n)),d):o},d.context=function(u){return arguments.length?(u==null?n=a=null:a=o(n=u),d):n},d}function we(){return we=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},we.apply(null,arguments)}function Ct(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var sr=["style","children"],ar=["outlineWidth","outlineColor","outlineOpacity"],It=function(e){var t=e.style,r=e.children,n=Ct(e,sr),o=t.outlineWidth,a=t.outlineColor,c=t.outlineOpacity,d=Ct(t,ar);return i.jsxs(i.Fragment,{children:[o>0&&i.jsx(Pe.text,we({},n,{style:we({},d,{strokeWidth:2*o,stroke:a,strokeOpacity:c,strokeLinejoin:"round"}),children:r})),i.jsx(Pe.text,we({},n,{style:d,children:r}))]})},cr=function(e){var t=e.x,r=e.y,n=e.size,o=e.fill,a=e.opacity,c=a===void 0?1:a,d=e.borderWidth,u=d===void 0?0:d,s=e.borderColor;return i.jsx("circle",{r:n/2,cx:t+n/2,cy:r+n/2,fill:o,opacity:c,strokeWidth:u,stroke:s===void 0?"transparent":s,style:{pointerEvents:"none"}})},dr=function(e){var t=e.x,r=e.y,n=e.size,o=e.fill,a=e.opacity,c=a===void 0?1:a,d=e.borderWidth,u=d===void 0?0:d,s=e.borderColor;return i.jsx("g",{transform:"translate("+t+","+r+")",children:i.jsx("path",{d:`
                    M`+n/2+` 0
                    L`+.8*n+" "+n/2+`
                    L`+n/2+" "+n+`
                    L`+.2*n+" "+n/2+`
                    L`+n/2+` 0
                `,fill:o,opacity:c,strokeWidth:u,stroke:s===void 0?"transparent":s,style:{pointerEvents:"none"}})})},ur=function(e){var t=e.x,r=e.y,n=e.size,o=e.fill,a=e.opacity,c=a===void 0?1:a,d=e.borderWidth,u=d===void 0?0:d,s=e.borderColor;return i.jsx("rect",{x:t,y:r,fill:o,opacity:c,strokeWidth:u,stroke:s===void 0?"transparent":s,width:n,height:n,style:{pointerEvents:"none"}})},hr=function(e){var t=e.x,r=e.y,n=e.size,o=e.fill,a=e.opacity,c=a===void 0?1:a,d=e.borderWidth,u=d===void 0?0:d,s=e.borderColor;return i.jsx("g",{transform:"translate("+t+","+r+")",children:i.jsx("path",{d:`
                M`+n/2+` 0
                L`+n+" "+n+`
                L0 `+n+`
                L`+n/2+` 0
            `,fill:o,opacity:c,strokeWidth:u,stroke:s===void 0?"transparent":s,style:{pointerEvents:"none"}})})};function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ce.apply(null,arguments)}var fr={top:0,right:0,bottom:0,left:0},Ft=function(e){var t,r=e.direction,n=e.itemsSpacing,o=e.padding,a=e.itemCount,c=e.itemWidth,d=e.itemHeight;if(typeof o!="number"&&(typeof(t=o)!="object"||Array.isArray(t)||t===null))throw new Error("Invalid property padding, must be one of: number, object");var u=typeof o=="number"?{top:o,right:o,bottom:o,left:o}:ce({},fr,o),s=u.left+u.right,m=u.top+u.bottom,C=c+s,g=d+m,S=(a-1)*n;return r==="row"?C=c*a+S+s:r==="column"&&(g=d*a+S+m),{width:C,height:g,padding:u}},pr=function(e){var t=e.anchor,r=e.translateX,n=e.translateY,o=e.containerWidth,a=e.containerHeight,c=e.width,d=e.height,u=r,s=n;switch(t){case"top":u+=(o-c)/2;break;case"top-right":u+=o-c;break;case"right":u+=o-c,s+=(a-d)/2;break;case"bottom-right":u+=o-c,s+=a-d;break;case"bottom":u+=(o-c)/2,s+=a-d;break;case"bottom-left":s+=a-d;break;case"left":s+=(a-d)/2;break;case"center":u+=(o-c)/2,s+=(a-d)/2}return{x:u,y:s}},gr=function(e){var t,r,n,o,a,c,d=e.direction,u=e.justify,s=e.symbolSize,m=e.symbolSpacing,C=e.width,g=e.height;switch(d){case"left-to-right":t=0,r=(g-s)/2,o=g/2,c="central",u?(n=C,a="end"):(n=s+m,a="start");break;case"right-to-left":t=C-s,r=(g-s)/2,o=g/2,c="central",u?(n=0,a="start"):(n=C-s-m,a="end");break;case"top-to-bottom":t=(C-s)/2,r=0,n=C/2,a="middle",u?(o=g,c="alphabetic"):(o=s+m,c="text-before-edge");break;case"bottom-to-top":t=(C-s)/2,r=g-s,n=C/2,a="middle",u?(o=0,c="text-before-edge"):(o=g-s-m,c="alphabetic")}return{symbolX:t,symbolY:r,labelX:n,labelY:o,labelAnchor:a,labelAlignment:c}},mr={circle:cr,diamond:dr,square:ur,triangle:hr},yr=function(e){var t,r,n,o,a,c,d,u,s,m,C,g=e.x,S=e.y,y=e.width,A=e.height,M=e.data,L=e.direction,P=L===void 0?"left-to-right":L,v=e.justify,h=v!==void 0&&v,W=e.textColor,j=e.background,B=j===void 0?"transparent":j,k=e.opacity,F=k===void 0?1:k,I=e.symbolShape,_=I===void 0?"square":I,G=e.symbolSize,N=G===void 0?16:G,Y=e.symbolSpacing,l=Y===void 0?8:Y,x=e.symbolBorderWidth,b=x===void 0?0:x,f=e.symbolBorderColor,p=f===void 0?"transparent":f,T=e.onClick,E=e.onMouseEnter,H=e.onMouseLeave,U=e.toggleSerie,R=e.effects,q=w.useState({}),O=q[0],$=q[1],X=et(),ue=w.useCallback(function(Q){if(R){var ve=R.filter(function(ee){return ee.on==="hover"}).reduce(function(ee,xe){return ce({},ee,xe.style)},{});$(ve)}E==null||E(M,Q)},[E,M,R]),he=w.useCallback(function(Q){if(R){var ve=R.filter(function(ee){return ee.on!=="hover"}).reduce(function(ee,xe){return ce({},ee,xe.style)},{});$(ve)}H==null||H(M,Q)},[H,M,R]),K=gr({direction:P,justify:h,symbolSize:(t=O.symbolSize)!=null?t:N,symbolSpacing:l,width:y,height:A}),fe=K.symbolX,oe=K.symbolY,z=K.labelX,be=K.labelY,pe=K.labelAnchor,We=K.labelAlignment,Le=[T,E,H,U].some(function(Q){return Q!==void 0}),Ae=typeof _=="function"?_:mr[_];return i.jsxs("g",{transform:"translate("+g+","+S+")",style:{opacity:(r=O.itemOpacity)!=null?r:F},children:[i.jsx("rect",{width:y,height:A,fill:(n=O.itemBackground)!=null?n:B,style:{cursor:Le?"pointer":"auto"},onClick:function(Q){T==null||T(M,Q),U==null||U(M.id)},onMouseEnter:ue,onMouseLeave:he}),w.createElement(Ae,ce({id:M.id,x:fe,y:oe,size:(o=O.symbolSize)!=null?o:N,fill:(a=(c=M.fill)!=null?c:M.color)!=null?a:"black",borderWidth:(d=O.symbolBorderWidth)!=null?d:b,borderColor:(u=O.symbolBorderColor)!=null?u:p},M.hidden?X.legends.hidden.symbol:void 0)),i.jsx(It,{textAnchor:pe,style:ce({},X.legends.text,{fill:(s=(m=(C=O.itemTextColor)!=null?C:W)!=null?m:X.legends.text.fill)!=null?s:"black",dominantBaseline:We,pointerEvents:"none",userSelect:"none"},M.hidden?X.legends.hidden.text:void 0),x:z,y:be,children:M.label})]})},br=function(e){var t=e.data,r=e.x,n=e.y,o=e.direction,a=e.padding,c=a===void 0?0:a,d=e.justify,u=e.effects,s=e.itemWidth,m=e.itemHeight,C=e.itemDirection,g=C===void 0?"left-to-right":C,S=e.itemsSpacing,y=S===void 0?0:S,A=e.itemTextColor,M=e.itemBackground,L=M===void 0?"transparent":M,P=e.itemOpacity,v=P===void 0?1:P,h=e.symbolShape,W=e.symbolSize,j=e.symbolSpacing,B=e.symbolBorderWidth,k=e.symbolBorderColor,F=e.onClick,I=e.onMouseEnter,_=e.onMouseLeave,G=e.toggleSerie,N=Ft({itemCount:t.length,itemWidth:s,itemHeight:m,itemsSpacing:y,direction:o,padding:c}).padding,Y=o==="row"?s+y:0,l=o==="column"?m+y:0;return i.jsx("g",{transform:"translate("+r+","+n+")",children:t.map(function(x,b){return i.jsx(yr,{data:x,x:b*Y+N.left,y:b*l+N.top,width:s,height:m,direction:g,justify:d,effects:u,textColor:A,background:L,opacity:v,symbolShape:h,symbolSize:W,symbolSpacing:j,symbolBorderWidth:B,symbolBorderColor:k,onClick:F,onMouseEnter:I,onMouseLeave:_,toggleSerie:G},b)})})},vr=function(e){var t=e.data,r=e.containerWidth,n=e.containerHeight,o=e.translateX,a=o===void 0?0:o,c=e.translateY,d=c===void 0?0:c,u=e.anchor,s=e.direction,m=e.padding,C=m===void 0?0:m,g=e.justify,S=e.itemsSpacing,y=S===void 0?0:S,A=e.itemWidth,M=e.itemHeight,L=e.itemDirection,P=e.itemTextColor,v=e.itemBackground,h=e.itemOpacity,W=e.symbolShape,j=e.symbolSize,B=e.symbolSpacing,k=e.symbolBorderWidth,F=e.symbolBorderColor,I=e.onClick,_=e.onMouseEnter,G=e.onMouseLeave,N=e.toggleSerie,Y=e.effects,l=Ft({itemCount:t.length,itemsSpacing:y,itemWidth:A,itemHeight:M,direction:s,padding:C}),x=l.width,b=l.height,f=pr({anchor:u,translateX:a,translateY:d,containerWidth:r,containerHeight:n,width:x,height:b}),p=f.x,T=f.y;return i.jsx(br,{data:t,x:p,y:T,direction:s,padding:C,justify:g,effects:Y,itemsSpacing:y,itemWidth:A,itemHeight:M,itemDirection:L,itemTextColor:P,itemBackground:v,itemOpacity:h,symbolShape:W,symbolSize:j,symbolSpacing:B,symbolBorderWidth:k,symbolBorderColor:F,onClick:I,onMouseEnter:_,onMouseLeave:G,toggleSerie:typeof N=="boolean"?void 0:N})};function xr(e){return e.target.depth}function kr(e){return e.depth}function Cr(e,t){return t-1-e.height}function Rt(e,t){return e.sourceLinks.length?e.depth:t-1}function Br(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?Dt(e.sourceLinks,xr)-1:0}function Me(e){return function(){return e}}function Bt(e,t){return ze(e.source,t.source)||e.index-t.index}function jt(e,t){return ze(e.target,t.target)||e.index-t.index}function ze(e,t){return e.y0-t.y0}function qe(e){return e.value}function jr(e){return e.index}function wr(e){return e.nodes}function Lr(e){return e.links}function wt(e,t){const r=e.get(t);if(!r)throw new Error("missing: "+t);return r}function Lt({nodes:e}){for(const t of e){let r=t.y0,n=r;for(const o of t.sourceLinks)o.y0=r+o.width/2,r+=o.width;for(const o of t.targetLinks)o.y1=n+o.width/2,n+=o.width}}function Sr(){let e=0,t=0,r=1,n=1,o=24,a=8,c,d=jr,u=Rt,s,m,C=wr,g=Lr,S=6;function y(){const l={nodes:C.apply(null,arguments),links:g.apply(null,arguments)};return A(l),M(l),L(l),P(l),W(l),Lt(l),l}y.update=function(l){return Lt(l),l},y.nodeId=function(l){return arguments.length?(d=typeof l=="function"?l:Me(l),y):d},y.nodeAlign=function(l){return arguments.length?(u=typeof l=="function"?l:Me(l),y):u},y.nodeSort=function(l){return arguments.length?(s=l,y):s},y.nodeWidth=function(l){return arguments.length?(o=+l,y):o},y.nodePadding=function(l){return arguments.length?(a=c=+l,y):a},y.nodes=function(l){return arguments.length?(C=typeof l=="function"?l:Me(l),y):C},y.links=function(l){return arguments.length?(g=typeof l=="function"?l:Me(l),y):g},y.linkSort=function(l){return arguments.length?(m=l,y):m},y.size=function(l){return arguments.length?(e=t=0,r=+l[0],n=+l[1],y):[r-e,n-t]},y.extent=function(l){return arguments.length?(e=+l[0][0],r=+l[1][0],t=+l[0][1],n=+l[1][1],y):[[e,t],[r,n]]},y.iterations=function(l){return arguments.length?(S=+l,y):S};function A({nodes:l,links:x}){for(const[f,p]of l.entries())p.index=f,p.sourceLinks=[],p.targetLinks=[];const b=new Map(l.map((f,p)=>[d(f,p,l),f]));for(const[f,p]of x.entries()){p.index=f;let{source:T,target:E}=p;typeof T!="object"&&(T=p.source=wt(b,T)),typeof E!="object"&&(E=p.target=wt(b,E)),T.sourceLinks.push(p),E.targetLinks.push(p)}if(m!=null)for(const{sourceLinks:f,targetLinks:p}of l)f.sort(m),p.sort(m)}function M({nodes:l}){for(const x of l)x.value=x.fixedValue===void 0?Math.max(Ve(x.sourceLinks,qe),Ve(x.targetLinks,qe)):x.fixedValue}function L({nodes:l}){const x=l.length;let b=new Set(l),f=new Set,p=0;for(;b.size;){for(const T of b){T.depth=p;for(const{target:E}of T.sourceLinks)f.add(E)}if(++p>x)throw new Error("circular link");b=f,f=new Set}}function P({nodes:l}){const x=l.length;let b=new Set(l),f=new Set,p=0;for(;b.size;){for(const T of b){T.height=p;for(const{source:E}of T.targetLinks)f.add(E)}if(++p>x)throw new Error("circular link");b=f,f=new Set}}function v({nodes:l}){const x=xt(l,p=>p.depth)+1,b=(r-e-o)/(x-1),f=new Array(x);for(const p of l){const T=Math.max(0,Math.min(x-1,Math.floor(u.call(null,p,x))));p.layer=T,p.x0=e+T*b,p.x1=p.x0+o,f[T]?f[T].push(p):f[T]=[p]}if(s)for(const p of f)p.sort(s);return f}function h(l){const x=Dt(l,b=>(n-t-(b.length-1)*c)/Ve(b,qe));for(const b of l){let f=t;for(const p of b){p.y0=f,p.y1=f+p.value*x,f=p.y1+c;for(const T of p.sourceLinks)T.width=T.value*x}f=(n-f+c)/(b.length+1);for(let p=0;p<b.length;++p){const T=b[p];T.y0+=f*(p+1),T.y1+=f*(p+1)}G(b)}}function W(l){const x=v(l);c=Math.min(a,(n-t)/(xt(x,b=>b.length)-1)),h(x);for(let b=0;b<S;++b){const f=Math.pow(.99,b),p=Math.max(1-f,(b+1)/S);B(x,f,p),j(x,f,p)}}function j(l,x,b){for(let f=1,p=l.length;f<p;++f){const T=l[f];for(const E of T){let H=0,U=0;for(const{source:q,value:O}of E.targetLinks){let $=O*(E.layer-q.layer);H+=N(q,E)*$,U+=$}if(!(U>0))continue;let R=(H/U-E.y0)*x;E.y0+=R,E.y1+=R,_(E)}s===void 0&&T.sort(ze),k(T,b)}}function B(l,x,b){for(let f=l.length,p=f-2;p>=0;--p){const T=l[p];for(const E of T){let H=0,U=0;for(const{target:q,value:O}of E.sourceLinks){let $=O*(q.layer-E.layer);H+=Y(E,q)*$,U+=$}if(!(U>0))continue;let R=(H/U-E.y0)*x;E.y0+=R,E.y1+=R,_(E)}s===void 0&&T.sort(ze),k(T,b)}}function k(l,x){const b=l.length>>1,f=l[b];I(l,f.y0-c,b-1,x),F(l,f.y1+c,b+1,x),I(l,n,l.length-1,x),F(l,t,0,x)}function F(l,x,b,f){for(;b<l.length;++b){const p=l[b],T=(x-p.y0)*f;T>1e-6&&(p.y0+=T,p.y1+=T),x=p.y1+c}}function I(l,x,b,f){for(;b>=0;--b){const p=l[b],T=(p.y1-x)*f;T>1e-6&&(p.y0-=T,p.y1-=T),x=p.y0-c}}function _({sourceLinks:l,targetLinks:x}){if(m===void 0){for(const{source:{sourceLinks:b}}of x)b.sort(jt);for(const{target:{targetLinks:b}}of l)b.sort(Bt)}}function G(l){if(m===void 0)for(const{sourceLinks:x,targetLinks:b}of l)x.sort(jt),b.sort(Bt)}function N(l,x){let b=l.y0-(l.sourceLinks.length-1)*c/2;for(const{target:f,width:p}of l.sourceLinks){if(f===x)break;b+=p+c}for(const{source:f,width:p}of x.targetLinks){if(f===l)break;b-=p}return b}function Y(l,x){let b=x.y0-(x.targetLinks.length-1)*c/2;for(const{source:f,width:p}of x.targetLinks){if(f===l)break;b+=p+c}for(const{target:f,width:p}of l.sourceLinks){if(f===x)break;b-=p}return b}return y}var Or=Nn,Mr=1,Pr=4;function zr(e){return Or(e,Mr|Pr)}var Tr=zr;const Wr=Jt(Tr);function de(){return de=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},de.apply(null,arguments)}var Xe={container:{display:"flex",alignItems:"center"},sourceChip:{marginRight:7},targetChip:{marginLeft:7,marginRight:7}},Ar={center:Br,justify:Rt,start:kr,end:Cr},Er=function(e){return Ar[e]},D={layout:"horizontal",align:"center",sort:"auto",colors:{scheme:"nivo"},nodeOpacity:.75,nodeHoverOpacity:1,nodeHoverOthersOpacity:.15,nodeThickness:12,nodeSpacing:12,nodeInnerPadding:0,nodeBorderWidth:1,nodeBorderColor:{from:"color",modifiers:[["darker",.5]]},nodeBorderRadius:0,linkOpacity:.25,linkHoverOpacity:.6,linkHoverOthersOpacity:.15,linkContract:0,linkBlendMode:"multiply",enableLinkGradient:!1,enableLabels:!0,label:"id",labelPosition:"inside",labelPadding:9,labelOrientation:"horizontal",labelTextColor:{from:"color",modifiers:[["darker",.8]]},labelComponent:It,isInteractive:!0,nodeTooltip:function(e){var t=e.node;return i.jsx(yt,{id:t.label,enableChip:!0,color:t.color})},linkTooltip:function(e){var t=e.link;return i.jsx(yt,{id:i.jsxs("span",{style:Xe.container,children:[i.jsx(bt,{color:t.source.color,style:Xe.sourceChip}),i.jsx("strong",{children:t.source.label})," > ",i.jsx("strong",{children:t.target.label}),i.jsx(bt,{color:t.target.color,style:Xe.targetChip}),i.jsx("strong",{children:t.formattedValue})]})})},legends:[],layers:["links","nodes","labels","legends"],role:"img",animate:!0,motionConfig:"gentle"},Dr=function(e){return e.id},$r=function(e){var t=e.data,r=e.valueFormat,n=e.layout,o=e.width,a=e.height,c=e.sort,d=e.align,u=e.colors,s=e.nodeThickness,m=e.nodeSpacing,C=e.nodeInnerPadding,g=e.nodeBorderColor,S=e.label,y=e.labelTextColor,A=w.useState(null),M=A[0],L=A[1],P=w.useState(null),v=P[0],h=P[1],W=w.useMemo(function(){if(c!=="auto")return c==="input"?null:c==="ascending"?function(f,p){return f.value-p.value}:c==="descending"?function(f,p){return p.value-f.value}:c},[c]),j=c==="input"?null:void 0,B=w.useMemo(function(){return typeof d=="function"?d:Er(d)},[d]),k=et(),F=En(u,"id"),I=vt(g,k),_=Dn(S),G=vt(y,k),N=$n(r),Y=w.useMemo(function(){return function(f){var p=f.data,T=f.formatValue,E=f.layout,H=f.alignFunction,U=f.sortFunction,R=f.linkSortMode,q=f.nodeThickness,O=f.nodeSpacing,$=f.nodeInnerPadding,X=f.width,ue=f.height,he=f.getColor,K=f.getLabel,fe=Sr().nodeAlign(H).nodeSort(U).linkSort(R).nodeWidth(q).nodePadding(O).size(E==="horizontal"?[X,ue]:[ue,X]).nodeId(Dr),oe=Wr(p);return fe(oe),oe.nodes.forEach(function(z){if(z.color=he(z),z.label=K(z),z.formattedValue=T(z.value),E==="horizontal")z.x=z.x0+$,z.y=z.y0,z.width=Math.max(z.x1-z.x0-2*$,0),z.height=Math.max(z.y1-z.y0,0);else{z.x=z.y0,z.y=z.x0+$,z.width=Math.max(z.y1-z.y0,0),z.height=Math.max(z.x1-z.x0-2*$,0);var be=z.x0,pe=z.x1;z.x0=z.y0,z.x1=z.y1,z.y0=be,z.y1=pe}}),oe.links.forEach(function(z){z.formattedValue=T(z.value),z.color=z.source.color,z.pos0=z.y0,z.pos1=z.y1,z.thickness=z.width,delete z.y0,delete z.y1,delete z.width}),oe}({data:t,formatValue:N,layout:n,alignFunction:B,sortFunction:W,linkSortMode:j,nodeThickness:s,nodeSpacing:m,nodeInnerPadding:C,width:o,height:a,getColor:F,getLabel:_})},[t,N,n,B,W,j,s,m,C,o,a,F,_]),l=Y.nodes,x=Y.links,b=w.useMemo(function(){return l.map(function(f){return{id:f.id,label:f.label,color:f.color}})},[l]);return{nodes:l,links:x,legendData:b,getNodeBorderColor:I,currentNode:M,setCurrentNode:L,currentLink:v,setCurrentLink:h,getLabelTextColor:G}},Ir=function(e){var t=e.node,r=e.x,n=e.y,o=e.width,a=e.height,c=e.color,d=e.opacity,u=e.borderWidth,s=e.borderColor,m=e.borderRadius,C=e.setCurrent,g=e.isInteractive,S=e.onClick,y=e.tooltip,A=tt(),M=A.animate,L=A.config,P=Et({x:r,y:n,width:o,height:a,opacity:d,color:c,config:L,immediate:!M}),v=At(),h=v.showTooltipFromEvent,W=v.hideTooltip,j=w.useCallback(function(I){C(t),h(w.createElement(y,{node:t}),I,"left")},[C,t,h,y]),B=w.useCallback(function(I){h(w.createElement(y,{node:t}),I,"left")},[h,t,y]),k=w.useCallback(function(){C(null),W()},[C,W]),F=w.useCallback(function(I){S==null||S(t,I)},[S,t]);return i.jsx(Pe.rect,{x:P.x,y:P.y,rx:m,ry:m,width:P.width.to(function(I){return Math.max(I,0)}),height:P.height.to(function(I){return Math.max(I,0)}),fill:P.color,fillOpacity:P.opacity,strokeWidth:u,stroke:s,strokeOpacity:d,onMouseEnter:g?j:void 0,onMouseMove:g?B:void 0,onMouseLeave:g?k:void 0,onClick:g?F:void 0})},Fr=function(e){var t=e.nodes,r=e.nodeOpacity,n=e.nodeHoverOpacity,o=e.nodeHoverOthersOpacity,a=e.borderWidth,c=e.getBorderColor,d=e.borderRadius,u=e.setCurrentNode,s=e.currentNode,m=e.currentLink,C=e.isCurrentNode,g=e.isInteractive,S=e.onClick,y=e.tooltip,A=function(M){return s||m?C(M)?n:o:r};return i.jsx(i.Fragment,{children:t.map(function(M){return i.jsx(Ir,{node:M,x:M.x,y:M.y,width:M.width,height:M.height,color:M.color,opacity:A(M),borderWidth:a,borderColor:c(M),borderRadius:d,setCurrent:u,isInteractive:g,onClick:S,tooltip:y},M.id)})})},Rr=function(e){var t=e.id,r=e.layout,n=e.startColor,o=e.endColor;return i.jsxs("linearGradient",de({id:t,spreadMethod:"pad"},r==="horizontal"?{x1:"0%",x2:"100%",y1:"0%",y2:"0%"}:{x1:"0%",x2:"0%",y1:"0%",y2:"100%"},{children:[i.jsx("stop",{offset:"0%",stopColor:n}),i.jsx("stop",{offset:"100%",stopColor:o})]}))},_r=function(e){var t=e.link,r=e.layout,n=e.path,o=e.color,a=e.opacity,c=e.blendMode,d=e.enableGradient,u=e.setCurrent,s=e.tooltip,m=e.isInteractive,C=e.onClick,g=t.source.id+"."+t.target.id+"."+t.index,S=tt(),y=S.animate,A=S.config,M=Rn(n),L=Et({color:o,opacity:a,config:A,immediate:!y}),P=At(),v=P.showTooltipFromEvent,h=P.hideTooltip,W=w.useCallback(function(F){u(t),v(w.createElement(s,{link:t}),F,"left")},[u,t,v,s]),j=w.useCallback(function(F){v(w.createElement(s,{link:t}),F,"left")},[v,t,s]),B=w.useCallback(function(){u(null),h()},[u,h]),k=w.useCallback(function(F){C==null||C(t,F)},[C,t]);return i.jsxs(i.Fragment,{children:[d&&i.jsx(Rr,{id:g,layout:r,startColor:t.startColor||t.source.color,endColor:t.endColor||t.target.color}),i.jsx(Pe.path,{fill:d?'url("#'+encodeURI(g)+'")':L.color,d:M,fillOpacity:L.opacity,onMouseEnter:m?W:void 0,onMouseMove:m?j:void 0,onMouseLeave:m?B:void 0,onClick:m?k:void 0,style:{mixBlendMode:c}})]})},Nr=function(e){var t=e.links,r=e.layout,n=e.linkOpacity,o=e.linkHoverOpacity,a=e.linkHoverOthersOpacity,c=e.linkContract,d=e.linkBlendMode,u=e.enableLinkGradient,s=e.setCurrentLink,m=e.currentLink,C=e.currentNode,g=e.isCurrentLink,S=e.isInteractive,y=e.onClick,A=e.tooltip,M=function(P){return C||m?g(P)?o:a:n},L=w.useMemo(function(){return r==="horizontal"?(P=kt().curve(In),function(v,h){var W=Math.max(1,v.thickness-2*h)/2,j=.12*(v.target.x0-v.source.x1),B=[[v.source.x1,v.pos0-W],[v.source.x1+j,v.pos0-W],[v.target.x0-j,v.pos1-W],[v.target.x0,v.pos1-W],[v.target.x0,v.pos1+W],[v.target.x0-j,v.pos1+W],[v.source.x1+j,v.pos0+W],[v.source.x1,v.pos0+W],[v.source.x1,v.pos0-W]];return P(B)+"Z"}):function(){var v=kt().curve(Fn);return function(h,W){var j=Math.max(1,h.thickness-2*W)/2,B=.12*(h.target.y0-h.source.y1),k=[[h.pos0+j,h.source.y1],[h.pos0+j,h.source.y1+B],[h.pos1+j,h.target.y0-B],[h.pos1+j,h.target.y0],[h.pos1-j,h.target.y0],[h.pos1-j,h.target.y0-B],[h.pos0-j,h.source.y1+B],[h.pos0-j,h.source.y1],[h.pos0+j,h.source.y1]];return v(k)+"Z"}}();var P},[r]);return i.jsx(i.Fragment,{children:t.map(function(P){return i.jsx(_r,{link:P,layout:r,path:L(P,c),color:P.color,opacity:M(P),blendMode:d,enableGradient:u,setCurrent:s,isInteractive:S,onClick:y,tooltip:A},P.source.id+"."+P.target.id+"."+P.index)})})},Hr=function(e){var t=e.nodes,r=e.layout,n=e.width,o=e.height,a=e.labelPosition,c=e.labelPadding,d=e.labelOrientation,u=e.getLabelTextColor,s=e.labelComponent,m=et(),C=d==="vertical"?-90:0,g=t.map(function(L){var P,v,h;return r==="horizontal"?(v=L.y+L.height/2,L.x<n/2?a==="inside"?(P=L.x1+c,h=d==="vertical"?"middle":"start"):(P=L.x-c,h=d==="vertical"?"middle":"end"):a==="inside"?(P=L.x-c,h=d==="vertical"?"middle":"end"):(P=L.x1+c,h=d==="vertical"?"middle":"start")):r==="vertical"&&(P=L.x+L.width/2,L.y<o/2?a==="inside"?(v=L.y1+c,h=d==="vertical"?"end":"middle"):(v=L.y-c,h=d==="vertical"?"start":"middle"):a==="inside"?(v=L.y-c,h=d==="vertical"?"start":"middle"):(v=L.y1+c,h=d==="vertical"?"end":"middle")),{id:L.id,label:L.label,x:P,y:v,textAnchor:h,color:u(L)}}),S=tt(),y=S.animate,A=S.config,M=_n(g.length,g.map(function(L){return{transform:"translate("+L.x+", "+L.y+") rotate("+C+")",color:L.color,config:A,immediate:!y}}));return i.jsx(i.Fragment,{children:M.map(function(L,P){var v=g[P];return i.jsx(s,{dominantBaseline:"central",textAnchor:v.textAnchor,transform:L.transform,style:de({},m.labels.text,{fill:L.color,pointerEvents:"none"}),node:t[P],children:v.label},v.id)})})},Ur=["isInteractive","animate","motionConfig","theme","renderWrapper"],Gr=function(e){var t=e.data,r=e.valueFormat,n=e.layout,o=n===void 0?D.layout:n,a=e.sort,c=a===void 0?D.sort:a,d=e.align,u=d===void 0?D.align:d,s=e.width,m=e.height,C=e.margin,g=e.colors,S=g===void 0?D.colors:g,y=e.nodeThickness,A=y===void 0?D.nodeThickness:y,M=e.nodeSpacing,L=M===void 0?D.nodeThickness:M,P=e.nodeInnerPadding,v=P===void 0?D.nodeInnerPadding:P,h=e.nodeBorderColor,W=h===void 0?D.nodeBorderColor:h,j=e.nodeOpacity,B=j===void 0?D.nodeOpacity:j,k=e.nodeHoverOpacity,F=k===void 0?D.nodeHoverOpacity:k,I=e.nodeHoverOthersOpacity,_=I===void 0?D.nodeHoverOthersOpacity:I,G=e.nodeBorderWidth,N=G===void 0?D.nodeBorderWidth:G,Y=e.nodeBorderRadius,l=Y===void 0?D.nodeBorderRadius:Y,x=e.linkOpacity,b=x===void 0?D.linkOpacity:x,f=e.linkHoverOpacity,p=f===void 0?D.linkHoverOpacity:f,T=e.linkHoverOthersOpacity,E=T===void 0?D.linkHoverOthersOpacity:T,H=e.linkContract,U=H===void 0?D.linkContract:H,R=e.linkBlendMode,q=R===void 0?D.linkBlendMode:R,O=e.enableLinkGradient,$=O===void 0?D.enableLinkGradient:O,X=e.enableLabels,ue=X===void 0?D.enableLabels:X,he=e.labelComponent,K=he===void 0?D.labelComponent:he,fe=e.labelPosition,oe=fe===void 0?D.labelPosition:fe,z=e.labelPadding,be=z===void 0?D.labelPadding:z,pe=e.labelOrientation,We=pe===void 0?D.labelOrientation:pe,Le=e.label,Ae=Le===void 0?D.label:Le,Q=e.labelTextColor,ve=Q===void 0?D.labelTextColor:Q,ee=e.nodeTooltip,xe=ee===void 0?D.nodeTooltip:ee,nt=e.linkTooltip,_t=nt===void 0?D.linkTooltip:nt,rt=e.isInteractive,Se=rt===void 0?D.isInteractive:rt,ot=e.onClick,it=e.legends,Nt=it===void 0?D.legends:it,lt=e.layers,ke=lt===void 0?D.layers:lt,st=e.role,Ht=st===void 0?D.role:st,Ut=e.ariaLabel,Gt=e.ariaLabelledBy,Yt=e.ariaDescribedBy,Ce=Wn(s,m,C),Ee=Ce.margin,De=Ce.innerWidth,$e=Ce.innerHeight,Ie=Ce.outerWidth,Fe=Ce.outerHeight,ne=$r({data:t,valueFormat:r,layout:o,width:De,height:$e,sort:c,align:u,colors:S,nodeThickness:A,nodeSpacing:L,nodeInnerPadding:v,nodeBorderColor:W,label:Ae,labelTextColor:ve}),Oe=ne.nodes,Be=ne.links,Vt=ne.legendData,qt=ne.getNodeBorderColor,J=ne.currentNode,Re=ne.setCurrentNode,te=ne.currentLink,_e=ne.setCurrentLink,Xt=ne.getLabelTextColor,at=w.useMemo(function(){var re=function(){return!1},le=function(){return!1};if(te&&(re=function(V){var Z=V.id;return Z===te.source.id||Z===te.target.id},le=function(V){var Z=V.source,se=V.target;return Z.id===te.source.id&&se.id===te.target.id}),J){var ie=[J.id];Be.filter(function(V){var Z=V.source,se=V.target;return Z.id===J.id||se.id===J.id}).forEach(function(V){var Z=V.source,se=V.target;ie.push(Z.id),ie.push(se.id)}),ie=Mn(ie),re=function(V){var Z=V.id;return ie.includes(Z)},le=function(V){var Z=V.source,se=V.target;return Z.id===J.id||se.id===J.id}}return{isCurrentNode:re,isCurrentLink:le}},[te,J,Be]),Ne=at.isCurrentNode,He=at.isCurrentLink,Zt=w.useMemo(function(){return{links:Be,nodes:Oe,margin:Ee,width:s,height:m,outerWidth:Ie,outerHeight:Fe,currentNode:J,isCurrentNode:Ne,setCurrentNode:Re,currentLink:te,isCurrentLink:He,setCurrentLink:_e,isInteractive:Se}},[Be,Oe,Ee,s,m,Ie,Fe,J,Ne,Re,te,He,_e,Se]),ge={links:null,nodes:null,labels:null,legends:null};return ke.includes("links")&&(ge.links=i.jsx(Nr,{links:Be,layout:o,linkContract:U,linkOpacity:b,linkHoverOpacity:p,linkHoverOthersOpacity:E,linkBlendMode:q,enableLinkGradient:$,setCurrentLink:_e,currentNode:J,currentLink:te,isCurrentLink:He,isInteractive:Se,onClick:ot,tooltip:_t},"links")),ke.includes("nodes")&&(ge.nodes=i.jsx(Fr,{nodes:Oe,nodeOpacity:B,nodeHoverOpacity:F,nodeHoverOthersOpacity:_,borderWidth:N,borderRadius:l,getBorderColor:qt,setCurrentNode:Re,currentNode:J,currentLink:te,isCurrentNode:Ne,isInteractive:Se,onClick:ot,tooltip:xe},"nodes")),ke.includes("labels")&&ue&&(ge.labels=i.jsx(Hr,{nodes:Oe,layout:o,width:De,height:$e,labelPosition:oe,labelPadding:be,labelOrientation:We,getLabelTextColor:Xt,labelComponent:K},"labels")),ke.includes("legends")&&(ge.legends=i.jsx(w.Fragment,{children:Nt.map(function(re,le){return i.jsx(vr,de({},re,{containerWidth:De,containerHeight:$e,data:Vt}),"legend"+le)})},"legends")),i.jsx(An,{width:Ie,height:Fe,margin:Ee,role:Ht,ariaLabel:Ut,ariaLabelledBy:Gt,ariaDescribedBy:Yt,children:ke.map(function(re,le){var ie;return typeof re=="function"?i.jsx(w.Fragment,{children:w.createElement(re,Zt)},le):(ie=ge==null?void 0:ge[re])!=null?ie:null})})},Yr=function(e){var t=e.isInteractive,r=t===void 0?D.isInteractive:t,n=e.animate,o=n===void 0?D.animate:n,a=e.motionConfig,c=a===void 0?D.motionConfig:a,d=e.theme,u=e.renderWrapper,s=function(m,C){if(m==null)return{};var g={};for(var S in m)if({}.hasOwnProperty.call(m,S)){if(C.indexOf(S)!==-1)continue;g[S]=m[S]}return g}(e,Ur);return i.jsx(Tn,{animate:o,isInteractive:r,motionConfig:c,renderWrapper:u,theme:d,children:i.jsx(Gr,de({isInteractive:r},s))})},Vr=function(e){return i.jsx(zn,{children:function(t){var r=t.width,n=t.height;return i.jsx(Yr,de({width:r,height:n},e))}})};function qr(){const e=w.useMemo(()=>({nodes:[{id:"White",group:1,total:430},{id:"Yellow",group:1,total:749},{id:"Orange",group:1,total:1204},{id:"Green",group:1,total:609},{id:"Blue",group:1,total:243},{id:"Purple",group:1,total:123},{id:"Brown",group:1,total:81},{id:"Red",group:1,total:70},{id:"Black",group:1,total:169}],links:[{source:"White",target:"Yellow",value:533},{source:"White",target:"Orange",value:119},{source:"White",target:"Green",value:13},{source:"White",target:"Blue",value:4},{source:"White",target:"Purple",value:3},{source:"White",target:"Brown",value:1},{source:"White",target:"Red",value:1},{source:"Yellow",target:"Orange",value:728},{source:"Yellow",target:"Green",value:82},{source:"Yellow",target:"Blue",value:9},{source:"Yellow",target:"Purple",value:1},{source:"Yellow",target:"Red",value:1},{source:"Orange",target:"Green",value:512},{source:"Orange",target:"Blue",value:28},{source:"Orange",target:"Purple",value:3},{source:"Orange",target:"Black",value:2},{source:"Green",target:"Blue",value:337},{source:"Green",target:"Purple",value:41},{source:"Green",target:"Brown",value:10},{source:"Green",target:"Red",value:7},{source:"Green",target:"Black",value:4},{source:"Blue",target:"Purple",value:194},{source:"Blue",target:"Brown",value:27},{source:"Blue",target:"Red",value:6},{source:"Blue",target:"Black",value:9},{source:"Purple",target:"Brown",value:146},{source:"Purple",target:"Red",value:15},{source:"Purple",target:"Black",value:10},{source:"Brown",target:"Red",value:117},{source:"Brown",target:"Black",value:12},{source:"Red",target:"Black",value:98}]}),[]),[t,r]=w.useState(e),[n,o]=w.useState(Ye),[a,c]=w.useState(void 0),d=w.useCallback(()=>{r(e),o(Ye),c(void 0)},[e]),u=w.useCallback(s=>{if(!s.label||s.label==="White"||s.label==="Black")return;if(s.label===a){d();return}const{nodes:m,links:C}={...e},g=Ze.indexOf(s.label),S=Ze.slice(0,g),y=m.filter(L=>!S.includes(L.id)),A=C.filter(L=>!S.includes(L.source)&&!S.includes(L.target)),M=Ye.slice(g);r({nodes:y,links:A}),o(M),c(s.label)},[a,e,d]);return i.jsxs(Te.Fragment,{children:[i.jsx("div",{style:{textAlign:"center",height:20,marginBottom:5,fontSize:"0.9rem"},children:a&&i.jsx(ye,{onClick:d,style:{color:"#ddd",cursor:"pointer"},children:"Reset"})||i.jsx("span",{children:"Click belt for details"})}),i.jsx("div",{style:{height:600},children:i.jsx(Vr,{data:t,layout:"vertical",sort:"input",margin:{top:10,right:10,bottom:20,left:10},align:"center",colors:n,nodeOpacity:1,nodeHoverOthersOpacity:.2,nodeThickness:22,nodeInnerPadding:0,nodeSpacing:0,nodeBorderWidth:1,nodeBorderColor:{from:"color",modifiers:[["darker",.5]]},nodeBorderRadius:3,linkOpacity:.6,linkBlendMode:"normal",linkHoverOthersOpacity:.1,linkContract:-.5,enableLinkGradient:!1,labelPosition:"outside",labelOrientation:"horizontal",labelPadding:-10,labelTextColor:{from:"color",modifiers:[["brighter",5]]},onClick:s=>{u(s)},nodeTooltip:({node:s})=>i.jsx("div",{style:{fontSize:"0.8rem",background:"#444",padding:"3px 4px",color:"#ddd",borderRadius:"5px"},children:i.jsxs("strong",{children:[s.label,": ",s.total]})}),linkTooltip:({link:s})=>i.jsxs("div",{style:{fontSize:"0.8rem",background:"#666",padding:"3px 4px",color:"#ddd",borderRadius:"5px"},children:[i.jsx("strong",{children:s.source.label})," to ",i.jsx("strong",{children:s.target.label}),"Â (",s.value,")"]})})})]})}const Xr={White:340,Yellow:681,Orange:1182,Green:668,Blue:269,Purple:150,Brown:91,Red:74,Black:159,Total:3614},Zr={White:1232,Yellow:2166,Orange:2842,Green:1121,Blue:328,Purple:147,Brown:88,Red:62,Black:134,Total:8120},St={discord:Xr,reddit:Zr};function Jr({data:e}){const{scorecardStats:t,discordBeltCounts:r,redditBeltCounts:n}=e,{userCounts:o}=t,{filters:a,addFilter:c,removeFilters:d}=w.useContext(Qe),u=Kr(),s=a!=null&&a.dataset?a==null?void 0:a.dataset:"pickerData",[m,C]=w.useState(s),g=w.useCallback(l=>{c("dataset",l,!0),C(l)},[c]),S=9435-o.totalUsers,y=w.useMemo(()=>{const l={data:[{id:"LPUbelts Users",label:"LPUbelts Users",value:o.totalUsers},{id:"Other LPU Pickers",label:"Other LPU Pickers (approx)",value:S}],colors:["#37bd17","#17561b"],description:"Click chart for details",startAngle:-65},x={parent:"pickerData",data:[{id:"Scorecard Users",label:"Scorecard Users",value:o.scorecardUsers},{id:"Other LPUbelts Users",label:"Other LPUbelts Users",value:o.totalUsers-o.scorecardUsers}],colors:["#d2bc18","#444"],description:"LPUbelts Scorecard Usage",startAngle:-35},b={parent:"LPUbelts Users",data:[{id:"Imported Belts",label:"Imported Belts",value:o.beltedUsers},{id:"Other Scorecard Users",label:"Other Scorecard Users",value:o.scorecardUsers-o.beltedUsers}],colors:["#189ad2","#444"],description:"Scorecard Belt Imports",startAngle:-120},f={parent:"Scorecard Users",data:Object.keys(o.belts).sort((O,$)=>Ue(O,$)).map(O=>({id:O,label:O,value:o.belts[O]})),colors:Ge,description:"Imported Belt Breakdown (click Black for Dan breakdown)",startAngle:-10},p={parent:"Imported Belts",data:Object.keys(o.dans).sort((O,$)=>parseInt(O)-parseInt($)).map(O=>({id:Ot(O),label:Ot(O),value:o.dans[O]})),colors:Mt,description:"Dan Breakdown"},T={parent:"pickerData",data:[{id:"Discord",label:"Discord",value:St.discord.Total},{id:"Reddit",label:"Reddit",value:St.reddit.Total}],colors:["#a981ec","#7833e3"],description:"Platforms users overlap, numbers shown for relative size"},E=Object.keys(r).reduce((O,$)=>{const X=$.replace(" Belt","").trim();return O[X]=r[$],O},{}),H={parent:"Other LPU Pickers",data:Object.keys(E).filter(O=>!O.includes("Dan")).sort((O,$)=>Ue(O,$)).map(O=>{const $=O==="Black"?"Black Belt":O;return{id:$,label:$,value:E[O]}}),colors:Ge,description:i.jsxs("span",{children:["Discord Belt Breakdown | ",i.jsx(ye,{onClick:()=>g("Reddit"),style:{color:"#189dea",textDecoration:"none",cursor:"pointer"},children:"Reddit"})]}),startAngle:-15},U={parent:"Discord",data:Object.keys(r).filter(O=>O.includes("Dan")).sort((O,$)=>parseInt(O)-parseInt($)).map(O=>({id:O,label:O,value:r[O]})),colors:Mt,description:"Discord Dan Breakdown"},R=Object.keys(n).reduce((O,$)=>{const X=$.replace(" Belt","").trim();return O[X]=n[$],O},{}),q={parent:"Other LPU Pickers",data:Object.keys(R).filter(O=>!O.includes("Dan")).sort((O,$)=>Ue(O,$)).map(O=>({id:O,label:O,value:R[O]})),colors:Ge,description:i.jsxs("span",{children:["Reddit Belt Breakdown | ",i.jsx(ye,{onClick:()=>g("Discord"),style:{color:"#189dea",textDecoration:"none",cursor:"pointer"},children:"Discord"})]}),startAngle:-25};return{pickerData:l,"LPUbelts Users":x,"Scorecard Users":b,"Imported Belts":f,Black:p,"Other LPU Pickers":T,Discord:H,"Black Belt":U,Reddit:q}},[r,g,S,n,o]),A=y[m].data,M=y[m].data.reduce((l,x)=>l+x.value,0),L=w.useCallback(l=>{y[l.id]&&(document.getElementById("chartDescription").style.opacity="0.2",setTimeout(()=>{document.getElementById("chartDescription").style.opacity="1",g(l.id)},200))},[g,y]),P=w.useCallback(()=>{y[y[m].parent].parent?c("dataset",y[m].parent,!0):d(["dataset"]),C(y[m].parent)},[c,y,m,d]),v=w.useCallback((l,x)=>{y[l.id]&&(x.currentTarget.style.cursor="pointer")},[y]),{width:h}=zt(),W=h<=360,j=h<=395,B=h<=428,k=h<=560,F={top:30,right:0,bottom:30,left:0};let I=320;W?I=175:j?I=190:B?I=230:k&&(I=240);const _="1.0rem",G=k?5:4,N=k?10:8,Y=k?0:8;return i.jsxs(Te.Fragment,{children:[i.jsx("div",{style:{fontSize:"0.95rem",fontWeight:500,width:"100%",textAlign:"center",marginBottom:4,opacity:1,transitionProperty:"opacity, left, top, height",transitionDuration:"0.1s, 0.1s"},id:"chartDescription",children:y[m].description}),i.jsxs("div",{style:{height:I,margin:"0px 8px 0px 8px",width:"100%",position:"relative"},children:[i.jsx("div",{style:{width:"100%",height:"100%",position:"absolute",top:0,left:0},children:i.jsx(pn,{data:A,theme:vn,colors:y[m].colors,margin:F,startAngle:y[m].startAngle||-40,endAngle:360,innerRadius:.5,padAngle:.7,cornerRadius:3,activeOuterRadiusOffset:0,arcLinkLabelsSkipAngle:G,arcLinkLabelsTextColor:"#ccc",arcLinkLabelsThickness:2,arcLinkLabelsColor:{from:"color"},arcLinkLabel:l=>l.label+": "+Math.round(l.value/M*100)+"%",arcLinkLabelsDiagonalLength:14,arcLinkLabelsStraightLength:Y,enableArcLabels:!1,arcLabelsRadiusOffset:.5,arcLabelsSkipAngle:N,arcLabelsTextColor:"#111",isInteractive:!0,transitionMode:"startAngle",motionConfig:"slow",sortByValue:!1,onClick:l=>{L(l)},onMouseEnter:(l,x)=>{v(l,x)},tooltip:l=>{const x=(l.datum.arc.angleDeg>G,l.datum.label+": "),b=l.datum.value;return i.jsx("div",{style:{fontSize:"0.8rem",background:"#555",padding:"3px 4px",color:"#ddd",borderRadius:"5px",display:k||u?"none":"block"},children:i.jsxs("div",{children:[x,b]})})}})}),i.jsx("div",{style:{width:"100%",position:"absolute",top:I/2-14,left:0,display:"flex",justifyContent:"center",fontSize:"1.1rem"},children:y[m].parent&&i.jsx(ye,{onClick:P,style:{color:"#ccc",cursor:"pointer",fontSize:_},children:"back"})})]},"pickPie")]})}function Ot(e){const t=["st","nd","rd","th"];return e+""+t[Math.min(4,parseInt(e))-1]}const Mt=["#222222","#2E2E2E","#3A3A3A","#464646","#525252","#5E5E5E","#6A6A6A","#767676","#828282","#8E8E8E","#9A9A9A","#A6A6A6","#B2B2B2","#BEBEBE","#CACACA","#D6D6D6","#E2E2E2","#EFEFEF","#FAFAFA","#FFFFFF"];function Kr(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0||window.matchMedia("(pointer: coarse)").matches}function Pt({entry:e,index:t,collapse:r=!1}){const n=Kt(),a=ft(e).replace(/[\s/]/g,"_").replace(/\W/g,""),c=w.useCallback(u=>{const s=`/locks?tab=search&search=${u.id}&id=${u.id}&name=${a}`;n(s)},[n,a]),d=e.belt==="Unranked"?"#bbb":"#fff";return i.jsxs(Wt,{sx:{"&:nth-of-type(odd) td, &:nth-of-type(odd) th":{backgroundColor:"#000"},"td, th":{padding:0,border:0}},style:{display:"table-row"},children:[i.jsx(je,{align:"left",style:{borderBottom:"1px solid #000",width:4,marginLeft:5,height:40,paddingBottom:1},children:i.jsx(kn,{value:e.belt})}),i.jsx(je,{align:"left",style:{alignItems:"center"},children:i.jsx("div",{style:{fontWeight:500,marginLeft:10,fontSize:"0.9rem"},children:i.jsx(ye,{onClick:()=>c(e),style:{color:d},children:ft(e)})})}),i.jsx(je,{align:"center",style:{fontWeight:500,fontSize:"0.9rem",paddingRight:5},children:e.currentPicks})]},t)}function Qr(){var W;const{visibleEntries:e=[]}=w.useContext(Tt),{filters:t,addFilter:r,removeFilters:n}=w.useContext(Qe),{userBelt:o="All Belts",sort:a}=t,[c,d]=w.useState(a);w.useEffect(()=>{d(!!a)},[a]);const u=60;let s=((W=e.find(j=>j.displayRank===u))==null?void 0:W.currentPicks)||0;s=s>2?s:0;const m=w.useMemo(()=>e.filter(j=>j.currentPicks>=s),[e,s]),C=w.useMemo(()=>e.filter(j=>j.currentPicks<s),[e,s]),g=w.useMemo(()=>["All Belts",...Ze],[]),S=w.useCallback(()=>{const j=g.findIndex(k=>k===o),B=j<g.length-1?j+1:0;r("userBelt",g[B],!0)},[r,g,o]),y=w.useCallback(()=>{const j=g.findIndex(k=>k===o),B=j>0?j-1:g.length-1;r("userBelt",g[B],!0)},[r,g,o]),[A,M]=w.useState(!1),L=w.useCallback(()=>M(!1),[]),P=w.useCallback(()=>M(!0),[]),v=w.useCallback(j=>{j.target.value!=="All Belts"?r("userBelt",j.target.value,!0):n(["userBelt"]),L()},[r,L,n]),h=w.useCallback(()=>{d(!c)},[c]);return i.jsxs(Te.Fragment,{children:[i.jsx("div",{style:{marginBottom:10,display:"flex",justifyContent:"center"},children:i.jsxs("div",{style:{padding:"0px",width:220,display:"flex",justifyContent:"center",alignItems:"center"},children:[i.jsx(ct,{title:"Previous Belt",arrow:!0,disableFocusListener:!0,children:i.jsx(dt,{onClick:y,style:{backgroundColor:"#bbb",color:"#000",height:24,width:24},children:i.jsx(gn,{})})}),i.jsx("div",{style:{padding:"0px",display:"flex",justifyContent:"center",flexGrow:1,alignItems:"center"},children:i.jsxs(wn,{id:"beltPulldown",size:"small",variant:"outlined",style:{marginBottom:0,width:140},children:[i.jsx(Ln,{style:{color:"#bbb"},children:"User Belt"}),i.jsx(Sn,{id:"beltSelect",value:o||"All Belts",label:"Brand",open:A,onClose:L,onOpen:P,onChange:v,style:{fontWeight:700,color:"#eee",fontSize:"1.1rem"},children:g.map((j,B)=>i.jsx(Qt,{value:g[B],children:g[B]},B))})]})}),i.jsx(ct,{title:"Next Belt",arrow:!0,disableFocusListener:!0,children:i.jsx(dt,{onClick:S,style:{backgroundColor:"#bbb",color:"#000",height:24,width:24},children:i.jsx(mn,{})})})]})}),i.jsx(Bn,{sortValues:jn,extraFilters:[{key:"tab",value:"search"}],compactMode:!1,resetAll:!0,expandAll:!1,style:{marginBottom:10}}),i.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center"},children:i.jsxs("div",{style:{border:"4px solid #1c1c1c",width:"100%",maxWidth:600},children:[i.jsx(pt,{sx:{backgroundColor:"#111",width:"100%"},children:i.jsxs(gt,{style:{backgroundColor:"#1c1c1c"},children:[i.jsx(Cn,{children:i.jsxs(Wt,{style:{padding:"0px",fontWeight:700},children:[i.jsx(je,{colSpan:"2",style:{padding:1,fontWeight:700,fontSize:"1.05rem"},children:"Lock"}),i.jsx(je,{style:{padding:1,fontWeight:700,fontSize:"1.05rem",paddingRight:5},children:"Picks"})]})}),i.jsx(mt,{children:m.map((j,B)=>i.jsx(Pt,{entry:j,index:B},B))})]})}),i.jsx(On,{in:!!c,timeout:"auto",unmountOnExit:!0,children:i.jsx(pt,{sx:{backgroundColor:"#111",width:"100%"},children:i.jsx(gt,{style:{backgroundColor:"#1c1c1c"},children:i.jsx(mt,{children:C.map((j,B)=>i.jsx(Pt,{entry:j,index:B},B))})})})})]})}),C.length>0&&i.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center"},children:i.jsx("div",{style:{border:"4px solid #1c1c1c",width:"100%",maxWidth:600,textAlign:"center"},children:i.jsx(ye,{onClick:h,style:{color:"#fff",fontSize:"1.0rem",cursor:"pointer"},children:!c&&"Show More"||"Show Less"})})})]})}function eo({data:e}){const{width:t}=zt(),n=t<560?"8px 8px 32px 8px":"24px 24px 32px 24px",o={margin:"46px 0px 26px 0px",width:"100%",backgroundColor:"#000",textAlign:"center"},a={margin:"0px 0px 14px 0px",width:"100%",backgroundColor:"#000",textAlign:"center"};return i.jsxs("div",{style:{minWidth:"320px",maxWidth:720,height:"100%",padding:n,backgroundColor:"#000",marginLeft:"auto",marginRight:"auto",fontSize:"1.5rem",fontWeight:600},children:[i.jsxs("div",{style:a,children:["User Belt Flows",i.jsx("div",{style:{fontSize:"0.9rem",fontWeight:400},children:"Discord users since Nov. 2019"})]}),i.jsx(qr,{}),i.jsx("div",{style:o,children:"User Drilldown"}),i.jsx(Jr,{data:e}),i.jsx("div",{style:o,children:"Scorecard Locks"}),i.jsx(Qr,{data:e})]})}function to({children:e,allEntries:t,scorecardEntries:r,profile:n}){const{filters:o}=w.useContext(Qe),{search:a,id:c,tab:d,name:u,sort:s,image:m,expandAll:C,dataset:g,...S}=o,{userBelt:y}=S,A=w.useCallback(v=>t.find(h=>h.id===v),[t]),M=w.useMemo(()=>Object.keys(r).map(v=>{var W,j,B;const h=A(v);return h?{...r[v],userBelt:Object.keys(r[v].scorecardPicks),currentPicks:r[v].scorecardPicks[y||"All Belts"],...h,makes:h.makeModels[0].make?h.makeModels.map(({make:k})=>k):h.makeModels[0].model,fuzzy:ht(h.makeModels.map(({make:k,model:F})=>[k,F]).flat().filter(k=>k).concat([h.version,h.notes,h.belt]).join(",")),content:[(W=h.media)!=null&&W.some(k=>!k.fullUrl.match(/youtube\.com/))?"Has Images":"No Images",(j=h.media)!=null&&j.some(k=>k.fullUrl.match(/youtube\.com/))?"Has Video":"No Video",((B=h.links)==null?void 0:B.length)>0?"Has Links":"No Links",en[h.belt].danPoints>0?"Worth Dan Points":void 0,ut(h.lastUpdated).isAfter(ut().subtract(1,"days"))?"Updated Recently":void 0,h.belt.startsWith("Black")?"Is Black":void 0,h.belt!=="Unranked"?"Is Ranked":void 0].flat().filter(k=>k),collection:tn.locks.map.map(k=>n&&n[k.key]&&n[k.key].includes(h.id)?k.label:"Not "+k.label),collectionSaves:Un[h.id]||0,simpleBelt:h.belt.replace(/\s\d/g,"")}:null}).filter(v=>v),[A,n,r,y]),L=w.useMemo(()=>{const v=Object.keys(S).map(B=>{const k=S[B];return Array.isArray(k)?k.map(F=>({key:B,value:F})):{key:B,value:k}}).flat(),h=M.filter(B=>v.every(({key:k,value:F})=>Array.isArray(B[k])?B[k].includes(F):B[k]===F)),W=a&&h.find(B=>B.id===a);let j=h;return W?j=[W]:a&&(j=xn.go(ht(a),h,{keys:no,threshold:-25e3}).map(B=>({...B.obj,score:B.score}))),s?j.sort((B,k)=>{if(s==="beltAscending")return nn(B.belt,k.belt)||k.currentPicks-B.currentPicks||B.fuzzy.localeCompare(k.fuzzy);if(s==="beltDescending")return rn(B.belt,k.belt)||k.currentPicks-B.currentPicks||B.fuzzy.localeCompare(k.fuzzy);if(s==="alphaAscending")return B.fuzzy.localeCompare(k.fuzzy);if(s==="alphaDescending")return k.fuzzy.localeCompare(B.fuzzy)}):j.sort((B,k)=>k.currentPicks-B.currentPicks||B.fuzzy.localeCompare(k.fuzzy)).map((B,k)=>({...B,displayRank:k+1}))},[S,M,a,s]),P=w.useMemo(()=>({allEntries:t,visibleEntries:L,getEntryFromId:A,expandAll:C,profile:n}),[t,A,L,C,n]);return i.jsx(Tt.Provider,{value:P,children:e})}const no=["fuzzy"];function Uo(){const{lockCollection:e}=w.useContext(on);fn("Explore Scorecard");const{data:t,loading:r,error:n,errorMessage:o}=hn({urls:ro});return i.jsxs(Te.Fragment,{children:[i.jsx(ln,{title:"Explore Scorecard"}),n&&i.jsx(bn,{errorMessage:o}),r&&i.jsx(un,{}),!r&&!n&&!!t&&i.jsx(sn,{filterFields:Hn,children:i.jsx(to,{allEntries:an,scorecardEntries:t.scorecardStats.lockCountsByUserBelt,profile:e,children:i.jsx(eo,{data:{...t,lockStats:yn}})})}),i.jsx(cn,{}),i.jsx(dn,{feature:"stats"})]})}const ro={brandDistribution:Gn,collectionsStatsCurrent:Yn,popularAreas:Vn,redditGrowth:qn,siteFullNew:Xn,pickStatsData:Zn,scorecardStats:Jn,discordBeltCounts:Kn,redditBeltCounts:Qn};export{Uo as default};
