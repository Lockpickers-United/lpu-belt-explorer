import{r as e,A as L,j as t,D as I,F as S,d as h,R as j,u as M,N as P,bb as T,h as D,e as B,T as G}from"./index-B3q2qv5b.js";import{A as W}from"./AdminToolButtons-DugVUSTR.js";import{R as b}from"./RaffleContext-CPtHveb3.js";import{L as N}from"./LoadingDisplay-WAzaotxc.js";import{R as z}from"./RaffleEntries-Dd-kDld_.js";import{D as C}from"./DataContext-BkI5Cwei.js";import{f as H,e as O}from"./filterFields-p45XURus.js";import{f as U}from"./filterEntriesAdvanced-e8GOuN5N.js";import"./index-C8JUP1g2.js";import{s as w}from"./searchEntriesForText-Be53kVR9.js";import"./EmojiEvents-CZ_JhhU_.js";import"./useData-CKR9WPZ-.js";import"./dataUrls-1xDVM400.js";import"./setDeep-J6HEwWhX.js";import"./Box-C2Y3FtQU.js";import"./CircularProgress-z1R1Jykx.js";import"./NoEntriesCard-B1KWWKDC.js";import"./LockListContext-BF14kwHd.js";import"./entryName-DeLMvVmD.js";import"./RaffleExportButton-D37fwB3m.js";import"./ExpandMore-63T9iBPf.js";import"./CopyLinkToRaflPotButton-CGkzzbLS.js";import"./Link-ZFg6xPUl.js";import"./FieldValue-_Hxlxca5.js";import"./FilterChip-B9E07Nzr.js";import"./glossary-B-_vYIGQ.js";import"./Chip-DDe-XtPJ.js";import"./ImageGallery-CkjdnlOy.js";import"./ImageViewer-DIUbeuW5.js";import"./Launch-DmxQtO2l.js";import"./Dialog-CjtdADu0.js";import"./LinearProgress-DDR08Bx8.js";import"./DialogContent-m_I9VQUt.js";import"./ImageListItem-DylNDGcL.js";import"./ContentCopy-DGl-SrgP.js";import"./ScopedDialog-iP8-5o6_.js";import"./Cancel-Dq2qwZKs.js";import"./Zoom-BG8z0lr6.js";import"./LoadingDisplaySmall-D8mUxZeA.js";import"./LogEntryButton-CJ3LUBmR.js";import"./AccordionSummary-C86DN7kL.js";import"./Collapse-BMT7cyQu.js";import"./index-BhusZyQM.js";import"./index-B0MfWX80.js";import"./AccordionActions-Nq2zscJj.js";import"./download-DnxaQERY.js";import"./List-BUpzUdJF.js";import"./RaffleSearchBar-Ddn_MBmk.js";import"./SearchBox-CqMqlvtt.js";import"./Search-dluWhXNU.js";import"./useFormControl-D-qhi1OQ.js";import"./Select-BRX-vdkZ.js";import"./Sort-CAySD4bG.js";import"./TextField-BmfnunRN.js";import"./ViewFilterButtons-Ck0Dyi_f.js";import"./FilterAlt-Cc-XkbzH.js";import"./HighlightOff-BKGh-_5m.js";import"./ToggleButtonGroup-D1aIW3PV.js";import"./AddCircle-gCAVR7fg.js";import"./sortFields-1lK6XsoA.js";import"./AdvancedFilters-y3ld_5yS.js";import"./ChoiceButtonGroup-DvSq42op.js";import"./stringUtils-BsiQ3MZ5.js";function Z(){const{lockCollection:s}=e.useContext(L),{visiblePotEntries:r}=e.useContext(C);console.log("RaffleDrawingEntries visiblePotEntries",r);const p=e.useMemo(()=>r==null?void 0:r.filter(n=>{var d;return((d=n.entrants)==null?void 0:d.length)>0}),[r]);return console.log("RaffleDrawingEntries drawPots",p),t.jsx(z,{profile:s,allPots:p,drawing:!0})}function q({children:s,drawing:r}){const p=e.useContext(C),{allPots:n}=e.useContext(b),{allRaffleEntries:d}=e.useContext(I);console.log("RaffleAdminDataProviderPots",n);const{filters:x,advancedFilterGroups:g}=e.useContext(S),{search:u,id:K,tab:Q,name:V,sort:c,image:X,preview:Y,single:_,expandAll:R,...$}=x||{},v=e.useMemo(()=>d.filter(o=>o.status==="approved").reduce((o,i)=>(i.pots.forEach(f=>{o.push({username:i.username,entryId:i.id,platform:i.platform,potId:f.itemId,potTickets:f.tickets})}),o),[]),[d]),l=e.useMemo(()=>n.map(o=>{const i=v.filter(f=>f.potId===o.id);return i.length>0&&(o.entrants=i),o},[]),[n,v]);console.log("mappedPotEntries",l);const A=.3;e.useMemo(()=>w(u,[...l],A),[l,u]);const F=e.useMemo(()=>{const o=U({advancedFilterGroups:g(),entries:l}),i=w(u,[...o],A);let f=c?i.sort((m,a)=>c==="updatedAt"?h(m.updatedAt).isBefore(h(a.updatedAt))?1:-1:c==="status"?H(m.status,a.status):c==="username"?m.username.localeCompare(a.username):c==="totalDonation"?a.totalDonation-m.totalDonation:h(m.createdAt).isBefore(h(a.createdAt))?1:-1):i.sort((m,a)=>m.potNumber-a.potNumber);return r&&(f=f.filter(m=>{var a;return((a=m.entrants)==null?void 0:a.length)>0})),f},[r,l,u,c]),E=e.useCallback(o=>l.find(i=>i.id===o),[l]),k=e.useMemo(()=>({...p,allEntries:n,visibleEntries:F,mappedPotEntries:l,getPotFromId:E,expandAll:R,statusLabels:J}),[p,n,F,l,E,R]);return t.jsx(C.Provider,{value:k,children:s})}const J={pending:{entryColor:"Blue",backgroundColor:"#3e71bd",textColor:"#fff"},approved:{entryColor:"Green",backgroundColor:"#34732f",textColor:"#fff"},issues:{entryColor:"Orange",backgroundColor:"#e16936",textColor:"#fff"},rejected:{entryColor:"Red",backgroundColor:"#c52323",textColor:"#fff"}};function y({width:s=700}){const r={maxWidth:s,marginLeft:"auto",marginRight:"auto",marginTop:10,fontWeight:700,display:"flex",flexDirection:"row"};return t.jsx(j.Fragment,{children:t.jsxs("div",{style:r,children:[t.jsx("div",{style:{flexGrow:1,fontSize:"1.7rem",margin:0},children:"LPU Raffle"}),t.jsx("div",{style:{fontSize:"1.4rem",marginTop:"0.3rem"},children:"PRIZE DRAWING"})]})})}function me(){const{raffleAdmin:s,setRaffleAdminRole:r}=e.useContext(b),{authLoaded:p,isLoggedIn:n}=e.useContext(L);e.useEffect(()=>{s&&r(!0)});const{isMobile:d}=M(),x=t.jsxs(j.Fragment,{children:[!d&&t.jsx("div",{style:{flexGrow:1,minWidth:"10px"}}),t.jsx(W,{})]});if(!p)return t.jsx(N,{message:"Loading..."});if(p&&!s)return t.jsxs(j.Fragment,{children:[t.jsx(P,{title:"RAFL Admin",extras:x}),t.jsx(y,{page:"drawing"}),t.jsxs("div",{style:{padding:20},children:[!n&&t.jsx("div",{children:"Please log in to access this page."}),n&&!s&&t.jsx("div",{children:"Sorry, you do not have access to this page."}),t.jsx("div",{children:t.jsx(T,{})})]}),t.jsx(D,{})]});const g=d?8:0,u={maxWidth:700,marginLeft:"auto",marginRight:"auto",paddingLeft:g,paddingRight:g};return t.jsx(B,{filterFields:O,children:t.jsx(q,{drawing:!0,children:t.jsxs("div",{style:u,children:[t.jsx(P,{title:"RAFL 2026",extras:x}),t.jsx(y,{page:"drawing"}),s&&t.jsx(Z,{}),t.jsx(D,{}),t.jsx(G,{feature:"raflAdmin"})]})})})}export{me as default};
