import{r as e,A as L,j as t,D as I,F as S,d as h,R as j,u as M,N as P,bb as T,h as D,e as B,T as G}from"./index-Dgk9hXc2.js";import{A as W}from"./AdminToolButtons-DswKt1Bv.js";import{R as b}from"./RaffleContext-Cq-WAPWG.js";import{L as N}from"./LoadingDisplay-CXb6CDBH.js";import{R as z}from"./RaffleEntries-CRAZOLcD.js";import{D as C}from"./DataContext-BVcJTbMm.js";import{f as H,e as O}from"./filterFields-PJVSEui-.js";import{f as U}from"./filterEntriesAdvanced-BL1zzTjo.js";import"./index-B8HLHKuL.js";import{s as w}from"./searchEntriesForText-DTuiwxPt.js";import"./EmojiEvents-CAFVjeUX.js";import"./useData-BrZscWyO.js";import"./dataUrls-1xDVM400.js";import"./setDeep-J6HEwWhX.js";import"./Box-bzNXGn_0.js";import"./CircularProgress-Pb2Dv8Z2.js";import"./NoEntriesCard-F7Gx42_k.js";import"./LockListContext-NBClUwPa.js";import"./entryName-DCS0HsPd.js";import"./RaffleExportButton-BprTWuIR.js";import"./ExpandMore-BozjA41J.js";import"./CopyLinkToRaflPotButton-ckqnkE2j.js";import"./Link-B42tTSBr.js";import"./FieldValue-D5JnI6dL.js";import"./FilterChip-BkzRncE5.js";import"./glossary-B-_vYIGQ.js";import"./Chip-CHAJ17JU.js";import"./ImageGallery-DklzXFkU.js";import"./ImageViewer-B5160AbO.js";import"./Launch-D0OIwHCS.js";import"./Dialog-CMG3DQtu.js";import"./LinearProgress-BkKAkXIo.js";import"./DialogContent-DxiCzEFI.js";import"./ImageListItem-C3a9MJd5.js";import"./ContentCopy-D2CMPgtj.js";import"./ScopedDialog-DyAL2Wuf.js";import"./Cancel-D2r2lPD7.js";import"./Zoom-HjTH-IA4.js";import"./LoadingDisplaySmall-KnjIF0J2.js";import"./LogEntryButton-Ddgse44t.js";import"./AccordionSummary-CUJWhuSR.js";import"./Collapse-CxT1EyQ-.js";import"./index-Ckcg_CYL.js";import"./index-CP02T_me.js";import"./AccordionActions-BfkmXsG_.js";import"./download-BGsvVAdF.js";import"./List-3_LUkPN0.js";import"./RaffleSearchBar-D3B3vWVW.js";import"./SearchBox-CI8JZxwH.js";import"./Search-DFK9GvBN.js";import"./useFormControl-Bj40y-R7.js";import"./Select-CuD5VZyG.js";import"./Sort-BmYTCHn9.js";import"./TextField-CdF-fE02.js";import"./ViewFilterButtons-BV2UVBm2.js";import"./FilterAlt-CdNv8JNy.js";import"./HighlightOff-DiCeiyyi.js";import"./ToggleButtonGroup-Cz_jFB5n.js";import"./AddCircle-rump_eZ1.js";import"./sortFields-1lK6XsoA.js";import"./AdvancedFilters-BihK5I3p.js";import"./ChoiceButtonGroup-D2o5z3Th.js";import"./stringUtils-BsiQ3MZ5.js";function Z(){const{lockCollection:s}=e.useContext(L),{visiblePotEntries:r}=e.useContext(C);console.log("RaffleDrawingEntries visiblePotEntries",r);const p=e.useMemo(()=>r==null?void 0:r.filter(n=>{var d;return((d=n.entrants)==null?void 0:d.length)>0}),[r]);return console.log("RaffleDrawingEntries drawPots",p),t.jsx(z,{profile:s,allPots:p,drawing:!0})}function q({children:s,drawing:r}){const p=e.useContext(C),{allPots:n}=e.useContext(b),{allRaffleEntries:d}=e.useContext(I);console.log("RaffleAdminDataProviderPots",n);const{filters:x,advancedFilterGroups:g}=e.useContext(S),{search:u,id:K,tab:Q,name:V,sort:c,image:X,preview:Y,single:_,expandAll:R,...$}=x||{},v=e.useMemo(()=>d.filter(o=>o.status==="approved").reduce((o,i)=>(i.pots.forEach(f=>{o.push({username:i.username,entryId:i.id,platform:i.platform,potId:f.itemId,potTickets:f.tickets})}),o),[]),[d]),l=e.useMemo(()=>n.map(o=>{const i=v.filter(f=>f.potId===o.id);return i.length>0&&(o.entrants=i),o},[]),[n,v]);console.log("mappedPotEntries",l);const A=.3;e.useMemo(()=>w(u,[...l],A),[l,u]);const F=e.useMemo(()=>{const o=U({advancedFilterGroups:g(),entries:l}),i=w(u,[...o],A);let f=c?i.sort((m,a)=>c==="updatedAt"?h(m.updatedAt).isBefore(h(a.updatedAt))?1:-1:c==="status"?H(m.status,a.status):c==="username"?m.username.localeCompare(a.username):c==="totalDonation"?a.totalDonation-m.totalDonation:h(m.createdAt).isBefore(h(a.createdAt))?1:-1):i.sort((m,a)=>m.potNumber-a.potNumber);return r&&(f=f.filter(m=>{var a;return((a=m.entrants)==null?void 0:a.length)>0})),f},[r,l,u,c]),E=e.useCallback(o=>l.find(i=>i.id===o),[l]),k=e.useMemo(()=>({...p,allEntries:n,visibleEntries:F,mappedPotEntries:l,getPotFromId:E,expandAll:R,statusLabels:J}),[p,n,F,l,E,R]);return t.jsx(C.Provider,{value:k,children:s})}const J={pending:{entryColor:"Blue",backgroundColor:"#3e71bd",textColor:"#fff"},approved:{entryColor:"Green",backgroundColor:"#34732f",textColor:"#fff"},issues:{entryColor:"Orange",backgroundColor:"#e16936",textColor:"#fff"},rejected:{entryColor:"Red",backgroundColor:"#c52323",textColor:"#fff"}};function y({width:s=700}){const r={maxWidth:s,marginLeft:"auto",marginRight:"auto",marginTop:10,fontWeight:700,display:"flex",flexDirection:"row"};return t.jsx(j.Fragment,{children:t.jsxs("div",{style:r,children:[t.jsx("div",{style:{flexGrow:1,fontSize:"1.7rem",margin:0},children:"LPU Raffle"}),t.jsx("div",{style:{fontSize:"1.4rem",marginTop:"0.3rem"},children:"PRIZE DRAWING"})]})})}function me(){const{raffleAdmin:s,setRaffleAdminRole:r}=e.useContext(b),{authLoaded:p,isLoggedIn:n}=e.useContext(L);e.useEffect(()=>{s&&r(!0)});const{isMobile:d}=M(),x=t.jsxs(j.Fragment,{children:[!d&&t.jsx("div",{style:{flexGrow:1,minWidth:"10px"}}),t.jsx(W,{})]});if(!p)return t.jsx(N,{message:"Loading..."});if(p&&!s)return t.jsxs(j.Fragment,{children:[t.jsx(P,{title:"RAFL Admin",extras:x}),t.jsx(y,{page:"drawing"}),t.jsxs("div",{style:{padding:20},children:[!n&&t.jsx("div",{children:"Please log in to access this page."}),n&&!s&&t.jsx("div",{children:"Sorry, you do not have access to this page."}),t.jsx("div",{children:t.jsx(T,{})})]}),t.jsx(D,{})]});const g=d?8:0,u={maxWidth:700,marginLeft:"auto",marginRight:"auto",paddingLeft:g,paddingRight:g};return t.jsx(B,{filterFields:O,children:t.jsx(q,{drawing:!0,children:t.jsxs("div",{style:u,children:[t.jsx(P,{title:"RAFL 2026",extras:x}),t.jsx(y,{page:"drawing"}),s&&t.jsx(Z,{}),t.jsx(D,{}),t.jsx(G,{feature:"raflAdmin"})]})})})}export{me as default};
