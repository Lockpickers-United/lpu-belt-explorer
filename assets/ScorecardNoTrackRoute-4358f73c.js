import{R as k,r as d,a1 as $,j as e,ac as S,v as M,aa as q,J as I,ak as z,al as D,am as W,an as U}from"./index-5aed8077.js";import{u as _}from"./useData-1d3f21d8.js";import{D as v,e as G,a as J,s as K}from"./index-4631fc0d.js";import{a as E,b as x,c as O,d as Q,T as V,e as X}from"./TableRow-d2ffbe1b.js";import{L as R}from"./Link-281d4d9e.js";import{N as Y,E as Z}from"./ScorecardExportButton-18d18281.js";import{L as ee}from"./LoadingDisplay-3366d372.js";import{P as te}from"./ProfileNotFound-9861fed0.js";import{a as oe,b as ne}from"./ScorecardListContext-fc59aeaa.js";import"./mycollection-0ec86312.js";import"./useWindowSize-e33788c7.js";import"./Box-821e937f.js";import"./download-909d6049.js";import"./ContentCopy-c322a910.js";import"./LPU-c3fa7122.js";import"./LinearProgress-42a07090.js";function re({owner:s,evid:o,merged:p}){const{getEntryFromId:g,getProjectEntryFromId:u}=d.useContext(v),h=g(o.matchId),j=u(o.matchId),t=h||j;let r=t?G(t):o.evidenceNotes;r=o.exceptionType==="nomatch"?`[ ${o.evidenceNotes} ]`:r,r=o.exceptionType&&s&&p?r+" *":r;const m=o.points===1?"pt":"pts";let a=o.date?$(o.date).format("L"):"(no date)";a=a.replace("/202","/2"),a=a.replace("/201","/1");const b=o.link.substring(0,20),f=T=>{const y=window.open(T,"_blank","noopener,noreferrer");y&&(y.opener=null)},n="#fff",i="#333",c="0.9rem";return e.jsx(k.Fragment,{children:e.jsxs(E,{sx:{"&:nth-of-type(even) td, &:nth-of-type(even) th":{backgroundColor:"#eee"},"td, th":{}},children:[e.jsx(x,{sx:{textAlign:"left",fontSize:c,lineHeight:"1.1rem",padding:"8px",backgroundColor:n,color:i,fontWeight:600},component:"th",scope:"row",children:r}),e.jsx(x,{sx:{textAlign:"left",fontSize:c,lineHeight:"1.1rem",padding:"8px",backgroundColor:n,color:i},component:"th",scope:"row",children:t==null?void 0:t.version}),e.jsx(x,{sx:{textAlign:"left",fontSize:c,lineHeight:"1.1rem",padding:"8px",backgroundColor:n,color:i},component:"th",scope:"row",children:e.jsx("nobr",{children:t==null?void 0:t.belt})}),e.jsx(x,{sx:{textAlign:"left",fontSize:c,lineHeight:"1.1rem",padding:"8px",backgroundColor:n,color:i},component:"th",scope:"row",children:a}),e.jsx(x,{sx:{textAlign:"left",fontSize:c,lineHeight:"1.1rem",padding:"8px",backgroundColor:n,color:i},component:"th",scope:"row",children:e.jsx(R,{onClick:()=>f(o.link),children:b})}),e.jsx(x,{sx:{textAlign:"left",fontSize:c,lineHeight:"1.1rem",padding:"8px",backgroundColor:n,color:i},component:"th",scope:"row",children:o.modifier}),e.jsx(x,{sx:{textAlign:"left",fontSize:c,lineHeight:"1.1rem",padding:"8px",backgroundColor:n,color:i},component:"th",scope:"row",children:e.jsxs("nobr",{children:[e.jsxs("span",{style:{fontWeight:700},children:[o.points," "]}),e.jsx("span",{style:{color:"#666"},children:m})]})})]},o.id)})}const se=k.memo(re);function ie({profile:s}){var f;const{userId:o}=S(),{visibleEntries:p=[]}=d.useContext(v),g=p.filter(n=>n.points>0),u=[{id:"lock",name:"lock",align:"left"},{id:"version",name:"version",align:"left"},{id:"belt",name:"belt",align:"left"},{id:"date",name:"date",align:"left"},{id:"link",name:"link",align:"left"},{id:"modifier",name:"modifier",align:"left"},{id:"points",name:"points",align:"left"}],{cardDanPoints:h,cardBBCount:j,cardEligibleDan:t}=d.useContext(v),r={1:"st",2:"nd",3:"rd"},m=r[[t]]?t+r[[t]]:t+"th",a=(f=s.displayName)==null?void 0:f.replace(/\s/g,"_"),b=d.useCallback(async()=>{const n=`@LPUBeltBot request ${m} Dan https://lpubelts.com/#/profile/${o}/scorecard/no-tracking?name=${a}`;await navigator.clipboard.writeText(n),M("Request copied to clipboard. Take it over to #belt-requests!")},[m,a,o]);return e.jsxs("div",{style:{maxWidth:900,padding:0,backgroundColor:"#eee",marginLeft:"auto",marginRight:"auto",marginTop:16},children:[e.jsxs("div",{style:{display:"flex",padding:8},children:[e.jsx("div",{style:{fontSize:"1.5rem",lineHeight:"1rem",flexGrow:1,marginRight:0},children:s.displayName}),e.jsxs("div",{style:{marginRight:25},children:["Dan Points ",e.jsx("strong",{children:h})]}),e.jsxs("div",{style:{marginRight:25},children:["Black Belt Locks ",e.jsx("strong",{children:j})]}),e.jsxs("div",{children:["Eligible for Dan ",e.jsx("span",{style:{fontSize:"1.7rem",lineHeight:"1rem"},children:t})]})]}),e.jsx("div",{style:{width:"100%",textAlign:"right",padding:8,marginBottom:10},children:e.jsx(R,{onClick:b,style:{color:"#99c2e5",cursor:"pointer"},children:"Copy Request"})}),p.length===0&&e.jsx(Y,{}),e.jsxs("div",{children:[e.jsx(O,{id:"statsTable",style:{padding:"0px 0px 0px 4px",width:"100%",marginLeft:"auto",marginRight:"auto"},component:q,elevation:2,children:e.jsxs(Q,{size:"small",children:[e.jsx(V,{children:e.jsx(E,{children:u.map((n,i)=>e.jsx(x,{sx:{textAlign:n.align,fontSize:"1rem",lineHeight:"1.1rem",padding:"8px",backgroundColor:"#ddd",color:"#000"},component:"th",scope:"row",children:n.name},i+1))})}),e.jsx(X,{children:g.map(n=>e.jsx(se,{evid:n},n.id))})]})}),e.jsx("br",{})]})]})}function Te(){const{userId:s}=S(),{getProfile:o,getEvidence:p}=d.useContext(I),[g,u]=d.useState(!1),h=d.useCallback(()=>{u(!g)},[g]),j=d.useCallback(async()=>{try{const l=await o(s);if(l){const w=l.displayName?l.displayName.toLowerCase().endsWith("s")?`${l.displayName}'`:`${l.displayName}'s`:"Anonymous";document.title=`LPU Belt Explorer - ${w} Scorecard`}const C=await p(s);return{profile:l,...z(C)}}catch(l){return console.error("Error loading profile and evidence.",l),null}},[s,o,p]),{data:t={},loading:r,error:m}=_({loadFn:j}),a=t?t.profile:{},b=t?t.scoredEvidence:[],f=t?t.bbCount:0,n=t?t.danPoints:0,i=t?t.eligibleDan:0,c=t?t.nextDanPoints:0,T=t?t.nextDanLocks:0;if(r||m)return null;const y=k.createContext({toggleColorMode:()=>{}});function B({children:l}){const C=D({palette:{mode:"dark",secondary:{main:"#2d49bc"}}}),w=D({palette:{mode:"light"}}),[P,L]=d.useState("light"),A=k.useMemo(()=>({toggleColorMode:()=>{L(F=>F==="light"?"dark":"light")}}),[]),N=k.useMemo(()=>P==="light"?w:C,[C,w,P]),H=ae(N);return e.jsx(y.Provider,{value:A,children:e.jsxs(W,{theme:N,children:[e.jsx(U,{enableColorScheme:!0}),e.jsx("style",{children:H}),l]})})}return e.jsx(J,{filterFields:K,children:e.jsx(oe,{cardEvidence:b,cardBBCount:f,cardDanPoints:n,cardEligibleDan:i,cardNextDanPoints:c,cardNextDanLocks:T,children:e.jsx(ne,{children:e.jsxs(B,{children:[r&&e.jsx(ee,{}),!r&&t&&!m&&e.jsx(ie,{profile:a,adminAction:h}),!r&&(!t||m)&&e.jsx(te,{}),e.jsx("div",{style:{width:"100%",textAlign:"center",marginBottom:30},children:e.jsx(Z,{})})]})})})})}const ae=s=>{const o=s.palette.text.icon;return`
            body {
                background-color: ${s.palette.background.default};
                margin: 0;
                padding: 0;
            }
            
            a {
                color: ${o};
            }
            
            pre{ 
                white-space: pre-wrap; 
                word-break: break-word;
            }
            
            :root {
              color-scheme: dark;
              overflow-y: scroll;
            }
        `};export{Te as default};
