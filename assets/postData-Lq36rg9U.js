import{a as b}from"./index-C0RmN517.js";import{X as v}from"./index-D9L2A7XV.js";const R=async({user:t,url:o,formData:s,json:a,snackBars:r,timeoutDuration:n=15e3})=>{var m,p,l,g,h,f;const i=new AbortController,c=setTimeout(()=>{i.abort()},n),y=Math.floor(Math.random()*1e6),u=t?await t.getIdToken():null,d=a!==void 0&&s===void 0,C={...u&&{Authorization:`Bearer ${u}`},"Content-Type":d?"application/json":"multipart/form-data"},$=d?a:s;try{const e=await b.post(`${o}?${y}`,$,{headers:C,signal:i.signal});return clearTimeout(c),r&&v("Request successful",{variant:"success"}),e.data}catch(e){clearTimeout(c);const T=e.name==="CanceledError"||e.code==="ERR_CANCELED"||((m=e.message)==null?void 0:m.includes("aborted")),E=T?"Request timed out. Please try again.":((g=(l=(p=e.response)==null?void 0:p.data)==null?void 0:l.error)==null?void 0:g.message)||((f=(h=e.response)==null?void 0:h.data)==null?void 0:f.message)||e.message||"Error during authentication or server request";throw r&&v(`${E} (${e.status})`,{variant:"error",autoHideDuration:T?5e3:3e3}),{...e,message:E.toString()}}},S=t=>{var o,s,a;if((o=t.response)!=null&&o.data&&typeof t.response.data=="string"){const r=(s=t.message.match(/code (\d+)/))==null?void 0:s[1],n=(a=t.response.data.match(/<pre>([\s\S]*?)<\/pre>/))==null?void 0:a[1];return{response:{data:{status:r,message:n}}}}else return t};export{S as c,R as p};
