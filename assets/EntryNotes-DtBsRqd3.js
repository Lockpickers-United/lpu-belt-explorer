import{r as f,X as lt,j as t,W as at,U as Ae,$ as ct,bf as dt,R as Pe,A as ut,D as pt,u as ht,B as F,bb as ft,L as X}from"./index-PLA41_BS.js";import{L as gt}from"./Link-VWB6wPYY.js";import{e as xt}from"./entryName-D5ePebnU.js";import{C as mt}from"./Cancel-CTH78YMZ.js";import{D as yt}from"./Dialog-ClQyqhJL.js";import{Z as vt}from"./Zoom-CWPcnaoZ.js";import{s as Ct}from"./sanitizeValues-M1B2Ngto.js";import{T as jt}from"./TextField-ajiKBIJE.js";import{M as kt}from"./index-CbLoBQcC.js";import{r as bt}from"./index-CqE1WFYE.js";import{r as wt}from"./index-Dpf_4Phg.js";import{C as We}from"./Collapse-7wRpaB0N.js";function Dt({entry:i,nameType:r}){const n=f.useCallback(async()=>{const c=xt(i,r).replace(/[\s/]/g,"_").replace(/\W/g,""),p=`https://share.lpubelts.com/?id=${i.id}&name=${c}`;await navigator.clipboard.writeText(p),lt("Link to entry copied to clipboard.")},[i,r]);return t.jsx(at,{title:"Copy Link to Entry",arrow:!0,disableFocusListener:!0,children:t.jsx(Ae,{onClick:n,children:t.jsx(gt,{})})})}function St({dialogContent:i,open:r,handleClose:n,width:v=350,dark:c=!0}){const p=g=>{g.stopPropagation(),g.preventDefault()};return t.jsx(yt,{open:r,onClose:n,sx:{".MuiDialog-paper":{backgroundColor:"transparent",backgroundImage:"none",padding:"12px",margin:"0px 0px 20px 0px",width:v},"& .MuiBackdrop-root":{backgroundColor:c?"rgba(0, 0, 0, 0.65)":"rgba(0, 0, 0, 0.5)",backdropFilter:c?"blur(0.75px)":"none"}},children:t.jsx(vt,{in:r,timeout:{enter:250,exit:250},children:t.jsxs("div",{children:[n&&t.jsx("div",{onClick:n,style:{display:"flex",flexGrow:1,justifyContent:"flex-end",marginBottom:-15,marginRight:-10},children:t.jsx(Ae,{style:{padding:0,color:"#eee",backgroundColor:"#333"},onClick:n,children:t.jsx(mt,{})})}),t.jsx("div",{onClick:p,style:{backgroundColor:"#666",borderRadius:4,boxShadow:"0px 11px 15px -7px rgba(0,0,0,0.4),0px 24px 38px 3px rgba(0,0,0,0.28),0px 9px 46px 8px rgba(0,0,0,0.24)"},children:i})]})})})}var H={},ze;function _t(){if(ze)return H;ze=1,Object.defineProperty(H,"__esModule",{value:!0});var i=ct(),r=dt(),n=function(){return n=Object.assign||function(e){for(var o,d=1,l=arguments.length;d<l;d++)for(var s in o=arguments[d])Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s]);return e},n.apply(this,arguments)};function v(e,o,d){for(var l,s=0,_=o.length;s<_;s++)!l&&s in o||(l||(l=Array.prototype.slice.call(o,0,s)),l[s]=o[s]);return e.concat(l||Array.prototype.slice.call(o))}function c(e){var o=e.size,d=o===void 0?25:o,l=e.SVGstrokeColor,s=l===void 0?"currentColor":l,_=e.SVGstorkeWidth,G=_===void 0?0:_,V=e.SVGclassName,u=V===void 0?"star-svg":V,C=e.SVGstyle;return i.jsx("svg",n({className:u,style:C,stroke:s,fill:"currentColor",strokeWidth:G,viewBox:"0 0 24 24",width:d,height:d,xmlns:"http://www.w3.org/2000/svg"},{children:i.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}))}function p(e,o){switch(o.type){case"PointerMove":return n(n({},e),{hoverValue:o.payload,hoverIndex:o.index});case"PointerLeave":return n(n({},e),{ratingValue:e.ratingValue,hoverIndex:0,hoverValue:null});case"MouseClick":return n(n({},e),{valueIndex:e.hoverIndex,ratingValue:o.payload});default:return e}}var g="style-module_starRatingWrap__q-lJC",I="style-module_simpleStarRating__nWUxf",w="style-module_fillIcons__6---A",N="style-module_emptyIcons__Bg-FZ",x="style-module_tooltip__tKc3i";function S(){return typeof window<"u"&&window.matchMedia("(pointer: coarse)").matches||"ontouchstart"in window||typeof navigator<"u"&&navigator.maxTouchPoints>0}return(function(e,o){o===void 0&&(o={});var d=o.insertAt;if(typeof document<"u"){var l=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",d==="top"&&l.firstChild?l.insertBefore(s,l.firstChild):l.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}})(".style-module_starRatingWrap__q-lJC{display:inline-block;touch-action:none}.style-module_simpleStarRating__nWUxf{display:inline-block;overflow:hidden;position:relative;touch-action:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;vertical-align:middle;white-space:nowrap}.style-module_fillIcons__6---A{display:inline-block;overflow:hidden;position:absolute;top:0;white-space:nowrap}.style-module_emptyIcons__Bg-FZ{display:inline-block}.style-module_tooltip__tKc3i{background-color:#333;border-radius:5px;color:#fff;display:inline-block;padding:5px 15px;vertical-align:middle}"),H.Rating=function(e){var o,d,l=e.onClick,s=e.onPointerMove,_=e.onPointerEnter,G=e.onPointerLeave,V=e.initialValue,u=V===void 0?0:V,C=e.iconsCount,y=C===void 0?5:C,W=e.size,P=W===void 0?40:W,B=e.readonly,L=B!==void 0&&B,O=e.rtl,z=O!==void 0&&O,E=e.customIcons,q=E===void 0?[]:E,m=e.allowFraction,j=m!==void 0&&m,Be=e.style,Y=e.className,Ee=Y===void 0?"react-simple-star-rating":Y,Q=e.transition,De=Q!==void 0&&Q,ee=e.allowHover,te=ee===void 0||ee,oe=e.disableFillHover,ne=oe!==void 0&&oe,ie=e.fillIcon,Fe=ie===void 0?null:ie,re=e.fillColor,Oe=re===void 0?"#ffbc0b":re,se=e.fillColorArray,qe=se===void 0?[]:se,Ue=e.fillStyle,le=e.fillClassName,Ke=le===void 0?"filled-icons":le,ae=e.emptyIcon,Ze=ae===void 0?null:ae,ce=e.emptyColor,$e=ce===void 0?"#cccccc":ce,He=e.emptyStyle,de=e.emptyClassName,Je=de===void 0?"empty-icons":de,ue=e.allowTitleTag,Xe=ue===void 0||ue,pe=e.showTooltip,Ye=pe!==void 0&&pe,he=e.tooltipDefaultText,Qe=he===void 0?"Your Rate":he,fe=e.tooltipArray,U=fe===void 0?[]:fe,et=e.tooltipStyle,ge=e.tooltipClassName,tt=ge===void 0?"react-simple-star-rating-tooltip":ge,xe=e.SVGclassName,me=xe===void 0?"star-svg":xe,ye=e.titleSeparator,ot=ye===void 0?"out of":ye,ve=e.SVGstyle,Ce=e.SVGstorkeWidth,je=Ce===void 0?0:Ce,ke=e.SVGstrokeColor,be=ke===void 0?"currentColor":ke,we=r.useReducer(p,{hoverIndex:0,valueIndex:0,ratingValue:u,hoverValue:null}),K=we[0],k=K.ratingValue,h=K.hoverValue,J=K.hoverIndex,Se=K.valueIndex,Z=we[1];r.useEffect((function(){u&&Z({type:"MouseClick",payload:0})}),[u]);var R=r.useMemo((function(){return j?2*y:y}),[j,y]),T=r.useMemo((function(){return u>R?0:j||Math.floor(u)===u?Math.round(u/y*100):2*Math.ceil(u)*10}),[j,u,y,R]),_e=r.useMemo((function(){return(j?2*u-1:u-1)||0}),[j,u]),A=r.useCallback((function(a){return y%2!=0?a/2/10:a*y/100}),[y]),Ve=function(a){for(var M=a.clientX,b=a.currentTarget.children[0].getBoundingClientRect(),it=b.left,rt=b.right,st=b.width,Me=z?rt-M:M-it,$=R,Ie=Math.round(st/R),D=0;D<=R;D+=1)if(Me<=Ie*D){$=D===0&&Me<Ie?0:D;break}var Ge=$-1;$>0&&(Z({type:"PointerMove",payload:100*$/R,index:Ge}),s&&h&&s(A(h),Ge,a))},Ne=function(a){h&&(Z({type:"MouseClick",payload:h}),l&&l(A(h),J,a))},nt=r.useMemo((function(){if(te){if(ne){var a=k&&k||T;return h&&h>a?h:a}return h&&h||k&&k||T}return k&&k||T}),[te,ne,h,k,T]);r.useEffect((function(){U.length>R&&console.error("tooltipArray Array length is bigger then Icons Count length.")}),[U.length,R]);var Le=r.useCallback((function(a){return h&&a[J]||k&&a[Se]||u&&a[_e]}),[h,J,k,Se,u,_e]),Re=r.useMemo((function(){return h&&A(h)||k&&A(k)||u&&A(T)}),[h,A,k,u,T]);return i.jsxs("span",n({className:g,style:{direction:"".concat(z?"rtl":"ltr")}},{children:[i.jsxs("span",n({className:"".concat(I," ").concat(Ee),style:n({cursor:L?"":"pointer"},Be),onPointerMove:L?void 0:Ve,onPointerEnter:L?void 0:function(a){_&&_(a),S()&&Ve(a)},onPointerLeave:L?void 0:function(a){S()&&Ne(),Z({type:"PointerLeave"}),G&&G(a)},onClick:L?void 0:Ne,"aria-hidden":"true"},{children:[i.jsx("span",n({className:"".concat(N," ").concat(Je),style:n({color:$e},He)},{children:v([],Array(y)).map((function(a,M){var b;return i.jsx(r.Fragment,{children:((b=q[M])===null||b===void 0?void 0:b.icon)||Ze||i.jsx(c,{SVGclassName:me,SVGstyle:ve,SVGstorkeWidth:je,SVGstrokeColor:be,size:P})},M)}))})),i.jsx("span",n({className:"".concat(w," ").concat(Ke),style:n((o={},o[z?"right":"left"]=0,o.color=Le(qe)||Oe,o.transition=De?"width .2s ease, color .2s ease":"",o.width="".concat(nt,"%"),o),Ue),title:Xe?"".concat(Re," ").concat(ot," ").concat(y):void 0},{children:v([],Array(y)).map((function(a,M){var b;return i.jsx(r.Fragment,{children:((b=q[M])===null||b===void 0?void 0:b.icon)||Fe||i.jsx(c,{SVGclassName:me,SVGstyle:ve,SVGstorkeWidth:je,SVGstrokeColor:be,size:P})},M)}))}))]})),Ye&&i.jsx("span",n({className:"".concat(x," ").concat(tt),style:n((d={},d[z?"marginRight":"marginLeft"]=20,d),et)},{children:(U.length>0?Le(U):Re)||Qe}))]}))},H}var Vt=_t();function Nt({ratings:i,dimension:r,onChange:n,size:v=24,emptyColor:c="#ccc",readonly:p=!1,fillColor:g,style:I,allowFraction:w=!0}){const N=f.useCallback(x=>{n({rating:x,dimension:r})},[r,n]);return t.jsx("div",{style:{display:"flex",placeItems:"center",marginTop:4,...I},children:t.jsx(Vt.Rating,{onClick:N,size:v,initialValue:i&&i[r],ratingValue:i&&i[r],emptyColor:c,readonly:p,fillColor:g,allowFraction:w})})}function Te({ratingDimensions:i,ratings:r,onRatingChange:n=()=>{},size:v,allowFraction:c=!1,readonly:p=!1,fontSize:g="1.0rem",paddingData:I=5,backgroundColor:w,fillColor:N,emptyColor:x="#777",fontWeight:S=500}){const e=Object.keys(i).map(o=>({ratingArea:i[o]||o,rating:t.jsx(Nt,{ratings:r,onChange:n,dimension:o,readonly:p,size:v,fontSize:g,allowFraction:c,fillColor:N,emptyColor:x,style:{marginLeft:5,marginTop:4}})}));return t.jsx(Pe.Fragment,{children:t.jsx("div",{style:{display:"flex",justifyContent:"space-between"},children:e.map((o,d)=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:`${I}px`,backgroundColor:d%2===0?w:"transparent",marginRight:d<e.length-1?15:0},children:[t.jsx("div",{style:{fontSize:g,fontWeight:S,color:"#ddd"},children:o.ratingArea}),t.jsx("div",{children:o.rating})]},d))})})}function Ft({entry:i}){const{isLoggedIn:r}=f.useContext(ut),{userLockNotes:n,updateProfileField:v}=f.useContext(pt),c=r?n[i.id]:{},p=typeof c=="string"?c||"":c&&c.notes||"",g=f.useCallback(async m=>{await v("userLockNotes",m),w(!1)},[v]),[I,w]=f.useState(!1),N=f.useCallback(()=>{w(!0)},[]),x=f.useCallback(()=>{w(!1),e(p)},[p]),[S,e]=f.useState(p),[o,d]=f.useState((c==null?void 0:c.ratings)||{}),[l,s]=f.useState(!1);f.useEffect(()=>{e(p||"")},[p]);const _=f.useCallback(m=>{e(Ct(m.target.value,{profanityOK:!0,urlsOK:!0}))},[]),G=f.useCallback(({dimension:m,rating:j})=>{d({...o,[m]:j}),s(!0)},[o]),V=f.useCallback(async()=>{const m={...n,[i.id]:{notes:S||""}};Object.keys(o).length>0&&(m[i.id].ratings=o),await g(m).catch(j=>{console.error("Error updating notes:",j)}),x(),s(!1)},[n,i.id,S,o,g,x]),u=f.useCallback(async()=>{const m={...n};delete m[i.id],await g(m).catch(j=>{console.error("Error removing notes:",j)}),x(),d({}),s(!1)},[i.id,x,g,n]),{isMobile:C,flexStyle:y}=ht(),W={fontSize:"1.0rem",fontWeight:400,marginBottom:5,paddingLeft:2,color:"#fff"},P=C?"0.85rem":"0.9rem",B=C?5:8,L=p.split(`
`).length,O=L>B?Math.min(L,12):B,z=C?5:10,E={Difficulty:"Difficulty",Fun:"Fun"},q=t.jsx("div",{style:{display:"flex"},children:r?t.jsxs("div",{style:{flexGrow:1,maxWidth:550,padding:10},children:[t.jsxs("div",{style:{marginTop:10,display:"flex"},children:[t.jsx("div",{style:{...W,flexGrow:1,fontWeight:700},children:"My Notes"}),t.jsxs("div",{style:{...W,color:"#aaa",fontSize:"0.85rem"},children:[S.length||0,"/1200"]})]}),t.jsx(jt,{type:"text",name:"notes",multiline:!0,fullWidth:!0,rows:O,value:S,onChange:_,id:"notes",color:"info",style:{},placeholder:"Add your own private notes about this lock, visible only to you.",variant:"outlined",autoFocus:!0,inputProps:{maxLength:1200,style:{fontSize:P}}}),t.jsx("div",{style:{display:"flex",marginTop:5},children:t.jsx(Te,{ratingDimensions:E,onRatingChange:G,ratings:o,emptyColor:"#555",fontSize:"0.85rem",size:20,paddingData:0})}),t.jsxs("div",{style:{flexGrow:1,textAlign:"right",marginTop:8},children:[t.jsx(F,{variant:"text",size:"small",onClick:x,children:"Cancel"}),t.jsx(F,{variant:"text",size:"small",onClick:V,color:"success",children:"Save"})]})]}):t.jsxs("div",{style:{flexGrow:1,padding:"40px 20px",placeItems:"center"},children:[t.jsxs("div",{style:{...W,marginBottom:15,fontWeight:700,textAlign:"center"},children:["Please sign in to add your",t.jsx("br",{}),"own private notes for locks."]}),t.jsx("div",{style:{width:210},children:t.jsx(ft,{onClick:x})})]})});return t.jsxs(Pe.Fragment,{children:[Object.keys(c||{}).length>0?t.jsxs("div",{style:{fontWeight:700,marginTop:15},children:[t.jsxs("div",{style:{display:"flex"},children:[t.jsx("span",{style:{},children:"My private notes  "}),t.jsx(X,{style:{fontWeight:400,color:"#2bb259"},onClick:N,children:"edit"})," • ",t.jsx(X,{style:{fontWeight:400,color:"#2bb259"},onClick:u,children:"remove"})]}),t.jsxs("div",{style:{fontSize:P,marginLeft:z,fontWeight:400},children:[t.jsx(kt,{remarkPlugins:[wt],rehypePlugins:[[bt,{target:"_blank",rel:["nofollow","noopener","noreferrer"]}]],children:p}),!p&&t.jsx("div",{style:{height:8}}),t.jsxs("div",{style:{display:y,height:32,justifyContent:"flex-start",alignItems:"center"},children:[t.jsx(Te,{ratingDimensions:E,onRatingChange:G,ratings:o,readonly:!1,fontSize:"0.85rem",size:19,paddingData:0}),l&&!C&&t.jsx(F,{variant:"text",size:"small",onClick:V,color:"success",children:"Save"}),t.jsx(We,{in:l&&C,style:{},children:t.jsxs("div",{style:{display:"flex",flexGrow:1,width:"100%",justifyContent:"center"},children:[t.jsx(F,{variant:"text",size:"small",onClick:x,style:{color:"#777"},children:"Cancel"}),t.jsx(F,{variant:"text",size:"small",onClick:V,color:"success",children:"Save"})]})})]}),t.jsx(We,{in:l&&C,style:{textAlign:"right"},children:t.jsx("div",{style:{height:22}})})]})]}):t.jsx("div",{style:{fontWeight:700,marginTop:15},children:t.jsx(X,{style:{fontWeight:600,color:"#2bb259",textDecoration:"none",cursor:"pointer"},onClick:N,children:"Add your own private notes"})}),t.jsx(St,{dialogContent:q,open:I,handleClose:x,width:C?350:550})]})}export{Dt as C,Ft as E};
