import{r as n,K as B,j as e,J as E,I as b,A as I,D as z,u as T,B as C,aI as D,R as M}from"./index-CyzQ6c94.js";import{L as R}from"./Link-kZpmHR7F.js";import{e as A}from"./entryName-DwdRFWed.js";import{C as F}from"./Cancel-CBSFiY-Q.js";import{D as G}from"./Dialog-C0tVyvJE.js";import{s as P}from"./sanitizeValues-Dws27LBF.js";import{T as O}from"./TextField-DRbiOw4R.js";import{L as g}from"./Link-CRDU452H.js";import{M as V}from"./index-BBhW7iQL.js";import{r as K}from"./index-ww0M7zi8.js";import{r as U}from"./index-DaDd55AS.js";function ne({entry:o,nameType:a}){const s=n.useCallback(async()=>{const t=A(o,a).replace(/[\s/]/g,"_").replace(/\W/g,""),l=`https://share.lpubelts.com/?id=${o.id}&name=${t}`;await navigator.clipboard.writeText(l),B("Link to entry copied to clipboard.")},[o,a]);return e.jsx(E,{title:"Copy Link to Entry",arrow:!0,disableFocusListener:!0,children:e.jsx(b,{onClick:s,children:e.jsx(R,{})})})}function _({dialogContent:o,open:a,handleClose:s,width:c=350}){return e.jsxs(G,{open:a,onClose:s,sx:{".MuiDialog-paper":{backgroundColor:"transparent",backgroundImage:"none",padding:"12px",margin:"0px 0px 20px 0px",width:c}},children:[e.jsx("div",{style:{display:"flex",flexGrow:1,justifyContent:"flex-end",marginBottom:-15,marginRight:-10},children:e.jsx(b,{style:{padding:0,color:"#eee",backgroundColor:"#333"},onClick:s,children:e.jsx(F,{})})}),e.jsx("div",{style:{backgroundColor:"#666",borderRadius:4,boxShadow:"0px 11px 15px -7px rgba(0,0,0,0.2),0px 24px 38px 3px rgba(0,0,0,0.14),0px 9px 46px 8px rgba(0,0,0,0.12)"},children:o})]})}function se({entry:o}){const{isLoggedIn:a}=n.useContext(I),{userLockNotes:s,updateProfileField:c}=n.useContext(z),t=s[o.id]||"",l=n.useCallback(async i=>{await c("userLockNotes",i),p(!1)},[c]),[v,p]=n.useState(!1),f=n.useCallback(()=>{p(!0)},[]),r=n.useCallback(()=>{p(!1),x(t)},[t]),[d,x]=n.useState(t);n.useEffect(()=>{x(t||"")},[t]);const w=i=>{x(P(i.target.value,{urlsOK:!0}))},L=n.useCallback(async()=>{const i={...s,[o.id]:d||""};await l(i).catch(m=>{console.error("Error updating notes:",m)}),r()},[s,o.id,d,l,r]),S=n.useCallback(async()=>{const i={...s};delete i[o.id],await l(i).catch(m=>{console.error("Error removing notes:",m)}),r()},[o.id,r,l,s]),{isMobile:u}=T(),h={fontSize:"1.0rem",fontWeight:400,marginBottom:5,paddingLeft:2,color:"#fff"},y=u?"0.95rem":"1.0rem",k=u?5:3,j=t.split(`
`).length,N=j>k?Math.min(j,12):k,W=e.jsx("div",{style:{display:"flex"},children:a?e.jsxs("div",{style:{flexGrow:1,maxWidth:550,padding:10},children:[e.jsxs("div",{style:{marginTop:10,display:"flex"},children:[e.jsx("div",{style:{...h,flexGrow:1,fontWeight:700},children:"My Notes"}),e.jsxs("div",{style:{...h,color:"#aaa",fontSize:"0.85rem"},children:[d.length||0,"/1200"]})]}),e.jsx(O,{type:"text",name:"notes",multiline:!0,fullWidth:!0,rows:N,value:d,onChange:w,id:"notes",color:"info",style:{},placeholder:"Add your personal notes about this lock",variant:"outlined",autoFocus:!0,inputProps:{maxLength:1200,style:{fontSize:y}}}),e.jsxs("div",{style:{flexGrow:1,textAlign:"right",marginTop:8},children:[e.jsx(C,{variant:"text",size:"small",onClick:r,children:"Cancel"}),e.jsx(C,{variant:"text",size:"small",onClick:L,color:"success",children:"Save"})]})]}):e.jsxs("div",{style:{flexGrow:1,padding:"40px 20px",placeItems:"center"},children:[e.jsxs("div",{style:{...h,marginBottom:15,fontWeight:700,textAlign:"center"},children:["Please sign in to add your",e.jsx("br",{}),"own notes for locks."]}),e.jsx("div",{style:{width:210},children:e.jsx(D,{onClick:r})})]})});return e.jsxs(M.Fragment,{children:[(t==null?void 0:t.length)>0?e.jsxs("div",{style:{fontWeight:700,marginTop:15},children:[e.jsxs("div",{style:{display:"flex"},children:[e.jsx("span",{style:{marginTop:-.6},children:"My notes  "}),e.jsx(g,{style:{fontWeight:400,color:"#2bb259"},onClick:f,children:"edit"})," • ",e.jsx(g,{style:{fontWeight:400,color:"#2bb259"},onClick:S,children:"remove"})]}),e.jsx("div",{style:{fontSize:y,marginLeft:10,fontWeight:400,fontStyle:"italic"},children:e.jsx(V,{remarkPlugins:[U],rehypePlugins:[[K,{target:"_blank",rel:["nofollow","noopener","noreferrer"]}]],children:t})})]}):e.jsx("div",{style:{fontWeight:700,marginTop:15},children:e.jsx(g,{style:{fontWeight:600,color:"#2bb259",textDecoration:"none",cursor:"pointer"},onClick:f,children:"Add your personal notes"})}),e.jsx(_,{dialogContent:W,open:v,handleClose:r,width:u?350:550})]})}export{ne as C,se as E};
