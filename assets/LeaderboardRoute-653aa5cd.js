import{O as w,r as l,j as e,T as p,X as M,Y as P,Z as D,$ as N,a0 as S,a1 as _,a2 as B,R as j,b as E,h as I,i as W,u as L,I as y,P as $,M as O,g as A,U as q,V as H,W as U,e as z,B as Y}from"./index-1d439e1c.js";import{u as T}from"./useWindowSize-91db4baa.js";import{d as G}from"./dayjs.min-4c03f87b.js";import{T as V,a as F,b as f,c as K,d as X,e as Z}from"./TableRow-5e91e735.js";import{L as J}from"./LinearProgress-2e826907.js";import{d as k,I as Q}from"./Search-a359a9e9.js";import{A as ee}from"./Autocomplete-8339278f.js";import{T as te}from"./TextField-0c801766.js";import{d as re}from"./Sort-ef7eb8a2.js";import{B as se}from"./Badge-380f94e1.js";import"./InputLabel-c1066814.js";import"./Chip-d8545c53.js";function oe(){const[r,t]=w(),s=r.get("sort"),i={border:0,padding:"4px 12px",backgroundColor:"#000"},o=l.useCallback(a=>()=>{a&&a!==s?r.set("sort",a):r.delete("sort"),t(r)},[r,t,s]);return e.jsx(V,{children:e.jsxs(F,{children:[e.jsx(f,{align:"center",style:i,children:e.jsx(p,{title:"Sort Default",arrow:!0,disableFocusListener:!0,children:e.jsx("span",{style:{cursor:"pointer"},onClick:o(),children:"#"})})}),e.jsx(f,{style:{fontWeight:700,fontSize:"1.2rem",border:0,padding:"4px 16px 4px 0px",backgroundColor:"#000"},children:"Name"},"Display Name"),e.jsx(f,{align:"center",style:i,children:e.jsx(p,{title:"Sort by Own",arrow:!0,disableFocusListener:!0,children:e.jsx(M,{color:s==="own"?"secondary":void 0,onClick:o("own"),style:{cursor:"pointer"}})})}),e.jsx(f,{align:"center",style:i,children:e.jsx(p,{title:"Sort by Picked",arrow:!0,disableFocusListener:!0,children:e.jsx(P,{color:s==="picked"?"secondary":void 0,onClick:o("picked"),style:{cursor:"pointer"}})})}),e.jsx(f,{align:"center",style:i,children:e.jsx(p,{title:"Sort by Recorded",arrow:!0,disableFocusListener:!0,children:e.jsx(D,{color:s==="recorded"?"secondary":void 0,onClick:o("recorded"),style:{cursor:"pointer"}})})}),e.jsx(f,{align:"center",style:i,children:e.jsx(p,{title:"Sort by Wishlist",arrow:!0,disableFocusListener:!0,children:e.jsx(N,{color:s==="wishlist"?"secondary":void 0,onClick:o("wishlist"),style:{cursor:"pointer"}})})})]})})}function m({align:r="center",isCurrentUser:t,leader:s,value:i}){const o=s.displayName?"#eee":"#bbb",a=t?{fontWeight:600,color:"#4db013"}:{fontWeight:500,color:o},u={color:o};return e.jsx(f,{align:r,sx:u,style:a,children:i})}function ae({leader:r,isCurrentUser:t}){const s={textDecoration:"none",color:t?"#4db013":"#fff"};if(r.displayName){const i=r.displayName.replace(/\s/g,"_"),o=`/#/profile/${r.id}?name=${i}`;return e.jsx("a",{style:s,href:o,children:r.displayName})}else return"Anonymous"}function ne({index:r,leader:t,highlighted:s,scrollableRef:i}){const o=l.useRef(),{user:a}=l.useContext(S),[u,c]=l.useState(!1),d=(a==null?void 0:a.uid)===t.id,n=s?{backgroundColor:"#333"}:{};return l.useEffect(()=>{s&&o&&!u&&setTimeout(()=>{c(!0),i.current.scrollTo({top:o.current.offsetTop-75,behavior:"smooth"})},0)},[s,i,u]),e.jsxs(F,{ref:o,sx:{"&:nth-of-type(even) td, &:nth-of-type(even) th":s?{}:{backgroundColor:"#000"},"td, th":{padding:"6px 2px",border:0},...n},children:[e.jsx(m,{isCurrentUser:d,leader:t,value:r+1}),e.jsx(m,{isCurrentUser:d,leader:t,value:e.jsx(ae,{isCurrentUser:d,leader:t}),align:"left"}),e.jsx(m,{isCurrentUser:d,leader:t,value:t.own}),e.jsx(m,{isCurrentUser:d,leader:t,value:t.picked}),e.jsx(m,{isCurrentUser:d,leader:t,value:t.recorded}),e.jsx(m,{isCurrentUser:d,leader:t,value:t.wishlist})]},t.id)}function ie({data:r,loading:t}){const s=_(),{user:i}=l.useContext(S),o=l.useRef(),{highlightedUser:a,sort:u}=l.useMemo(()=>{const n=B.parse(s.search);return{highlightedUser:n.user,sort:n.sort&&le.includes(n.sort)?n.sort:void 0}},[s.search]),c=l.useMemo(()=>t?ce:u?r.data.toSorted((n,h)=>h[u]-n[u]):r.data,[u,t,r]),d=t?"####-##-## ##:##":G(r.metadata.updatedDateTime).format("MM/DD/YY hh:mm");return e.jsxs(j.Fragment,{children:[t&&e.jsx(J,{variant:"indeterminate",color:"secondary"}),e.jsxs("div",{style:{maxWidth:700,padding:8,backgroundColor:"#000",marginLeft:"auto",marginRight:"auto",marginTop:16},children:[e.jsx(K,{sx:{height:"78vh",backgroundColor:"#111"},id:"scrollable",ref:o,children:e.jsxs(X,{stickyHeader:!0,children:[e.jsx(oe,{}),e.jsx(Z,{children:c.map((n,h)=>{const b=!!a&&(a==="me"&&n.id===i.uid||a===n.displayName);return e.jsx(ne,{index:h,leader:n,scrollableRef:o,highlighted:b},n.id)})})]})}),e.jsxs(E,{variant:"caption",align:"right",component:"div",style:{width:"100%",marginTop:8},children:["Updated hourly, last update: ",d," GMT"]})]})]})}const le=["own","picked","recorded","wishlist"],ce=[...Array(40)].map((r,t)=>({id:t,displayName:"........................",own:"---",picked:"---",recorded:"---",wishlist:"--"}));var v={},de=W;Object.defineProperty(v,"__esModule",{value:!0});var R=v.default=void 0,ue=de(I()),C=e;R=v.default=(0,ue.default)([(0,C.jsx)("circle",{cx:"10",cy:"8",r:"4"},"0"),(0,C.jsx)("path",{d:"M10.35 14.01C7.62 13.91 2 15.27 2 18v2h9.54c-2.47-2.76-1.23-5.89-1.19-5.99m9.08 4.01c.36-.59.57-1.28.57-2.02 0-2.21-1.79-4-4-4s-4 1.79-4 4 1.79 4 4 4c.74 0 1.43-.22 2.02-.57L20.59 22 22 20.59zM16 18c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"},"1")],"PersonSearch");function he(){const r=L(),t=l.useCallback(()=>{r("/leaderboard?user=me")},[r]);return e.jsx(p,{title:"Find Me",arrow:!0,disableFocusListener:!0,children:e.jsx(y,{color:"inherit",onClick:t,children:e.jsx(R,{})})})}function pe({data:r}){const t={maxWidth:450},{isMobile:s}=T(),i=L(),o=l.useRef(),a=r.data.filter(x=>x.displayName).map(x=>x.displayName),u=l.useCallback((x,g)=>{g?a.includes(g)&&i(`/leaderboard?user=${g}`):i("/leaderboard")},[i,a]),[c,d]=l.useState(!1),n=l.useCallback(()=>{d(!0),setTimeout(()=>o.current.focus(),15)},[]),h=l.useCallback(()=>d(!1),[]),b=c&&s?{width:"auto",position:"fixed",left:60,right:0,paddingRight:16,maxWidth:"unset",zIndex:9999999,backgroundColor:"#272727"}:{};return e.jsxs(j.Fragment,{children:[!c&&s&&e.jsx(p,{title:"Search",arrow:!0,disableFocusListener:!0,children:e.jsx(y,{color:"inherit",onClick:n,children:e.jsx(k,{})})}),(c||!s)&&e.jsx(ee,{selectOnFocus:!0,clearOnEscape:!0,handleHomeEndKeys:!0,fullWidth:!0,style:{...t,...b},options:a,onChange:u,renderInput:x=>e.jsx(te,{...x,placeholder:"Search",variant:"standard",color:"secondary",inputRef:o,InputProps:{...x.InputProps,startAdornment:e.jsx(Q,{position:"start",children:e.jsx(k,{})})}})}),e.jsx($,{invisible:!0,open:c&&s,onClick:h})]})}function xe(){const[r,t]=l.useState(null),s=!!r,i=l.useCallback(n=>t(n.currentTarget),[]),o=l.useCallback(()=>t(null),[]),[a,u]=w(),c=a.get("sort"),d=l.useCallback(n=>()=>{o(),n&&n!==c?a.set("sort",n):a.delete("sort"),u(a)},[a,u,c,o]);return e.jsxs(j.Fragment,{children:[e.jsx(p,{title:"Sort",arrow:!0,disableFocusListener:!0,children:e.jsx(y,{color:"inherit",onClick:i,children:e.jsx(se,{variant:"dot",color:"secondary",overlap:"circular",invisible:!c,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(re,{})})})}),e.jsx(O,{anchorEl:r,open:s,onClose:o,children:fe.map(({label:n,value:h})=>e.jsx(A,{onClick:d(h),selected:c===h,children:n},n))})]})}const fe=[{label:"Default",value:void 0},{label:"Own",value:"own"},{label:"Picked",value:"picked"},{label:"Recorded",value:"recorded"},{label:"Wishlist",value:"wishlist"}];function Re(){const{isMobile:r}=T(),[t,s]=l.useState({data:[],metadata:{}}),[i,o]=l.useState(!0);l.useEffect(()=>{(async()=>{try{const d=await(await fetch(me)).json();s(d),o(!1)}catch(c){console.error("Error loading leaderboard data.",c),z("Error loading leaderboard data. Please reload the page.",{autoHideDuration:null,action:e.jsx(Y,{color:"secondary",onClick:()=>window.location.reload(),children:"Refresh"})}),o(!1)}})()},[]);const a=e.jsxs(j.Fragment,{children:[e.jsx(pe,{data:t}),e.jsx(xe,{}),e.jsx(he,{}),!r&&e.jsx("div",{style:{flexGrow:1}})]});return e.jsxs(j.Fragment,{children:[e.jsx(q,{title:"Leaderboard",extras:a}),e.jsx(ie,{data:t,loading:i}),e.jsx(H,{}),e.jsx(U,{feature:"leaderboard"})]})}const me="https://explore.lpubelts.com/leaderboard/leaderboardData.json";export{Re as default};
