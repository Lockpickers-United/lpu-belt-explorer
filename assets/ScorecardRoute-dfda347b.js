import{ar as K,r as t,D as $,u as M,b as ve,j as e,R as A,B as y,J as ie,I as ae,ax as be,aa as le,a2 as ce,ak as de,a3 as pe,W as Ie,F as me,ay as Ee,V as Te,A as xe,Z as De,ab as Se,S as Le,ah as Ae,az as Re,e as _e,d as we,N as Pe,h as Fe,T as Be}from"./index-9aaf69d0.js";import{c as Ne}from"./dataUrls-46e31bfb.js";import{S as Oe,a as Ve,b as Me}from"./ScorecardListContext-96a0ba0f.js";import{s as We}from"./filterFields-da0afefd.js";import{s as ze}from"./sortFields-b1bde6f9.js";import{S as He,F as Ue}from"./SortButton-661bd296.js";import{L as $e}from"./LoadingDisplay-cf75c5bc.js";import{V as Ye,S as Ge}from"./ScorecardRow-906d583f.js";import{D as ue}from"./DataContext-969904aa.js";import"./index-a0d6f4fd.js";import{I as te,S as oe}from"./ScorecardDanStats-d4bc7ca4.js";import{L as J}from"./LoadingDisplay-bb803e71.js";import{L as X}from"./Link-4f4c751e.js";import{T as Qe}from"./TextField-8b44301d.js";import{d as he,E as V}from"./EvidenceForm-5ba9f76e.js";import{P as qe}from"./ProfileHeader-2ec62597.js";import{N as Xe}from"./NoScorecardData-71b5af11.js";import{I as Ke}from"./IntroCopy-77c00c88.js";import{B as Je}from"./BeltStripe-9904012d.js";import{e as Ze}from"./entryName-dfe10c14.js";import{L as et}from"./ListItem-853263d6.js";import{d as tt}from"./Cached-0181f150.js";import{C as se}from"./Collapse-8a123860.js";import{A as ot,a as st,b as rt}from"./AccordionSummary-67f28a2b.js";import{T as nt,a as re}from"./ToggleButtonGroup-8d251fcc.js";import{E as it}from"./ScorecardExportButton-fa0c3ee1.js";import{S as at}from"./ScorecardProfileNotFound-b08454ee.js";import{S as lt}from"./SearchBox-d9680eea.js";import{u as ne}from"./useData-2d88d89d.js";import{L as ct,A as dt}from"./LocalizationProvider-039c7201.js";import"./rankingRequestData-d3ef79e5.js";import"./FilterAlt-09c1ff06.js";import"./Select-c4f8a659.js";import"./Box-11c7036f.js";import"./Chip-6a2cc6e1.js";import"./Sort-01737b3c.js";import"./LockListContext-14f6d157.js";import"./LPU-c3fa7122.js";import"./LinearProgress-19bedd04.js";import"./ExpandMore-23538526.js";import"./FieldValue-936b070d.js";import"./Link-8f876f4f.js";import"./BeltIcon-471cd2c5.js";import"./chartDefaults-bfd54756.js";import"./nivo-bar-01977f63.js";import"./nivo-axes-be772bbb.js";import"./nivo-legends-7a75c2fc.js";import"./uniq-0b21fe05.js";import"./_baseClone-27652511.js";import"./CircularProgress-bfab3147.js";import"./Launch-f194c5a0.js";import"./PhotoCamera-58ba69a5.js";import"./LockEntrySearchBox-9067d1e0.js";import"./Search-6aeeea2d.js";import"./BeltStripeMini-8e71ac11.js";import"./Autocomplete-6e872167.js";import"./index-92edf68d.js";import"./DialogContent-a5806df4.js";import"./Dialog-86b6bdb4.js";import"./VideocamOutlined-e605acc3.js";import"./FormGroup-e2b21cb2.js";import"./Checkbox-26ff77fd.js";import"./LoadingDisplaySmall-9feff078.js";import"./CopyProfileLinkButton-038f80d2.js";import"./mycollection-0ec86312.js";import"./index-f71703a5.js";import"./index-5724f7b7.js";import"./index-65fd9b30.js";import"./download-5850e36c.js";import"./List-cfdedd7a.js";import"./ContentCopy-dfe78a47.js";function ye({setControlsExpanded:s,adminAction:o}){const{userId:r}=K(),{importUnclaimedEvidence:g}=t.useContext($),{isMobile:j}=M(),[i,p]=t.useState(!1),c=ve(),[a,u]=t.useState(""),[h,m]=t.useState(null),v=t.useCallback(async()=>{p(!0);const b=await g(r,a);p(!1),b?(u(""),s(!1),o()):m("Cannot find dan sheet tab")},[g,r,a,s,o]),T=j?"block":"flex",I=j?"0.95rem":"1rem";return e.jsx(A.Fragment,{children:e.jsx("div",{style:{placeItems:"center",display:T},children:i?e.jsx(J,{}):e.jsx(A.Fragment,{children:e.jsxs("div",{style:{padding:20,fontSize:I},children:[e.jsx("strong",{children:"For Black Belt pickers only."}),e.jsx("br",{}),"Black Belt pickers currently use another scorecard system known as the Dan Sheet. This import allows them to bring their picking history over to the site. If you do not already have a tab in the Dan sheet, this import will not work for you. For those that do, specify the name of your tab in the sheet to import your history into your Scorecard. Please note that tab names are case sensitive. ",e.jsx(X,{onClick:()=>{c("/profile/scorecard/howto")},style:{color:"#bbb",cursor:"pointer"},children:"Click here to learn more."}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("div",{style:{padding:"0px",alignItems:"center"},children:e.jsxs("div",{style:{padding:"0px",display:"flex"},children:[e.jsx("div",{style:{flexGrow:1}}),e.jsx(Qe,{id:"tab-to-import",label:"Tab to Import",value:a,size:"small",error:!!h,helperText:h,margin:"dense",color:"secondary",onChange:b=>{u(b.target.value)}}),e.jsx(y,{style:{color:"#000",padding:0,lineHeight:"1rem",height:40,marginTop:8,marginLeft:10},variant:"contained",onClick:v,edge:"start",color:"secondary",children:"Import"})]})})]})})})})}function pt({id:s,owner:o}){const[r,g]=t.useState(null),{cardActivity:j}=t.useContext(ue),i=j.filter(a=>a.id===s).filter(a=>a),p=t.useCallback(a=>{g(a)},[]),c=t.useCallback(()=>{g(null)},[]);return e.jsxs(A.Fragment,{children:[e.jsx(ie,{title:"My Collection",arrow:!0,disableFocusListener:!0,children:e.jsx(ae,{variant:"outlined",color:"inherit",onClick:p,children:e.jsx(be,{color:i.length>0?"secondary":"inherit",fontSize:"medium"})})}),e.jsx(le,{sx:{color:"#fff",zIndex:a=>a.zIndex.drawer+1},open:!!r,onClick:null,children:!!r&&e.jsxs(ce,{style:{maxWidth:600,marginLeft:"auto",marginRight:"auto",border:"1px solid #666",opacity:1},children:[e.jsx(de,{title:"Documentation",action:e.jsx(he,{sx:{cursor:"pointer"}}),style:{paddingBottom:0},onClick:c}),e.jsxs(pe,{children:[i.map((a,u)=>e.jsx(V,{activity:a,handleUpdate:c,source:"collectionButton",owner:o},u)),i.length===0&&e.jsx(V,{activity:null,lockId:s,handleUpdate:c,source:"collectionButton",owner:o})]})]})})]})}function mt({entry:s,owner:o}){const r=s.link?"#fff":"#888";return e.jsxs(et,{style:{minHeight:64,borderTop:"1px solid rgba(255, 255, 255, 0.12)",color:r},children:[e.jsx(Je,{value:s.belt}),e.jsx(Ie,{primary:Ze(s),primaryTypographyProps:{fontWeight:500},secondary:s.version,secondaryTypographyProps:{color:r},style:{padding:"0px 0px 0px 10px"}}),e.jsx(Ye,{entry:s,color:r}),e.jsx(pt,{id:s.id,owner:o})]},s.id)}const xt=A.memo(mt);function ut({owner:s,popularEntries:o,popularType:r}){const{isMobile:g}=M(),{filters:j}=t.useContext(me),[i,p]=t.useState(25),[c,a]=t.useState("all"),[u,h]=t.useState(!0),m=t.useMemo(()=>o.slice(0,i),[o,i]),v=t.useMemo(()=>c==="picked"?m.filter(l=>l.link):c==="notPicked"?m.filter(l=>!l.link):m,[c,m]),T=m.filter(l=>l.link).length,I=v.length>0?Math.floor(T/m.length*100):0,b=s?"You've picked":"Picked",P=Object.keys(j).filter(l=>l!=="locks"&&l!=="tab").length>0?"matching":"most popular",f=t.useCallback(l=>()=>{h(!1),setTimeout(()=>p(l),150),setTimeout(()=>h(!0),300)},[]),n=g?"block":"flex",k=i===25?"contained":"text",E=i===50?"contained":"text",R=i===100?"contained":"text",F=c==="all"?"contained":"text",_=c==="picked"?"contained":"text",D=c==="notPicked"?"contained":"text";return o?e.jsxs("div",{style:{maxWidth:700,padding:0,backgroundColor:"#222",marginLeft:"auto",marginRight:"auto",marginTop:16},children:[e.jsxs("div",{style:{width:"100%",textAlign:"center",padding:"0px 20px 24px 20px"},children:[e.jsx(Ee,{in:u,children:e.jsxs("div",{style:{fontSize:"1.2rem",fontWeight:700},children:[b," ",T," of the ",m.length," ",P," locks in ",r," Scorecards (",I,"%)"]})}),"(only entries with documentation are counted)",e.jsxs("div",{style:{marginTop:20,display:n,padding:"0px 20px"},children:[e.jsxs("div",{style:{flexGrow:1,textAlign:"left",fontSize:"1rem",marginTop:6},children:[e.jsx(y,{onClick:()=>a("all"),color:"info",variant:F,value:"all",style:{padding:"2px 8px 2px 8px",minWidth:35,lineHeight:"1rem",marginRight:6},children:"All"}),e.jsx(y,{onClick:()=>a("picked"),color:"info",variant:_,value:"picked",style:{padding:"2px 8px 2px 8px",minWidth:35,lineHeight:"1rem",marginRight:2},children:"Picked"}),e.jsx(y,{onClick:()=>a("notPicked"),color:"info",variant:D,value:"notPicked",style:{padding:"2px 8px 2px 8px",minWidth:35,lineHeight:"1rem"},children:"Not Picked"})]}),e.jsxs("div",{style:{flexGrow:1,textAlign:"right",fontSize:"1rem",marginTop:6},children:["Top Locks:  ",e.jsx(y,{onClick:f(25),color:"info",variant:k,value:"25",style:{padding:"2px 2px 2px 2px",minWidth:35,lineHeight:"1rem"},children:"25"}),e.jsx(y,{onClick:f(50),variant:E,color:"info",value:"50",style:{padding:"2px 2px 2px 2px",minWidth:35,lineHeight:"1rem"},children:"50"}),e.jsx(y,{onClick:f(100),color:"info",variant:R,value:"100",style:{padding:"2px 2px 2px 2px",minWidth:35,lineHeight:"1rem"},children:"100"})]})]})]}),e.jsx("div",{children:e.jsx(Te,{dense:!0,style:{padding:0},children:v.map(l=>e.jsx(xt,{entry:l,owner:s},l.id))})})]}):e.jsx(J,{})}function ht({profile:s}){const{isMobile:o}=M(),{user:r}=t.useContext(xe),{oauthState:g}=t.useContext($),j=(s==null?void 0:s.blackBeltAwardedAt)>0,[i,p]=t.useState(!1),c=t.useCallback(()=>{p(!i)},[i]),[a,u]=t.useState(!1),h=()=>{u(!1),p(!1)},m=()=>{u(!0)},v=t.useCallback(()=>{const{VITE_DISCORD_CLIENT_ID:f}={VITE_LOCAL_DATA:"false",VITE_DISCORD_CLIENT_ID:"1271550138929774725",VITE_DISCORD_CLIENT_SECRET:"CoecO8cx2SyhMq2k3WdWNp-lavxYkeS-",VITE_REDDIT_CLIENT_ID:"i_lvEF-IFPalom2BR_lVjg",VITE_REDDIT_CLIENT_SECRET:"09PAhQfve1tysFh3jQAtmFaG5pWG0A",VITE_DEV_FIRESTORE:"false",VITE_RAFL_VIEW_FORM_ID:"1FAIpQLSf_PQ6XXDYy0cTn_2MeDCwikTOYLRtncPKluFRK-QEYHX0qug",VITE_RAFL_STATE:"hidden",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},n=encodeURIComponent("identify"),k=encodeURIComponent(`${location.origin}/#/auth/discord`),E=`https://discord.com/oauth2/authorize?client_id=${f}&response_type=code&redirect_uri=${k}&scope=${n}`;window.location.assign(E)},[]),T=t.useCallback(async()=>{const{VITE_REDDIT_CLIENT_ID:f}={VITE_LOCAL_DATA:"false",VITE_DISCORD_CLIENT_ID:"1271550138929774725",VITE_DISCORD_CLIENT_SECRET:"CoecO8cx2SyhMq2k3WdWNp-lavxYkeS-",VITE_REDDIT_CLIENT_ID:"i_lvEF-IFPalom2BR_lVjg",VITE_REDDIT_CLIENT_SECRET:"09PAhQfve1tysFh3jQAtmFaG5pWG0A",VITE_DEV_FIRESTORE:"false",VITE_RAFL_VIEW_FORM_ID:"1FAIpQLSf_PQ6XXDYy0cTn_2MeDCwikTOYLRtncPKluFRK-QEYHX0qug",VITE_RAFL_STATE:"hidden",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},n=await g(r.uid),k=encodeURIComponent("identity flair privatemessages"),E=encodeURIComponent(`${location.origin}/#/auth/reddit`),R=`https://www.reddit.com/api/v1/authorize?client_id=${f}&response_type=code&state=${n}&redirect_uri=${E}&duration=temporary&scope=${k}`;window.location.assign(R)},[r,g]),I=o?"0.91rem":"1rem",b=o?"1.3rem":"1.5rem",P="IMPORT BELTS";return e.jsxs(A.Fragment,{children:[e.jsx(ie,{title:"Import",arrow:!0,disableFocusListener:!0,children:e.jsx(y,{variant:"contained",color:"secondary",size:"small",style:{lineHeight:"1.2rem",marginLeft:6},onClick:m,children:P})}),e.jsx(le,{sx:{color:"#fff",zIndex:f=>f.zIndex.drawer+1},open:a,onClick:null,children:a&&e.jsxs(ce,{style:{maxWidth:600,marginLeft:"auto",marginRight:"auto",border:"1px solid #666",opacity:1},children:[e.jsx(de,{title:"Import Belts",action:e.jsx(he,{sx:{cursor:"pointer"}}),style:{paddingBottom:0},onClick:h}),e.jsxs(pe,{children:[e.jsxs(se,{in:!i,children:[e.jsxs("div",{style:{padding:"0px 0px",fontSize:I,lineHeight:b},children:[e.jsx("strong",{children:"New!"})," Add your approved Belts (and Dan Levels) to your Scorecard. You'll need to authorize for each site, and we'll pull your username and approvals for you. Please note: you can only import belts already approved through the official process.",e.jsx("br",{}),e.jsx("br",{}),"You'll need to briefly authorize for each platform you use for belts. For Discord, we use the publicly available awards in #belt-requests so that linking is a simple confirmation of your username to determine which belts are yours. Reddit requests temporary permission in order to scan direct messages for belt awards. We cannot access and do not store your password.",e.jsx("br",{}),e.jsx("br",{}),e.jsxs("span",{style:{fontWeight:400},children:["New Discord approvals will be automatically added to your scorecard as long as there is a Discord username in your Profile. You only need to re-import from Discord if you want to add belts from an additional username.",e.jsx("br",{}),e.jsx("br",{}),"You'll need to import from Reddit again to pick up newly approved belts."]})]}),e.jsxs("div",{style:{padding:20,width:"100%",textAlign:"center"},children:[e.jsx("span",{style:{fontWeight:700},children:"Import From"}),e.jsx("br",{}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx(y,{variant:"contained",color:"secondary",style:{lineHeight:"1.2rem"},onClick:v,children:"DISCORD"}),e.jsx(y,{variant:"contained",color:"secondary",style:{lineHeight:"1.2rem",marginLeft:16},onClick:T,children:"REDDIT"})]})]}),!j&&e.jsxs("div",{style:{padding:20,width:"100%",textAlign:"center"},children:["Black Belts only: ",e.jsx(X,{onClick:c,style:{color:"#99c2e5",cursor:"pointer"},children:"Import your Dan Sheet"})]})]}),e.jsx(se,{in:i,children:i&&e.jsxs(A.Fragment,{children:[e.jsx(ye,{}),e.jsxs("div",{style:{padding:20,width:"100%",textAlign:"center"},children:["Return to ",e.jsx(X,{onClick:c,style:{color:"#99c2e5",cursor:"pointer"},children:"Import Belts"})]})]})})]})]})})]})}function yt({owner:s,profile:o,adminAction:r,popular:g}){const{isMobile:j}=M(),{userId:i}=K(),{visibleEntries:p=[],popularEntries:c=[],bbPopularEntries:a=[],cardActivity:u,cardMaxBelt:h}=t.useContext(ue),{expanded:m}=t.useContext(Oe),{filters:v,setFilters:T,removeFilters:I}=t.useContext(me),{name:b,locks:P}=v,{createEvidenceForEntries:f,removePickerActivity:n,refreshPickerActivity:k}=t.useContext($),{admin:E}=t.useContext(De),[R,F]=t.useState(m),[_,D]=t.useState(!1),[l,B]=t.useState("import"),[W,w]=t.useState(!1),[C,z]=t.useState(P==="mostPopular"||g);m&&m!==R&&F(m);const O=t.useMemo(()=>{if(o&&o.recorded){const x=u.map(q=>q.matchId);return o.recorded.filter(q=>!x.includes(q))}else return[]},[o,u]),N=t.useCallback(x=>{v.id&&I(["id"]),F(x)},[v,I]),Y=t.useCallback(async()=>{w(!0),await f(i,O),D(!1),w(!1),r()},[f,i,O,r]),S=t.useCallback(x=>{l===x?(D(!_),B(void 0)):l==="lock"&&x==="project"||l==="project"&&x==="lock"?B(x):(B(x),D(!_))},[l,_]),[H,U]=t.useState(null),G=!!H,d=t.useCallback(x=>{x.preventDefault(),x.stopPropagation(),U(x.currentTarget)},[]),L=t.useCallback(()=>U(null),[]),ge=t.useCallback(async()=>{w(!0),await n(u),L(),w(!1),r()},[u,n,L,r]),Z=t.useCallback(()=>{D(!1),B(void 0),T(C?{name:b}:{locks:"mostPopular",name:b}),z(!C)},[C,b,T]),je=t.useCallback(async()=>{w(!0),await k(i),w(!1),r(),window.location.reload()},[r,k,i]),fe=o!=null&&o.displayName&&!o.privacyAnonymous?o.displayName.toLowerCase().endsWith("s")?`${o.displayName}'`:`${o.displayName}'s`:"Anonymous",ke=s?"My Locks":`${fe} Locks`,ee=15,Q=j?"block":"flex",Ce=j?6:0;return e.jsxs("div",{style:{maxWidth:700,padding:0,backgroundColor:"#222",marginLeft:"auto",marginRight:"auto",marginTop:16},children:[e.jsx(qe,{profile:o,page:"scorecard",owner:s,mostPopular:C}),s&&p.length===0&&!(o!=null&&o.tabClaimed)&&e.jsx("div",{style:{margin:8,padding:"0px 0px"},children:e.jsx(Ke,{pageName:"scorecard"})}),p.length>0&&e.jsx(A.Fragment,{children:j?e.jsxs("div",{style:{display:Q,padding:"0px 8px 0px 16px"},children:[(o==null?void 0:o.blackBeltAwardedAt)>0&&e.jsx(oe,{profile:o,owner:s}),e.jsx("div",{style:{marginRight:0,width:"95%"},children:e.jsx(te,{profile:o,entries:p})})]}):e.jsxs("div",{style:{display:Q,padding:"10px 8px 0px 16px"},children:[e.jsx("div",{style:{marginRight:10,width:370},children:e.jsx(te,{profile:o,entries:p})}),o.danLevel>=0&&e.jsx("div",{style:{flexGrow:1,marginRight:0},children:e.jsx(oe,{profile:o,owner:s})})]})}),e.jsxs(ot,{expanded:_,disableGutters:!0,children:[e.jsx(st,{style:{paddingLeft:ee,paddingRight:ee,placeItems:"center",width:"100%"},children:e.jsxs("div",{style:{width:"100%",placeItems:"center",textAlign:"center"},children:[e.jsxs("div",{style:{display:Q,width:"100%",placeItems:"center",textAlign:"center"},children:[(s||E)&&e.jsxs("div",{style:{width:"100%",textAlign:"left"},children:[e.jsx(y,{variant:"contained",size:"small",color:"secondary",style:{lineHeight:"1.2rem",marginLeft:6},onClick:()=>S("lock"),children:"ADD LOCK"}),e.jsx(ht,{profile:o}),e.jsx(y,{variant:"outlined",color:"secondary",size:"small",style:{lineHeight:"1.2rem",marginLeft:6},onClick:()=>S("project"),children:"ADD PROJECT"})]}),e.jsxs("div",{style:{width:"100%",textAlign:"right",display:"flex",marginTop:Ce},children:[e.jsx("div",{style:{flexGrow:1}}),e.jsxs(nt,{exclusive:!0,children:[e.jsx(re,{variant:"outlined",color:"info",size:"small",disabled:!C,style:{padding:"4px 10px",borderColor:"#236585",color:C?"#aaa":"#38b9f6",backgroundColor:C?"transparent":"#333"},onClick:()=>Z(),value:"myLocks",children:e.jsx("nobr",{children:ke})}),e.jsx(re,{variant:"outlined",color:"info",size:"small",disabled:C,style:{padding:"4px 10px",borderColor:"#236585",color:C?"#38b9f6":"#aaa",backgroundColor:C?"#333":"transparent"},onClick:()=>Z(),value:"mostPopular",children:"MOST POPULAR"})]})]})]}),W&&e.jsx(J,{}),E&&!W&&e.jsx("div",{style:{backgroundColor:"#700",padding:5,marginTop:20},children:e.jsxs("div",{style:{display:"flex"},children:[e.jsx("div",{style:{width:"10%",textAlign:"center"},children:"ADMIN"}),e.jsx(y,{color:"secondary",size:"small",style:{lineHeight:"1.2rem",marginLeft:6},onClick:()=>S("award"),children:"ADD BELT"}),e.jsx(y,{color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:()=>S("import"),children:"IMPORT DAN SHEET"}),e.jsxs(y,{color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:Y,children:["MERGE RECORDED (",O.length,")"]}),e.jsx(y,{color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:d,children:"DELETE SCORECARD"}),e.jsxs(Se,{anchorEl:H,open:G,onClose:L,children:[e.jsxs("div",{style:{padding:20,textAlign:"center"},children:["You cannot undo delete.",e.jsx("br",{}),"Are you sure?"]}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(y,{style:{marginBottom:10,color:"#000"},variant:"contained",onClick:ge,edge:"start",color:"error",children:"Delete"})})]}),e.jsx(ae,{color:"secondary",onClick:je,children:e.jsx(tt,{})})]})})]})}),e.jsxs(rt,{style:{backgroundColor:"#333"},children:[l==="import"&&e.jsx(ye,{setControlsExpanded:D,adminAction:r}),l==="lock"&&e.jsx(V,{activity:null,handleUpdate:S,addLock:!0,owner:s}),l==="project"&&e.jsx(V,{activity:null,handleUpdate:S,addProject:!0,owner:s}),l==="award"&&e.jsx(V,{activity:null,handleUpdate:S,addAward:!0,owner:s})]})]}),!C&&e.jsxs(A.Fragment,{children:[p.length===0&&e.jsx(Xe,{}),e.jsx("div",{children:p.map(x=>e.jsx(Ge,{owner:s,activity:x,expanded:x.id===R,onExpand:N,merged:o.blackBeltAwardedAt>0},x.id))})]}),C&&e.jsx(ut,{owner:s,profile:o,adminAction:r,popularType:(h==null?void 0:h.rank)<9?"all":"BB",popularEntries:(h==null?void 0:h.rank)<9?c:a})]})}function Fo({mostPopular:s}){const{userId:o}=K(),{user:r}=t.useContext(xe),{getProfile:g,getPickerActivity:j}=t.useContext($),{scoredActivity:i,bbCount:p,danPoints:c,eligibleDan:a,nextDanPoints:u,nextDanLocks:h,uniqueLocks:m,maxBelt:v}=t.useContext(Le),{isMobile:T}=M(),[I,b]=t.useState(!1),P=t.useCallback(()=>{b(!I)},[I]),f=t.useCallback(async()=>{try{const d=await g(o);if(d){const L=d.displayName&&!d.privacyAnonymous?d.displayName.toLowerCase().endsWith("s")?`${d.displayName}'`:`${d.displayName}'s`:"Anonymous";document.title=`LPU Belt Explorer - ${L} Scorecard`}if((r==null?void 0:r.uid)!==o){const L=await j(o);return{profile:d,...Ae(L)}}else return{profile:d,scoredActivity:i,bbCount:p,danPoints:c,eligibleDan:a,nextDanPoints:u,nextDanLocks:h,uniqueLocks:m,maxBelt:v}}catch(d){return console.error("Error loading profile and activity.",d),null}},[I,g,o,r,j,i,p,c,a,u,h,m,v]),{data:n={},loading:k,error:E}=ne({loadFn:f}),R=(r==null?void 0:r.uid)===o,F=n?n.profile:{},_=n?n.scoredActivity:[],D=n?n.bbCount:0,l=n?n.danPoints:0,B=n?n.eligibleDan:0,W=n?n.nextDanPoints:0,w=n?n.nextDanLocks:0,C=n?n.uniqueLocks:0,z=n?n.scoredActivity.filter(d=>d.collectionDB==="awards").map(d=>Re[d.matchId]).filter(d=>d.awardType==="belt").sort((d,L)=>d.rank-L.rank):[],O=n?z[z.length-1]:{},N=ne({url:Ne}),Y=N.data?N.data.blackBeltOnly.listStats.recordedLocks.topItems:[],S=N.data?N.data.allUsers.listStats.recordedLocks.topItems:[],H=window.location.hash.search(/locks=mostPopular/)<1&&!s?e.jsxs(A.Fragment,{children:[e.jsx(lt,{label:"Scorecard",extraFilters:[{key:"tab",value:"search"}]}),e.jsx(He,{sortValues:ze}),e.jsx(Ue,{extraFilters:[{key:"tab",value:"search"}]}),!T&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}})]}):null,U=e.jsx("div",{style:{margin:"30px 0px"},children:e.jsx(it,{text:!0})}),G=k?"Loading...":"Profile";return k||E?null:e.jsx(_e,{filterFields:We,children:e.jsx(Ve,{cardActivity:_,cardBBCount:D,cardDanPoints:l,cardEligibleDan:B,cardNextDanPoints:W,cardNextDanLocks:w,cardUniqueLocks:C,cardMaxBelt:O,popularLocks:S,popularLocksBB:Y,children:e.jsxs(Me,{children:[e.jsxs(ct,{adapterLocale:we.locale(),dateAdapter:dt,children:[e.jsx(Pe,{title:G,extras:H}),k&&e.jsx($e,{}),!k&&n&&!E&&e.jsx(yt,{owner:r&&(r==null?void 0:r.uid)===o,profile:F,adminAction:P,popular:s}),!k&&(!n||E)&&e.jsx(at,{}),e.jsx(Fe,{before:U})]}),e.jsx(Be,{feature:"scorecard",own:R})]})})})}export{Fo as default};
