import{P as Te,Q as De,U as Ie,V as Me,r as t,F as z,u as _,j as e,a2 as se,R as Y,I as X,am as $,K as q,B as G,L as Ce,D as Ne,a1 as ce,ah as ze,aq as me,A as ye,$ as je,bc as ve,X as We,a0 as ke}from"./index-CE4ZCYQr.js";import{B as de,S as Ee}from"./Sort-uZj_nL7u.js";import{f as pe,F as Ae,a as Ge,C as Fe}from"./FilterAlt-DEGjDKMh.js";import{L as ue}from"./LockListContext-B0S3fNtq.js";import{T as Se,a as ne}from"./ToggleButtonGroup-CEJrlhW3.js";import{B as he}from"./Box-bLSA-IDK.js";import{D as we}from"./DataContext-kX_YzVkQ.js";import{H as xe}from"./HighlightOff-Brqs67YM.js";import{s as ge}from"./setDeep-J6HEwWhX.js";import{A as $e}from"./AddCircle-DxFK5che.js";import{F as qe,I as _e,S as He}from"./Select-B859B-Hn.js";import{C as Ve}from"./Cancel-C-YUa-Q5.js";const re=({advancedFilterGroups:d,entries:c,groupIndex:f,valueIndex:m})=>{if(!c||c.length===0)return[];const r=Array.isArray(d)?d:[];if(r.length===0||f<0)return c;const i=s=>{if(!s||!s.fieldName)return null;const o=s.fieldName,l=Array.isArray(s.values)?s.values.filter(n=>n!=null&&String(n).length):[];if(l.length===0)return null;const C=(s.operator||"AND").toUpperCase()==="OR"?"OR":"AND",u=(s.matchType||"Is").toLowerCase()==="is not";return{fieldName:o,values:l,operator:C,negative:u}};let a=r.map(i).filter(Boolean);if(a.length===0)return c;if(Number.isFinite(f)&&f>=0&&(a=a.slice(0,Math.min(f+1,a.length))),a.length>0&&Number.isFinite(m)&&m>=0){const s=a.length-1,o=a[s];Array.isArray(o.values)&&o.values.length>0&&(o.values=o.values.slice(0,Math.min(m+1,o.values.length)))}return c.filter(s=>a.every(({fieldName:o,values:l,operator:C,negative:u})=>{const n=s[o],p=x=>Array.isArray(n)?n.includes(x):n===x,v=l.some(x=>p(x)),h=l.every(x=>p(x)),S=C==="OR"?v:h;return u?!S:S}))};var J={},be;function Ue(){if(be)return J;be=1;var d=Te();Object.defineProperty(J,"__esModule",{value:!0}),J.default=void 0;var c=d(De()),f=Ie();return J.default=(0,c.default)((0,f.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM8 9h8v10H8zm7.5-5-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutline"),J}var Ke=Ue();const Pe=Me(Ke);function Qe({label:d,active:c=!1,group:f,operator:m,valueIndex:r,currentValue:i,onFilter:a,onRemove:s,handleAddValue:o,sort:l,size:C="medium",context:u}){if(!d||d.length===0)return null;const{searchedBeltEntries:n,visibleEntries:p,visibleBeltEntries:v}=t.useContext(we),{advancedFilterGroups:h,setAdvancedFilterGroups:S}=t.useContext(z),{fieldName:x,groupIndex:w,matchType:F,values:B=[]}=f;[...h()];let T=Array.isArray(B)?B.filter(b=>b&&String(b).length>0).join(m==="OR"?" OR ":" AND "):B;T=F==="Is Not"?`NOT ${T}`:T;const M=t.useMemo(()=>{if(c){if(w===0&&(!r||r===0))return n;if(w>0&&(!r||r===0)||r>0&&m==="OR")return re({advancedFilterGroups:h(),entries:n,groupIndex:w-1,valueIndex:99});if(r>0&&m==="AND")return re({advancedFilterGroups:h(),entries:n,groupIndex:w,valueIndex:r-1})}else return n;return[]},[c,w,r,m,n,h]),{options:H,counts:W}=t.useMemo(()=>{const b=M.reduce((k,A)=>(Array.isArray(A[x])?A[x].forEach(fe=>{ge(k,[fe],A.id)}):ge(k,[A[x]],A.id),k),{});let L=u==="drawer"?Array.from(new Set([...Object.keys(b),i,T])):Array.from(new Set([...Object.keys(b),i]));L=L.filter(k=>k&&String(k).length>0&&k!=="undefined");const K=L.sort((k,A)=>{if(l)return l(k,A);if(typeof k=="string"&&typeof A=="string")return k.localeCompare(A);if(Number.isInteger(k)&&Number.isInteger(A))return k-A});return{counts:K.reduce((k,A)=>{if(A==="no more options")return k[A]=0,k;const Be=h().map((P,Le)=>{if(Le!==w)return P;if((P.operator||m)==="OR")return{...P,values:[A]};const Q=Array.isArray(B)?[...B]:[];typeof r=="number"?Q.length===0?Q.push(A):Q[r]=A:Q.push(A);const Re=Q.filter(ae=>ae!=null&&String(ae).length>0);return{...P,values:Re}});let te;return c?te=re({advancedFilterGroups:Be.slice(0,w+1),entries:n}):te=re({advancedFilterGroups:[{fieldName:x,matchType:F,operator:"OR",values:[A]}],entries:v,groupIndex:0}),k[A]=Array.isArray(te)?te.length:0,k},{}),options:K}},[M,u,i,T,x,l,h,c,w,m,B,r,F,v,n]),V=Array.isArray(B)?B.filter((b,L)=>L!==r):[];let D=H.filter(b=>W[b]>0&&(b!==i||b!==T||W[b]!==p.length)||b===i||b===T).filter(b=>!V.includes(b));D.length===0&&(D=["no more options"]);const g=D.length===1&&D[0]==="no more options",[j,y]=t.useState(!1),R=t.useCallback(b=>{y(!1);const L=b.target.value;L!=="no more options"&&(setTimeout(()=>a&&a(L),0),setTimeout(()=>document.activeElement.blur()))},[a]),O=t.useCallback(()=>{y(!1),setTimeout(()=>document.activeElement.blur())},[]),I=t.useCallback(()=>y(!0),[]),Z=t.useCallback(()=>{let L=h().filter((K,ee)=>ee!==w);L.length===0&&(L=[{_id:`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,fieldName:"",matchType:"Is",operator:"OR",values:[]}]),S(L)},[h,w,S]),le=t.useCallback(()=>{s&&s()},[s]),oe=u==="drawer"?18:12,ie=u!=="drawer"?{backgroundColor:i.length>0?"#333":void 0}:F==="Is Not"?{backgroundColor:i.length>0?"#733030  ":void 0}:{backgroundColor:i.length>0?"#555":void 0},{isMobile:U}=_(),E=U||u==="drawer"?210:250,N=U?"medium":"small";return e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:oe},children:[(D==null?void 0:D.length)===0||(x==null?void 0:x.length)===0?null:e.jsxs(qe,{style:{minWidth:E,marginBottom:0,marginRight:4},size:C==="small"?"small":"medium",fullWidth:!0,children:[e.jsx(_e,{id:`filter-${x}`,color:"secondary",style:{opacity:g?.5:1},children:d}),e.jsx(He,{label:d,labelId:`filter-${x}`,value:g?"no more options":u==="drawer"?T:i,disabled:g,onChange:R,style:{...ie,opacity:g?.5:1},color:"secondary",open:j,onClose:O,onOpen:I,onBlur:O,children:D.map((b,L)=>{const K=W[b]||0,ee=["AND","OR"].some(k=>b.includes(k));return e.jsx(se,{value:b,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",justifyContent:"space-between"},children:[e.jsx("div",{style:{maxWidth:160,overflow:"hidden",textOverflow:"ellipsis"},children:pe[b]?pe[b]:b}),e.jsx("div",{style:{fontSize:"0.8rem",marginLeft:8,opacity:.85},children:g||ee?"":K})]})},`${b}-${L}`)})})]}),u!=="drawer"&&e.jsxs(Y.Fragment,{children:[r===0&&i.length>0&&e.jsx(X,{"aria-label":"add filter group",onClick:o,style:{marginTop:4,marginLeft:2},size:N,children:e.jsx($e,{fontSize:N,style:{color:"#5d854f"}})}),(i.length>0||r>0)&&e.jsx(X,{"aria-label":"remove filter value",onClick:le,style:{marginTop:4,marginLeft:2},size:N,children:e.jsx(xe,{fontSize:N,style:{color:"#d04e4e"}})}),(!r||r===0)&&x&&e.jsx(X,{"aria-label":"remove filter group",onClick:Z,style:{marginTop:4,marginLeft:2},size:N,children:e.jsx(Pe,{fontSize:N,style:{color:"#eee"}})})]}),(i.length>0||r>0)&&u==="drawer"&&e.jsx(X,{"aria-label":"remove filter value",onClick:Z,style:{marginTop:4,marginLeft:2},size:N,children:e.jsx(xe,{fontSize:N,style:{color:"#d04e4e"}})})]})}function Je({style:d={}}){const{filters:c,addFilter:f,removeFilters:m}=t.useContext(z),{tab:r}=t.useContext(ue),{belt:i}=c,a=/\/locks/.test(location.hash),s=t.useMemo(()=>r||i||"White",[i,r]),o=t.useMemo(()=>s!=="search"?"belt":"all",[s]),[l,C]=t.useState(s);s!==l&&s!=="search"?C(s):o==="belt"&&s==="search"&&C("search");const u=t.useCallback(h=>()=>{h==="all"?f("tab","search",!0):h==="belt"&&(m(["belt"]),f("tab",l,!0))},[f,l,m]),{color:n}=$[l]?$[l]:{color:"#inherit"},p=l==="Black"?"#444":n,v=o==="belt"?1:.7;return e.jsx(Y.Fragment,{children:$[l]&&a&&e.jsx("div",{style:d,children:e.jsxs(Se,{variant:"outlined",children:[e.jsxs(ne,{onClick:u("belt"),style:{color:o==="belt"?"#fff":"#777",backgroundColor:o==="belt"?"#3f3f3f":"#222",height:28,padding:"0px 10px 0px 0px",borderColor:"#666",width:134,textAlign:"left",justifyContent:"flex-start"},value:"belt",disabled:o==="belt",children:[e.jsx("div",{style:{backgroundColor:n,height:26,width:12,borderRadius:"3px 0px 0px 3px",borderRight:`${p} 1px solid`,marginRight:8,opacity:v}}),e.jsxs("div",{style:{flexGrow:1,textAlign:"center"},children:[l," BELT"]})]},"belt"),e.jsx(ne,{onClick:u("all"),style:{color:o==="all"?"#fff":"#777",backgroundColor:o==="all"?"#3f3f3f":"#222",height:28,padding:"0px 12px",borderColor:"#666"},value:"all",disabled:o==="all",children:"ALL LOCKS"},"all")]})})})}function Oe({forceText:d,forceIcon:c,closeDrawer:f,alwaysShow:m,drawer:r=!1,nav:i=!1}){const{isMobile:a}=_(),{filterCount:s,clearFilters:o,clearAdvancedFilterGroups:l}=t.useContext(z),C=t.useCallback(()=>{o(),l&&l(),f&&f()},[l,o,f]),u=r||i?"text":"outlined",n=i?{marginLeft:2}:{height:28,padding:"0px 12px",minWidth:80,marginLeft:8};return s===0&&!m?null:a&&!d||c?e.jsx(q,{title:"Reset All",arrow:!0,disableFocusListener:!0,children:e.jsx(X,{onClick:C,color:"warning",style:{padding:0},children:e.jsx(Ve,{})})}):e.jsx(G,{variant:u,color:"warning",onClick:C,style:n,children:"Reset"})}function Xe({text:d}){const{filters:c,addFilter:f,removeFilter:m}=t.useContext(z),{expandAll:r}=c,i=t.useCallback(()=>{!r||r==="false"?f("expandAll","Expand All",!0):m("expandAll","Expand All")},[r,f,m]),a=r?"Collapse All":"Expand All";return d?e.jsx("div",{children:e.jsx(q,{title:a,arrow:!0,disableFocusListener:!0,children:e.jsx(Ce,{onClick:()=>i(),style:{color:"#fff",textDecoration:"none",cursor:"pointer"},size:"small",children:e.jsx("div",{style:{marginLeft:5,marginTop:5,padding:5,fontWeight:700},children:a.toUpperCase()})})})}):e.jsx("div",{children:e.jsx(q,{title:a,arrow:!0,disableFocusListener:!0,children:e.jsx(G,{onClick:()=>i(),style:{color:"#aaa"},size:"small",children:a})})})}function Ye({sortValues:d,compactMode:c,expandAll:f}){const[m,r]=t.useState(null),i=!!m,a=t.useCallback(F=>r(F.currentTarget),[]),s=t.useCallback(()=>r(null),[]),{filters:o,addFilter:l}=t.useContext(z),{sort:C}=o,{adminRole:u}=t.useContext(Ne),{compact:n,setCompact:p}=t.useContext(ce),v=t.useCallback(F=>()=>{s(),p(F)},[s,p]),h=t.useCallback(F=>()=>{s(),setTimeout(()=>l("sort",F,!0),0)},[l,s]),S={vertical:"top",horizontal:"right"},{width:x}=_(),w=x<=500;return e.jsxs(Y.Fragment,{children:[e.jsx(q,{title:"View Options",arrow:!0,disableFocusListener:!0,children:e.jsx(G,{color:"inherit",onClick:a,style:{color:"#ddd"},children:e.jsx(de,{variant:"dot",color:"secondary",invisible:!C,anchorOrigin:S,children:w?e.jsx(Ee,{}):"VIEW"})})}),e.jsxs(ze,{anchorEl:m,open:i,onClose:s,children:[e.jsx("div",{style:{marginLeft:5,padding:5,fontWeight:700},children:"SORT BY"}),d.map(({label:F,value:B})=>e.jsx(se,{onClick:h(B),selected:C===B,children:F},F)),c&&e.jsxs("div",{children:[e.jsx(me,{}),e.jsx("div",{style:{marginLeft:5,marginTop:5,padding:5,fontWeight:700},children:"MODE"}),e.jsx(se,{onClick:v(!1),selected:!n,children:"Normal"}),e.jsx(se,{onClick:v(!0),selected:n,children:"Compact"})]}),u&&f&&e.jsxs("div",{children:[e.jsx(me,{}),e.jsx(Xe,{text:!0})]})]})]})}function Ze({onFiltersChanged:d}){const{isLoggedIn:c}=t.useContext(ye),{beta:f}=t.useContext(ce),{filters:m,filterCount:r,addFilters:i,addFilter:a,filterFields:s,removeFilters:o}=t.useContext(z),{tab:l}=t.useContext(ue),{belt:C}=m,u=/\/locks/.test(location.hash),n=t.useMemo(()=>l||C||"White",[C,l]),p=t.useMemo(()=>n!=="search"?"belt":"all",[n]),[v,h]=t.useState(n);n!==v&&n!=="search"?h(n):p==="belt"&&n==="search"&&h("search");const[S,x]=t.useState(!1),w=t.useCallback(()=>x(!S),[S]);je("f",w);const F=t.useCallback(j=>()=>{j==="all"?a("tab","search",!0):j==="belt"&&(o(["belt"]),a("tab",v,!0))},[a,v,o]),B=t.useCallback((j,y)=>{i([{key:j,value:y},{key:"id",value:void 0},{key:"name",value:void 0}],!0),d&&d()},[i,d]),T=t.useCallback(()=>x(!0),[]),M=t.useCallback(()=>x(!1),[]),{color:H,lineColor:W="#999"}=$[v]?$[v]:{color:"#inherit"},V=p==="belt"?1:.7,{width:D}=_(),g=D<=500;return e.jsxs(Y.Fragment,{children:[e.jsx(q,{title:"Filter",arrow:!0,disableFocusListener:!0,children:e.jsx(G,{color:"inherit",onClick:T,style:{color:"#ddd"},children:e.jsx(de,{variant:"dot",badgeContent:r,color:"secondary",anchorOrigin:{vertical:"top",horizontal:"right"},children:g?e.jsx(Ae,{}):"FILTER"})})}),S&&e.jsxs(ve,{anchor:"right",open:S,onClose:M,children:[e.jsx(We,{variant:"dense",onClick:M,style:{padding:"8px 0px 0px 8px"},children:e.jsx("div",{style:{fontSize:"1.3rem",fontWeight:700},children:"Filters"})}),$[v]&&u&&e.jsx("div",{style:{marginLeft:8,marginBottom:8},children:e.jsxs(Se,{variant:"outlined",children:[e.jsxs(ne,{onClick:F("belt"),style:{color:p==="belt"?"#eee":"#777",backgroundColor:p==="belt"?"inherit":"#111",padding:"6px 12px",borderColor:"#666"},value:"belt",disabled:p==="belt",children:[e.jsx("div",{style:{backgroundColor:H,height:16,width:16,borderColor:W,borderRadius:8,border:"1px solid",marginRight:8,opacity:V}}),v," BELT"]},"belt"),e.jsx(ne,{onClick:F("all"),style:{color:p==="all"?"#eee":"#777",backgroundColor:p==="all"?"inherit":"#111",padding:"6px 12px",borderColor:"#666"},value:"all",disabled:p==="all",children:"ALL LOCKS"},"all")]})}),e.jsx(he,{margin:1,children:e.jsx(ke,{direction:"column",style:{minWidth:250},children:s.filter(j=>(!j.beta||f)&&(!j.userBased||c)).filter(j=>!(p==="belt"&&l!=="search"&&j.label==="Belt")).map((j,y)=>e.jsx(Ge,{tab:l,...j,onFilter:B},y))})}),e.jsxs("div",{style:{padding:8},children:[e.jsx(Fe,{forceText:!0}),e.jsx(G,{variant:"outlined",color:"inherit",onClick:M,children:"Done"})]})]})]})}function et(){const[d,c]=t.useState(!1),{isLoggedIn:f}=t.useContext(ye),{beta:m}=t.useContext(ce),{filters:r,filterCount:i,filterFields:a,showAdvancedSearch:s,setShowAdvancedSearch:o,advancedFilterGroups:l,setAdvancedFilterGroups:C}=t.useContext(z),{tab:u}=t.useContext(ue),{visibleBeltEntries:n=[]}=t.useContext(we),{belt:p}=r,v=t.useMemo(()=>{const g=l().filter(y=>y.fieldName.length>0&&Array.isArray(y.values)&&y.values.length>0).map(y=>({...a.find(O=>O.fieldName===y.fieldName),active:!0})),j=a.filter(y=>!g.find(R=>R.fieldName===y.fieldName));return[...g,...j]},[l,a]),h=t.useMemo(()=>u||p||"White",[p,u]),S=t.useMemo(()=>h!=="search"?"belt":"all",[h]),[x,w]=t.useState(h);h!==x&&h!=="search"?w(h):S==="belt"&&h==="search"&&w("search");const F=t.useCallback(()=>c(!d),[d]);je("f",F);const B=t.useCallback((g,j)=>{if(!g||!j)return;o(!0);const y=[...l().filter(I=>I.fieldName.length>0)],R=y.findIndex(I=>I.fieldName===g&&Array.isArray(I.values)&&I.values.length>0);if(R>=0){const I=y[R];if(I.values.includes(j))return;y[R]={...I,values:[j]},C(y);return}const O={_id:`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,fieldName:g,matchType:"Is",operator:"OR",values:[j]};C([...y,O])},[l,C,o]),T=t.useCallback(()=>c(!0),[]),M=t.useCallback(()=>c(!1),[]),H=t.useCallback(()=>{o(!s)},[o,s]),W={color:"#ddd",textDecoration:"underline",cursor:"pointer","&:hover":{color:"#fff"}},{width:V}=_(),D=V<=500;return e.jsxs(Y.Fragment,{children:[e.jsx(q,{title:"Filter",arrow:!0,disableFocusListener:!0,children:e.jsx(G,{color:"inherit",onClick:T,style:{color:"#ddd"},children:e.jsx(de,{variant:"dot",badgeContent:i,color:"warning",anchorOrigin:{vertical:"top",horizontal:"right"},children:D?e.jsx(Ae,{}):"FILTER"})})}),d&&e.jsxs(ve,{anchor:"right",open:d,onClose:M,sx:{".MuiDrawer-paper":{width:280,padding:1}},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",margin:"8px 8px 12px 8px",height:38},onClick:M,children:[e.jsx("div",{style:{fontWeight:700,fontSize:"1.3rem"},children:"Filters"}),e.jsxs("div",{style:{fontWeight:400,fontSize:"1.0rem",marginLeft:8},children:["(",(n==null?void 0:n.length)||0," Lock",(n==null?void 0:n.length)!==1&&"s",")"]}),e.jsx("div",{style:{flexGrow:1,textAlign:"right",fontSize:"0.9rem"},children:s?e.jsx(Oe,{advanced:!0,drawer:!0}):e.jsx(Ce,{onClick:H,sx:W,children:s?"Reset":"Advanced"})})]}),e.jsx(Je,{style:{margin:"0px 0px 8px 8px"}}),e.jsx(he,{margin:1,children:e.jsx(ke,{direction:"column",style:{minWidth:250},children:v.filter(g=>(!g.beta||m)&&(!g.userBased||f)).filter(g=>!(S==="belt"&&u!=="search"&&g.label==="Belt")).map((g,j)=>{var U;const y=l(),R=y.findIndex(E=>E.fieldName===g.fieldName&&Array.isArray(E.values)&&E.values.length>0),O=R>=0?y[R]:null,I=O?{...O,groupIndex:R}:{fieldName:g.fieldName,groupIndex:-1,matchType:"Is",operator:"OR",values:[""]},Z=O&&((U=O.values)==null?void 0:U[0])||"",le=O&&O.matchType||"Is",oe=O&&O.operator||"OR",ie=O?R:0;return e.jsx(Qe,{...g,active:g.active,label:g.label,group:I,groupIndex:ie,matchType:le,operator:oe,valueIndex:0,currentValue:Z,onFilter:E=>B(g.fieldName,E),onRemove:()=>{},handleAddValue:()=>{},size:"small",context:"drawer"},j)})})}),e.jsxs("div",{style:{padding:8},children:[e.jsx(Fe,{forceText:!0}),e.jsx(G,{variant:"outlined",color:"inherit",onClick:M,children:"Close"})]})]})]})}function ft({sortValues:d,extraFilters:c=[],compactMode:f,resetAll:m=!1,expandAll:r=!1,style:i,advancedEnabled:a=!1}){const{filters:s,filterCount:o,isFiltered:l}=t.useContext(z),{sort:C}=s,u=C||o>0||l&&m,{width:n}=_(),p=n<=500,v=p?3:0,h=p?2:0,S=p?40:60;return e.jsxs(he,{style:{display:"flex",paddingTop:v,marginBottom:h,marginLeft:0,justifyContent:"center",...i},sx:{".MuiBadge-anchorOriginTopRightRectangular":{marginTop:"5px"},".MuiButton-root":{minWidth:S}},children:[e.jsx(Ye,{sortValues:d,compactMode:f,expandAll:r}),a?e.jsx(et,{extraFilters:c}):e.jsx(Ze,{extraFilters:c}),!!u&&e.jsx(Oe,{advanced:!0,nav:!0})]})}export{Qe as A,Xe as E,Je as F,Oe as R,ft as V};
