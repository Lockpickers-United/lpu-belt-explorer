import{a as q}from"./index-xsH4HHeE.js";import{X as E}from"./index-CfbufueW.js";const x=async({user:e,url:o,formData:s,json:a,snackBars:r,timeoutDuration:n=15e3})=>{var m,p,l,g,f,h;const i=new AbortController,c=setTimeout(()=>{i.abort()},n),v=Math.floor(Math.random()*1e6),u=e?await e.getIdToken():null,d=a!==void 0&&s===void 0,y={...u&&{Authorization:`Bearer ${u}`},"Content-Type":d?"application/json":"multipart/form-data"},C=d?a:s;try{const t=await q.post(`${o}?${v}`,C,{headers:y,signal:i.signal});return clearTimeout(c),r&&E("Request successful",{variant:"success"}),t.data}catch(t){clearTimeout(c);const T=t.name==="CanceledError"||t.code==="ERR_CANCELED"||((m=t.message)==null?void 0:m.includes("aborted")),b=T?"Request timed out. Please try again.":((g=(l=(p=t.response)==null?void 0:p.data)==null?void 0:l.error)==null?void 0:g.message)||((h=(f=t.response)==null?void 0:f.data)==null?void 0:h.message)||t.message||"Error during authentication or server request";r&&E(b,{variant:"error",autoHideDuration:T?5e3:3e3})}},A=e=>{var o,s,a;if((o=e.response)!=null&&o.data&&typeof e.response.data=="string"){const r=(s=e.message.match(/code (\d+)/))==null?void 0:s[1],n=(a=e.response.data.match(/<pre>([\s\S]*?)<\/pre>/))==null?void 0:a[1];return{response:{data:{status:r,message:n}}}}else return e};export{A as c,x as p};
