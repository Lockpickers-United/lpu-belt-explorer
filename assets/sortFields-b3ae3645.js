import{r as t,J as F,K as S,j as e,E as j,I as D,B as $,X as E,A as q,am as G,U as O,R as T,aG as J,O as P,H as K,V as X,W as Q,a3 as Y,a9 as Z}from"./index-2dd09f9d.js";import{F as y,D as N}from"./filterFields-71de39fc.js";import{F as ee,I as te,S as ne}from"./Select-24f65f1d.js";import{B as W}from"./Box-af8714a6.js";import{C as le,I as R}from"./Chip-6caa460c.js";import{u as z}from"./useWindowSize-10ba4e4d.js";import{B,d as re}from"./Sort-9fa167ae.js";import{d as M}from"./Search-c710e679.js";import{T as ae}from"./TextField-7a1b6749.js";function se(r,n){const[s,o]=t.useState(r);return t.useEffect(()=>{const f=setTimeout(()=>o(r),n||500);return()=>{clearTimeout(f)}},[r,n]),s}var _={},oe=S;Object.defineProperty(_,"__esModule",{value:!0});var L=_.default=void 0,ie=oe(F()),ce=e;L=_.default=(0,ie.default)((0,ce.jsx)("path",{d:"M5 13h14v-2H5zm-2 4h14v-2H3zM7 7v2h14V7z"}),"ClearAll");function ue({forceText:r}){const{isMobile:n}=z(),{filterCount:s,clearFilters:o}=t.useContext(y);return s===0?null:n&&!r?e.jsx(j,{title:"Clear Filters",arrow:!0,disableFocusListener:!0,children:e.jsx(D,{onClick:o,children:e.jsx(L,{})})}):e.jsx($,{variant:"outlined",color:"inherit",onClick:o,style:{minWidth:120},children:"ClearÂ Filters"})}var I={},de=S;Object.defineProperty(I,"__esModule",{value:!0});var H=I.default=void 0,he=de(F()),pe=e;H=I.default=(0,he.default)((0,pe.jsx)("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61"}),"FilterAlt");function fe({label:r,fieldName:n,onFilter:s,sort:o}){const{visibleEntries:f}=t.useContext(N),{filters:g}=t.useContext(y),[v,i]=t.useState(!1),c=t.useCallback(p=>{i(!1),setTimeout(()=>s(n,p.target.value,!0),0),setTimeout(()=>document.activeElement.blur())},[n,s]),u=t.useCallback(()=>{i(!1),setTimeout(()=>document.activeElement.blur())},[]),h=t.useCallback(()=>i(!0),[]),{counts:x,options:m}=t.useMemo(()=>{const p=f.map(a=>a[n]).flat().filter(a=>a),C=p.reduce((a,l)=>(a[l]||(a[l]=0),a[l]++,a),{}),A=[...new Set(p)].sort((a,l)=>{if(o)return o(a,l);if(typeof a=="string"&&typeof l=="string")return a.localeCompare(l);if(Number.isInteger(a)&&Number.isInteger(l))return a-l});return{counts:C,options:A}},[n,f,o]),d=t.useDeferredValue(g),b=d[n],k=Array.isArray(b)?d[n]:b?[b]:[];return e.jsxs(ee,{style:{minWidth:120,maxWidth:300,marginTop:4},fullWidth:!0,children:[e.jsx(te,{id:`filter-${n}`,color:"secondary",children:r}),e.jsx(ne,{multiple:!0,label:r,labelId:`filter-${n}`,value:k,onChange:c,style:{marginBottom:8},color:"secondary",open:v,onClose:u,onOpen:h,onBlur:u,MenuProps:{PaperProps:{style:{maxHeight:ge*8+ve}}},renderValue:p=>e.jsx(W,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:p.map(C=>e.jsx(le,{label:C},C))}),children:m.map((p,C)=>e.jsx(E,{value:p,children:`${p} (${x[p]||0})`},C))})]})}const ge=48,ve=8;function Be({onFiltersChanged:r,extraFilters:n=[]}){const{isLoggedIn:s}=t.useContext(q),{beta:o}=t.useContext(G),{filterCount:f,addFilters:g,filterFields:v}=t.useContext(y),[i,c]=t.useState(!1),u=t.useCallback(()=>c(!i),[i]);O("f",u);const h=t.useCallback(()=>c(!0),[]),x=t.useCallback(()=>c(!1),[]),m=t.useCallback((d,b)=>{g([{key:d,value:b},{key:"id",value:void 0},{key:"name",value:void 0},...n],!0),r&&r()},[g,r,n]);return e.jsxs(T.Fragment,{children:[e.jsx(j,{title:"Filter",arrow:!0,disableFocusListener:!0,children:e.jsx(D,{color:"inherit",onClick:h,children:e.jsx(B,{badgeContent:f,color:"secondary",overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(H,{})})})}),e.jsxs(J,{anchor:"right",open:i,onClose:x,children:[e.jsx(P,{variant:"dense",onClick:x,children:e.jsx(K,{variant:"h6",children:"Filters"})}),e.jsx(W,{margin:1,children:e.jsx(X,{direction:"column",style:{minWidth:250},children:v.filter(d=>(!d.beta||o)&&(!d.userBased||s)).map((d,b)=>e.jsx(fe,{...d,onFilter:m},b))})}),e.jsxs(P,{variant:"dense",children:[e.jsx(ue,{forceText:!0,style:{marginRight:8}}),e.jsx($,{variant:"outlined",color:"inherit",onClick:x,children:"Done"})]})]})]})}function _e({sortValues:r}){const[n,s]=t.useState(null),o=!!n,f=t.useCallback(h=>s(h.currentTarget),[]),g=t.useCallback(()=>s(null),[]),{filters:v,addFilter:i}=t.useContext(y),{sort:c}=v,u=t.useCallback(h=>()=>{g(),setTimeout(()=>i("sort",h,!0),0)},[i,g]);return e.jsxs(T.Fragment,{children:[e.jsx(j,{title:"Sort",arrow:!0,disableFocusListener:!0,children:e.jsx(D,{color:"inherit",onClick:f,children:e.jsx(B,{variant:"dot",color:"secondary",overlap:"circular",invisible:!c,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(re,{})})})}),e.jsx(Q,{anchorEl:n,open:o,onClose:g,children:r.map(({label:h,value:x})=>e.jsx(E,{onClick:u(x),selected:c===x,children:h},h))})]})}var w={},xe=S;Object.defineProperty(w,"__esModule",{value:!0});var V=w.default=void 0,be=xe(F()),me=e;V=w.default=(0,be.default)((0,me.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");function Ie({label:r,extraFilters:n=[]}){const[s]=Y(),{filters:o,addFilters:f,removeFilter:g}=t.useContext(y),[v,i]=t.useState(o.search||""),{isMobile:c}=z(),u=t.useRef();O("s",()=>{var l;return(l=u==null?void 0:u.current)==null?void 0:l.focus()},{preventDefault:!0});const h=t.useCallback(()=>{window.scrollTo({top:0}),i(""),g("search",""),u.current.focus()},[g]),x=t.useCallback(l=>{const{value:U}=l.target;i(U)},[]),m=se(v,250);t.useEffect(()=>{m!==s.get("search")&&(m?(window.scrollTo({top:0}),f([{key:"search",value:m},{key:"id",value:void 0},{key:"name",value:void 0},...n],!0)):f([{key:"search",value:m}],!0))},[m]);const[d,b]=t.useState(!1),k=t.useCallback(()=>setTimeout(()=>b(!1),0),[]),p=t.useCallback(()=>{b(!0),setTimeout(()=>{u.current.focus(),u.current.select()},0)},[]);t.useEffect(()=>{const l=s.get("search");l!==v&&i(l||"")},[s]);const C=v?e.jsx(R,{position:"end",children:e.jsx(j,{title:"Clear",arrow:!0,disableFocusListener:!0,children:e.jsx(D,{color:"inherit",onClick:h,edge:"end",size:"small",children:e.jsx(V,{})})})}):null,A=c?{maxWidth:450,marginRight:8}:{maxWidth:450,paddingLeft:60,marginRight:8},a=d&&c?{width:"auto",position:"fixed",left:60,right:0,paddingRight:16,maxWidth:"unset",zIndex:9999999,backgroundColor:"#272727"}:{};return e.jsxs(T.Fragment,{children:[!d&&c&&e.jsx(j,{title:"Search",arrow:!0,disableFocusListener:!0,children:e.jsx(D,{color:"inherit",onClick:p,children:e.jsx(B,{invisible:v.length===0,variant:"dot",color:"secondary",overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(M,{})})})}),(d||!c)&&e.jsx(ae,{placeholder:`Search ${r}`,InputProps:{inputProps:{ref:u},startAdornment:e.jsx(R,{position:"start",children:e.jsx(M,{})}),endAdornment:C},variant:"standard",color:"secondary",onChange:x,onBlur:k,value:v,style:{...A,...a},fullWidth:!0}),e.jsx(Z,{invisible:!0,open:d&&c,onClick:k})]})}const we=[{label:"Default",value:void 0},{label:"Alphabetical (Ascending)",value:"alphaAscending"},{label:"Alphabetical (Descending)",value:"alphaDescending"},{label:"Belt (Ascending)",value:"beltAscending"},{label:"Belt (Descending)",value:"beltDescending"},{label:"Popularity",value:"popularity"},{label:"Recently Updated",value:"recentlyUpdated"}],Pe=[{label:"Default",value:void 0},{label:"UL Group (Ascending)",value:"groupAscending"},{label:"UL Group (Descending)",value:"groupDescending"},{label:"Difficulty Tier (Ascending)",value:"tierAscending"},{label:"Difficulty Tier (Descending)",value:"tierDescending"},{label:"Alphabetical (Ascending)",value:"alphaAscending"},{label:"Alphabetical (Descending)",value:"alphaDescending"},{label:"Recently Updated",value:"recentlyUpdated"}],Re=[{label:"Default",value:void 0},{label:"Dan Points (Ascending)",value:"danPointsAscending"},{label:"Dan Points (Descending)",value:"danPointsDescending"},{label:"Date (Ascending)",value:"dateAscending"},{label:"Date (Descending)",value:"dateDescending"},{label:"Belt (Ascending)",value:"beltAscending"},{label:"Belt (Descending)",value:"beltDescending"},{label:"Alphabetical (Ascending)",value:"alphaAscending"},{label:"Alphabetical (Descending)",value:"alphaDescending"}];export{ue as C,Be as F,Ie as S,_e as a,Pe as d,we as l,Re as s};
