import{r as t,an as O,j as a,D as m,A as F,d as k,bJ as M,bG as W,bI as p,bK as C,bH as L,X as E,B as w,aa as z}from"./index-BmMTHZKs.js";import{R as I,a as G}from"./RaffleContext-BszYlyXr.js";import{A as Y}from"./AdminToolButtons-C2LBHfGd.js";import{D as q}from"./Dialog-pp_ln0Le.js";import{B as J}from"./Box-DuhsjPK-.js";import"./useData-Oa7fUtiX.js";import"./dataUrls-1xDVM400.js";import"./index-Bk6Ri9Zz.js";import"./setDeep-J6HEwWhX.js";import"./EmojiEvents-Vb0gjAcY.js";const K="/assets/hello-my-name-is-RAFL-2026s-CTaRzepe.png";function N(){const{raffleAdminRole:l,raflState:i}=t.useContext(I),n=O(),s=i==="setup"&&!l&&n.pathname!=="/rafl/contribute"&&n.pathname!=="/rafl/photos"&&n.pathname!=="/rafl/potpreview";return a.jsx(q,{open:s,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:1}}},sx:{".MuiDialog-paper":{backgroundColor:"#000",opacity:1,backgroundImage:"none"}},children:a.jsxs("div",{style:{textAlign:"center",padding:20,maxWidth:400},children:[a.jsx(J,{component:"img",alt:"Lock Pickers United",src:K,style:{marginLeft:"auto",marginRight:"auto",display:"block",width:"100%",margin:"30px 0px 30px"}}),a.jsx("br",{}),a.jsx("div",{style:{fontSize:"1.2rem",marginBottom:150},children:"Stay tuned!"}),a.jsx("br",{}),a.jsx(Y,{})]})})}function U({children:l}){const i=t.useContext(m),{authLoaded:n,isLoggedIn:s,user:x}=t.useContext(F),{profile:b}=t.useContext(m),[u,h]=t.useState(null),[g,y]=t.useState(!1),R=t.useCallback(async c=>{if(u||!s)return"error";try{const e=Object.fromEntries(Object.entries(c||{}).filter(([,r])=>r!==void 0));e.pots=(e.pots||[]).reduce((r,d)=>{const f=r.find($=>$.itemId===d.itemId);return f?f.tickets=(f.tickets||0)+(d.tickets||0):r.push({...d}),r},[]),e.createdAt||(e.createdAt=k().toISOString()),e.updatedAt=k().toISOString(),e.raflYear=2026;const o=await M(W(p,"raffle-entries"),e);return console.log("Created Raffle Entry",e),o.id}catch(e){throw console.error("Error creating raffle entry:",e),e}},[u,s]),[D,v]=t.useState({}),[S,B]=t.useState(!1);t.useEffect(()=>{const c=C(p,"data-cache","raffle-entries-summary"),e=L(c,o=>{const r=o.exists()?o.data():null;v(r||{}),B(!0),y(!0)},o=>{console.error("Error listening to DB:",o),h(!0),E("There was a problem reading raffle data. It will be unavailable until you refresh the page. ",{autoHideDuration:null,action:a.jsx(w,{color:"secondary",onClick:()=>location.reload(),children:"Refresh"})})});return()=>e()},[n,s,x]);const[j,P]=t.useState({}),[A,T]=t.useState(!1);t.useEffect(()=>{const c=C(p,"data-cache","raffle-winners"),e=L(c,o=>{const r=o.exists()?o.data():null;P(r||{}),T(!0),y(!0)},o=>{console.error("Error listening to DB:",o),h(!0),E("There was a problem reading raffle data. It will be unavailable until you refresh the page. ",{autoHideDuration:null,action:a.jsx(w,{color:"secondary",onClick:()=>location.reload(),children:"Refresh"})})});return()=>e()},[n,s,x]);const H=t.useMemo(()=>({...i,testEntry:X,createRaffleEntry:R,dbLoaded:g,profile:b,summaryData:D,summaryLoaded:S,winnerData:j,winnersLoaded:A,dbError:u}),[i,R,g,b,D,S,j,A,u]);return a.jsx(m.Provider,{value:H,children:l})}const X={platform:"Discord",username:"MacGuffin Security",belt:"Yellow",donations:[{amount:123,receipt:"https://lpubelts.com/",charity:{itemFullTitle:"American Humane",itemTitle:"American Humane",itemId:"ch_AmHum"}}],pots:[{tickets:123,itemFullTitle:"Pot 1 - $$$ of Locc",itemTitle:"$$$ of Locc",itemId:"2025-025",itemPotNumber:"1",itemIndex:0}],totalDonation:123,allocatedTickets:123,status:"pending",dev:!0,adminEntry:!0};function _(){const{raffleAdmin:l,raffleAdminRole:i,raflState:n}=t.useContext(I);l&&console.log("RaffleParentRoute, status:",n,i?" (raffleAdminRole)":"")}function ie(){return a.jsx(U,{children:a.jsxs(G,{children:[a.jsx(z,{}),a.jsx(N,{}),a.jsx(_,{})]})})}export{ie as default};
