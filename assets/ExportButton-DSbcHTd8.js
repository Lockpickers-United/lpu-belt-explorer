import{r as c,M as Q,j as e,K as ne,I as ie,U as mt,ar as ft,R as re,A as gt,D as yt,u as vt,B as W,aJ as Ct,L as te,ah as jt,a2 as H,ap as Z,Z as X}from"./index-CxJ13Q9t.js";import{L as kt}from"./Link-C0Kf74eE.js";import{e as se}from"./entryName-edVuKam4.js";import{C as bt}from"./Cancel-C0HyqOnN.js";import{D as wt}from"./Dialog-CmGOQoWJ.js";import{s as St}from"./sanitizeValues-B4vs0CrB.js";import{T as It}from"./TextField-B7MVRRYU.js";import{M as Lt}from"./index-CtlLRMNi.js";import{r as Mt}from"./index-StOu_fRm.js";import{r as _t}from"./index-nyfLLmSz.js";import{C as Oe}from"./Collapse-qV8GzT1v.js";import{d as qe,F as oe,C as Nt}from"./download-B9TUnTx_.js";import{L as Vt}from"./List-Cu38PuQg.js";import{D as Rt}from"./DataContext-bskxqDB_.js";import"./index-mfFxZH4k.js";import{C as Et}from"./ContentCopy-BvW_6MEu.js";function eo({entry:s,nameType:r}){const n=c.useCallback(async()=>{const p=se(s,r).replace(/[\s/]/g,"_").replace(/\W/g,""),h=`https://share.lpubelts.com/?id=${s.id}&name=${p}`;await navigator.clipboard.writeText(h),Q("Link to entry copied to clipboard.")},[s,r]);return e.jsx(ne,{title:"Copy Link to Entry",arrow:!0,disableFocusListener:!0,children:e.jsx(ie,{onClick:n,children:e.jsx(kt,{})})})}function Tt({dialogContent:s,open:r,handleClose:n,width:v=350}){return e.jsxs(wt,{open:r,onClose:n,sx:{".MuiDialog-paper":{backgroundColor:"transparent",backgroundImage:"none",padding:"12px",margin:"0px 0px 20px 0px",width:v}},children:[e.jsx("div",{style:{display:"flex",flexGrow:1,justifyContent:"flex-end",marginBottom:-15,marginRight:-10},children:e.jsx(ie,{style:{padding:0,color:"#eee",backgroundColor:"#333"},onClick:n,children:e.jsx(bt,{})})}),e.jsx("div",{style:{backgroundColor:"#666",borderRadius:4,boxShadow:"0px 11px 15px -7px rgba(0,0,0,0.2),0px 24px 38px 3px rgba(0,0,0,0.14),0px 9px 46px 8px rgba(0,0,0,0.12)"},children:s})]})}var Y={},Je;function zt(){if(Je)return Y;Je=1,Object.defineProperty(Y,"__esModule",{value:!0});var s=mt(),r=ft(),n=function(){return n=Object.assign||function(t){for(var o,i=1,l=arguments.length;i<l;i++)for(var a in o=arguments[i])Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a]);return t},n.apply(this,arguments)};function v(t,o,i){for(var l,a=0,m=o.length;a<m;a++)!l&&a in o||(l||(l=Array.prototype.slice.call(o,0,a)),l[a]=o[a]);return t.concat(l||Array.prototype.slice.call(o))}function p(t){var o=t.size,i=o===void 0?25:o,l=t.SVGstrokeColor,a=l===void 0?"currentColor":l,m=t.SVGstorkeWidth,C=m===void 0?0:m,k=t.SVGclassName,u=k===void 0?"star-svg":k,w=t.SVGstyle;return s.jsx("svg",n({className:u,style:w,stroke:a,fill:"currentColor",strokeWidth:C,viewBox:"0 0 24 24",width:i,height:i,xmlns:"http://www.w3.org/2000/svg"},{children:s.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}))}function h(t,o){switch(o.type){case"PointerMove":return n(n({},t),{hoverValue:o.payload,hoverIndex:o.index});case"PointerLeave":return n(n({},t),{ratingValue:t.ratingValue,hoverIndex:0,hoverValue:null});case"MouseClick":return n(n({},t),{valueIndex:t.hoverIndex,ratingValue:o.payload});default:return t}}var x="style-module_starRatingWrap__q-lJC",N="style-module_simpleStarRating__nWUxf",f="style-module_fillIcons__6---A",_="style-module_emptyIcons__Bg-FZ",g="style-module_tooltip__tKc3i";function L(){return typeof window<"u"&&window.matchMedia("(pointer: coarse)").matches||"ontouchstart"in window||typeof navigator<"u"&&navigator.maxTouchPoints>0}return function(t,o){o===void 0&&(o={});var i=o.insertAt;if(typeof document<"u"){var l=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",i==="top"&&l.firstChild?l.insertBefore(a,l.firstChild):l.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}(".style-module_starRatingWrap__q-lJC{display:inline-block;touch-action:none}.style-module_simpleStarRating__nWUxf{display:inline-block;overflow:hidden;position:relative;touch-action:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;vertical-align:middle;white-space:nowrap}.style-module_fillIcons__6---A{display:inline-block;overflow:hidden;position:absolute;top:0;white-space:nowrap}.style-module_emptyIcons__Bg-FZ{display:inline-block}.style-module_tooltip__tKc3i{background-color:#333;border-radius:5px;color:#fff;display:inline-block;padding:5px 15px;vertical-align:middle}"),Y.Rating=function(t){var o,i,l=t.onClick,a=t.onPointerMove,m=t.onPointerEnter,C=t.onPointerLeave,k=t.initialValue,u=k===void 0?0:k,w=t.iconsCount,b=w===void 0?5:w,T=t.size,A=T===void 0?40:T,F=t.readonly,V=F!==void 0&&F,O=t.rtl,z=O!==void 0&&O,B=t.customIcons,q=B===void 0?[]:B,j=t.allowFraction,S=j!==void 0&&j,Ke=t.style,le=t.className,Ue=le===void 0?"react-simple-star-rating":le,ae=t.transition,He=ae!==void 0&&ae,ce=t.allowHover,de=ce===void 0||ce,ue=t.disableFillHover,pe=ue!==void 0&&ue,he=t.fillIcon,Ze=he===void 0?null:he,xe=t.fillColor,Xe=xe===void 0?"#ffbc0b":xe,me=t.fillColorArray,Ye=me===void 0?[]:me,Qe=t.fillStyle,fe=t.fillClassName,et=fe===void 0?"filled-icons":fe,ge=t.emptyIcon,tt=ge===void 0?null:ge,ye=t.emptyColor,ot=ye===void 0?"#cccccc":ye,nt=t.emptyStyle,ve=t.emptyClassName,st=ve===void 0?"empty-icons":ve,Ce=t.allowTitleTag,it=Ce===void 0||Ce,je=t.showTooltip,rt=je!==void 0&&je,ke=t.tooltipDefaultText,lt=ke===void 0?"Your Rate":ke,be=t.tooltipArray,J=be===void 0?[]:be,at=t.tooltipStyle,we=t.tooltipClassName,ct=we===void 0?"react-simple-star-rating-tooltip":we,Se=t.SVGclassName,Ie=Se===void 0?"star-svg":Se,Le=t.titleSeparator,dt=Le===void 0?"out of":Le,Me=t.SVGstyle,_e=t.SVGstorkeWidth,Ne=_e===void 0?0:_e,Ve=t.SVGstrokeColor,Re=Ve===void 0?"currentColor":Ve,Ee=r.useReducer(h,{hoverIndex:0,valueIndex:0,ratingValue:u,hoverValue:null}),$=Ee[0],I=$.ratingValue,y=$.hoverValue,ee=$.hoverIndex,Te=$.valueIndex,K=Ee[1];r.useEffect(function(){u&&K({type:"MouseClick",payload:0})},[u]);var R=r.useMemo(function(){return S?2*b:b},[S,b]),G=r.useMemo(function(){return u>R?0:S||Math.floor(u)===u?Math.round(u/b*100):2*Math.ceil(u)*10},[S,u,b,R]),ze=r.useMemo(function(){return(S?2*u-1:u-1)||0},[S,u]),D=r.useCallback(function(d){return b%2!=0?d/2/10:d*b/100},[b]),Ge=function(d){for(var E=d.clientX,M=d.currentTarget.children[0].getBoundingClientRect(),pt=M.left,ht=M.right,xt=M.width,Fe=z?ht-E:E-pt,U=R,Be=Math.round(xt/R),P=0;P<=R;P+=1)if(Fe<=Be*P){U=P===0&&Fe<Be?0:P;break}var Pe=U-1;U>0&&(K({type:"PointerMove",payload:100*U/R,index:Pe}),a&&y&&a(D(y),Pe,d))},De=function(d){y&&(K({type:"MouseClick",payload:y}),l&&l(D(y),ee,d))},ut=r.useMemo(function(){if(de){if(pe){var d=I&&I||G;return y&&y>d?y:d}return y&&y||I&&I||G}return I&&I||G},[de,pe,y,I,G]);r.useEffect(function(){J.length>R&&console.error("tooltipArray Array length is bigger then Icons Count length.")},[J.length,R]);var We=r.useCallback(function(d){return y&&d[ee]||I&&d[Te]||u&&d[ze]},[y,ee,I,Te,u,ze]),Ae=r.useMemo(function(){return y&&D(y)||I&&D(I)||u&&D(G)},[y,D,I,u,G]);return s.jsxs("span",n({className:x,style:{direction:"".concat(z?"rtl":"ltr")}},{children:[s.jsxs("span",n({className:"".concat(N," ").concat(Ue),style:n({cursor:V?"":"pointer"},Ke),onPointerMove:V?void 0:Ge,onPointerEnter:V?void 0:function(d){m&&m(d),L()&&Ge(d)},onPointerLeave:V?void 0:function(d){L()&&De(),K({type:"PointerLeave"}),C&&C(d)},onClick:V?void 0:De,"aria-hidden":"true"},{children:[s.jsx("span",n({className:"".concat(_," ").concat(st),style:n({color:ot},nt)},{children:v([],Array(b)).map(function(d,E){var M;return s.jsx(r.Fragment,{children:((M=q[E])===null||M===void 0?void 0:M.icon)||tt||s.jsx(p,{SVGclassName:Ie,SVGstyle:Me,SVGstorkeWidth:Ne,SVGstrokeColor:Re,size:A})},E)})})),s.jsx("span",n({className:"".concat(f," ").concat(et),style:n((o={},o[z?"right":"left"]=0,o.color=We(Ye)||Xe,o.transition=He?"width .2s ease, color .2s ease":"",o.width="".concat(ut,"%"),o),Qe),title:it?"".concat(Ae," ").concat(dt," ").concat(b):void 0},{children:v([],Array(b)).map(function(d,E){var M;return s.jsx(r.Fragment,{children:((M=q[E])===null||M===void 0?void 0:M.icon)||Ze||s.jsx(p,{SVGclassName:Ie,SVGstyle:Me,SVGstorkeWidth:Ne,SVGstrokeColor:Re,size:A})},E)})}))]})),rt&&s.jsx("span",n({className:"".concat(g," ").concat(ct),style:n((i={},i[z?"marginRight":"marginLeft"]=20,i),at)},{children:(J.length>0?We(J):Ae)||lt}))]}))},Y}var Gt=zt();function Dt({ratings:s,dimension:r,onChange:n,size:v=24,emptyColor:p="#ccc",readonly:h=!1,fillColor:x,style:N,allowFraction:f=!0}){const _=c.useCallback(g=>{n({rating:g,dimension:r})},[r,n]);return e.jsx("div",{style:{display:"flex",placeItems:"center",marginTop:4,...N},children:e.jsx(Gt.Rating,{onClick:_,size:v,initialValue:s&&s[r],ratingValue:s&&s[r],emptyColor:p,readonly:h,fillColor:x,allowFraction:f})})}function $e({ratingDimensions:s,ratings:r,onRatingChange:n=()=>{},size:v,allowFraction:p=!1,readonly:h=!1,fontSize:x="1.0rem",paddingData:N=5,backgroundColor:f,fillColor:_,emptyColor:g="#777",fontWeight:L=500}){const t=Object.keys(s).map(o=>({ratingArea:s[o]||o,rating:e.jsx(Dt,{ratings:r,onChange:n,dimension:o,readonly:h,size:v,fontSize:x,allowFraction:p,fillColor:_,emptyColor:g,style:{marginLeft:5,marginTop:4}})}));return e.jsx(re.Fragment,{children:e.jsx("div",{style:{display:"flex",justifyContent:"space-between"},children:t.map((o,i)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:`${N}px`,backgroundColor:i%2===0?f:"transparent",marginRight:i<t.length-1?15:0},children:[e.jsx("div",{style:{fontSize:x,fontWeight:L,color:"#ddd"},children:o.ratingArea}),e.jsx("div",{children:o.rating})]},i))})})}function to({entry:s}){const{isLoggedIn:r}=c.useContext(gt),{userLockNotes:n,updateProfileField:v}=c.useContext(yt),p=r?n[s.id]:{},h=typeof p=="string"?p||"":p&&p.notes||"",x=c.useCallback(async j=>{await v("userLockNotes",j),f(!1)},[v]),[N,f]=c.useState(!1),_=c.useCallback(()=>{f(!0)},[]),g=c.useCallback(()=>{f(!1),t(h)},[h]),[L,t]=c.useState(h),[o,i]=c.useState((p==null?void 0:p.ratings)||{}),[l,a]=c.useState(!1);c.useEffect(()=>{t(h||"")},[h]);const m=c.useCallback(j=>{t(St(j.target.value,{profanityOK:!0,urlsOK:!0}))},[]),C=c.useCallback(({dimension:j,rating:S})=>{i({...o,[j]:S}),a(!0)},[o]),k=c.useCallback(async()=>{const j={...n,[s.id]:{notes:L||""}};Object.keys(o).length>0&&(j[s.id].ratings=o),await x(j).catch(S=>{console.error("Error updating notes:",S)}),g(),a(!1)},[n,s.id,L,o,x,g]),u=c.useCallback(async()=>{const j={...n};delete j[s.id],await x(j).catch(S=>{console.error("Error removing notes:",S)}),g(),i({}),a(!1)},[s.id,g,x,n]),{isMobile:w,flexStyle:b}=vt(),T={fontSize:"1.0rem",fontWeight:400,marginBottom:5,paddingLeft:2,color:"#fff"},A=w?"0.85rem":"0.9rem",F=w?5:8,V=h.split(`
`).length,O=V>F?Math.min(V,12):F,z=w?5:10,B={Difficulty:"Difficulty",Fun:"Fun"},q=e.jsx("div",{style:{display:"flex"},children:r?e.jsxs("div",{style:{flexGrow:1,maxWidth:550,padding:10},children:[e.jsxs("div",{style:{marginTop:10,display:"flex"},children:[e.jsx("div",{style:{...T,flexGrow:1,fontWeight:700},children:"My Notes"}),e.jsxs("div",{style:{...T,color:"#aaa",fontSize:"0.85rem"},children:[L.length||0,"/1200"]})]}),e.jsx(It,{type:"text",name:"notes",multiline:!0,fullWidth:!0,rows:O,value:L,onChange:m,id:"notes",color:"info",style:{},placeholder:"Add your own private notes about this lock, visible only to you.",variant:"outlined",autoFocus:!0,inputProps:{maxLength:1200,style:{fontSize:A}}}),e.jsx("div",{style:{display:"flex",marginTop:5},children:e.jsx($e,{ratingDimensions:B,onRatingChange:C,ratings:o,emptyColor:"#555",fontSize:"0.85rem",size:20,paddingData:0})}),e.jsxs("div",{style:{flexGrow:1,textAlign:"right",marginTop:8},children:[e.jsx(W,{variant:"text",size:"small",onClick:g,children:"Cancel"}),e.jsx(W,{variant:"text",size:"small",onClick:k,color:"success",children:"Save"})]})]}):e.jsxs("div",{style:{flexGrow:1,padding:"40px 20px",placeItems:"center"},children:[e.jsxs("div",{style:{...T,marginBottom:15,fontWeight:700,textAlign:"center"},children:["Please sign in to add your",e.jsx("br",{}),"own private notes for locks."]}),e.jsx("div",{style:{width:210},children:e.jsx(Ct,{onClick:g})})]})});return e.jsxs(re.Fragment,{children:[Object.keys(p||{}).length>0?e.jsxs("div",{style:{fontWeight:700,marginTop:15},children:[e.jsxs("div",{style:{display:"flex"},children:[e.jsx("span",{style:{},children:"My private notes  "}),e.jsx(te,{style:{fontWeight:400,color:"#2bb259"},onClick:_,children:"edit"})," • ",e.jsx(te,{style:{fontWeight:400,color:"#2bb259"},onClick:u,children:"remove"})]}),e.jsxs("div",{style:{fontSize:A,marginLeft:z,fontWeight:400},children:[e.jsx(Lt,{remarkPlugins:[_t],rehypePlugins:[[Mt,{target:"_blank",rel:["nofollow","noopener","noreferrer"]}]],children:h}),!h&&e.jsx("div",{style:{height:8}}),e.jsxs("div",{style:{display:b,height:32,justifyContent:"flex-start",alignItems:"center"},children:[e.jsx($e,{ratingDimensions:B,onRatingChange:C,ratings:o,readonly:!1,fontSize:"0.85rem",size:19,paddingData:0}),l&&!w&&e.jsx(W,{variant:"text",size:"small",onClick:k,color:"success",children:"Save"}),e.jsx(Oe,{in:l&&w,style:{},children:e.jsxs("div",{style:{display:"flex",flexGrow:1,width:"100%",justifyContent:"center"},children:[e.jsx(W,{variant:"text",size:"small",onClick:g,style:{color:"#777"},children:"Cancel"}),e.jsx(W,{variant:"text",size:"small",onClick:k,color:"success",children:"Save"})]})})]}),e.jsx(Oe,{in:l&&w,style:{textAlign:"right"},children:e.jsx("div",{style:{height:22}})})]})]}):e.jsx("div",{style:{fontWeight:700,marginTop:15},children:e.jsx(te,{style:{fontWeight:600,color:"#2bb259",textDecoration:"none",cursor:"pointer"},onClick:_,children:"Add your own private notes"})}),e.jsx(Tt,{dialogContent:q,open:N,handleClose:g,width:w?350:550})]})}function oo({text:s,entries:r}){const[n,v]=c.useState(null),p=!!n,h=c.useCallback(t=>v(t.currentTarget),[]),x=c.useCallback(()=>v(null),[]),{visibleEntries:N}=c.useContext(Rt),f=r||N,_=c.useCallback(()=>{const t=JSON.stringify(f);x(),qe("lpubeltsData.json",t),Q("Current lock entries downloaded as lpubeltsData.json")},[x,f]),g=c.useCallback(()=>{const o=f.map(i=>({id:i.id,make:i.makeModels.map(l=>l.make).join(","),model:i.makeModels.map(l=>l.model).join(","),version:i.version,belt:i.belt,name:se(i),versionText:i.version?" ("+i.version+")":""})).map(i=>"* "+i.name+i.versionText).join(`
`);x(),navigator.clipboard.writeText(o).then(),Q("Current lock entries copied to clipboard.")},[x,f]),L=c.useCallback(()=>{const t=["id","name","version","belt","notes"],o=f.map(m=>({id:m.id,make:m.makeModels.map(C=>C.make).join(","),model:m.makeModels.map(C=>C.model).join(","),version:m.version,belt:m.belt,name:se(m),notes:m.personalNotes})),i=t.join(","),l=o.map(m=>t.map(C=>m[C]).map(C=>{const k=`${C??""}`.replace(/"/g,'""');return/(\s|,|")/.test(k)?`"${k}"`:k}).join(",")).join(`
`),a=`${i}
${l}`;x(),qe("lpubeltsData.csv",a),Q("Current lock entries downloaded as lpubeltsData.csv")},[x,f]);return e.jsxs(re.Fragment,{children:[s?e.jsx(ne,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(W,{variant:"outlined",size:"small",onClick:h,style:{color:"#ddd",borderColor:"#aaa"},startIcon:e.jsx(oe,{}),children:"Export"})}):e.jsx(ne,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(ie,{onClick:h,children:e.jsx(oe,{})})}),e.jsxs(jt,{anchorEl:n,open:p,onClose:x,children:[!s&&e.jsxs(H,{disabled:!0,children:[e.jsx(Z,{children:e.jsx(oe,{fontSize:"small"})}),e.jsx(X,{children:"Export"})]}),e.jsxs(H,{onClick:g,children:[e.jsx(Z,{children:e.jsx(Et,{fontSize:"small"})}),e.jsx(X,{children:"Copy to clipboard"})]}),e.jsxs(H,{onClick:L,children:[e.jsx(Z,{children:e.jsx(Vt,{fontSize:"small"})}),e.jsx(X,{children:"CSV"})]}),e.jsxs(H,{onClick:_,children:[e.jsx(Z,{children:e.jsx(Nt,{fontSize:"small"})}),e.jsx(X,{children:"JSON"})]})]})]})}export{eo as C,oo as E,to as a};
