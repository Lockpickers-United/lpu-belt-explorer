import{r as o,d as b,X as U,j as e,W as I,B as F,U as re,aj as ae,ak as T,at as V,a4 as H,D as O,R as W,b8 as de,P as ce,bO as ue,u as K,L as y,b as me,F as Q,Q as J,aA as fe,A as pe,N as Z,bb as xe,h as ee,e as he,T as ge}from"./index-Bt088N6G.js";import{f as te,g as je}from"./filterFields-BFZVdPaD.js";import{A as Ce}from"./AdminToolButtons-Bh0PCuuQ.js";import{R as z}from"./RaffleContext-DI1VGOg4.js";import{D as N}from"./DataContext-DZzk06YH.js";import{A as be}from"./AdvancedFilters-BojBpM14.js";import{N as ve}from"./NoEntriesCard-C4ZOAZEG.js";import{R as Ae}from"./RaffleSearchBar-DxmdbYIb.js";import{b as Ee}from"./sortFields-CZ4oDFSx.js";import{d as oe,F as X,C as Se}from"./download-C4Sy4acs.js";import{L as ke}from"./List-uh2JM-U5.js";import{C as De}from"./ContentCopy-Dm2KnBuD.js";import{E as Re}from"./ExpandMore-bOw1wC6D.js";import{C as Fe}from"./CopyLinkToRaflPotButton-BUVBHjvh.js";import{F as _}from"./FieldValue-D54PTNJH.js";import{B as Te}from"./BeltStripe-DX9Hu5pC.js";import{D as We}from"./Dialog-DPn7FctB.js";import{S as le}from"./ScopedDialog-EilayV_K.js";import{T as we}from"./TextField-Z4FH3MjE.js";import{B as Le}from"./Box-DVY-zDE8.js";import{A as ye,a as Ie,b as Ne}from"./AccordionSummary-Cgvxro6S.js";import{A as Me}from"./AccordionActions-oExPqwIj.js";import{u as Be}from"./usePageTitle-0OYGTF7p.js";import{R as Oe}from"./RaffleEntryForm-BlMZyZTA.js";import{R as se}from"./RaffleHeader-Bl9QhdHG.js";import{L as ze}from"./LoadingDisplay-CwlWeKPM.js";import{r as Pe}from"./index-C-8tXE5b.js";import{a as $e,s as ne}from"./setDeep-J6HEwWhX.js";import{s as q}from"./searchEntriesForText-BZGjSCxW.js";import{f as ie}from"./filterEntriesAdvanced-CzPd1IBS.js";import"./EmojiEvents-D8CUySSK.js";import"./useData-BADip_oy.js";import"./dataUrls-DVxTtpO-.js";import"./ViewFilterButtons-FAoax4ft.js";import"./Sort-LsO-hOTG.js";import"./Search-Ci21FcZr.js";import"./useFormControl-O2MAh_uR.js";import"./Select-BJF5oM-5.js";import"./FilterAlt-CSNPb73f.js";import"./entryName-FIs5LayD.js";import"./HighlightOff-tcTsxd5H.js";import"./LockListContext-DzRLCLcD.js";import"./ToggleButtonGroup-DbW-A9lq.js";import"./AddCircle-DA8awriw.js";import"./Cancel-B-32pMfM.js";import"./ChoiceButtonGroup-BEsHQ9Fs.js";import"./Collapse-0xwnij66.js";import"./SearchBox-DtkuCpMO.js";import"./Link-B54nXIIn.js";import"./Zoom-C1FcYVWL.js";import"./RaffleSubHead-D_qIH78I.js";import"./RaffleAutocompleteBox-Bxz1eYWh.js";import"./SignInDetect-CBhT68cs.js";import"./Cached-CDrLfm_I.js";import"./CircularProgress-BxoqlzJA.js";import"./index-B9ygI19o.js";import"./stringUtils-BsiQ3MZ5.js";function Ge({text:t}){const[m,f]=o.useState(null),c=!!m,l=o.useCallback(i=>f(i.currentTarget),[]),u=o.useCallback(()=>f(null),[]),j=b().format("YYYY-MM-DD"),{raffleAdminRole:C}=o.useContext(z),{visibleEntries:p=[]}=o.useContext(N),v=o.useCallback(()=>{const i=JSON.stringify(p);u(),oe(`raffleEntries${j}.json`,i),U("Current RAFL entries downloaded as raffleEntries.json")},[j,u,p]),D=o.useCallback(()=>{const S=p.map(d=>{const A=d.pots.filter(x=>d.potsWon.includes(x.itemId)).map(x=>x.itemTitle);return{id:d.id,username:d.username,platform:d.platform,createdAt:d.createdAt,potNames:d.potNames.join(", "),donations:d.donations.map(x=>x.charity.itemTitle).join(", "),totalDonation:d.totalDonation,wonPots:A.join(", ")}}).map(d=>{let A=`${d.username} (${d.platform}) - $${d.totalDonation}
  POTS: ${d.potNames}
  DONATIONS: ${d.donations}
`;return d.wonPots.length>0&&(A+=`  POTS WON: ${d.wonPots}
`),A}).join(`
`);u(),navigator.clipboard.writeText(S).then(()=>{U("Current RAFL entries copied to clipboard.")})},[u,p]),E=o.useCallback(()=>{const i=p.map(x=>{const g=x.pots.filter(h=>x.potsWon.includes(h.itemId)).map(h=>h.itemTitle);return{id:x.id,username:x.username,platform:x.platform,totalDonation:`$${x.totalDonation}`,createdAt:b(x.createdAt).format("MM-DD-YYYY"),potNames:x.potNames.join(", "),donations:x.donations.map(h=>h.charity.itemTitle).join(", "),wonPots:g.join(", ")}}),S=Object.keys(i[0]).join(","),d=i.map(x=>Object.keys(i[0]).map(g=>x[g]).map(g=>{const h=`${g??""}`.replace(/"/g,'""');return/(\s|,|")/.test(h)?`"${h}"`:h}).join(",")).join(`
`),A=`${S}
${d}`;u(),oe("raffleEntries.csv",A),U("Current RAFL entries downloaded as raffleEntries.csv")},[u,p]);return e.jsxs("div",{children:[t?e.jsx(I,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{variant:"outlined",size:"small",onClick:l,style:{color:"#ddd",borderColor:"#aaa"},startIcon:e.jsx(X,{}),children:"Export"})}):e.jsx(I,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(re,{onClick:l,children:e.jsx(X,{})})}),e.jsxs(ae,{anchorEl:m,open:c,onClose:u,children:[!t&&e.jsxs(T,{disabled:!0,children:[e.jsx(V,{children:e.jsx(X,{fontSize:"small"})}),e.jsx(H,{children:"Export"})]}),e.jsxs(T,{onClick:D,children:[e.jsx(V,{children:e.jsx(De,{fontSize:"small"})}),e.jsx(H,{children:"Copy to clipboard"})]}),e.jsxs(T,{onClick:E,children:[e.jsx(V,{children:e.jsx(ke,{fontSize:"small"})}),e.jsx(H,{children:"CSV"})]}),C&&e.jsxs(T,{onClick:v,children:[e.jsx(V,{children:e.jsx(Se,{fontSize:"small"})}),e.jsx(H,{children:"JSON"})]})]})]})}function Ye({entry:t}){const{updateRaffleEntry:m,deleteRaffleEntry:f}=o.useContext(O),{statusLabels:c}=o.useContext(N),[l,u]=W.useState(null),j=!!l,C=g=>{u(g.currentTarget)},p=()=>{u(null)},v=o.useCallback(g=>{if(!g||g===t.status)return;const h={...t,status:g};g==="approved"?h.approvedAt=b().toISOString():g==="rejected"&&(h.rejectedAt=b().toISOString()),m(h).then(()=>{}).catch(w=>{console.error("Error updating entry status:",w)}),p()},[t,m]),D=t.status==="pending",E=t.status==="approved",i=t.status==="issues",S=t.status==="rejected",[d,A]=W.useState(!1),x=()=>{A(!1)};return e.jsxs(W.Fragment,{children:[e.jsx(I,{title:"Change Entry Status",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{variant:"contained",size:"small",endIcon:e.jsx(de,{}),onClick:C,style:{backgroundColor:c[t.status].backgroundColor,marginRight:0},children:t.status})}),e.jsx(ae,{open:j,anchorEl:l,onClose:p,children:e.jsxs(ce,{direction:"column",style:{minWidth:100},children:[e.jsx(T,{style:{color:D?"#fff":c.pending.backgroundColor,fontWeight:D?700:400},onClick:()=>v("pending"),disabled:D,children:"Pending"}),e.jsx(T,{style:{color:E?"#fff":c.approved.backgroundColor,fontWeight:E?700:400},onClick:()=>v("approved"),disabled:E,children:"Approved"}),e.jsx(T,{style:{color:i?"#fff":c.issues.backgroundColor,fontWeight:i?700:400},onClick:()=>v("issues"),disabled:i,children:"Issues"}),e.jsx(T,{style:{color:S?"#fff":c.rejected.backgroundColor,fontWeight:S?700:400},onClick:()=>v("rejected"),disabled:S,children:"Rejected"})]})}),e.jsxs(We,{open:d,onClose:x,children:[e.jsxs("div",{style:{padding:20,textAlign:"center"},children:["You cannot undo delete.",e.jsx("br",{}),"Are you sure?"]}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(F,{style:{marginBottom:10,color:"#000"},variant:"contained",onClick:()=>f(t).then(()=>A(!1)),edge:"start",color:"error",children:"Delete"})})]})]})}function Ve({entry:t,containerRef:m}){const{deleteRaffleEntry:f}=o.useContext(O),[c,l]=o.useState(!1),u=o.useCallback(()=>{l(!1)},[]),j=e.jsxs("div",{style:{textAlign:"center",fontWeight:700,fontSize:"1.1rem",padding:40},children:["You cannot undo delete.",e.jsx("br",{}),"Are you sure?",e.jsx("br",{}),e.jsx("br",{}),e.jsx(F,{style:{marginBottom:10,color:"#111"},variant:"contained",onClick:()=>f(t).then(()=>l(!1)),edge:"start",color:"error",children:"Delete"})]}),{isMobile:C}=ue();return e.jsxs(W.Fragment,{children:[e.jsx(I,{title:"Change Entry Status",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{variant:"text",size:"small",onClick:()=>l(!0),style:{color:"#e50808",margin:"0px 0px 0px 15px"},children:"Delete Entry"})}),e.jsx(le,{open:c,dialogContent:j,handleClose:u,containerRef:m,position:{top:80},centerX:!0,width:C?350:550})]})}function He({entry:t,containerRef:m}){var x;const{updateRaffleEntry:f}=o.useContext(O),[c,l]=o.useState(!1),u=o.useCallback(()=>{l(!0)},[]),j=o.useCallback(()=>{l(!1),p(t.notes||"")},[t.notes]),[C,p]=o.useState(t.notes||"");o.useEffect(()=>{p(t.notes||"")},[t.notes]);const v=g=>{p(g.target.value)},D=o.useCallback(()=>{const g={...t,notes:C||""};f(g,!1).then(()=>{console.log("Notes updated successfully")}).catch(h=>{console.error("Error updating notes:",h)}),j()},[t,j,C,f]),E=o.useCallback(()=>{const g={...t,notes:""};f(g,!1).then(()=>{}).catch(h=>{console.error("Error removing notes:",h)}),j()},[t,j,f]),{isMobile:i}=K(),S={fontSize:"1.0rem",fontWeight:400,marginBottom:5,paddingLeft:2,color:"#fff"},d=i?"0.95rem":"1.0rem",A=e.jsx("div",{style:{display:"flex"},children:e.jsxs("div",{style:{flexGrow:1,maxWidth:550,padding:10},children:[e.jsxs("div",{style:{marginTop:10,display:"flex"},children:[e.jsx("div",{style:{...S,flexGrow:1,fontWeight:700},children:"Entry Notes"}),e.jsxs("div",{style:{...S,color:"#aaa",fontSize:"0.85rem"},children:[C.length||0,"/1200"]})]}),e.jsx(we,{type:"text",name:"notes",multiline:!0,fullWidth:!0,rows:3,value:C,onChange:v,id:"notes",color:"info",style:{},placeholder:"Add additional notes about this entry",variant:"outlined",autoFocus:!0,InputProps:{style:{fontSize:d}},slotProps:{htmlInput:{maxLength:1200}}}),e.jsxs("div",{style:{flexGrow:1,textAlign:"right",marginTop:8},children:[e.jsx(F,{variant:"text",size:"small",onClick:j,children:"Cancel"}),e.jsx(F,{variant:"text",size:"small",onClick:D,color:"success",children:"Save"})]})]})});return e.jsxs(Le,{sx:{position:"relative",overflow:"hidden",isolation:"isolate"},children:[((x=t.notes)==null?void 0:x.length)>0?e.jsxs("div",{style:{fontWeight:700,marginTop:15},children:[e.jsxs("div",{style:{display:"flex"},children:[e.jsx("span",{style:{marginTop:-.6},children:"Notes  "}),e.jsx(y,{style:{fontWeight:400,color:"#2bb259"},onClick:u,children:"edit"})," • ",e.jsx(y,{style:{fontWeight:400,color:"#2bb259"},onClick:E,children:"remove"})]}),e.jsx("div",{style:{fontSize:d,marginLeft:10,fontWeight:400,fontStyle:"italic"},children:t.notes})]}):e.jsx("div",{style:{fontWeight:700,marginTop:15},children:e.jsx(y,{style:{fontWeight:600,color:"#2bb259"},onClick:u,children:"Add notes"})}),e.jsx(le,{open:c,dialogContent:A,handleClose:j,containerRef:m,position:{top:80},centerX:!0,width:i?350:550})]})}function Ke({entry:t,expanded:m,onExpand:f,setEditEntryId:c}){var B,Y;const{raffleAdminRole:l}=o.useContext(z),{expandAll:u,statusLabels:j}=o.useContext(N),{updateRaffleEntry:C}=o.useContext(O),p=me(),{filters:v}=o.useContext(Q),{sort:D}=v||{},[E,i]=o.useState(!1),S={maxWidth:700,marginLeft:"auto",marginRight:"auto"},d=o.useRef(null);o.useEffect(()=>{if(m&&d&&!E&&!u){const r=window.innerWidth<=600?70:74;i(!0),setTimeout(()=>{window.scrollTo({left:0,top:d.current.offsetTop-r,behavior:m?"auto":"smooth"})},m?0:100)}else m||i(!1)},[m,t,E,u]);const A=o.useCallback((s,r)=>{f&&f(r?t==null?void 0:t.id:!1)},[t==null?void 0:t.id,f]),x=b(t==null?void 0:t.updatedAt).valueOf()-b(t==null?void 0:t.createdAt).valueOf()>6e4,g=o.useCallback(s=>{const r=window.open(s,"_blank","noopener,noreferrer");r&&(r.opener=null)},[]),h=o.useCallback(s=>{p(s)},[p]),w=o.useCallback(s=>{if(!l)return;const r=t.donations.map((a,R)=>R===s?{...a,approved:!a.approved}:a),n={...t,donations:r};C(n).then(()=>{console.log("Donation approval toggled")}).catch(a=>{console.error("Error updating donation approval:",a)})},[t,l,C]),{isMobile:k,flexStyle:P}=K(),$=k?"12px 0px 8px 0px":"12px 0px 8px 8px",M=k?"0.95rem":"1.0rem",L=k?2:10,G={no:{backgroundColor:"#333",color:"#aaa"},yes:{backgroundColor:"#aaa",color:"#fff"}};return e.jsxs(ye,{expanded:m,onChange:A,style:S,ref:d,children:[e.jsxs(Ie,{expandIcon:e.jsx(Re,{}),sx:{".MuiAccordionSummary-content":{margin:"6px 0px"}},children:[e.jsx(Te,{value:j[t.status].entryColor}),e.jsxs("div",{style:{display:P,alignItems:"center",flexGrow:1},children:[e.jsxs("div",{style:{margin:$,display:"flex",flexGrow:1,fontWeight:600,color:((B=t.potsWon)==null?void 0:B.length)>0?"#2bb259":"#fff"},children:[t==null?void 0:t.username," ",e.jsxs("span",{style:{fontWeight:400,color:"#777",marginLeft:8},children:["(",t.platform.toLowerCase(),")"]}),((Y=t.potsWon)==null?void 0:Y.length)>0&&e.jsx("span",{style:{fontWeight:600,color:"#2bb259",marginLeft:12},children:"Winner"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[e.jsx(_,{name:"Submitted",value:e.jsx(J,{style:{fontSize:"0.95rem",lineHeight:1.25},children:b(t==null?void 0:t.createdAt).format("MMM DD")}),style:{marginRight:20}}),D==="updatedAt"&&e.jsx(_,{name:"Updated",value:e.jsx(J,{style:{fontSize:"0.95rem",lineHeight:1.25},children:b(t==null?void 0:t.updatedAt).format("MMM DD")}),textStyle:x?{}:{color:"#777"},style:{marginRight:30}}),e.jsx(_,{name:"Donations",value:e.jsxs(J,{style:{fontSize:"0.95rem",lineHeight:1.25},children:["$ ",Intl.NumberFormat().format(t.totalDonation)]}),textStyle:t.totalDonation!==t.allocatedTickets?{color:"#f33"}:{},style:{marginRight:20}})]})]})]}),m&&e.jsxs(W.Fragment,{children:[e.jsxs(Ne,{sx:{padding:"0px 16px 0px 16px",margin:"0px 10px"},children:[e.jsxs("div",{style:{textAlign:"right",margin:"0px 0px 10px 0px",fontWeight:700},children:["Entry Status  ",e.jsx(Ye,{entry:t})]}),e.jsx("div",{style:{fontWeight:500,fontSize:"0.8rem"},children:"DONATIONS"}),t.donations.map((s,r)=>{var n,a;return e.jsxs("div",{style:{display:"flex",flexGrow:1,alignItems:"center",fontSize:M,marginLeft:L,marginBottom:4},children:[e.jsx("div",{style:{fontWeight:500,flexGrow:1},children:((n=s.charity)==null?void 0:n.itemFullTitle)||((a=s.charity)==null?void 0:a.itemTitle)||"No Charity Selected"}),k?e.jsx(I,{title:"My Collection",arrow:!0,disableFocusListener:!0,children:e.jsx(re,{variant:"outlined",color:"inherit",onClick:()=>g(s.receipt),style:{marginRight:10},children:e.jsx(fe,{fontSize:"small"})})}):e.jsxs("div",{style:{display:"flex"},children:[s.receipt&&e.jsxs("span",{children:["Receipt: ",e.jsx(y,{style:{color:"#ccc",textDecoration:"underline",cursor:"pointer"},onClick:()=>g(s.receipt),children:(s.receipt.match(/^(?:https?:\/\/)?([^/?#]+)/i)||[])[1]}),"  "]}),s.amount>0&&e.jsxs("span",{style:{marginRight:6},children:["Donation: $ ",Intl.NumberFormat().format(s.amount)]})]}),e.jsx(F,{style:{minWidth:20,padding:"0px 5px",...G[s.approved?"yes":"no"]},onClick:()=>w(r),variant:"contained",children:"OK"})]},r)}),e.jsx("div",{style:{fontWeight:500,fontSize:"0.8rem",marginTop:10},children:"POTS"}),t.pots.map((s,r)=>e.jsxs("div",{style:{display:"flex",flexGrow:1,fontSize:M,marginLeft:10},children:[e.jsxs("div",{style:{fontWeight:500,marginBottom:4,flexGrow:1},children:[e.jsx(y,{style:{color:"#fff",textDecoration:"none",cursor:"pointer"},onClick:()=>h(`/rafl/?id=${s.itemId}`),children:(s==null?void 0:s.itemFullTitle)||(s==null?void 0:s.itemTitle)||"No Pot Selected"}),s.winner&&e.jsx(y,{style:{color:"#2bb259",fontWeight:700,marginLeft:12},onClick:()=>h(`/rafl/?id=${s.itemId}`),children:"Winner"})]}),e.jsx("div",{style:{marginBottom:4},children:(s==null?void 0:s.tickets)>0&&e.jsxs("span",{style:{marginRight:12},children:["Tickets: ",Intl.NumberFormat().format(s.tickets)]})})]},r)),e.jsx(He,{entry:t,containerRef:d}),e.jsxs("div",{style:{fontSize:"0.9rem",fontWeight:400,marginTop:10,textAlign:"right"},children:["Last updated: ",b(t==null?void 0:t.updatedAt).format("MMM DD")]}),e.jsx("div",{style:{textAlign:"center",margin:"15px 0px 5px 0px"},children:e.jsx(I,{title:"Edit Entry",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{variant:"contained",size:"small",onClick:()=>{c(t.id)},style:{backgroundColor:"#2bb259",color:"#000",padding:"6px 14px"},children:"EDIT ENTRY"})})})]}),e.jsxs(Me,{disableSpacing:!0,children:[e.jsx("div",{style:{display:"flex",flexGrow:1},children:e.jsx(Ve,{entry:t,containerRef:d})}),e.jsx(Fe,{entry:t})]})]})]})}const Ue=W.memo(Ke,(t,m)=>{const f=Object.keys(t.entry),c=Object.keys(m.entry);if(f.length!==c.length)return!1;for(let l=0;l<f.length;l++)if(f[l]!==c[l]||t.entry[f[l]]!==m.entry[c[l]])return!1;return t.expanded===m.expanded&&t.onExpand===m.onExpand});function Je({editEntryId:t,setEditEntryId:m}){const{filters:f}=o.useContext(Q),[c,l]=o.useState(f.id),{visibleEntries:u,expandAll:j}=o.useContext(N),{summary:C}=o.useContext(z);Be("RAFL Admin - Submitted Entries");const p=o.useDeferredValue(c),v=o.useCallback(i=>{l(i)},[]),{isMobile:D}=K(),E=D?{maxWidth:700,marginLeft:"auto",marginRight:"auto",padding:8}:{maxWidth:700,marginLeft:"auto",marginRight:"auto",padding:"12px 12px 12px 12px"};return e.jsxs("div",{style:{paddingBottom:32},children:[e.jsx("div",{style:{...E,paddingBottom:0,backgroundColor:"#333"},children:e.jsx("div",{style:{padding:"4px 4px 4px 4px"},children:e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:500,marginTop:1,marginBottom:0},children:"Submitted RAFL Entries"})})}),e.jsx(Ae,{label:"Raffle Entries",sortValues:Ee,entryCount:u.length}),e.jsx(be,{}),u.length===0&&e.jsx(ve,{label:"Rafl Entries"}),u.map(i=>e.jsx(Ue,{entry:i,onExpand:v,expanded:i.id===p||!!j,editId:t,setEditEntryId:m},i.id)),e.jsx("div",{style:{marginLeft:"auto",marginRight:"auto",textAlign:"center",justifyItems:"center",marginTop:30},children:e.jsx(Ge,{text:!0})})]})}function Xe({children:t}){const m=o.useContext(N),{entriesLoaded:f,allRaffleEntries:c,winnerData:l}=o.useContext(O),{allPots:u}=o.useContext(z),{filters:j,advancedFilterGroups:C}=o.useContext(Q),{search:p,id:v,tab:D,name:E,sort:i,image:S,preview:d,single:A,expandAll:x,...g}=j||{},h=o.useMemo(()=>Object.keys(l).reduce((s,r)=>(l[r].map(n=>{$e(s,[n.entryId],r)}),s),{}),[l]),w=.3,k=o.useMemo(()=>{let s={},r={};return c==null||c.forEach(n=>{n.donations.forEach(a=>{ne(s,[n.id],a.charity.itemFullTitle)},[]),n.pots.forEach(a=>{var R;ne(r,[n.id],a.itemTitle),(R=h[n.id])!=null&&R.includes(a.itemId)&&(a.winner=!0)},[])},{}),c.map(n=>{var a;return{...n,charities:s[n.id]||[],potNames:r[n.id]||[],content:[n.notes&&n.notes.length>0&&"Has Notes",n.donations.every(R=>R.approved)?"All Donations OK":"Donations not OK"].filter(Boolean),potsWon:h[n.id]||[],potWinner:((a=h[n.id])==null?void 0:a.length)>0?"Won Pots":"No Wins",fuzzy:Pe([n.username,...s[n.id],...r[n.id]].join(","))}})},[c,h]),P=o.useMemo(()=>k.reduce((s,r)=>(r.pots.forEach(n=>{s.push({username:r.username,entryId:r.id,platform:r.platform,potId:n.itemId,potTickets:n.tickets})}),s),[]),[k]),$=o.useMemo(()=>q(p,[...k],w),[k,p]),M=o.useMemo(()=>{if(!f)return[];const s=ie({advancedFilterGroups:C(),entries:k}),r=q(p,[...s],w);return i?r.sort((n,a)=>{var R;return i==="updatedAt"?b(n.updatedAt).isBefore(b(a.updatedAt))?1:-1:i==="status"?te(n.status,a.status):i==="username"?(R=n.username)==null?void 0:R.localeCompare(a.username):i==="totalDonation"?a.totalDonation-n.totalDonation:b(n.createdAt).isBefore(b(a.createdAt))?1:-1}):r.sort((n,a)=>b(n.createdAt).isBefore(b(a.createdAt))?1:-1)},[C,f,k,p,i]),L=o.useMemo(()=>u.map(s=>{const r=P.filter(n=>n.potId===s.id);return r.length>0&&(s.entrants=r),s},[]),[u,P]),G=o.useMemo(()=>{const s=ie({advancedFilterGroups:C(),entries:k}),r=q(p,[...s],w);return i?r.sort((n,a)=>{var R;return i==="updatedAt"?b(n.updatedAt).isBefore(b(a.updatedAt))?1:-1:i==="status"?te(n.status,a.status):i==="username"?(R=n.username)==null?void 0:R.localeCompare(a.username):i==="totalDonation"?a.totalDonation-n.totalDonation:b(n.createdAt).isBefore(b(a.createdAt))?1:-1}):r.sort((n,a)=>n.potNumber-a.potNumber)},[C,k,p,i]),B=o.useCallback(s=>L.find(r=>r.id===s),[L]),Y=o.useMemo(()=>({...m,allEntries:c,searchedEntries:$,visibleEntries:M,mappedPotEntries:L,visiblePotEntries:G,getPotFromId:B,expandAll:x,statusLabels:_e}),[m,c,$,M,L,G,B,x]);return e.jsx(N.Provider,{value:Y,children:t})}const _e={pending:{entryColor:"Blue",backgroundColor:"#3e71bd",textColor:"#fff"},approved:{entryColor:"Green",backgroundColor:"#34732f",textColor:"#fff"},issues:{entryColor:"Orange",backgroundColor:"#e16936",textColor:"#fff"},rejected:{entryColor:"Red",backgroundColor:"#c52323",textColor:"#fff"}};function eo(){const{raffleAdmin:t,setRaffleAdminRole:m}=o.useContext(z),{authLoaded:f,isLoggedIn:c}=o.useContext(pe);o.useEffect(()=>{t&&m(!0)});const{isMobile:l}=K(),[u,j]=o.useState(null),C=e.jsxs(W.Fragment,{children:[!l&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}}),e.jsx(Ce,{})]});if(!f)return e.jsx(ze,{message:"Loading..."});if(f&&!t)return e.jsxs(W.Fragment,{children:[e.jsx(Z,{title:"RAFL Admin",extras:C}),e.jsx(se,{page:"RAFL Admin"}),e.jsxs("div",{style:{padding:20},children:[!c&&e.jsx("div",{children:"Please log in to access this page."}),c&&!t&&e.jsx("div",{children:"Sorry, you do not have access to this page."}),e.jsx("div",{children:e.jsx(xe,{})})]}),e.jsx(ee,{})]});const p=l?8:0,v={maxWidth:700,marginLeft:"auto",marginRight:"auto",paddingLeft:p,paddingRight:p};return e.jsx(he,{filterFields:je,children:e.jsx(Xe,{children:e.jsxs("div",{style:v,children:[e.jsx(Z,{title:"RAFL Admin",extras:C}),e.jsx(se,{page:"entries"}),t&&!u&&e.jsx(Je,{editEntryId:u,setEditEntryId:j}),t&&!!u&&e.jsx(Oe,{editEntryId:u,setEditEntryId:j}),e.jsx(ee,{}),e.jsx(ge,{feature:"raflAdmin"})]})})})}export{eo as default};
