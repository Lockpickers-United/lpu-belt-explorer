import{r as t,K as W,M as D,j as e,u as E,G as I,I as F,B as $,aa as z,a2 as A,V as H,R as q,a8 as L}from"./index-d38eaa7b.js";import{F as B,D as G}from"./filterFields-6822315b.js";import"./index-4cc5b5c3.js";import{F as K,I as J,S as Q}from"./Select-2a086c83.js";import{B as U}from"./Box-225c35bc.js";import{C as X,I as M}from"./Chip-eb8ee2b3.js";import{d as R}from"./Search-6d15d447.js";import{B as Y}from"./Badge-7d672b3c.js";import{T as Z}from"./TextField-650b6717.js";function N(a,o){const[u,i]=t.useState(a);return t.useEffect(()=>{const p=setTimeout(()=>i(a),o||500);return()=>{clearTimeout(p)}},[a,o]),u}const k={safelocksOwn:"Own",safelockCracked:"Cracked",safelockWishlist:"Wishlist",shippingSplit:"Shipping included",shippingNotSplit:"Winner may pay shipping"};var _={},ee=D;Object.defineProperty(_,"__esModule",{value:!0});var P=_.default=void 0,te=ee(W()),re=e;P=_.default=(0,te.default)((0,re.jsx)("path",{d:"M5 13h14v-2H5zm-2 4h14v-2H3zM7 7v2h14V7z"}),"ClearAll");function Ce({forceText:a}){const{isMobile:o}=E(),{filterCount:u,clearFilters:i}=t.useContext(B);return u===0?null:o&&!a?e.jsx(I,{title:"Clear Filters",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{onClick:i,children:e.jsx(P,{})})}):e.jsx($,{variant:"outlined",color:"inherit",onClick:i,style:{minWidth:120,marginRight:8},children:"ClearÂ Filters"})}function ge({label:a,fieldName:o,onFilter:u,sort:i,tab:p}){const{visibleEntries:m}=t.useContext(G),{filters:j}=t.useContext(B),c=t.useMemo(()=>p==="search"||!p?m:m.filter(s=>s.simpleBelt===p),[p,m]),[g,d]=t.useState(!1),h=t.useCallback(s=>{d(!1),setTimeout(()=>u(o,s.target.value,!0),0),setTimeout(()=>document.activeElement.blur())},[o,u]),y=t.useCallback(()=>{d(!1),setTimeout(()=>document.activeElement.blur())},[]),b=t.useCallback(()=>d(!0),[]),{counts:f,options:x}=t.useMemo(()=>{const s=c.map(n=>n[o]).flat().filter(n=>n),l=s.reduce((n,r)=>(n[r]||(n[r]=0),n[r]++,n),{}),T=[...new Set(s)].sort((n,r)=>{if(i)return i(n,r);if(typeof n=="string"&&typeof r=="string")return n.localeCompare(r);if(Number.isInteger(n)&&Number.isInteger(r))return n-r});return{counts:l,options:T}},[c,o,i]),v=t.useDeferredValue(j),C=v[o],S=Array.isArray(C)?v[o]:C?[C]:[];return e.jsxs(K,{style:{minWidth:120,maxWidth:300,marginTop:8},fullWidth:!0,children:[e.jsx(J,{id:`filter-${o}`,color:"secondary",children:a}),e.jsx(Q,{multiple:!0,label:a,labelId:`filter-${o}`,value:S,onChange:h,style:{marginBottom:0},color:"secondary",open:g,onClose:y,onOpen:b,onBlur:y,MenuProps:{PaperProps:{style:{maxHeight:se*8+ne}}},renderValue:s=>e.jsx(U,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:s.map(l=>e.jsx(X,{label:k[l]?k[l]:l},l))}),children:x.map((s,l)=>e.jsx(z,{value:s,children:k[s]?k[s]:s+` (${f[s]||0})`},l))})]})}const se=48,ne=8;var w={},oe=D;Object.defineProperty(w,"__esModule",{value:!0});var V=w.default=void 0,ie=oe(W()),ae=e;V=w.default=(0,ie.default)((0,ae.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");function ve({label:a,extraFilters:o=[],keepOpen:u}){const[i]=A(),{filters:p,addFilters:m,removeFilter:j}=t.useContext(B),[c,g]=t.useState(p.search||""),{isMobile:d}=E(),h=t.useRef();H("s",()=>{var r;return(r=h==null?void 0:h.current)==null?void 0:r.focus()},{preventDefault:!0});const y=t.useCallback(()=>{window.scrollTo({top:0}),g(""),j("search",""),h.current.focus()},[j]),b=t.useCallback(r=>{const{value:O}=r.target;g(O)},[]),f=N(c,250);t.useEffect(()=>{f!==i.get("search")&&(f?(window.scrollTo({top:0}),m([{key:"search",value:f},{key:"id",value:void 0},{key:"name",value:void 0},...o],!0)):m([{key:"search",value:f}],!0))},[f]);const[x,v]=t.useState(!1),C=t.useCallback(()=>setTimeout(()=>v(!1),0),[]),S=t.useCallback(()=>{v(!0),setTimeout(()=>{h.current.focus(),h.current.select()},0)},[]);t.useEffect(()=>{const r=i.get("search");r!==c&&g(r||"")},[i]);const s=c?e.jsx(M,{position:"end",children:e.jsx(I,{title:"Clear",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{color:"inherit",onClick:y,edge:"end",size:"small",children:e.jsx(V,{})})})}):null,l=d?{maxWidth:450,marginTop:8,marginRight:8}:{maxWidth:450,marginTop:6,marginRight:8},T=x&&d?{width:"auto",position:"fixed",left:50,right:0,paddingRight:16,maxWidth:"unset",zIndex:9999999,backgroundColor:"#272727"}:{},n=c?"secondary":"inherit";return e.jsxs(q.Fragment,{children:[!x&&d&&!u&&e.jsx(I,{title:"Search",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{color:"inherit",onClick:S,children:e.jsx(Y,{invisible:c.length===0,variant:"dot",color:"secondary",overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(R,{})})})}),(x||!d||u)&&e.jsx(Z,{placeholder:`Search ${a}`,InputProps:{inputProps:{ref:h},startAdornment:e.jsx(M,{position:"start",children:e.jsx(R,{color:n})}),endAdornment:s},variant:"standard",color:"secondary",onChange:b,onBlur:C,value:c,style:{...l,...T},fullWidth:!0}),e.jsx(L,{invisible:!0,open:x&&d,onClick:C})]})}export{Ce as C,ge as F,ve as S,k as f};
