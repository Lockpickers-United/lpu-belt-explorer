import{aK as q,aL as Z,u as $,r as n,au as ge,j as e,R as J,aa as fe,D as je,d as be,B as P,T as ke,bE as ve,e as ye,a0 as Ne,N as Ce}from"./index-1d9eaadd.js";import{I as Ie}from"./IntroCopy-ff975049.js";import{u as Se}from"./usePageTitle-a19c2b7f.js";import{d as Ae}from"./Search-f25d86b5.js";import{e as _}from"./entryName-49e48298.js";import{B as Le}from"./BeltStripeMini-41082c48.js";import{A as Oe}from"./Autocomplete-63c13b4d.js";import{T as B}from"./TextField-8638faad.js";import{I as Ue}from"./InputAdornment-1d3dfa79.js";import{B as Ee}from"./Box-916a547b.js";import{B as we}from"./BeltIcon-3bef1909.js";import{D as Re}from"./Dropzone-5fa63a91.js";import{L as Be}from"./LoadingDisplay-d175d799.js";import{D as De}from"./DataContext-031b7489.js";import"./index-fe229e78.js";import{p as Pe,c as Te}from"./postData-ad7eff5a.js";import{C as $e}from"./Checkbox-b5ef8c0b.js";import{C as ze}from"./Collapse-c844b088.js";import{I as Fe,a as We}from"./ImageListItem-c0fbb513.js";import{D as T}from"./Dialog-35222ba2.js";import{D as Me}from"./LockDataProvider-5575f280.js";import"./index-3ae695dc.js";import"./index-f50d5e0f.js";import"./index-aef7ca15.js";import"./Link-7e85cb1f.js";import"./useDocumentTitle-991639ee.js";import"./Select-96a2cbf3.js";import"./Chip-1734b2c0.js";import"./index-8d194c20.js";import"./Cancel-9dcd6516.js";import"./CircularProgress-26f45152.js";import"./axios-439bb627.js";import"./collectionStatsById-8def94ca.js";var Q={exports:{}};(function(r,p){(function(x,u){r.exports=u()})(q,()=>{return x={705:o=>{o.exports=function(a,i){const l=[];return i.length===0?l.push({text:a,highlight:!1}):i[0][0]>0&&l.push({text:a.slice(0,i[0][0]),highlight:!1}),i.forEach((d,g)=>{const k=d[0],j=d[1];l.push({text:a.slice(k,j),highlight:!0}),g===i.length-1?j<a.length&&l.push({text:a.slice(j,a.length),highlight:!1}):j<i[g+1][0]&&l.push({text:a.slice(j,i[g+1][0]),highlight:!1})}),l}}},u={},function o(a){var i=u[a];if(i!==void 0)return i.exports;var l=u[a]={exports:{}};return x[a](l,l.exports,o),l.exports}(705);var x,u})})(Q);var Ye=Q.exports;const He=Z(Ye);var V={exports:{}};(function(r,p){(function(x,u){r.exports=u()})(q,()=>{return x={772:(o,a,i)=>{const l=i(826).remove,d=/[.*+?^${}()|[\]\\]/g,g=/[a-z0-9_]/i,k=/\s+/;o.exports=function(j,O,L){var m,U;U={insideWords:!1,findAllOccurrences:!1,requireMatchAll:!1},m=(m=L)||{},Object.keys(m).forEach(s=>{U[s]=!!m[s]}),L=U;const C=Array.from(j).map(s=>l(s));let t=C.join("");return(O=l(O)).trim().split(k).filter(s=>s.length>0).reduce((s,v)=>{const h=v.length,b=!L.insideWords&&g.test(v[0])?"\\b":"",I=new RegExp(b+v.replace(d,"\\$&"),"i");let y,f;if(y=I.exec(t),L.requireMatchAll&&y===null)return t="",[];for(;y;){f=y.index;const E=h-C.slice(f,f+h).join("").length,w=f-C.slice(0,f).join("").length,N=[f+w,f+h+w+E];if(N[0]!==N[1]&&s.push(N),t=t.slice(0,f)+new Array(h+1).join(" ")+t.slice(f+h),!L.findAllOccurrences)break;y=I.exec(t)}return s},[]).sort((s,v)=>s[0]-v[0])}},826:o=>{var a={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",Ấ:"A",Ắ:"A",Ẳ:"A",Ẵ:"A",Ặ:"A",Æ:"AE",Ầ:"A",Ằ:"A",Ȃ:"A",Ç:"C",Ḉ:"C",È:"E",É:"E",Ê:"E",Ë:"E",Ế:"E",Ḗ:"E",Ề:"E",Ḕ:"E",Ḝ:"E",Ȇ:"E",Ì:"I",Í:"I",Î:"I",Ï:"I",Ḯ:"I",Ȋ:"I",Ð:"D",Ñ:"N",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",Ố:"O",Ṍ:"O",Ṓ:"O",Ȏ:"O",Ù:"U",Ú:"U",Û:"U",Ü:"U",Ý:"Y",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",ấ:"a",ắ:"a",ẳ:"a",ẵ:"a",ặ:"a",æ:"ae",ầ:"a",ằ:"a",ȃ:"a",ç:"c",ḉ:"c",è:"e",é:"e",ê:"e",ë:"e",ế:"e",ḗ:"e",ề:"e",ḕ:"e",ḝ:"e",ȇ:"e",ì:"i",í:"i",î:"i",ï:"i",ḯ:"i",ȋ:"i",ð:"d",ñ:"n",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",ố:"o",ṍ:"o",ṓ:"o",ȏ:"o",ù:"u",ú:"u",û:"u",ü:"u",ý:"y",ÿ:"y",Ā:"A",ā:"a",Ă:"A",ă:"a",Ą:"A",ą:"a",Ć:"C",ć:"c",Ĉ:"C",ĉ:"c",Ċ:"C",ċ:"c",Č:"C",č:"c",C̆:"C",c̆:"c",Ď:"D",ď:"d",Đ:"D",đ:"d",Ē:"E",ē:"e",Ĕ:"E",ĕ:"e",Ė:"E",ė:"e",Ę:"E",ę:"e",Ě:"E",ě:"e",Ĝ:"G",Ǵ:"G",ĝ:"g",ǵ:"g",Ğ:"G",ğ:"g",Ġ:"G",ġ:"g",Ģ:"G",ģ:"g",Ĥ:"H",ĥ:"h",Ħ:"H",ħ:"h",Ḫ:"H",ḫ:"h",Ĩ:"I",ĩ:"i",Ī:"I",ī:"i",Ĭ:"I",ĭ:"i",Į:"I",į:"i",İ:"I",ı:"i",Ĳ:"IJ",ĳ:"ij",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",Ḱ:"K",ḱ:"k",K̆:"K",k̆:"k",Ĺ:"L",ĺ:"l",Ļ:"L",ļ:"l",Ľ:"L",ľ:"l",Ŀ:"L",ŀ:"l",Ł:"l",ł:"l",Ḿ:"M",ḿ:"m",M̆:"M",m̆:"m",Ń:"N",ń:"n",Ņ:"N",ņ:"n",Ň:"N",ň:"n",ŉ:"n",N̆:"N",n̆:"n",Ō:"O",ō:"o",Ŏ:"O",ŏ:"o",Ő:"O",ő:"o",Œ:"OE",œ:"oe",P̆:"P",p̆:"p",Ŕ:"R",ŕ:"r",Ŗ:"R",ŗ:"r",Ř:"R",ř:"r",R̆:"R",r̆:"r",Ȓ:"R",ȓ:"r",Ś:"S",ś:"s",Ŝ:"S",ŝ:"s",Ş:"S",Ș:"S",ș:"s",ş:"s",Š:"S",š:"s",Ţ:"T",ţ:"t",ț:"t",Ț:"T",Ť:"T",ť:"t",Ŧ:"T",ŧ:"t",T̆:"T",t̆:"t",Ũ:"U",ũ:"u",Ū:"U",ū:"u",Ŭ:"U",ŭ:"u",Ů:"U",ů:"u",Ű:"U",ű:"u",Ų:"U",ų:"u",Ȗ:"U",ȗ:"u",V̆:"V",v̆:"v",Ŵ:"W",ŵ:"w",Ẃ:"W",ẃ:"w",X̆:"X",x̆:"x",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Y̆:"Y",y̆:"y",Ź:"Z",ź:"z",Ż:"Z",ż:"z",Ž:"Z",ž:"z",ſ:"s",ƒ:"f",Ơ:"O",ơ:"o",Ư:"U",ư:"u",Ǎ:"A",ǎ:"a",Ǐ:"I",ǐ:"i",Ǒ:"O",ǒ:"o",Ǔ:"U",ǔ:"u",Ǖ:"U",ǖ:"u",Ǘ:"U",ǘ:"u",Ǚ:"U",ǚ:"u",Ǜ:"U",ǜ:"u",Ứ:"U",ứ:"u",Ṹ:"U",ṹ:"u",Ǻ:"A",ǻ:"a",Ǽ:"AE",ǽ:"ae",Ǿ:"O",ǿ:"o",Þ:"TH",þ:"th",Ṕ:"P",ṕ:"p",Ṥ:"S",ṥ:"s",X́:"X",x́:"x",Ѓ:"Г",ѓ:"г",Ќ:"К",ќ:"к",A̋:"A",a̋:"a",E̋:"E",e̋:"e",I̋:"I",i̋:"i",Ǹ:"N",ǹ:"n",Ồ:"O",ồ:"o",Ṑ:"O",ṑ:"o",Ừ:"U",ừ:"u",Ẁ:"W",ẁ:"w",Ỳ:"Y",ỳ:"y",Ȁ:"A",ȁ:"a",Ȅ:"E",ȅ:"e",Ȉ:"I",ȉ:"i",Ȍ:"O",ȍ:"o",Ȑ:"R",ȑ:"r",Ȕ:"U",ȕ:"u",B̌:"B",b̌:"b",Č̣:"C",č̣:"c",Ê̌:"E",ê̌:"e",F̌:"F",f̌:"f",Ǧ:"G",ǧ:"g",Ȟ:"H",ȟ:"h",J̌:"J",ǰ:"j",Ǩ:"K",ǩ:"k",M̌:"M",m̌:"m",P̌:"P",p̌:"p",Q̌:"Q",q̌:"q",Ř̩:"R",ř̩:"r",Ṧ:"S",ṧ:"s",V̌:"V",v̌:"v",W̌:"W",w̌:"w",X̌:"X",x̌:"x",Y̌:"Y",y̌:"y",A̧:"A",a̧:"a",B̧:"B",b̧:"b",Ḑ:"D",ḑ:"d",Ȩ:"E",ȩ:"e",Ɛ̧:"E",ɛ̧:"e",Ḩ:"H",ḩ:"h",I̧:"I",i̧:"i",Ɨ̧:"I",ɨ̧:"i",M̧:"M",m̧:"m",O̧:"O",o̧:"o",Q̧:"Q",q̧:"q",U̧:"U",u̧:"u",X̧:"X",x̧:"x",Z̧:"Z",z̧:"z"},i=Object.keys(a).join("|"),l=new RegExp(i,"g"),d=new RegExp(i,""),g=function(k){return k.replace(l,function(j){return a[j]})};o.exports=g,o.exports.has=function(k){return!!k.match(d)},o.exports.remove=g}},u={},function o(a){var i=u[a];if(i!==void 0)return i.exports;var l=u[a]={exports:{}};return x[a](l,l.exports,o),l.exports}(772);var x,u})})(V);var Ge=V.exports;const Ke=Z(Ge);function Xe({handleChangeLock:r,allEntries:p,disabled:x,reset:u=!1}){const o={maxWidth:700},{isMobile:a}=$(),i=n.useRef(),l=n.useMemo(()=>{let t={},s={};return{allLocks:p==null?void 0:p.sort((h,b)=>{ge(h.belt,b.belt)||_(h,"short").localeCompare(_(b,"short"))}).reduce((h,b)=>{const I=b.version?" - "+b.version:"";return b.makeModels.map(y=>{const f=y.make?y.make:y.model,E=y.make?` ${y.model}`:"",w=`${f}${E}${I}`;h.push({id:b.id,lockName:w,make:f,model:E})}),h},[]).filter(h=>h),lockIds:t,lockNames:s}},[p]),{allLocks:d,lockIds:g,lockNames:k}=l,j=d.filter((t,s)=>d.findIndex(v=>v.lockName===t.lockName)!==s),O=d==null?void 0:d.map(t=>(t.lockName=j.find(s=>s.lockName===t.lockName)?t.lockName+` (${p.find(s=>s.id===t.id).belt})`:t.lockName,t)).map(t=>(g[t.lockName]=t.id,k[t.lockName]=`${t.make}${t.model}`,{label:t.lockName,belt:p.find(s=>s.id===t.id).belt})),L=n.useCallback((t,s)=>{s?O.includes(s.label)&&r({lockFullName:s.label,lockName:k[s.label],lockId:g[s.label]}):r({})},[g,k,O,r]),[m,U]=n.useState(!1),C=n.useCallback(()=>U(!1),[]);return e.jsxs(J.Fragment,{children:[e.jsx(Oe,{disabled:x,selectOnFocus:!0,clearOnEscape:!0,handleHomeEndKeys:!0,fullWidth:!0,style:o,options:O,onChange:L,renderInput:t=>e.jsx(B,{...t,placeholder:"Search Locks",variant:"standard",color:"info",inputRef:i,InputProps:{...t.InputProps,startAdornment:e.jsx(Ue,{position:"start",children:e.jsx(Ae,{})})}}),getOptionLabel:t=>t.label,renderOption:(t,s,{inputValue:v})=>{const{key:h,...b}=t,I=Ke(s.label,v,{insideWords:!0});return He(s.label,I),e.jsxs(Ee,{...b,style:{...t.style,height:34,padding:0,overflow:"elipsis",whiteSpace:"nowrap",color:s.belt==="Unranked"?"#aaa":"#fff",fontSize:"0.95rem"},children:[e.jsx(Le,{value:s.belt,style:{marginRight:10}}),s.label]},h)}},u||x),e.jsx(fe,{invisible:!0,open:m&&a,onClick:C})]})}function _e({profile:r,user:p}){var M,Y,H,G,K,X;const{allEntries:x}=n.useContext(De),{updateProfileField:u}=n.useContext(je),[o,a]=n.useState({}),[i,l]=n.useState(void 0),[d,g]=n.useState([]),[k,j]=n.useState(void 0),[O,L]=n.useState(!1),[m,U]=n.useState(void 0),[C,t]=n.useState(!1),[s,v]=n.useState(""),[h,b]=n.useState(""),[I,y]=n.useState((r==null?void 0:r.photoCredit)||(r==null?void 0:r.displayName)||""),[f,E]=n.useState(!1),w=be().format("YYYYMMDD-HHMMss"),N=x.find(c=>c.id===(o==null?void 0:o.lockId)),ee=!!(o!=null&&o.lockName)&&!!(o!=null&&o.lockId)&&!!I&&d.length>0,z=`${o.lockName}_${o.lockId}_`.replace("/","+"),F=`${I}`.replace("/","+"),te=d.map(c=>c.name),se=d.length===1?"File":"Files",oe=async c=>{c.preventDefault(),L(!0);const S=`${w}_${z}_${F}`,A=new FormData;d.forEach(R=>{const{base:D,ext:xe}=qe(R.name);A.append("files",R,`${S}/${z}_${D}_${F}.${xe}`)}),A.append("droppedFileNames",te),A.append("lockFullName",o.lockFullName),A.append("lockName",o.lockName),A.append("version",N==null?void 0:N.version),A.append("belt",N==null?void 0:N.belt),A.append("lockId",o.lockId),A.append("photoCredit",I),A.append("displayName",r==null?void 0:r.displayName),A.append("uploadsDir",S),A.append("notes",h);const pe="https://explore.lpubelts.com:8443/upload",ue=!1,he=15e3;try{j(await Pe({user:p,url:pe,formData:A,snackBars:ue,timeoutDuration:he})),ne(I)}catch(R){U(Te(R)),a([]),d.forEach(D=>URL.revokeObjectURL(D.preview)),g([])}finally{L(!1)}},ae=n.useCallback(c=>{a(c),l(x.find(S=>S.id===c.lockId))},[x]),ne=n.useCallback(c=>{u("photoCredit",c)},[u]),re=n.useCallback(c=>{const{value:S}=c.target;y(S)},[]),ie=n.useCallback(c=>{const{value:S}=c.target;b(S)},[]),W=n.useCallback(()=>{a({}),l(void 0),d.forEach(c=>URL.revokeObjectURL(c.preview)),g([]),j(void 0),L(!1),U(void 0),t(!1),v(""),b(""),E(!f)},[d,f]),le=n.useCallback(()=>{t(!C),a([])},[C]),ce=n.useCallback(c=>{const{value:S}=c.target;v(S),a({lockFullName:S,lockName:S,lockId:"NOTINLIST"})},[]),de=C?.5:1,{flexStyle:me}=$();return e.jsxs("div",{style:{maxWidth:800,padding:0,marginLeft:"auto",marginRight:"auto",marginTop:16,marginBottom:46,paddingLeft:8},children:[e.jsx("form",{action:null,encType:"multipart/form-data",method:"post",onSubmit:oe,children:e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:500,marginBottom:10},children:"Select Lock"}),e.jsx("div",{style:{opacity:de},children:e.jsx(Xe,{handleChangeLock:ae,allEntries:x,disabled:C,reset:f})}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx($e,{onChange:le,color:"info",size:"small",id:"notInList",checked:C})," Submit photos for a lock not on the site."]}),e.jsxs(ze,{in:C,style:{marginTop:10},children:[e.jsx("span",{style:{fontSize:"0.9rem"},children:"Lock Name"}),e.jsx("br",{}),e.jsx(B,{type:"text",id:"altLockName",name:"altLockName",value:s,style:{width:400},onChange:ce,color:"info"})]}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{style:{display:me},children:[e.jsxs("div",{style:{marginRight:50,width:350},children:[e.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:500,marginBottom:10},children:["Files to Upload",e.jsx("br",{})]}),e.jsx(Re,{files:d,setFiles:g}),i&&e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:500,marginBottom:10,marginTop:20},children:["Existing Images",e.jsx("br",{})]}),i.media?e.jsx("div",{children:e.jsx(Fe,{sx:{width:350},variant:"masonry",cols:2,gap:8,children:i.media.map(c=>e.jsx(We,{children:e.jsx("img",{srcSet:`${c.thumbnailUrl}?w=164&fit=crop&auto=format&dpr=2 2x`,src:`${c.thumbnailUrl}?w=164&fit=crop&auto=format`,alt:c.title,loading:"lazy"})},c.thumbnailUrl))})}):e.jsx("span",{children:"no images"})]})]}),e.jsxs("div",{style:{width:350},children:[e.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:500,marginBottom:10},children:["Details",e.jsx("br",{})]}),o.lockFullName&&e.jsxs("span",{children:[e.jsx("span",{style:{fontSize:"0.9rem"},children:"Lock Name"}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex"},children:[o.lockId!=="NOTINLIST"&&e.jsx(we,{value:N==null?void 0:N.belt,style:{marginBottom:-10}}),e.jsx("div",{style:{fontWeight:700,fontSize:"1.2rem",marginLeft:10},children:o.lockFullName})]}),e.jsx("br",{})]}),e.jsx("span",{style:{fontSize:"0.9rem"},children:"Credit to"}),e.jsx("br",{}),e.jsx(B,{type:"text",name:"photoCredit",value:I,style:{width:350},onChange:re,color:"info"}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("span",{style:{fontSize:"0.9rem"},children:"Notes"}),e.jsx("br",{}),e.jsx(B,{type:"text",name:"notes",multiline:!0,fullWidth:!0,rows:3,color:"info",maxLength:1e3,id:"notes",value:h,onChange:ie}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(P,{type:"submit",variant:"contained",color:"info",disabled:!ee||O,children:"Upload"})]})]}),e.jsx("br",{}),e.jsx("br",{})]})}),e.jsx(T,{open:O,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:.7}}},children:e.jsx("div",{style:{width:320,textAlign:"center",padding:30},children:e.jsx(Be,{})})}),e.jsx(T,{open:!!k&&!m,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:.7}}},children:e.jsx("div",{style:{display:"flex"},children:e.jsxs("div",{style:{backgroundColor:"#444",marginLeft:"auto",marginRight:"auto",padding:40},children:[e.jsxs("div",{style:{fontSize:"1.7rem",fontWeight:500,marginBottom:60,textAlign:"center"},children:[se," Uploaded Succesfully!"]}),e.jsx("div",{style:{width:"100%",textAlign:"center"},children:e.jsx(P,{onClick:W,variant:"contained",color:"info",style:{marginLeft:"auto",marginRight:"auto"},children:"Submit more photos"})})]})})}),e.jsx(T,{open:!!m,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:.7}}},children:e.jsx("div",{style:{display:"flex"},children:e.jsxs("div",{style:{backgroundColor:"#444",marginLeft:"auto",marginRight:"auto",padding:40},children:[e.jsxs("div",{style:{fontSize:"1.7rem",fontWeight:500,marginBottom:20,textAlign:"center"},children:["Something went wrong.",e.jsx("br",{}),"Please try again later.",e.jsx("br",{})]}),e.jsxs("div",{style:{fontSize:"0.85rem",fontWeight:400,marginBottom:20,textAlign:"center"},children:["Error message: ",((Y=(M=m==null?void 0:m.response)==null?void 0:M.data)==null?void 0:Y.message)||(m==null?void 0:m.message),((G=(H=m==null?void 0:m.response)==null?void 0:H.data)==null?void 0:G.status)&&e.jsxs("span",{children:[" (",(X=(K=m==null?void 0:m.response)==null?void 0:K.data)==null?void 0:X.status,")"]})]}),e.jsx("div",{style:{width:"100%",textAlign:"center"},children:e.jsx(P,{onClick:W,variant:"contained",color:"error",style:{marginLeft:"auto",marginRight:"auto"},children:"OK"})})]})})}),e.jsx(ke,{feature:"uploadPhotos"})]})}function qe(r){const p=r.lastIndexOf(".");return p===-1?{base:r,ext:""}:{base:r.substring(0,p),ext:r.substring(p)}}function Ot(){const{isMobile:r}=$(),{profile:p,user:x}=ve();Se("LPU Belt Explorer - Submit Photos");const u=e.jsx(J.Fragment,{children:!r&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}})});return e.jsx(ye,{children:e.jsxs(Me,{allEntries:Ne,profile:p,children:[e.jsx(Ce,{title:"Submit Photos",extras:u}),p&&!p.photoCredit&&e.jsx("div",{style:{marginTop:20,padding:"0px 0px"},children:e.jsx(Ie,{pageName:"photoUpload",maxWidth:820})}),e.jsx(_e,{profile:p,user:x})]})})}export{Ot as default};
