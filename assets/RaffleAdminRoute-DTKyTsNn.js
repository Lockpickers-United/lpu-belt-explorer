import{r as o,d as b,X as U,j as e,W,B as F,U as re,ak as ae,a8 as T,at as Y,a4 as V,D as B,R as w,b8 as ce,P as ue,bO as fe,u as H,L as I,b as me,F as Q,Q as J,az as pe,A as xe,N as Z,bb as he,h as ee,e as ge,T as je}from"./index-Bm6m2Om2.js";import{e as te,f as Ce}from"./filterFields-Bpc5BlRB.js";import{A as be}from"./AdminToolsButton-Cj7TY6V9.js";import{R as K}from"./RaffleContext-BLiEUHk7.js";import{D as N}from"./DataContext-CQjWI8HO.js";import{A as ve}from"./AdvancedFilters-CALYndI9.js";import{N as Ee}from"./NoEntriesCard-Bp056QRv.js";import{R as Ae}from"./RaffleSearchBar-lJxdDEYI.js";import{b as Se}from"./sortFields-1lK6XsoA.js";import{d as oe,F as X,C as ke}from"./download-BKflxP3t.js";import{L as De}from"./List-BNsqqsy0.js";import{C as Re}from"./ContentCopy-CUY0cfS4.js";import{E as Fe}from"./ExpandMore-Dfm3rz0D.js";import{C as Te}from"./CopyLinkToRaflPotButton-C06xRSNd.js";import{F as _}from"./FieldValue-CUKr3stW.js";import{B as we}from"./BeltStripe-DMzo4NYk.js";import{D as ye}from"./Dialog-BXQThPRj.js";import{S as le}from"./ScopedDialog-eSt7pCZf.js";import{T as Le}from"./TextField-7PMIoZcU.js";import{B as Ie}from"./Box-Dz36KBpD.js";import{A as We,a as Ne,b as Me}from"./AccordionSummary-DM71jMdJ.js";import{A as ze}from"./AccordionActions-o9P1dfF-.js";import{u as Be}from"./usePageTitle-CP6r2KF4.js";import{R as Oe}from"./RaffleEntryForm-f7VCHSJ4.js";import{R as se}from"./RaffleHeader-ZfSUH34p.js";import{L as Pe}from"./LoadingDisplay-BhZwzRr1.js";import{r as de}from"./index-Bwt0ZGG8.js";import{a as $e,s as ne}from"./setDeep-J6HEwWhX.js";import{i as Ge}from"./stringUtils-BsiQ3MZ5.js";import{e as Ye}from"./entryName-Bb_WhnLo.js";import{a as Ve,f as ie}from"./filterEntriesAdvanced-CXYqTsym.js";import"./EmojiEvents-D-1qtgbk.js";import"./useData-CA8i_qs9.js";import"./dataUrls-CThgH6Wi.js";import"./ViewFilterButtons-DHtJ1YB9.js";import"./Sort-D535nmSS.js";import"./Search-CFwTqlBy.js";import"./useFormControl-DGEMYn-k.js";import"./Select-CJtr4w59.js";import"./FilterAlt-C_cjJQG0.js";import"./HighlightOff-QRKpWjfl.js";import"./LockListContext-DLs9gjOn.js";import"./ToggleButtonGroup-B7MOWQcQ.js";import"./AddCircle-GUjeUdXi.js";import"./Cancel-DTcOOxzF.js";import"./ChoiceButtonGroup-CabInEuX.js";import"./Collapse-_qN3GE2w.js";import"./SearchBox-8naPDWVg.js";import"./Link-BW5MZTxl.js";import"./Zoom-RNuFVCYj.js";import"./RaffleSubHead-DfiuuDlI.js";import"./RaffleAutocompleteBox-BsrVnU6w.js";import"./SignInDetect-BHV_putD.js";import"./Cached-D5jZuqb4.js";import"./CircularProgress-Cd-H5Ut-.js";import"./index-xsH4HHeE.js";function He({text:t}){const[l,f]=o.useState(null),d=!!l,a=o.useCallback(m=>f(m.currentTarget),[]),i=o.useCallback(()=>f(null),[]),h=b().format("YYYY-MM-DD"),{raffleAdminRole:C}=o.useContext(K),{visibleEntries:p=[]}=o.useContext(N),E=o.useCallback(()=>{const m=JSON.stringify(p);i(),oe(`raffleEntries${h}.json`,m),U("Current RAFL entries downloaded as raffleEntries.json")},[h,i,p]),R=o.useCallback(()=>{const k=p.map(u=>{const A=u.pots.filter(x=>u.potsWon.includes(x.itemId)).map(x=>x.itemTitle);return{id:u.id,username:u.username,platform:u.platform,createdAt:u.createdAt,potNames:u.potNames.join(", "),donations:u.donations.map(x=>x.charity.itemTitle).join(", "),totalDonation:u.totalDonation,wonPots:A.join(", ")}}).map(u=>{let A=`${u.username} (${u.platform}) - $${u.totalDonation}
  POTS: ${u.potNames}
  DONATIONS: ${u.donations}
`;return u.wonPots.length>0&&(A+=`  POTS WON: ${u.wonPots}
`),A}).join(`
`);i(),navigator.clipboard.writeText(k).then(()=>{U("Current RAFL entries copied to clipboard.")})},[i,p]),v=o.useCallback(()=>{const m=p.map(x=>{const j=x.pots.filter(g=>x.potsWon.includes(g.itemId)).map(g=>g.itemTitle);return{id:x.id,username:x.username,platform:x.platform,totalDonation:`$${x.totalDonation}`,createdAt:b(x.createdAt).format("MM-DD-YYYY"),potNames:x.potNames.join(", "),donations:x.donations.map(g=>g.charity.itemTitle).join(", "),wonPots:j.join(", ")}}),k=Object.keys(m[0]).join(","),u=m.map(x=>Object.keys(m[0]).map(j=>x[j]).map(j=>{const g=`${j??""}`.replace(/"/g,'""');return/(\s|,|")/.test(g)?`"${g}"`:g}).join(",")).join(`
`),A=`${k}
${u}`;i(),oe("raffleEntries.csv",A),U("Current RAFL entries downloaded as raffleEntries.csv")},[i,p]);return e.jsxs("div",{children:[t?e.jsx(W,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{variant:"outlined",size:"small",onClick:a,style:{color:"#ddd",borderColor:"#aaa"},startIcon:e.jsx(X,{}),children:"Export"})}):e.jsx(W,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(re,{onClick:a,children:e.jsx(X,{})})}),e.jsxs(ae,{anchorEl:l,open:d,onClose:i,children:[!t&&e.jsxs(T,{disabled:!0,children:[e.jsx(Y,{children:e.jsx(X,{fontSize:"small"})}),e.jsx(V,{children:"Export"})]}),e.jsxs(T,{onClick:R,children:[e.jsx(Y,{children:e.jsx(Re,{fontSize:"small"})}),e.jsx(V,{children:"Copy to clipboard"})]}),e.jsxs(T,{onClick:v,children:[e.jsx(Y,{children:e.jsx(De,{fontSize:"small"})}),e.jsx(V,{children:"CSV"})]}),C&&e.jsxs(T,{onClick:E,children:[e.jsx(Y,{children:e.jsx(ke,{fontSize:"small"})}),e.jsx(V,{children:"JSON"})]})]})]})}function Ke({entry:t}){const{updateRaffleEntry:l,deleteRaffleEntry:f}=o.useContext(B),{statusLabels:d}=o.useContext(N),[a,i]=w.useState(null),h=!!a,C=j=>{i(j.currentTarget)},p=()=>{i(null)},E=o.useCallback(j=>{if(!j||j===t.status)return;const g={...t,status:j};j==="approved"?g.approvedAt=b().toISOString():j==="rejected"&&(g.rejectedAt=b().toISOString()),l(g).then(()=>{console.log("Entry status updated to",j)}).catch(y=>{console.error("Error updating entry status:",y)}),p()},[t,l]),R=t.status==="pending",v=t.status==="approved",m=t.status==="issues",k=t.status==="rejected",[u,A]=w.useState(!1),x=()=>{A(!1)};return e.jsxs(w.Fragment,{children:[e.jsx(W,{title:"Change Entry Status",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{variant:"contained",size:"small",endIcon:e.jsx(ce,{}),onClick:C,style:{backgroundColor:d[t.status].backgroundColor,marginRight:0},children:t.status})}),e.jsx(ae,{open:h,anchorEl:a,onClose:p,children:e.jsxs(ue,{direction:"column",style:{minWidth:100},children:[e.jsx(T,{style:{color:R?"#fff":d.pending.backgroundColor},onClick:()=>E("pending"),disabled:R,children:"Pending"}),e.jsx(T,{style:{color:v?"#fff":d.approved.backgroundColor},onClick:()=>E("approved"),disabled:v,children:"Approved"}),e.jsx(T,{style:{color:m?"#fff":d.issues.backgroundColor},onClick:()=>E("issues"),disabled:m,children:"Issues"}),e.jsx(T,{style:{color:k?"#fff":d.rejected.backgroundColor},onClick:()=>E("rejected"),disabled:k,children:"Rejected"})]})}),e.jsxs(ye,{open:u,onClose:x,children:[e.jsxs("div",{style:{padding:20,textAlign:"center"},children:["You cannot undo delete.",e.jsx("br",{}),"Are you sure?"]}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(F,{style:{marginBottom:10,color:"#000"},variant:"contained",onClick:()=>f(t).then(()=>A(!1)),edge:"start",color:"error",children:"Delete"})})]})]})}function Ue({entry:t,containerRef:l}){const{deleteRaffleEntry:f}=o.useContext(B),[d,a]=o.useState(!1),i=o.useCallback(()=>{a(!1)},[]),h=e.jsxs("div",{style:{textAlign:"center",fontWeight:700,fontSize:"1.1rem",padding:40},children:["You cannot undo delete.",e.jsx("br",{}),"Are you sure?",e.jsx("br",{}),e.jsx("br",{}),e.jsx(F,{style:{marginBottom:10,color:"#111"},variant:"contained",onClick:()=>f(t).then(()=>a(!1)),edge:"start",color:"error",children:"Delete"})]}),{isMobile:C}=fe();return e.jsxs(w.Fragment,{children:[e.jsx(W,{title:"Change Entry Status",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{variant:"text",size:"small",onClick:()=>a(!0),style:{color:"#e50808",margin:"0px 0px 0px 15px"},children:"Delete Entry"})}),e.jsx(le,{open:d,dialogContent:h,handleClose:i,containerRef:l,position:{top:80},centerX:!0,width:C?350:550})]})}function Je({entry:t,containerRef:l}){var x;const{updateRaffleEntry:f}=o.useContext(B),[d,a]=o.useState(!1),i=o.useCallback(()=>{a(!0)},[]),h=o.useCallback(()=>{a(!1),p(t.notes||"")},[t.notes]),[C,p]=o.useState(t.notes||"");o.useEffect(()=>{p(t.notes||"")},[t.notes]);const E=j=>{p(j.target.value)},R=o.useCallback(()=>{const j={...t,notes:C||""};f(j,!1).then(()=>{console.log("Notes updated successfully")}).catch(g=>{console.error("Error updating notes:",g)}),h()},[t,h,C,f]),v=o.useCallback(()=>{const j={...t,notes:""};f(j,!1).then(()=>{}).catch(g=>{console.error("Error removing notes:",g)}),h()},[t,h,f]),{isMobile:m}=H(),k={fontSize:"1.0rem",fontWeight:400,marginBottom:5,paddingLeft:2,color:"#fff"},u=m?"0.95rem":"1.0rem",A=e.jsx("div",{style:{display:"flex"},children:e.jsxs("div",{style:{flexGrow:1,maxWidth:550,padding:10},children:[e.jsxs("div",{style:{marginTop:10,display:"flex"},children:[e.jsx("div",{style:{...k,flexGrow:1,fontWeight:700},children:"Entry Notes"}),e.jsxs("div",{style:{...k,color:"#aaa",fontSize:"0.85rem"},children:[C.length||0,"/1200"]})]}),e.jsx(Le,{type:"text",name:"notes",multiline:!0,fullWidth:!0,rows:3,value:C,onChange:E,id:"notes",color:"info",style:{},placeholder:"Add additional notes about this entry",variant:"outlined",autoFocus:!0,InputProps:{style:{fontSize:u}},slotProps:{htmlInput:{maxLength:1200}}}),e.jsxs("div",{style:{flexGrow:1,textAlign:"right",marginTop:8},children:[e.jsx(F,{variant:"text",size:"small",onClick:h,children:"Cancel"}),e.jsx(F,{variant:"text",size:"small",onClick:R,color:"success",children:"Save"})]})]})});return e.jsxs(Ie,{sx:{position:"relative",overflow:"hidden",isolation:"isolate"},children:[((x=t.notes)==null?void 0:x.length)>0?e.jsxs("div",{style:{fontWeight:700,marginTop:15},children:[e.jsxs("div",{style:{display:"flex"},children:[e.jsx("span",{style:{marginTop:-.6},children:"Notes  "}),e.jsx(I,{style:{fontWeight:400,color:"#2bb259"},onClick:i,children:"edit"})," • ",e.jsx(I,{style:{fontWeight:400,color:"#2bb259"},onClick:v,children:"remove"})]}),e.jsx("div",{style:{fontSize:u,marginLeft:10,fontWeight:400,fontStyle:"italic"},children:t.notes})]}):e.jsx("div",{style:{fontWeight:700,marginTop:15},children:e.jsx(I,{style:{fontWeight:600,color:"#2bb259"},onClick:i,children:"Add notes"})}),e.jsx(le,{open:d,dialogContent:A,handleClose:h,containerRef:l,position:{top:80},centerX:!0,width:m?350:550})]})}function Xe({entry:t,expanded:l,onExpand:f,setEditEntryId:d}){var z,G;const{raffleAdminRole:a}=o.useContext(K),{expandAll:i,statusLabels:h}=o.useContext(N),{updateRaffleEntry:C}=o.useContext(B),p=me(),{filters:E}=o.useContext(Q),{sort:R}=E||{},[v,m]=o.useState(!1),k={maxWidth:700,marginLeft:"auto",marginRight:"auto"},u=o.useRef(null);o.useEffect(()=>{if(l&&u&&!v&&!i){console.log("entry",t);const r=window.innerWidth<=600?70:74;m(!0),setTimeout(()=>{window.scrollTo({left:0,top:u.current.offsetTop-r,behavior:l?"auto":"smooth"})},l?0:100)}else l||m(!1)},[l,t,v,i]);const A=o.useCallback((s,r)=>{f&&f(r?t==null?void 0:t.id:!1)},[t==null?void 0:t.id,f]),x=b(t==null?void 0:t.updatedAt).valueOf()-b(t==null?void 0:t.createdAt).valueOf()>6e4,j=o.useCallback(s=>{const r=window.open(s,"_blank","noopener,noreferrer");r&&(r.opener=null)},[]),g=o.useCallback(s=>{p(s)},[p]),y=o.useCallback(s=>{if(!a)return;const r=t.donations.map((c,D)=>D===s?{...c,approved:!c.approved}:c),n={...t,donations:r};C(n).then(()=>{console.log("Donation approval toggled")}).catch(c=>{console.error("Error updating donation approval:",c)})},[t,a,C]),{isMobile:S,flexStyle:O}=H(),P=S?"12px 0px 8px 0px":"12px 0px 8px 8px",M=S?"0.95rem":"1.0rem",L=S?2:10,$={no:{backgroundColor:"#333",color:"#aaa"},yes:{backgroundColor:"#aaa",color:"#fff"}};return e.jsxs(We,{expanded:l,onChange:A,style:k,ref:u,children:[e.jsxs(Ne,{expandIcon:e.jsx(Fe,{}),sx:{".MuiAccordionSummary-content":{margin:"6px 0px"}},children:[e.jsx(we,{value:h[t.status].entryColor}),e.jsxs("div",{style:{display:O,alignItems:"center",flexGrow:1},children:[e.jsxs("div",{style:{margin:P,display:"flex",flexGrow:1,fontWeight:600,color:((z=t.potsWon)==null?void 0:z.length)>0?"#2bb259":"#fff"},children:[t==null?void 0:t.username," ",e.jsxs("span",{style:{fontWeight:400,color:"#777",marginLeft:8},children:["(",t.platform.toLowerCase(),")"]}),((G=t.potsWon)==null?void 0:G.length)>0&&e.jsx("span",{style:{fontWeight:600,color:"#2bb259",marginLeft:12},children:"Winner"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[e.jsx(_,{name:"Submitted",value:e.jsx(J,{style:{fontSize:"0.95rem",lineHeight:1.25},children:b(t==null?void 0:t.createdAt).format("MMM DD")}),style:{marginRight:20}}),R==="updatedAt"&&e.jsx(_,{name:"Updated",value:e.jsx(J,{style:{fontSize:"0.95rem",lineHeight:1.25},children:b(t==null?void 0:t.updatedAt).format("MMM DD")}),textStyle:x?{}:{color:"#777"},style:{marginRight:30}}),e.jsx(_,{name:"Donations",value:e.jsxs(J,{style:{fontSize:"0.95rem",lineHeight:1.25},children:["$ ",Intl.NumberFormat().format(t.totalDonation)]}),textStyle:t.totalDonation!==t.allocatedTickets?{color:"#f33"}:{},style:{marginRight:20}})]})]})]}),l&&e.jsxs(w.Fragment,{children:[e.jsxs(Me,{sx:{padding:"0px 16px 0px 16px",margin:"0px 10px"},children:[e.jsxs("div",{style:{textAlign:"right",margin:"0px 0px 10px 0px",fontWeight:700},children:["Entry Status  ",e.jsx(Ke,{entry:t})]}),e.jsx("div",{style:{fontWeight:500,fontSize:"0.8rem"},children:"DONATIONS"}),t.donations.map((s,r)=>{var n,c;return e.jsxs("div",{style:{display:"flex",flexGrow:1,alignItems:"center",fontSize:M,marginLeft:L,marginBottom:4},children:[e.jsx("div",{style:{fontWeight:500,flexGrow:1},children:((n=s.charity)==null?void 0:n.itemFullTitle)||((c=s.charity)==null?void 0:c.itemTitle)||"No Charity Selected"}),S?e.jsx(W,{title:"My Collection",arrow:!0,disableFocusListener:!0,children:e.jsx(re,{variant:"outlined",color:"inherit",onClick:()=>j(s.receipt),style:{marginRight:10},children:e.jsx(pe,{fontSize:"small"})})}):e.jsxs("div",{style:{display:"flex"},children:[s.receipt&&e.jsxs("span",{children:["Receipt: ",e.jsx(I,{style:{color:"#ccc",textDecoration:"underline",cursor:"pointer"},onClick:()=>j(s.receipt),children:(s.receipt.match(/^(?:https?:\/\/)?([^/?#]+)/i)||[])[1]}),"  "]}),s.amount>0&&e.jsxs("span",{style:{marginRight:6},children:["Donation: $ ",Intl.NumberFormat().format(s.amount)]})]}),e.jsx(F,{style:{minWidth:20,padding:"0px 5px",...$[s.approved?"yes":"no"]},onClick:()=>y(r),variant:"contained",children:"OK"})]},r)}),e.jsx("div",{style:{fontWeight:500,fontSize:"0.8rem",marginTop:10},children:"POTS"}),t.pots.map((s,r)=>e.jsxs("div",{style:{display:"flex",flexGrow:1,fontSize:M,marginLeft:10},children:[e.jsxs("div",{style:{fontWeight:500,marginBottom:4,flexGrow:1},children:[e.jsx(I,{style:{color:"#fff",textDecoration:"none",cursor:"pointer"},onClick:()=>g(`/rafl/?id=${s.itemId}`),children:(s==null?void 0:s.itemFullTitle)||(s==null?void 0:s.itemTitle)||"No Pot Selected"}),s.winner&&e.jsx(I,{style:{color:"#2bb259",fontWeight:700,marginLeft:12},onClick:()=>g(`/rafl/?id=${s.itemId}`),children:"Winner"})]}),e.jsx("div",{style:{marginBottom:4},children:(s==null?void 0:s.tickets)>0&&e.jsxs("span",{style:{marginRight:12},children:["Tickets: ",Intl.NumberFormat().format(s.tickets)]})})]},r)),e.jsx(Je,{entry:t,containerRef:u}),e.jsxs("div",{style:{fontSize:"0.9rem",fontWeight:400,marginTop:10,textAlign:"right"},children:["Last updated: ",b(t==null?void 0:t.updatedAt).format("MMM DD")]}),e.jsx("div",{style:{textAlign:"center",margin:"15px 0px 5px 0px"},children:e.jsx(W,{title:"Edit Entry",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{variant:"contained",size:"small",onClick:()=>{d(t.id)},style:{backgroundColor:"#2bb259",color:"#000",padding:"6px 14px"},children:"EDIT ENTRY"})})})]}),e.jsxs(ze,{disableSpacing:!0,children:[e.jsx("div",{style:{display:"flex",flexGrow:1},children:e.jsx(Ue,{entry:t,containerRef:u})}),e.jsx(Te,{entry:t})]})]})]})}const _e=w.memo(Xe,(t,l)=>{const f=Object.keys(t.entry),d=Object.keys(l.entry);if(f.length!==d.length)return!1;for(let a=0;a<f.length;a++)if(f[a]!==d[a]||t.entry[f[a]]!==l.entry[d[a]])return!1;return t.expanded===l.expanded&&t.onExpand===l.onExpand});function qe({editEntryId:t,setEditEntryId:l}){const{filters:f}=o.useContext(Q),[d,a]=o.useState(f.id),{visibleEntries:i,expandAll:h}=o.useContext(N);Be("RAFL Admin - Submitted Entries");const C=o.useDeferredValue(d),p=o.useCallback(v=>{a(v)},[]),{isMobile:E}=H(),R=E?{maxWidth:700,marginLeft:"auto",marginRight:"auto",padding:8}:{maxWidth:700,marginLeft:"auto",marginRight:"auto",padding:"12px 12px 12px 12px"};return e.jsxs("div",{style:{paddingBottom:32},children:[e.jsx("div",{style:{...R,paddingBottom:0,backgroundColor:"#333"},children:e.jsx("div",{style:{padding:"4px 4px 4px 4px"},children:e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:500,marginTop:1,marginBottom:0},children:"Submitted RAFL Entries"})})}),e.jsx(Ae,{label:"Raffle Entries",sortValues:Se,entryCount:i.length}),e.jsx(ve,{}),i.length===0&&e.jsx(Ee,{label:"Rafl Entries"}),i.map(v=>e.jsx(_e,{entry:v,onExpand:p,expanded:v.id===C||!!h,editId:t,setEditEntryId:l},v.id)),e.jsx("div",{style:{marginLeft:"auto",marginRight:"auto",textAlign:"center",justifyItems:"center",marginTop:30},children:e.jsx(He,{text:!0})})]})}function q(t,l,f=.3){const d=t&&l.find(i=>i.id===t);if(d)return[d];const a=/^\/(.*)\/$/.exec(t);return a&&Ge(a[1])?l.reduce((i,h)=>(Ye(h,"long").match(new RegExp(a[1],"i"))&&i.push(h),i),[]):t?Ve.go(de(t),l,{keys:["fuzzy"],threshold:-23e3}).map(i=>({...i.obj,score:i.score})).filter(i=>i.score>f):l}function Qe({children:t}){const l=o.useContext(N),{entriesLoaded:f,allRaffleEntries:d,winnerData:a}=o.useContext(B),{allPots:i}=o.useContext(K),{filters:h,advancedFilterGroups:C}=o.useContext(Q),{search:p,id:E,tab:R,name:v,sort:m,image:k,preview:u,single:A,expandAll:x,...j}=h||{},g=o.useMemo(()=>Object.keys(a).reduce((s,r)=>(a[r].map(n=>{$e(s,[n.entryId],r)}),s),{}),[a]),y=.3,S=o.useMemo(()=>{let s={},r={};return d==null||d.forEach(n=>{n.donations.forEach(c=>{ne(s,[n.id],c.charity.itemFullTitle)},[]),n.pots.forEach(c=>{var D;ne(r,[n.id],c.itemTitle),(D=g[n.id])!=null&&D.includes(c.itemId)&&(c.winner=!0)},[])},{}),d.map(n=>{var c;return{...n,charities:s[n.id]||[],potNames:r[n.id]||[],content:[n.notes&&n.notes.length>0&&"Has Notes",n.donations.every(D=>D.approved)?"All Donations OK":"Donations not OK"].filter(Boolean),potsWon:g[n.id]||[],potWinner:((c=g[n.id])==null?void 0:c.length)>0?"Won Pots":"No Wins",fuzzy:de([n.username,...s[n.id],...r[n.id]].join(","))}})},[d,g]),O=o.useMemo(()=>S.reduce((s,r)=>(r.pots.forEach(n=>{s.push({username:r.username,entryId:r.id,platform:r.platform,potId:n.itemId,potTickets:n.tickets})}),s),[]),[S]),P=o.useMemo(()=>q(p,[...S],y),[S,p]),M=o.useMemo(()=>{if(!f)return[];const s=ie({advancedFilterGroups:C(),entries:S}),r=q(p,[...s],y);return m?r.sort((n,c)=>{var D;return m==="updatedAt"?b(n.updatedAt).isBefore(b(c.updatedAt))?1:-1:m==="status"?te(n.status,c.status):m==="username"?(D=n.username)==null?void 0:D.localeCompare(c.username):m==="totalDonation"?c.totalDonation-n.totalDonation:b(n.createdAt).isBefore(b(c.createdAt))?1:-1}):r.sort((n,c)=>b(n.createdAt).isBefore(b(c.createdAt))?1:-1)},[C,f,S,p,m]),L=o.useMemo(()=>i.map(s=>{const r=O.filter(n=>n.potId===s.id);return r.length>0&&(s.entrants=r),s},[]),[i,O]),$=o.useMemo(()=>{const s=ie({advancedFilterGroups:C(),entries:S}),r=q(p,[...s],y);return m?r.sort((n,c)=>{var D;return m==="updatedAt"?b(n.updatedAt).isBefore(b(c.updatedAt))?1:-1:m==="status"?te(n.status,c.status):m==="username"?(D=n.username)==null?void 0:D.localeCompare(c.username):m==="totalDonation"?c.totalDonation-n.totalDonation:b(n.createdAt).isBefore(b(c.createdAt))?1:-1}):r.sort((n,c)=>n.potNumber-c.potNumber)},[C,S,p,m]),z=o.useCallback(s=>L.find(r=>r.id===s),[L]),G=o.useMemo(()=>({...l,allEntries:d,searchedEntries:P,visibleEntries:M,mappedPotEntries:L,visiblePotEntries:$,getPotFromId:z,expandAll:x,statusLabels:Ze}),[l,d,P,M,L,$,z,x]);return e.jsx(N.Provider,{value:G,children:t})}const Ze={pending:{entryColor:"Blue",backgroundColor:"#3e71bd",textColor:"#fff"},approved:{entryColor:"Green",backgroundColor:"#34732f",textColor:"#fff"},issues:{entryColor:"Orange",backgroundColor:"#e16936",textColor:"#fff"},rejected:{entryColor:"Red",backgroundColor:"#c52323",textColor:"#fff"}};function oo(){const{raffleAdmin:t,setRaffleAdminRole:l}=o.useContext(K),{authLoaded:f,isLoggedIn:d}=o.useContext(xe);o.useEffect(()=>{t&&l(!0)});const{isMobile:a}=H(),[i,h]=o.useState(null),C=e.jsxs(w.Fragment,{children:[!a&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}}),e.jsx(be,{})]});if(!f)return e.jsx(Pe,{message:"Loading..."});if(f&&!t)return e.jsxs(w.Fragment,{children:[e.jsx(Z,{title:"RAFL Admin",extras:C}),e.jsx(se,{page:"RAFL Admin"}),e.jsxs("div",{style:{padding:20},children:[!d&&e.jsx("div",{children:"Please log in to access this page."}),d&&!t&&e.jsx("div",{children:"Sorry, you do not have access to this page."}),e.jsx("div",{children:e.jsx(he,{})})]}),e.jsx(ee,{})]});const p=a?8:0,E={maxWidth:700,marginLeft:"auto",marginRight:"auto",paddingLeft:p,paddingRight:p};return e.jsx(ge,{filterFields:Ce,children:e.jsx(Qe,{children:e.jsxs("div",{style:E,children:[e.jsx(Z,{title:"RAFL Admin",extras:C}),e.jsx(se,{page:"entries"}),t&&!i&&e.jsx(qe,{editEntryId:i,setEditEntryId:h}),t&&!!i&&e.jsx(Oe,{editEntryId:i,setEditEntryId:h}),e.jsx(ee,{}),e.jsx(je,{feature:"raflAdmin"})]})})})}export{oo as default};
