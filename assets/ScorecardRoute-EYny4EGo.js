import{I as Q,r as o,D as W,u as U,b as Se,j as e,R as A,L as K,B as g,W as ae,U as le,aC as De,aj as ce,ab as de,ar as pe,ac as me,a4 as we,F as xe,aD as Te,a3 as Ae,A as ue,a6 as Le,N as Ee,ak as Pe,S as Be,ao as Re,aE as Fe,e as Ne,d as _e,h as ze,T as He}from"./index-dKRtSNxw.js";import{c as Oe}from"./dataUrls-DkJe4Pqg.js";import{S as Me,a as We,b as Ue}from"./ScorecardListContext-DA-hawyl.js";import{s as $e}from"./filterFields-BL35TyfQ.js";import{L as Ve}from"./LoadingDisplay-ClE7MCh_.js";import{V as Ge,S as Ye}from"./ScorecardRow-3WYZR1k1.js";import{D as he}from"./DataContext-C4bwfEhO.js";import"./index-DUXewakl.js";import{I as te,S as oe}from"./ScorecardDanStats-Dn_aJ2Ph.js";import{L as X}from"./LoadingDisplay-B0sXvsD0.js";import{T as qe}from"./TextField-DUOVYMOU.js";import{E as O}from"./EvidenceForm-B17I5ba7.js";import{P as Je}from"./ProfileHeader-DWS3PA3Q.js";import{N as Ke,S as Qe}from"./ScorecardExportButton-DGkJy1BA.js";import{I as Xe}from"./IntroCopy-BFEjf5yp.js";import{B as Ze}from"./BeltStripe-CbwYp4Dn.js";import{e as et}from"./entryName-q5xc3klz.js";import{H as ge}from"./HighlightOff-vqKwEBTW.js";import{L as tt}from"./ListItem-rtI2q2HE.js";import{C as ot}from"./Cached-CxEv1AMW.js";import{C as se}from"./Collapse-CjmNnK1b.js";import{A as st}from"./AdvancedFilters-BelcMtlB.js";import{S as rt}from"./SearchBox-Bct6iWRt.js";import{s as nt}from"./sortFields-ChCLUnX8.js";import{V as it}from"./ViewFilterButtons-DdfEuVej.js";import{A as at,a as lt,b as ct}from"./AccordionSummary-CVD4cB-S.js";import{T as dt,a as re}from"./ToggleButtonGroup-BQ_Ge2JJ.js";import{S as pt}from"./ScorecardProfileNotFound-Mp3Llnn6.js";import{u as ne}from"./useData-C-IPBLTA.js";import{u as mt}from"./usePageTitle-BuZvY77b.js";import{L as xt,A as ut}from"./LocalizationProvider-BECe7-e3.js";import"./filterEntriesAdvanced-B_LinbMH.js";import"./LPU-DltM2OBF.js";import"./LinearProgress-lcwn9dMT.js";import"./ExpandMore-BmYua4nl.js";import"./FieldValue-DK74nsT6.js";import"./Link-BBPjKFGX.js";import"./BeltIcon-BtjvAu26.js";import"./chartDefaults-pV7GKcxU.js";import"./nivo-bar-D1VKmBkc.js";import"./nivo-axes-CKasbbGP.js";import"./nivo-legends-DeNG2VqZ.js";import"./uniq-Cv6pUjpR.js";import"./_baseClone-D80LX-GB.js";import"./Box-CNe_KsJS.js";import"./CircularProgress-CT2nwPW6.js";import"./Select-CkAXGQLK.js";import"./useFormControl-BW-14CyG.js";import"./Launch-BlNOsLo7.js";import"./PhotoCamera-uhC_amuL.js";import"./LockEntrySearchBox-CHdpBWqq.js";import"./Search-BY9elSYw.js";import"./BeltStripeMini-9r5eCRsF.js";import"./Autocomplete-DiCFB7a5.js";/* empty css                  */import"./pageData-BY6jrYM9.js";import"./index-DgSHc12p.js";import"./index-D46jrXAu.js";import"./index-CKKy2RiU.js";import"./sanitizeValues-UI0dpttx.js";import"./index-BrAJnI6L.js";import"./DialogContent-OAWOfw5I.js";import"./Dialog-C32-PCOV.js";import"./VideocamOutlined-DxqUTuLZ.js";import"./Checkbox-BgwfIG6v.js";import"./SwitchBase-C9tNWwTr.js";import"./LoadingDisplaySmall-EgnLNagL.js";import"./CopyProfileLinkButton-Clox0l9X.js";import"./mycollection-Dqx3MeiB.js";import"./download-C-8pOeYN.js";import"./List-Deh2Wed6.js";import"./ContentCopy-C8nYr4CP.js";import"./ChoiceButtonGroup-DNTnUCQg.js";import"./Sort-Cg95l-0G.js";import"./FilterAlt-OBCVvvoN.js";import"./LockListContext-J59pH27_.js";import"./setDeep-J6HEwWhX.js";import"./AddCircle-BQVe-vUY.js";import"./Cancel-dbNbMitp.js";function ye({setControlsExpanded:n,adminAction:t}){const{userId:r}=Q(),{importUnclaimedEvidence:f}=o.useContext(W),{isMobile:y}=U(),[i,p]=o.useState(!1),d=Se(),[a,u]=o.useState(""),[h,m]=o.useState(null),k=o.useCallback(async()=>{p(!0);const C=await f(r,a);p(!1),C?(u(""),n(!1),t()):m("Cannot find dan sheet tab")},[f,r,a,n,t]),b=y?"block":"flex",S=y?"0.95rem":"1rem";return e.jsx(A.Fragment,{children:e.jsx("div",{style:{placeItems:"center",display:b},children:i?e.jsx(X,{}):e.jsx(A.Fragment,{children:e.jsxs("div",{style:{padding:20,fontSize:S},children:[e.jsx("strong",{children:"For Black Belt pickers only."}),e.jsx("br",{}),"Black Belt pickers currently use another scorecard system known as the Dan Sheet. This import allows them to bring their picking history over to the site. If you do not already have a tab in the Dan sheet, this import will not work for you. For those that do, specify the name of your tab in the sheet to import your history into your Scorecard. Please note that tab names are case sensitive. ",e.jsx(K,{onClick:()=>{d("/profile/scorecard/howto")},style:{color:"#bbb",cursor:"pointer"},children:"Click here to learn more."}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("div",{style:{padding:"0px",alignItems:"center"},children:e.jsxs("div",{style:{padding:"0px",display:"flex"},children:[e.jsx("div",{style:{flexGrow:1}}),e.jsx(qe,{id:"tab-to-import",label:"Tab to Import",value:a,size:"small",error:!!h,helperText:h,margin:"dense",color:"secondary",onChange:C=>{u(C.target.value)}}),e.jsx(g,{style:{color:"#000",padding:0,lineHeight:"1rem",height:40,marginTop:8,marginLeft:10},variant:"contained",onClick:k,edge:"start",color:"secondary",children:"Import"})]})})]})})})})}function ht({id:n,owner:t}){const[r,f]=o.useState(null),{cardActivity:y}=o.useContext(he),i=y.filter(a=>a.id===n).filter(a=>a),p=o.useCallback(a=>{f(a)},[]),d=o.useCallback(()=>{f(null)},[]);return e.jsxs(A.Fragment,{children:[e.jsx(ae,{title:"My Collection",arrow:!0,disableFocusListener:!0,children:e.jsx(le,{variant:"outlined",color:"inherit",onClick:p,children:e.jsx(De,{color:i.length>0?"secondary":"inherit",fontSize:"medium"})})}),e.jsx(ce,{sx:{color:"#fff",zIndex:a=>a.zIndex.drawer+1},open:!!r,onClick:null,children:!!r&&e.jsxs(de,{style:{maxWidth:600,marginLeft:"auto",marginRight:"auto",border:"1px solid #666",opacity:1},children:[e.jsx(pe,{title:"Documentation",action:e.jsx(ge,{sx:{cursor:"pointer"}}),style:{paddingBottom:0},onClick:d}),e.jsxs(me,{children:[i.map((a,u)=>e.jsx(O,{activity:a,handleUpdate:d,source:"collectionButton",owner:t},u)),i.length===0&&e.jsx(O,{activity:null,lockId:n,handleUpdate:d,source:"collectionButton",owner:t})]})]})})]})}function gt({entry:n,owner:t}){const r=n.link?"#fff":"#888";return e.jsxs(tt,{style:{minHeight:64,borderTop:"1px solid rgba(255, 255, 255, 0.12)",color:r},children:[e.jsx(Ze,{value:n.belt}),e.jsx(we,{primary:et(n),primaryTypographyProps:{fontWeight:500},secondary:n.version,secondaryTypographyProps:{color:r},style:{padding:"0px 0px 0px 10px"}}),e.jsx(Ge,{entry:n,color:r}),e.jsx(ht,{id:n.id,owner:t})]},n.id)}const yt=A.memo(gt);function jt({owner:n,popularEntries:t,popularType:r}){const{isMobile:f}=U(),{filters:y}=o.useContext(xe),[i,p]=o.useState(25),[d,a]=o.useState("all"),[u,h]=o.useState(!0),m=o.useMemo(()=>t.slice(0,i),[t,i]),k=o.useMemo(()=>d==="picked"?m.filter(l=>l.link):d==="notPicked"?m.filter(l=>!l.link):m,[d,m]),b=m.filter(l=>l.link).length,S=k.length>0?Math.floor(b/m.length*100):0,C=n?"You've picked":"Picked",E=Object.keys(y).filter(l=>l!=="locks"&&l!=="tab").length>0?"matching":"most popular",s=o.useCallback(l=>()=>{h(!1),setTimeout(()=>p(l),150),setTimeout(()=>h(!0),300)},[]),v=f?"block":"flex",I=i===25?"contained":"text",D=i===50?"contained":"text",w=i===100?"contained":"text",N=d==="all"?"contained":"text",_=d==="picked"?"contained":"text",P=d==="notPicked"?"contained":"text";return t?e.jsxs("div",{style:{maxWidth:700,padding:0,backgroundColor:"#222",marginLeft:"auto",marginRight:"auto",marginTop:16},children:[e.jsxs("div",{style:{width:"100%",textAlign:"center",padding:"0px 20px 24px 20px"},children:[e.jsx(Te,{in:u,children:e.jsxs("div",{style:{fontSize:"1.2rem",fontWeight:700},children:[C," ",b," of the ",m.length," ",E," locks in ",r," Scorecards (",S,"%)"]})}),"(only entries with documentation are counted)",e.jsxs("div",{style:{marginTop:20,display:v,padding:"0px 20px"},children:[e.jsxs("div",{style:{flexGrow:1,textAlign:"left",fontSize:"1rem",marginTop:6},children:[e.jsx(g,{onClick:()=>a("all"),color:"info",variant:N,value:"all",style:{padding:"2px 8px 2px 8px",minWidth:35,lineHeight:"1rem",marginRight:6},children:"All"}),e.jsx(g,{onClick:()=>a("picked"),color:"info",variant:_,value:"picked",style:{padding:"2px 8px 2px 8px",minWidth:35,lineHeight:"1rem",marginRight:2},children:"Picked"}),e.jsx(g,{onClick:()=>a("notPicked"),color:"info",variant:P,value:"notPicked",style:{padding:"2px 8px 2px 8px",minWidth:35,lineHeight:"1rem"},children:"Not Picked"})]}),e.jsxs("div",{style:{flexGrow:1,textAlign:"right",fontSize:"1rem",marginTop:6},children:["Top Locks:  ",e.jsx(g,{onClick:s(25),color:"info",variant:I,value:"25",style:{padding:"2px 2px 2px 2px",minWidth:35,lineHeight:"1rem"},children:"25"}),e.jsx(g,{onClick:s(50),variant:D,color:"info",value:"50",style:{padding:"2px 2px 2px 2px",minWidth:35,lineHeight:"1rem"},children:"50"}),e.jsx(g,{onClick:s(100),color:"info",variant:w,value:"100",style:{padding:"2px 2px 2px 2px",minWidth:35,lineHeight:"1rem"},children:"100"})]})]})]}),e.jsx("div",{children:e.jsx(Ae,{dense:!0,style:{padding:0},children:k.map(l=>e.jsx(yt,{entry:l,owner:n},l.id))})})]}):e.jsx(X,{})}const ie={VITE_DISCORD_CLIENT_ID:"1271550138929774725",VITE_REDDIT_CLIENT_ID:"i_lvEF-IFPalom2BR_lVjg"};function ft({profile:n}){const{isMobile:t}=U(),{user:r}=o.useContext(ue),{oauthState:f}=o.useContext(W),y=(n==null?void 0:n.blackBeltAwardedAt)>0,[i,p]=o.useState(!1),d=o.useCallback(()=>{p(!i)},[i]),[a,u]=o.useState(!1),h=()=>{u(!1),p(!1)},m=()=>{u(!0)},k=o.useCallback(()=>{const{VITE_DISCORD_CLIENT_ID:s}=ie,v=encodeURIComponent("identify"),I=encodeURIComponent(`${location.origin}/#/auth/discord`),D=`https://discord.com/oauth2/authorize?client_id=${s}&response_type=code&redirect_uri=${I}&scope=${v}`;window.location.assign(D)},[]),b=o.useCallback(async()=>{const{VITE_REDDIT_CLIENT_ID:s}=ie,v=await f(r.uid),I=encodeURIComponent("identity flair privatemessages"),D=encodeURIComponent(`${location.origin}/#/auth/reddit`),w=`https://www.reddit.com/api/v1/authorize?client_id=${s}&response_type=code&state=${v}&redirect_uri=${D}&duration=temporary&scope=${I}`;window.location.assign(w)},[r,f]),S=t?"0.91rem":"1rem",C=t?"1.3rem":"1.5rem";return e.jsxs(A.Fragment,{children:[e.jsx(ae,{title:"Import",arrow:!0,disableFocusListener:!0,children:e.jsx(g,{variant:"contained",color:"secondary",size:"small",style:{lineHeight:"1.2rem",marginLeft:6},onClick:m,children:"IMPORT BELTS"})}),e.jsx(ce,{sx:{color:"#fff",zIndex:s=>s.zIndex.drawer+1},open:a,onClick:null,children:a&&e.jsxs(de,{style:{maxWidth:600,marginLeft:"auto",marginRight:"auto",border:"1px solid #666",opacity:1},children:[e.jsx(pe,{title:"Import Belts",action:e.jsx(ge,{sx:{cursor:"pointer"}}),style:{paddingBottom:0},onClick:h}),e.jsxs(me,{children:[e.jsxs(se,{in:!i,children:[e.jsxs("div",{style:{padding:"0px 0px",fontSize:S,lineHeight:C},children:[e.jsx("strong",{children:"New!"})," Add your approved Belts (and Dan Levels) to your Scorecard. You'll need to authorize for each site, and we'll pull your username and approvals for you. Please note: you can only import belts already approved through the official process.",e.jsx("br",{}),e.jsx("br",{}),"You'll need to briefly authorize for each platform you use for belts. For Discord, we use the publicly available awards in #belt-requests so that linking is a simple confirmation of your username to determine which belts are yours. Reddit requests temporary permission in order to scan direct messages for belt awards. We cannot access and do not store your password.",e.jsx("br",{}),e.jsx("br",{}),e.jsxs("span",{style:{fontWeight:400},children:["New Discord approvals will be automatically added to your scorecard as long as there is a Discord username in your Profile. You only need to re-import from Discord if you want to add belts from an additional username.",e.jsx("br",{}),e.jsx("br",{}),"You'll need to import from Reddit again to pick up newly approved belts."]})]}),e.jsxs("div",{style:{padding:20,width:"100%",textAlign:"center"},children:[e.jsx("span",{style:{fontWeight:700},children:"Import From"}),e.jsx("br",{}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx(g,{variant:"contained",color:"secondary",style:{lineHeight:"1.2rem"},onClick:k,children:"DISCORD"}),e.jsx(g,{variant:"contained",color:"secondary",style:{lineHeight:"1.2rem",marginLeft:16},onClick:b,children:"REDDIT"})]})]}),!y&&e.jsxs("div",{style:{padding:20,width:"100%",textAlign:"center"},children:["Black Belts only: ",e.jsx(K,{onClick:d,style:{color:"#99c2e5",cursor:"pointer"},children:"Import your Dan Sheet"})]})]}),e.jsx(se,{in:i,children:i&&e.jsxs(A.Fragment,{children:[e.jsx(ye,{}),e.jsxs("div",{style:{padding:20,width:"100%",textAlign:"center"},children:["Return to ",e.jsx(K,{onClick:d,style:{color:"#99c2e5",cursor:"pointer"},children:"Import Belts"})]})]})})]})]})})]})}function kt({owner:n,profile:t,adminAction:r,popular:f}){const{isMobile:y}=U(),{userId:i}=Q(),{visibleEntries:p=[],popularEntries:d=[],bbPopularEntries:a=[],cardActivity:u,cardMaxBelt:h}=o.useContext(he),{expanded:m}=o.useContext(Me),{filters:k,filterCount:b,setFilters:S,removeFilters:C}=o.useContext(xe),{name:E,locks:s}=k,{createEvidenceForEntries:v,removePickerActivity:I,refreshPickerActivity:D}=o.useContext(W),{admin:w}=o.useContext(Le),[N,_]=o.useState(m),[P,l]=o.useState(!1),[T,z]=o.useState("import"),[M,B]=o.useState(!1),[j,$]=o.useState(s==="mostPopular"||f);m&&m!==N&&_(m);const R=o.useMemo(()=>{if(t&&t.recorded){const x=u.map(J=>J.matchId);return t.recorded.filter(J=>!x.includes(J))}else return[]},[t,u]),V=o.useCallback(x=>{k.id&&C(["id"]),_(x)},[k,C]),G=o.useCallback(async()=>{B(!0),await v(i,R),l(!1),B(!1),r()},[v,i,R,r]),L=o.useCallback(x=>{T===x?(l(!P),z(void 0)):T==="lock"&&x==="project"||T==="project"&&x==="lock"?z(x):(z(x),l(!P))},[T,P]),[H,c]=o.useState(null),F=!!H,je=o.useCallback(x=>{x.preventDefault(),x.stopPropagation(),c(x.currentTarget)},[]),Y=o.useCallback(()=>c(null),[]),fe=o.useCallback(async()=>{B(!0),await I(u),Y(),B(!1),r()},[u,I,Y,r]),Z=o.useCallback(()=>{l(!1),z(void 0),S(j?{name:E}:{locks:"mostPopular",name:E}),$(!j)},[j,E,S]),ke=o.useCallback(async()=>{B(!0),await D(i),B(!1),r(),window.location.reload()},[r,D,i]),ve=t!=null&&t.displayName&&!t.privacyAnonymous?t.displayName.toLowerCase().endsWith("s")?`${t.displayName}'`:`${t.displayName}'s`:"Anonymous",be=window.location.hash.search(/locks=mostPopular/)<1&&!j?e.jsxs(A.Fragment,{children:[e.jsx(rt,{label:"Scorecard",extraFilters:[{key:"tab",value:"search"}]}),e.jsx(it,{sortValues:nt,advancedEnabled:!0,extraFilters:[{key:"tab",value:"search"}],compactMode:!1,resetAll:!0,expandAll:!1}),!y&&e.jsx("div",{style:{flexGrow:1,minWidth:10}})]}):null,Ce=n?"My Locks":`${ve} Locks`,ee=15,q=y?"block":"flex",Ie=y?6:0;return e.jsxs(A.Fragment,{children:[e.jsx(Ee,{title:"Scorecard",extras:be}),e.jsxs("div",{style:{maxWidth:700,padding:0,backgroundColor:"#222",marginLeft:"auto",marginRight:"auto",marginTop:16},children:[e.jsx(Je,{profile:t,page:"scorecard",owner:n,mostPopular:j}),n&&p.length===0&&!(t!=null&&t.tabClaimed)&&e.jsx("div",{style:{margin:8,padding:"0px 0px"},children:e.jsx(Xe,{pageName:"scorecard"})}),p.length>0&&e.jsx(A.Fragment,{children:y?e.jsxs("div",{style:{display:q,padding:"0px 8px 0px 16px"},children:[(t==null?void 0:t.blackBeltAwardedAt)>0&&e.jsx(oe,{profile:t,owner:n}),e.jsx("div",{style:{marginRight:0,width:"95%"},children:e.jsx(te,{profile:t,entries:p})})]}):e.jsxs("div",{style:{display:q,padding:"10px 8px 0px 16px"},children:[e.jsx("div",{style:{marginRight:10,width:370},children:e.jsx(te,{profile:t,entries:p})}),t.danLevel>=0&&e.jsx("div",{style:{flexGrow:1,marginRight:0},children:e.jsx(oe,{profile:t,owner:n})})]})}),e.jsxs(at,{expanded:P,disableGutters:!0,children:[e.jsx(lt,{style:{paddingLeft:ee,paddingRight:ee,placeItems:"center",width:"100%"},children:e.jsxs("div",{style:{width:"100%",placeItems:"center",textAlign:"center"},children:[e.jsxs("div",{style:{display:q,width:"100%",placeItems:"center",textAlign:"center"},children:[(n||w)&&e.jsxs("div",{style:{width:"100%",textAlign:"left"},children:[e.jsx(g,{variant:"contained",size:"small",color:"secondary",style:{lineHeight:"1.2rem",marginLeft:6},onClick:()=>L("lock"),children:"ADD LOCK"}),e.jsx(ft,{profile:t}),e.jsx(g,{variant:"outlined",color:"secondary",size:"small",style:{lineHeight:"1.2rem",marginLeft:6},onClick:()=>L("project"),children:"ADD PROJECT"})]}),e.jsxs("div",{style:{width:"100%",textAlign:"right",display:"flex",marginTop:Ie},children:[e.jsx("div",{style:{flexGrow:1}}),e.jsxs(dt,{exclusive:!0,children:[e.jsx(re,{variant:"outlined",color:"info",size:"small",disabled:!j,style:{padding:"4px 10px",borderColor:"#236585",color:j?"#aaa":"#38b9f6",backgroundColor:j?"transparent":"#333"},onClick:()=>Z(),value:"myLocks",children:e.jsx("nobr",{children:Ce})}),e.jsx(re,{variant:"outlined",color:"info",size:"small",disabled:j,style:{padding:"4px 10px",borderColor:"#236585",color:j?"#38b9f6":"#aaa",backgroundColor:j?"#333":"transparent"},onClick:()=>Z(),value:"mostPopular",children:"MOST POPULAR"})]})]})]}),M&&e.jsx(X,{}),w&&!M&&e.jsx("div",{style:{backgroundColor:"#700",padding:5,marginTop:20},children:e.jsxs("div",{style:{display:"flex"},children:[e.jsx("div",{style:{width:"10%",textAlign:"center"},children:"ADMIN"}),e.jsx(g,{color:"secondary",size:"small",style:{lineHeight:"1.2rem",marginLeft:6},onClick:()=>L("award"),children:"ADD BELT"}),e.jsx(g,{color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:()=>L("import"),children:"IMPORT DAN SHEET"}),e.jsxs(g,{color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:G,children:["MERGE RECORDED (",R.length,")"]}),e.jsx(g,{color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:je,children:"DELETE SCORECARD"}),e.jsxs(Pe,{anchorEl:H,open:F,onClose:Y,children:[e.jsxs("div",{style:{padding:20,textAlign:"center"},children:["You cannot undo delete.",e.jsx("br",{}),"Are you sure?"]}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(g,{style:{marginBottom:10,color:"#000"},variant:"contained",onClick:fe,edge:"start",color:"error",children:"Delete"})})]}),e.jsx(le,{color:"secondary",onClick:ke,children:e.jsx(ot,{})})]})})]})}),e.jsxs(ct,{style:{backgroundColor:"#333"},children:[T==="import"&&e.jsx(ye,{setControlsExpanded:l,adminAction:r}),T==="lock"&&e.jsx(O,{activity:null,handleUpdate:L,addLock:!0,owner:n}),T==="project"&&e.jsx(O,{activity:null,handleUpdate:L,addProject:!0,owner:n}),T==="award"&&e.jsx(O,{activity:null,handleUpdate:L,addAward:!0,owner:n})]})]}),b>0&&e.jsx(st,{profile:t,collectionType:"scorecard"}),!j&&e.jsxs(A.Fragment,{children:[p.length===0&&e.jsx(Ke,{}),e.jsx("div",{children:p.map(x=>e.jsx(Ye,{owner:n,activity:x,expanded:x.id===N,onExpand:V,merged:t.blackBeltAwardedAt>0},x.id))})]}),j&&e.jsx(jt,{owner:n,profile:t,adminAction:r,popularType:(h==null?void 0:h.rank)<9?"all":"BB",popularEntries:(h==null?void 0:h.rank)<9?d:a})]})]})}function Yo({mostPopular:n}){var H;const{userId:t}=Q(),{user:r}=o.useContext(ue),{getProfile:f,getPickerActivity:y}=o.useContext(W),{scoredActivity:i,bbCount:p,danPoints:d,eligibleDan:a,nextDanPoints:u,nextDanLocks:h,uniqueLocks:m,maxBelt:k}=o.useContext(Be);mt("Scorecard");const[b,S]=o.useState(!1),C=o.useCallback(()=>{S(!b)},[b]),E=o.useCallback(async()=>{try{const c=await f(t);if(c){const F=c.displayName&&!c.privacyAnonymous?c.displayName.toLowerCase().endsWith("s")?`${c.displayName}'`:`${c.displayName}'s`:"Anonymous";document.title=`LPU Belt Explorer - ${F} Scorecard`}if((r==null?void 0:r.uid)!==t){const F=await y(t);return{profile:c,...Re(F)}}else return{profile:c,scoredActivity:i,bbCount:p,danPoints:d,eligibleDan:a,nextDanPoints:u,nextDanLocks:h,uniqueLocks:m,maxBelt:k}}catch(c){return console.error("Error loading profile and activity.",c),null}},[b,f,t,r,y,i,p,d,a,u,h,m,k]),{data:s={},loading:v,error:I}=ne({loadFn:E}),D=(r==null?void 0:r.uid)===t,w=s?s.profile:{},N=((H=s==null?void 0:s.profile)==null?void 0:H.blackBeltAwardedAt)>0,_=s?s.scoredActivity:[],P=s?s.bbCount:0,l=s?s.danPoints:0,T=s?s.eligibleDan:0,z=s?s.nextDanPoints:0,M=s?s.nextDanLocks:0,B=s?s.uniqueLocks:0,j=s?s.scoredActivity.filter(c=>c.collectionDB==="awards").map(c=>Fe[c.matchId]).filter(c=>c.awardType==="belt").sort((c,F)=>c.rank-F.rank):[],$=s?j[j.length-1]:{},R=ne({url:Oe}),V=R.data?R.data.blackBeltOnly.listStats.recordedLocks.topItems:[],G=R.data?R.data.allUsers.listStats.recordedLocks.topItems:[],L=e.jsx("div",{style:{margin:"30px 0px"},children:e.jsx(Qe,{text:!0,profile:w})});return v||I?null:e.jsx(Ne,{filterFields:$e,children:e.jsx(We,{cardActivity:_,cardBBCount:P,cardDanPoints:l,cardEligibleDan:T,cardNextDanPoints:z,cardNextDanLocks:M,cardUniqueLocks:B,cardMaxBelt:$,popularLocks:G,popularLocksBB:V,profile:w,blackBeltScorecard:N,children:e.jsxs(Ue,{children:[e.jsxs(xt,{adapterLocale:_e.locale(),dateAdapter:ut,children:[v&&e.jsx(Ve,{}),!v&&s&&!I&&e.jsx(kt,{owner:r&&(r==null?void 0:r.uid)===t,profile:w,adminAction:C,popular:n}),!v&&(!s||I)&&e.jsx(pt,{}),e.jsx(ze,{before:L})]}),e.jsx(He,{feature:"scorecard",own:D})]})})})}export{Yo as default};
