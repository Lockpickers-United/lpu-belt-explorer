import{j as t,R as M,al as A,r as u,A as F,a1 as R,a2 as N,Z as W,D as I,am as H,$ as U,N as z,F as $,T as G}from"./index-9a6ce20d.js";import{D as O,a as V,l as Y}from"./filterFields-9dd8683f.js";import{S as q,F as Z,a as J,l as K}from"./sortFields-ed18f740.js";import{D as Q}from"./LockDataProvider-da5d5a79.js";import{L as X,a as _}from"./LockListContext-0ddf3f6d.js";import{C as tt,E as et,T as it}from"./ToggleCompactButton-cb1211da.js";import{L as ot}from"./LoadingDisplay-29057351.js";import{u as st}from"./useData-74baa56d.js";import{u as j}from"./useWindowSize-be23f983.js";import{N as rt}from"./NoProfileData-7e069f9c.js";import{P as at}from"./ProfileNotFound-c99bed6b.js";import{I as nt}from"./InlineFilterDisplay-cbc5e29f.js";import{B as T}from"./nivo-bar.es-3a837ad2.js";import{p as E}from"./chartDefaults-9fc07b21.js";import{P as dt}from"./ProfileHeader-780dd358.js";import"./Select-4aac435e.js";import"./Box-8581b8d5.js";import"./Chip-e81fc882.js";import"./Sort-90181fa7.js";import"./Search-f0e44f7a.js";import"./TextField-04b643cf.js";import"./entryName-775d9a94.js";import"./BeltStripe-b4da5b40.js";import"./BeltIcon-194ea6fe.js";import"./Launch-d20e6ccc.js";import"./PhotoCamera-179cf666.js";import"./Autocomplete-53be4a91.js";import"./index-4be1d3c8.js";import"./Dialog-c7f75393.js";import"./ListItem-2d368bf4.js";import"./FormGroup-c56bf579.js";import"./FieldValue-22f2e232.js";import"./LoadingDisplay-963bae2b.js";import"./AccordionSummary-b4024eea.js";import"./index-cab5f322.js";import"./index-ab6d1a93.js";import"./AccordionActions-43759313.js";import"./LPU-c3fa7122.js";import"./LinearProgress-767ffac7.js";import"./mycollection-0ec86312.js";import"./ImageViewer-c0b4712b.js";import"./Link-d2429bbb.js";import"./ContentCopy-41900c66.js";import"./nivo-legends.es-1a9d08a9.js";import"./CopyProfileLinkButton-d4672166.js";import"./ToggleButtonGroup-32d389a3.js";import"./Link-84dc1764.js";function lt({lockCollection:s,userText:l,collectionBarHeight:h}){const c=s.own?s.own.length:0,x=s.picked?s.picked.length:0,r=s.recordedLocks?s.recordedLocks.length:0,a=s.wishlist?s.wishlist.length:0,e=c+x+r+a?{own:c,picked:x,recorded:r,wishlist:a}:{own:0,picked:0,recorded:0,wishlist:0},o={own:14,picked:11,recorded:11,wishlist:8},m={own:250,picked:280,recorded:260,wishlist:100},i={own:Math.min(o.own,e.own),picked:Math.min(o.picked,e.picked),recorded:Math.min(o.recorded,e.recorded),wishlist:Math.min(o.wishlist,e.wishlist)},n={own:e.own>o.own?0:o.own-i.own,picked:e.picked>o.picked?0:o.picked-i.picked,recorded:e.recorded>o.recorded?0:o.recorded-i.recorded,wishlist:e.wishlist>o.wishlist?0:o.wishlist-i.wishlist},g={own:2,picked:2,recorded:2,wishlist:2},P={own:Math.max(e.own-(i.own+n.own+g.own),0),picked:Math.max(e.picked-(i.picked+n.picked+g.picked),0),recorded:Math.max(e.recorded-(i.recorded+n.recorded+g.recorded),0),wishlist:Math.max(e.wishlist-(i.wishlist+n.wishlist+g.wishlist),0)},y={own:Math.min(m.own-e.own,m.own-o.own-g.own),picked:Math.min(m.picked-e.picked,m.picked-o.picked-g.picked),recorded:Math.min(m.recorded-e.recorded,m.recorded-o.recorded-g.recorded),wishlist:Math.min(m.wishlist-e.wishlist,m.wishlist-o.wishlist-g.wishlist)},k=["own","picked","recorded","wishlist"],S=k.map((w,f)=>({row:k[f],"Average A":i[w],"Average B":n[w],Average:g[w],USER:P[w],"Top 10":y[w]})),{width:B}=j(),L=B<=560,C=h,D=L?{top:10,right:20,bottom:50,left:55}:{top:10,right:20,bottom:50,left:55},b=["#3c90c5","#aaa","#000","#3c90c5","#aaa"],d=s?[{title:l,color:"#3c90c5",width:"14px"}]:[];d.push({title:"Average",color:"#000",width:"35px"},{title:"Top 10 Average",color:"#aaaaaa",width:"120px"});const v=({items:w})=>t.jsxs("div",{className:"chart-legend",style:{display:"flex",fontSize:".9rem",color:"#ddd",marginTop:13},children:[t.jsx("div",{style:{width:"100%"}}),w.map(f=>t.jsxs("div",{style:{display:"flex",padding:"0px 18px 24px 18px"},children:[t.jsx("div",{style:{backgroundColor:f.color,height:15,width:15,margin:"2px 6px 0px 0px",border:"1px solid #555"}}),t.jsx("div",{style:{textAlign:"left",width:f.width},children:f.title})]},f.title)),t.jsx("div",{style:{width:"100%"}})]});return t.jsxs(M.Fragment,{children:[t.jsx("div",{style:{height:C},children:t.jsx(T,{data:S,keys:["Average A","Average B","Average","USER","Top 10"],theme:E,indexBy:"row",margin:D,padding:.2,valueScale:{type:"linear"},colors:b,enableLabel:!1,axisLeft:{tickSize:5,tickPadding:5,tickRotation:0,tickValues:5,format:"00",legend:"Saves",legendPosition:"middle",legendOffset:-45,legendOpacity:.9},axisBottom:{tickRotation:-45},enableGridY:!1,isInteractive:!1,animate:!1})}),t.jsx(v,{items:d})]})}function ct({beltData:s}){const{width:l}=j(),h=l<=360,c=l<=560,x=175,r=c?{top:15,right:20,bottom:60,left:20}:{top:0,right:10,bottom:60,left:10},a=["#d5d5d5","#d8d801","#ed7d01","#389700","#0090de","#634b9f","#9d5918","#ba0303","#000","#373737"],p=["#000","#000","#000","#000","#000","#000","#000","#000","#ddd","#ddd"];return t.jsxs("div",{style:{height:x,padding:"0px 8px 0px 8px",width:"100%"},children:[t.jsx(T,{data:s,margin:r,padding:.15,colors:e=>a[e.index%a.length],animate:!0,axisBottom:{tickRotation:-45},axisLeft:null,enableGridY:!1,theme:E,isInteractive:!1,enableLabel:!0,label:e=>e.data.count,labelSkipWidth:12,labelSkipHeight:12,labelTextColor:e=>p[e.index%p.length]}),t.jsx("div",{className:"chart-legend",style:{fontSize:".9rem",color:"#ddd",textAlign:"center",width:"100%",marginTop:"3px"},children:"Belt Distribution"})]},"bar")}function pt({profile:s,entries:l}){const{userId:h}=A(),{user:c}=u.useContext(F),x=h===(c==null?void 0:c.uid)?"You":"User",r=u.useMemo(()=>{const D=W.concat("Unranked"),b=l.map(({belt:d})=>d.includes("Black")?"Black":d).reduce((d,v)=>(d[v]||(d[v]=0),d[v]++,d),{});return D.map(d=>({id:d,label:d,count:b[d]||0,value:b[d]||0}))},[l]),{isMobile:a}=j(),p=a?{maxWidth:700,borderRadius:0}:{maxWidth:700,marginLeft:"auto",marginRight:"auto",borderRadius:0},{width:e}=j(),o=e<=360,m=e<=395,i=e<=428,n=e<=560,y={...{width:"100%",padding:"0px",marginBottom:12,alignItems:"center",marginLeft:"auto",marginRight:"auto"},...n?{}:{display:"flex"}},k=n?"100%":"50%",S=n?"100%":"50%",B=o?200:n?210:180,L=n?160:170,C=o?150:170;return t.jsx(R,{style:p,sx:{paddingBottom:5},children:t.jsx(N,{style:{paddingTop:0,paddingLeft:8},children:t.jsx("div",{style:{textAlign:"center"},children:t.jsxs("div",{style:y,children:[t.jsx("div",{style:{width:k,verticalAlign:"top",height:B},children:t.jsx(lt,{lockCollection:s,userText:x,collectionBarHeight:L})}),t.jsx("div",{style:{width:S,height:C,marginTop:"0px"},children:t.jsx(ct,{beltData:r})})]})})})})}function mt({profile:s,owner:l}){const{compact:h}=u.useContext(X),[c,x]=u.useState(!1),{visibleEntries:r=[]}=u.useContext(O),a=u.useDeferredValue(c);return t.jsx(M.Fragment,{children:t.jsxs("div",{style:{maxWidth:700,padding:0,backgroundColor:"#222",marginLeft:"auto",marginRight:"auto",marginTop:16},children:[t.jsx(dt,{profile:s,page:"collection",owner:l}),t.jsx(nt,{profile:s,collectionType:"locks"}),t.jsx(pt,{profile:s,entries:r}),h?t.jsx(tt,{entries:r}):r.map(p=>t.jsx(et,{entry:p,expanded:p.id===a,onExpand:x},p.id))]})})}function ae(){const{user:s}=u.useContext(F),{userId:l}=A(),{getProfile:h}=u.useContext(I),{isMobile:c}=j(),x=u.useCallback(async()=>{try{const i=await h(l);if(i){const n=i.displayName?i.displayName.toLowerCase().endsWith("s")?`${i.displayName}'`:`${i.displayName}'s`:"Anonymous";document.title=`LPU Belt Explorer - ${n} Profile`}return i}catch(i){return console.error("Error loading profile.",i),null}},[h,l]),{data:r={},loading:a,error:p}=st({loadFn:x}),e=u.useMemo(()=>{if(a||!r)return[];const i=new Set(H.locks.getCollected(r));return U.filter(n=>i.has(n.id))},[r,a]),o=t.jsxs(M.Fragment,{children:[t.jsx(q,{label:"Collection"}),t.jsx(Z,{}),t.jsx(J,{sortValues:K}),!c&&t.jsx("div",{style:{flexGrow:1,minWidth:"10px"}}),t.jsx(it,{})]}),m=a?"Loading...":"Profile";return t.jsx(V,{filterFields:Y,children:t.jsx(Q,{allEntries:e,profile:r,children:t.jsxs(_,{children:[t.jsx(z,{title:m,extras:o}),a&&t.jsx(ot,{}),!a&&r&&!p&&t.jsx(mt,{profile:r,owner:s&&s.uid===l}),!a&&r&&!p&&e.length===0&&t.jsx(rt,{}),!a&&(!r||p)&&t.jsx(at,{}),t.jsx($,{}),t.jsx(G,{feature:"profile"})]})})})}export{ae as default};
