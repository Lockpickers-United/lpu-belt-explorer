import{r as t,K as j,d as T,j as e,R as $,J as f,B as g,I as y,ab as z,ac as c,am as d,W as p}from"./index-6718c2da.js";import{d as v,a as h,b as B}from"./download-8cec285a.js";import{d as L}from"./List-90d075fe.js";import{e as E}from"./entryName-5383522f.js";import{d as F}from"./ContentCopy-ab7e2708.js";import{D as J}from"./DataContext-89d97534.js";import"./index-e7f902ca.js";function K({text:b}){const[C,k]=t.useState(null),S=!!C,u=t.useCallback(r=>k(r.currentTarget),[]),n=t.useCallback(()=>k(null),[]),{visibleEntries:i=[]}=t.useContext(J),I=t.useCallback(()=>{const r=JSON.stringify(i);n(),v("scorecardData.json",r),j("Current Scorecard entries downloaded as scorecardData.json")},[n,i]),w=t.useCallback(()=>{const x=i.map(s=>({id:s.id,make:s.makeModels.map(l=>l.make).join(","),model:s.makeModels.map(l=>l.model).join(","),version:s.version,belt:s.belt,name:E(s),versionText:s.version?" ("+s.version+")":""})).map(s=>"* "+s.name+s.versionText).join(`
`);n(),navigator.clipboard.writeText(x),j("Current scorecard entries copied to clipboard.")},[n,i]),D=t.useCallback(()=>{const r=["id","name","version","belt","modifier","points","date","link"],x=i.map(o=>({id:o.matchId,make:o.makeModels.map(a=>a.make).join(","),model:o.makeModels.map(a=>a.model).join(","),version:o.version,belt:o.belt,link:o.link,modifier:o.evidenceModifier,points:o.points,date:o.date?T(o.date).format("L"):"",name:E(o)})),s=r.join(","),l=x.map(o=>r.map(a=>o[a]).map(a=>{const m=`${a??""}`.replace(/"/g,'""');return/(\s|,|")/.test(m)?`"${m}"`:m}).join(",")).join(`
`),M=`${s}
${l}`;n(),v("scorecardData.csv",M),j("Current Scorecard entries downloaded as scorecardData.csv")},[n,i]);return e.jsxs($.Fragment,{children:[b?e.jsx(f,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(g,{variant:"outlined",size:"small",onClick:u,style:{color:"#ddd",borderColor:"#aaa"},startIcon:e.jsx(h,{}),children:"Export"})}):e.jsx(f,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(y,{onClick:u,children:e.jsx(h,{})})}),e.jsxs(z,{anchorEl:C,open:S,onClose:n,children:[!b&&e.jsxs(c,{disabled:!0,children:[e.jsx(d,{children:e.jsx(h,{fontSize:"small"})}),e.jsx(p,{children:"Export"})]}),e.jsxs(c,{onClick:w,children:[e.jsx(d,{children:e.jsx(F,{fontSize:"small"})}),e.jsx(p,{children:"Copy to clipboard"})]}),e.jsxs(c,{onClick:D,children:[e.jsx(d,{children:e.jsx(L,{fontSize:"small"})}),e.jsx(p,{children:"CSV"})]}),e.jsxs(c,{onClick:I,children:[e.jsx(d,{children:e.jsx(B,{fontSize:"small"})}),e.jsx(p,{children:"JSON"})]})]})]})}export{K as E};
