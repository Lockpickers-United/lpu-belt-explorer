import{r as t,ao as H,j as a,D as m,A as F,d as A,bQ as M,bN as W,bP as p,bR as C,bO as L,Y as E,B as w,aa as Y}from"./index-DUr27NUl.js";import{R as v,a as z}from"./RaffleContext-veniFCh1.js";import{A as N}from"./AdminToolButtons-B7-z_CLv.js";import{D as q}from"./Dialog-azs_2Fcq.js";import{B as G}from"./Box-BpC1zFfO.js";import"./useData-BSo5UGM7.js";import"./dataUrls-DVxTtpO-.js";import"./index-DrkNI6xS.js";import"./setDeep-J6HEwWhX.js";import"./EmojiEvents-bAaRoNTS.js";const Q="/assets/hello-my-name-is-RAFL-2026s-CTaRzepe.png";function U(){const{raffleAdminRole:c,raflState:i}=t.useContext(v),n=H(),s=i==="setup"&&!c&&n.pathname!=="/rafl/contribute"&&n.pathname!=="/rafl/photos"&&n.pathname!=="/rafl/potpreview";return a.jsx(q,{open:s,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:1}}},sx:{".MuiDialog-paper":{backgroundColor:"#000",opacity:1,backgroundImage:"none"}},children:a.jsxs("div",{style:{textAlign:"center",padding:20,maxWidth:400},children:[a.jsx(G,{component:"img",alt:"Lock Pickers United",src:Q,style:{marginLeft:"auto",marginRight:"auto",display:"block",width:"100%",margin:"30px 0px 30px"}}),a.jsx("br",{}),a.jsx("div",{style:{fontSize:"1.2rem",marginBottom:150},children:"Stay tuned!"}),a.jsx("br",{}),a.jsx(N,{})]})})}function _({children:c}){const i=t.useContext(m),{authLoaded:n,isLoggedIn:s,user:x}=t.useContext(F),{profile:b}=t.useContext(m),[u,h]=t.useState(null),[g,y]=t.useState(!1),R=t.useCallback(async l=>{if(u||!s)return"error";try{const e=Object.fromEntries(Object.entries(l||{}).filter(([,r])=>r!==void 0));e.pots=(e.pots||[]).reduce((r,d)=>{const f=r.find($=>$.itemId===d.itemId);return f?f.tickets=(f.tickets||0)+(d.tickets||0):r.push({...d}),r},[]),e.createdAt||(e.createdAt=A().toISOString()),e.updatedAt=A().toISOString(),e.raflYear=2026;const o=await M(W(p,"raffle-entries"),e);return console.log("Created Raffle Entry",e),o.id}catch(e){throw console.error("Error creating raffle entry:",e),e}},[u,s]),[D,I]=t.useState({}),[j,B]=t.useState(!1);t.useEffect(()=>{const l=C(p,"data-cache","raffle-entries-summary"),e=L(l,o=>{const r=o.exists()?o.data():null;I(r||{}),B(!0),y(!0)},o=>{console.error("Error listening to DB:",o),h(!0),E("There was a problem reading raffle data. It will be unavailable until you refresh the page. ",{autoHideDuration:null,action:a.jsx(w,{color:"secondary",onClick:()=>location.reload(),children:"Refresh"})})});return()=>e()},[n,s,x]);const[S,P]=t.useState({}),[k,T]=t.useState(!1);t.useEffect(()=>{const l=C(p,"data-cache","raffle-winners"),e=L(l,o=>{const r=o.exists()?o.data():null;P(r||{}),T(!0),y(!0)},o=>{console.error("Error listening to DB:",o),h(!0),E("There was a problem reading raffle data. It will be unavailable until you refresh the page. ",{autoHideDuration:null,action:a.jsx(w,{color:"secondary",onClick:()=>location.reload(),children:"Refresh"})})});return()=>e()},[n,s,x]);const O=t.useMemo(()=>({...i,testEntry:J,createRaffleEntry:R,dbLoaded:g,profile:b,summaryData:D,summaryLoaded:j,winnerData:S,winnersLoaded:k,dbError:u}),[i,R,g,b,D,j,S,k,u]);return a.jsx(m.Provider,{value:O,children:c})}const J={platform:"Discord",username:"MacGuffin Security",belt:"Yellow",donations:[{amount:123,receipt:"https://lpubelts.com/",charity:{itemFullTitle:"American Humane",itemTitle:"American Humane",itemId:"ch_AmHum"}}],pots:[{tickets:123,itemFullTitle:"Pot 1 - $$$ of Locc",itemTitle:"$$$ of Locc",itemId:"2025-025",itemPotNumber:"1",itemIndex:0}],totalDonation:123,allocatedTickets:123,status:"pending",dev:!0,adminEntry:!0};function K(){const{raffleAdmin:c,raffleAdminRole:i,raflState:n}=t.useContext(v)}function ie(){return a.jsx(_,{children:a.jsxs(z,{children:[a.jsx(Y,{}),a.jsx(U,{}),a.jsx(K,{})]})})}export{ie as default};
