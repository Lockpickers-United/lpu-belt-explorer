import{Y as F,Z as L,$ as W,a0 as N,j as e,X as I,r as l,ad as M,a5 as O,R as P,U as w,W as T,bs as $,B as R,b as q,u as D,bL as V}from"./index-DmE7cyma.js";import{R as b}from"./RaffleContext-D-LR3Cxn.js";import{C as _}from"./Cached-DgJSficu.js";import{E as H}from"./ExpandMore-DCGl5fo-.js";import{C as Z,c as G}from"./CircularProgress-BAdgRuY6.js";import{n as U}from"./dataUrls-CThgH6Wi.js";import{a as J}from"./index-xsH4HHeE.js";import{B as z}from"./Box-DY3mJfwK.js";import{A as X,a as Y,b as K}from"./AccordionSummary-BNszCNOX.js";var C={},A;function Q(){if(A)return C;A=1;var t=F();Object.defineProperty(C,"__esModule",{value:!0}),C.default=void 0;var n=t(L()),s=W();return C.default=(0,n.default)((0,s.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility"),C}var ee=Q();const k=N(ee);function te({diameter:t=40}){return e.jsx("div",{style:{display:"flex",placeItems:"center",justifyContent:"center",width:t,height:t},children:e.jsx(Z,{variant:"indeterminate",disableShrink:!0,sx:{color:n=>(n.palette.mode==="light","#fff"),animationDuration:"550ms",[`& .${G.circle}`]:{strokeLinecap:"round"}},size:18,thickness:5})})}const se=(t,n)=>{const[s,r]=t.split("#"),c=s.includes("?")?"&":"?";return`${s}${c}${n}${r?"#"+r:""}`},re=async({user:t,url:n,formData:s,json:r,snackBars:c,timeoutDuration:f=15e3})=>{var g,y,v,j,E,S;const o=new AbortController,u=setTimeout(()=>{o.abort()},f),x=Math.floor(Math.random()*1e6),h=t?await t.getIdToken():null,i=r!==void 0&&s===void 0,d={...h&&{Authorization:`Bearer ${h}`}},m=i?r:s;let a=m;try{typeof FormData<"u"&&m instanceof FormData&&(a=Object.fromEntries(m.entries()))}catch{}try{const p=await J.get(se(n,x),{headers:d,signal:o.signal,params:a});return clearTimeout(u),p.data}catch(p){clearTimeout(u);const B=p.name==="CanceledError"||p.code==="ERR_CANCELED"||((g=p.message)==null?void 0:g.includes("aborted"))?"Request timed out. Please try again.":((j=(v=(y=p.response)==null?void 0:y.data)==null?void 0:v.error)==null?void 0:j.message)||((S=(E=p.response)==null?void 0:E.data)==null?void 0:S.message)||p.message||"Error during authentication or server request";throw{...p,message:B}}};function ie({refresh:t,page:n}){const[s,r]=l.useState(!1),[c,f]=l.useState(""),[o,u]=l.useState(!1),{preview:x,setPreview:h}=l.useContext(b),[i,d]=M(),m=i.has("preview"),a=x||m,g=l.useCallback(async()=>{const E=`${U}/refresh-preview`;try{r(!0);const S=await re({url:E,snackBars:!1,timeoutDuration:3e4});I("Request successful",{variant:"success"}),f(S)}catch(S){I(`Error creating request: ${S.message}`,{variant:"error",autoHideDuration:3e3})}finally{r(!1)}await t()},[t]),y=l.useRef(null),v=l.useCallback(()=>{m?(i.delete("preview"),d(i),h(!1)):h(!x)},[x,m,i,h,d]);O("p",()=>v(),{preventDefault:!0});const j=a?"#983de6":"#fff";return e.jsxs(P.Fragment,{children:[n!=="pots"?e.jsx(z,{ref:y,style:{display:"flex",alignItems:"center",overflow:"hidden"},children:e.jsx(w,{style:{padding:8},disabled:!0,children:e.jsx(k,{style:{color:j,opacity:.5},fontSize:"small"})})}):e.jsx(z,{ref:y,style:{display:"flex",alignItems:"center",overflow:"hidden"},children:a?e.jsx($,{in:a,direction:"left",appear:!1,children:e.jsxs("div",{style:{display:"flex",flexGrow:1,marginRight:0},children:[e.jsx(R,{onClick:v,style:{padding:"0px 8px 0px 0px",marginRight:0,color:"#8830d3",fontSize:"1.0rem",lineHeight:"1.2rem",whiteSpace:"nowrap"},children:"PREVIEW MODE ON"}),s?e.jsx("div",{style:{marginRight:0},children:e.jsx(te,{diameter:36})}):e.jsx(T,{title:"Refresh From Sheet",arrow:!0,disableFocusListener:!0,children:e.jsx(w,{onClick:g,style:{marginRight:0},children:e.jsx(_,{fontSize:"small"})})}),e.jsx(w,{onClick:v,style:{padding:8},children:e.jsx(k,{style:{color:j},fontSize:"small"})})]})}):e.jsx(T,{title:"Toggle Preview Mode",arrow:!0,disableFocusListener:!0,children:e.jsx(w,{onClick:v,style:{padding:8},children:e.jsx(k,{style:{color:j},fontSize:"small"})})})}),(c==null?void 0:c.status)==="Errors"&&e.jsxs(X,{expanded:o,onChange:()=>u(!o),sx:{".MuiAccordionSummary-content":{margin:0}},children:[e.jsx(Y,{expandIcon:e.jsx(H,{}),style:{maxWidth:700,margin:"0px auto 10px auto",paddingLeft:20,fontWeight:700,fontSize:"1rem",backgroundColor:"#e34141"},children:"There were errors trying to import"}),e.jsx(K,{style:{maxWidth:700,margin:"20px auto 10px auto",padding:10,fontWeight:400,fontSize:"0.8rem",backgroundColor:"#e34141",display:"flex",alignItems:"center"},children:e.jsx("pre",{children:JSON.stringify(c,null,2)})})]})]})}function ne({page:t,width:n=700}){const{preview:s,setPreview:r,refresh:c}=l.useContext(b),[f,o]=M(),u=f.has("preview"),x=s||u,h=q(),{setAnimateTotal:i}=l.useContext(b),d=l.useCallback(j=>{h(j),i(!1)},[h,i]),m=l.useCallback(()=>{x&&t==="pots"&&(f.delete("preview"),o(f),r(!1))},[t,f,r,o,x]),{isMobile:a}=D(),g=a?"1.0rem":"1.03rem",y=!s||t!=="pots"||!a,v={maxWidth:n,marginLeft:"auto",marginRight:"auto",display:"flex",alignItems:"center",height:40};return e.jsxs(P.Fragment,{children:[e.jsxs("div",{style:v,children:[e.jsx(w,{style:{padding:4},onClick:m,disabled:t!=="pots",children:e.jsx(V,{fontSize:"medium",style:{color:"#4c82fd"}})}),y&&e.jsxs(P.Fragment,{children:[e.jsx(R,{onClick:()=>d("/rafl/admin"),style:{padding:"0px 8px",marginRight:10,marginLeft:10,color:t==="entries"?"#48adf1":"#ccc",fontSize:g},sx:{":hover":{bgcolor:"#333",color:"#fff"}},disabled:t==="entries",children:"ENTRIES"}),e.jsx(R,{onClick:()=>d("/rafl/reports"),style:{padding:"0px 8px",marginRight:10,color:t==="reports"?"#48adf1":"#ccc",fontSize:g},sx:{":hover":{bgcolor:"#333",color:"#fff"}},disabled:t==="reports",children:"REPORTS"})]}),e.jsx("div",{style:{display:"flex",flexGrow:1,justifyContent:"right"},children:e.jsx(ie,{page:t,refresh:c})})]}),e.jsx("div",{style:{height:2}})]})}function pe({page:t,width:n=700}){const{raflState:s,raffleAdminRole:r}=l.useContext(b),c=q(),{setAnimateTotal:f}=l.useContext(b),o=l.useCallback(y=>{c(y),f(!1)},[c,f]),{isMobile:u,flexStyle:x}=D(),h=u?0:4,i=u?"1.0rem":"1.03rem",d=u?3:10,m={maxWidth:n,marginLeft:"auto",marginRight:"auto",marginTop:10,padding:"0px 0px 0px 0px",fontWeight:700,display:x};let a=s!=="preview"||r||u?"PRIZES":"PRIZE PREVIEW";a=["hidden","post"].includes(s)?a.replace("PRIZES","2026 PRIZES"):a;const g=s==="live"||r?"ENTER":"INFO";return e.jsxs(P.Fragment,{children:[e.jsxs("div",{style:m,children:[e.jsx("div",{style:{flexGrow:1,fontSize:"1.7rem",marginTop:0},children:"LPU Annual Raffle"}),e.jsxs("div",{style:{marginTop:h,justifyItems:"right"},children:[e.jsx("div",{style:{flexGrow:1}}),e.jsx(R,{onClick:()=>o("/rafl"),style:{marginRight:d,color:t==="pots"?"#fff":"#ccc",fontSize:i},disabled:t==="pots",children:a}),s==="preview"&&!r&&e.jsx(R,{onClick:()=>o("/rafl/announce"),style:{marginRight:d,color:t==="announce"?"#fff":"#ccc",fontSize:i},disabled:t==="announce",children:"CONTRIBUTE"}),(s!=="hidden"||r)&&e.jsx(R,{onClick:()=>o("/rafl/charities"),style:{marginRight:d,color:t==="charities"?"#fff":"#ccc",fontSize:i},disabled:t==="charities",children:"CHARITIES"}),(["preview","live","post"].includes(s)||r)&&e.jsx(R,{onClick:()=>o("/rafl/enter"),style:{marginRight:0,color:t==="enter"?"#fff":"#ccc",fontSize:i},children:g}),(["live","post"].includes(s)||r)&&e.jsx(R,{onClick:()=>o("/rafl/stats"),style:{marginLeft:d,color:t==="stats"?"#fff":"#ccc",fontSize:i},children:"STATS"})]})]}),r&&e.jsx(ne,{page:t,width:n}),e.jsx("div",{style:{height:8}})]})}export{pe as R};
