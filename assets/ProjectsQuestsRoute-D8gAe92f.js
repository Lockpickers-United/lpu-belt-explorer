import{d as h,r as s,F as S,j as e,R as z,au as k,W as F,U as T,u as A,N as B,h as Y,T as I,D as W,e as O}from"./index-DEGBTbGQ.js";import{p as R}from"./filterFields-BdSagfMs.js";import{u as L}from"./usePageTitle-D2phylvE.js";import{D as P}from"./DataContext-BFjPc8m3.js";import{r as V}from"./index-ZxkTfsrQ.js";import{u as Q}from"./useData-B813F0fb.js";import{a as _}from"./dataUrls-DVxTtpO-.js";import{f as G}from"./filterEntriesAdvanced-CqSR_p37.js";import{e as H}from"./entryName-O7o5a_nG.js";import{s as E}from"./searchEntriesForText-DIG3XL83.js";import{D as U}from"./DataTableSort-rAE532d0.js";import{E as q}from"./ExportButton-BOAbv8nn.js";import{S as J}from"./SearchBox-CIk5tP7J.js";import{V as K}from"./ViewFilterButtons-D8j2oFqA.js";import{p as X}from"./sortFields-UrZb0N2z.js";import{A as Z}from"./AdvancedFilters-DCjnvmTC.js";import{E as M,S as $,Y as ee,a as te}from"./ErrorOutline-Cmf6E5Nn.js";import{P as re}from"./PhotoCamera-Df0e8-c-.js";import"./stringUtils-BsiQ3MZ5.js";import"./ArrowDropDown-B_FJmkkG.js";import"./TableRow-DCD-IS7p.js";import"./download-30_DJji1.js";import"./List-UsPdffG9.js";import"./ContentCopy-DbuFDjIm.js";import"./Search-DtNivRBU.js";import"./useFormControl-CC9E6W7B.js";import"./Select-rOK7jhVf.js";import"./Sort-CMCZG88_.js";import"./TextField-Y4UikRVS.js";import"./FilterAlt-B8Qq_w-f.js";import"./HighlightOff-CHje_O3u.js";import"./Box-Dqd26gZC.js";import"./LockListContext-CxgFNcEw.js";import"./ToggleButtonGroup-Bm83KcTD.js";import"./setDeep-J6HEwWhX.js";import"./AddCircle-DbKZcz1f.js";import"./Cancel-BT6GqgPp.js";import"./ChoiceButtonGroup-y64yV99h.js";import"./Collapse-Bah4cV6D.js";function oe({children:t,profile:x}){var b;const{data:i,loading:j,error:n,_errorMessage:g}=Q({urls:se}),d=h((b=i==null?void 0:i.metadata)==null?void 0:b.updatedDateTime).format("MM/DD/YY HH:mm"),{filters:D,advancedFilterGroups:w}=s.useContext(S),{search:v,sort:l,expandAll:y}=D,a=s.useMemo(()=>{var r;return i&&!j&&!n?(r=i==null?void 0:i.allProjectsEvidence)==null?void 0:r.evidence:[]},[i,n,j]),u=s.useMemo(()=>a==null?void 0:a.map(r=>{let f;try{f=new URL(r.evidenceUrl).hostname}catch{}return{...r,pickerName:r.displayName||r.tabName,tierName:ie[r.tier],dateText:h(r.date).format("MM/DD/YY"),source:r.unclaimed?"Dan Sheet":"Scorecard",envidenceHost:f,fuzzy:V([H(r,"long")].concat([r.discipline,r.displayName,r.tabName]).join(",")),score:1}}),[a]),p=E(v,[...u]),c=s.useMemo(()=>{const r=G({advancedFilterGroups:w(),entries:u}),f=E(v,[...r]);return l?f.sort((o,m)=>{if(l==="popularity")return m.collectionSaves-o.collectionSaves||m.views-o.views||o.fuzzy.localeCompare(m.fuzzy);if(l==="alphaAscending")return o.fuzzy.localeCompare(m.fuzzy);if(l==="alphaDescending")return m.fuzzy.localeCompare(o.fuzzy);if(l==="recentlyUpdated")return Math.floor(h(m.lastUpdated).valueOf()/3600)-Math.floor(h(o.lastUpdated).valueOf()/3600)||o.fuzzy.localeCompare(m.fuzzy);if(l==="dateAdded")return Math.floor(h(m.dateAdded).valueOf()/3600*24)-Math.floor(h(o.dateAdded).valueOf()/3600*24)||o.fuzzy.localeCompare(m.fuzzy)}):f},[w,u,v,l]),C=s.useCallback(r=>a.find(f=>f.id===r),[a]),N=s.useMemo(()=>({allEntries:a,mappedEntries:u,visibleEntries:c,searchedEntries:p,getEntryFromId:C,expandAll:y,profile:x,updateTime:d}),[a,u,c,p,C,y,x,d]);return e.jsx(P.Provider,{value:N,children:t})}const se={allProjectsEvidence:_},ie={T1:"Tier 1",T2:"Tier 2",T3:"Tier 3",T4:"Tier 4",T5:"Tier 5"};function ae({evidenceUrl:t,handleChange:x=()=>{},owner:i=!1}){const j=s.useCallback(g=>{g.preventDefault(),g.stopPropagation();const d=window.open(t,"_blank","noopener,noreferrer");d&&(d.opener=null)},[t]);let n=e.jsx($,{style:{width:20,height:20}});return t.match(/(https|http):\/\/.*(youtu.be|youtube.com)/)?n=e.jsx(ee,{style:{width:20,height:20}}):t.match(/(https|http):\/\/.*discord.com/)?n=e.jsx(te,{style:{width:20,height:20}}):t.match(/(https|http):\/\/.*imgur.com/)&&(n=e.jsx(re,{style:{width:20,height:20}})),e.jsxs(z.Fragment,{children:[k(t)&&e.jsx(F,{title:"View Documentation",arrow:!0,disableFocusListener:!0,children:e.jsx(T,{style:{width:40,height:40},onClick:j,children:n})}),!!t&&!k(t)&&e.jsx(F,{title:"Documentation link is not valid",arrow:!0,disableFocusListener:!0,children:e.jsx(T,{style:{width:40,height:40},onClick:x,children:e.jsx(M,{style:{width:22,height:22,color:"#c07b32"}})})}),!t&&e.jsx(F,{title:"Documentation link is missing",arrow:!0,disableFocusListener:!0,children:e.jsx(T,{style:{width:40,height:40},onClick:x,children:e.jsx(M,{style:{width:22,height:22,color:"#e55940"}})})})]})}function ne(){const{visibleEntries:t=[],expandAll:x,updateTime:i}=s.useContext(P),{isMobile:j}=A(),n=s.useCallback(p=>{const c=window.open(p,"_blank","noopener,noreferrer");c&&(c.opener=null)},[]),g=[...t],d=[{id:"pickerName",align:"left",name:"Picker Name"},{id:"discipline",align:"left",name:"Discipline"},{id:"tier",align:"left",name:"Tier"},{id:"date",align:"left",name:"Date"},{id:"source",align:"left",name:"Source"},{id:"evidenceUrl",align:"center",name:"Evidence"}],D="pickerName",w="100%",v={columns:d,rows:g,defaultSort:D,sortable:!0,wrap:!1},l=s.useCallback((p,c)=>p==="evidenceUrl"?e.jsx(ae,{evidenceUrl:c}):p==="date"?h(c).format("MM/DD/YY"):c,[n,t]),y=e.jsxs(z.Fragment,{children:[e.jsx(J,{label:"Projects",extraFilters:[{key:"tab",value:"search"}],keepOpen:!1,entryCount:t.length}),e.jsx(K,{sortValues:X,advancedEnabled:!0,extraFilters:[],entryType:"Project",compactMode:!1,resetAll:!0,expandAll:!1}),!j&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}})]}),a=e.jsx("div",{style:{margin:"30px 0px"},children:e.jsx(q,{text:!0,entries:t,advancedEnabled:!0})}),u={maxWidth:700,marginLeft:"auto",marginRight:"auto"};return e.jsxs(z.Fragment,{children:[e.jsx(B,{title:"Projects",extras:y}),e.jsxs("div",{style:{margin:8,paddingBottom:32},children:[e.jsx(Z,{}),e.jsx("div",{style:u,children:e.jsx(U,{tableData:v,tableWidth:w,linkFunction:l})})]}),e.jsx(Y,{extras:void 0,before:a}),e.jsx(I,{feature:"projectsQuests"})]})}function Ue(){const{lockCollection:t}=s.useContext(W);return L("Projects & Quests"),e.jsx(O,{filterFields:R,children:e.jsx(oe,{profile:t,children:e.jsx(ne,{})})})}export{Ue as default};
