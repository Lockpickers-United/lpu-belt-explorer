import{r as o,K as E,j as e,J as N,I as B,A,D as R,u as G,B as T,aI as $,R as W,ad as P,ae as y,ao as w,Y as L}from"./index-SGUxfkCZ.js";import{L as V}from"./Link-DURFVmPo.js";import{e as z}from"./entryName-DqLFbWtk.js";import{C as J}from"./Cancel-BE6Y-Dxs.js";import{D as K}from"./Dialog-CKjQxueJ.js";import{s as U}from"./sanitizeValues-BITs4wJZ.js";import{T as _}from"./TextField-Ckv6-ANX.js";import{L as I}from"./Link-B9O0UkTh.js";import{M as q}from"./index-BmBKoEz1.js";import{r as H}from"./index-06clRrn7.js";import{r as Y}from"./index-j_oQhzSx.js";import{d as M,F as D,C as Q}from"./download-Bq0cxwn4.js";import{L as X}from"./List-s1SNimrE.js";import{D as Z}from"./DataContext-CG8N2kpO.js";import"./index-DolXW4_-.js";import{C as ee}from"./ContentCopy-BcjtugCk.js";function ge({entry:s,nameType:u}){const r=o.useCallback(async()=>{const t=z(s,u).replace(/[\s/]/g,"_").replace(/\W/g,""),a=`https://share.lpubelts.com/?id=${s.id}&name=${t}`;await navigator.clipboard.writeText(a),E("Link to entry copied to clipboard.")},[s,u]);return e.jsx(N,{title:"Copy Link to Entry",arrow:!0,disableFocusListener:!0,children:e.jsx(B,{onClick:r,children:e.jsx(V,{})})})}function oe({dialogContent:s,open:u,handleClose:r,width:h=350}){return e.jsxs(K,{open:u,onClose:r,sx:{".MuiDialog-paper":{backgroundColor:"transparent",backgroundImage:"none",padding:"12px",margin:"0px 0px 20px 0px",width:h}},children:[e.jsx("div",{style:{display:"flex",flexGrow:1,justifyContent:"flex-end",marginBottom:-15,marginRight:-10},children:e.jsx(B,{style:{padding:0,color:"#eee",backgroundColor:"#333"},onClick:r,children:e.jsx(J,{})})}),e.jsx("div",{style:{backgroundColor:"#666",borderRadius:4,boxShadow:"0px 11px 15px -7px rgba(0,0,0,0.2),0px 24px 38px 3px rgba(0,0,0,0.14),0px 9px 46px 8px rgba(0,0,0,0.12)"},children:s})]})}function Ce({entry:s}){const{isLoggedIn:u}=o.useContext(A),{userLockNotes:r,updateProfileField:h}=o.useContext(R),t=r[s.id]||"",a=o.useCallback(async j=>{await h("userLockNotes",j),C(!1)},[h]),[c,C]=o.useState(!1),d=o.useCallback(()=>{C(!0)},[]),p=o.useCallback(()=>{C(!1),k(t)},[t]),[f,k]=o.useState(t);o.useEffect(()=>{k(t||"")},[t]);const x=j=>{k(U(j.target.value,{profanityOK:!0,urlsOK:!0}))},b=o.useCallback(async()=>{const j={...r,[s.id]:f||""};await a(j).catch(S=>{console.error("Error updating notes:",S)}),p()},[r,s.id,f,a,p]),n=o.useCallback(async()=>{const j={...r};delete j[s.id],await a(j).catch(S=>{console.error("Error removing notes:",S)}),p()},[s.id,p,a,r]),{isMobile:m}=G(),v={fontSize:"1.0rem",fontWeight:400,marginBottom:5,paddingLeft:2,color:"#fff"},l=m?"0.85rem":"0.9rem",i=m?5:8,g=t.split(`
`).length,F=g>i?Math.min(g,12):i,O=e.jsx("div",{style:{display:"flex"},children:u?e.jsxs("div",{style:{flexGrow:1,maxWidth:550,padding:10},children:[e.jsxs("div",{style:{marginTop:10,display:"flex"},children:[e.jsx("div",{style:{...v,flexGrow:1,fontWeight:700},children:"My Notes"}),e.jsxs("div",{style:{...v,color:"#aaa",fontSize:"0.85rem"},children:[f.length||0,"/1200"]})]}),e.jsx(_,{type:"text",name:"notes",multiline:!0,fullWidth:!0,rows:F,value:f,onChange:x,id:"notes",color:"info",style:{},placeholder:"Add your own personal notes about this lock",variant:"outlined",autoFocus:!0,inputProps:{maxLength:1200,style:{fontSize:l}}}),e.jsxs("div",{style:{flexGrow:1,textAlign:"right",marginTop:8},children:[e.jsx(T,{variant:"text",size:"small",onClick:p,children:"Cancel"}),e.jsx(T,{variant:"text",size:"small",onClick:b,color:"success",children:"Save"})]})]}):e.jsxs("div",{style:{flexGrow:1,padding:"40px 20px",placeItems:"center"},children:[e.jsxs("div",{style:{...v,marginBottom:15,fontWeight:700,textAlign:"center"},children:["Please sign in to add your",e.jsx("br",{}),"own notes for locks."]}),e.jsx("div",{style:{width:210},children:e.jsx($,{onClick:p})})]})});return e.jsxs(W.Fragment,{children:[(t==null?void 0:t.length)>0?e.jsxs("div",{style:{fontWeight:700,marginTop:15},children:[e.jsxs("div",{style:{display:"flex"},children:[e.jsx("span",{style:{marginTop:-.6},children:"My notes  "}),e.jsx(I,{style:{fontWeight:400,color:"#2bb259"},onClick:d,children:"edit"})," • ",e.jsx(I,{style:{fontWeight:400,color:"#2bb259"},onClick:n,children:"remove"})]}),e.jsx("div",{style:{fontSize:l,marginLeft:10,marginBottom:25,fontWeight:400},children:e.jsx(q,{remarkPlugins:[Y],rehypePlugins:[[H,{target:"_blank",rel:["nofollow","noopener","noreferrer"]}]],children:t})})]}):e.jsx("div",{style:{fontWeight:700,marginTop:15},children:e.jsx(I,{style:{fontWeight:600,color:"#2bb259",textDecoration:"none",cursor:"pointer"},onClick:d,children:"Add your personal notes"})}),e.jsx(oe,{dialogContent:O,open:c,handleClose:p,width:m?350:550})]})}function ke({text:s,entries:u}){const[r,h]=o.useState(null),t=!!r,a=o.useCallback(x=>h(x.currentTarget),[]),c=o.useCallback(()=>h(null),[]),{visibleEntries:C}=o.useContext(Z),d=u||C,p=o.useCallback(()=>{const x=JSON.stringify(d);c(),M("lpubeltsData.json",x),E("Current lock entries downloaded as lpubeltsData.json")},[c,d]),f=o.useCallback(()=>{const b=d.map(n=>({id:n.id,make:n.makeModels.map(m=>m.make).join(","),model:n.makeModels.map(m=>m.model).join(","),version:n.version,belt:n.belt,name:z(n),versionText:n.version?" ("+n.version+")":""})).map(n=>"* "+n.name+n.versionText).join(`
`);c(),navigator.clipboard.writeText(b).then(),E("Current lock entries copied to clipboard.")},[c,d]),k=o.useCallback(()=>{const x=["id","name","version","belt","notes"],b=d.map(l=>({id:l.id,make:l.makeModels.map(i=>i.make).join(","),model:l.makeModels.map(i=>i.model).join(","),version:l.version,belt:l.belt,name:z(l),notes:l.personalNotes})),n=x.join(","),m=b.map(l=>x.map(i=>l[i]).map(i=>{const g=`${i??""}`.replace(/"/g,'""');return/(\s|,|")/.test(g)?`"${g}"`:g}).join(",")).join(`
`),v=`${n}
${m}`;c(),M("lpubeltsData.csv",v),E("Current lock entries downloaded as lpubeltsData.csv")},[c,d]);return e.jsxs(W.Fragment,{children:[s?e.jsx(N,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(T,{variant:"outlined",size:"small",onClick:a,style:{color:"#ddd",borderColor:"#aaa"},startIcon:e.jsx(D,{}),children:"Export"})}):e.jsx(N,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(B,{onClick:a,children:e.jsx(D,{})})}),e.jsxs(P,{anchorEl:r,open:t,onClose:c,children:[!s&&e.jsxs(y,{disabled:!0,children:[e.jsx(w,{children:e.jsx(D,{fontSize:"small"})}),e.jsx(L,{children:"Export"})]}),e.jsxs(y,{onClick:f,children:[e.jsx(w,{children:e.jsx(ee,{fontSize:"small"})}),e.jsx(L,{children:"Copy to clipboard"})]}),e.jsxs(y,{onClick:k,children:[e.jsx(w,{children:e.jsx(X,{fontSize:"small"})}),e.jsx(L,{children:"CSV"})]}),e.jsxs(y,{onClick:p,children:[e.jsx(w,{children:e.jsx(Q,{fontSize:"small"})}),e.jsx(L,{children:"JSON"})]})]})]})}export{ge as C,ke as E,Ce as a};
