import{aK as q,aL as Z,u as W,r as a,au as ge,j as e,R as J,aa as fe,D as je,d as be,B as P,T as ke,bE as ve,e as ye,a0 as Ne,N as Ce}from"./index-dd1f1d8b.js";import{I as Ie}from"./IntroCopy-1280a23f.js";import{u as Se}from"./usePageTitle-ff8ed586.js";import{d as Ae}from"./Search-ba60e8be.js";import{e as _}from"./entryName-f3f6570c.js";import{B as Le}from"./BeltStripeMini-d5867d47.js";import{A as Oe}from"./Autocomplete-01a209a1.js";import{T as B}from"./TextField-d80edfc1.js";import{I as Ue}from"./InputAdornment-85da5fc0.js";import{B as Ee}from"./BeltIcon-d716e27b.js";import{D as Re}from"./Dropzone-4b6f28ed.js";import{L as we}from"./LoadingDisplay-2f23ac99.js";import{D as Be}from"./DataContext-716d59db.js";import"./index-0cc5349a.js";import{p as De,c as Pe}from"./postData-75f65832.js";import{C as Te}from"./Checkbox-5f88eaa7.js";import{C as We}from"./Collapse-803332eb.js";import{I as $e,a as Fe}from"./ImageListItem-b4905790.js";import{D as T}from"./Dialog-54eb83aa.js";import{D as ze}from"./LockDataProvider-07539b1f.js";import"./index-a912cd82.js";import"./index-9216d467.js";import"./index-111dda3d.js";import"./Link-b2500588.js";import"./useDocumentTitle-eaa040f5.js";import"./Select-c2d1b790.js";import"./Chip-8e6995f2.js";import"./index-8e209fb8.js";import"./Cancel-3afb0673.js";import"./Box-86badff5.js";import"./CircularProgress-c9af6e94.js";import"./axios-439bb627.js";import"./collectionStatsById-8def94ca.js";var Q={exports:{}};(function(r,p){(function(g,h){r.exports=h()})(q,()=>{return g={705:o=>{o.exports=function(n,i){const l=[];return i.length===0?l.push({text:n,highlight:!1}):i[0][0]>0&&l.push({text:n.slice(0,i[0][0]),highlight:!1}),i.forEach((d,f)=>{const v=d[0],b=d[1];l.push({text:n.slice(v,b),highlight:!0}),f===i.length-1?b<n.length&&l.push({text:n.slice(b,n.length),highlight:!1}):b<i[f+1][0]&&l.push({text:n.slice(b,i[f+1][0]),highlight:!1})}),l}}},h={},function o(n){var i=h[n];if(i!==void 0)return i.exports;var l=h[n]={exports:{}};return g[n](l,l.exports,o),l.exports}(705);var g,h})})(Q);var Me=Q.exports;const Ye=Z(Me);var V={exports:{}};(function(r,p){(function(g,h){r.exports=h()})(q,()=>{return g={772:(o,n,i)=>{const l=i(826).remove,d=/[.*+?^${}()|[\]\\]/g,f=/[a-z0-9_]/i,v=/\s+/;o.exports=function(b,O,L){var m,U;U={insideWords:!1,findAllOccurrences:!1,requireMatchAll:!1},m=(m=L)||{},Object.keys(m).forEach(s=>{U[s]=!!m[s]}),L=U;const C=Array.from(b).map(s=>l(s));let t=C.join("");return(O=l(O)).trim().split(v).filter(s=>s.length>0).reduce((s,y)=>{const x=y.length,k=!L.insideWords&&f.test(y[0])?"\\b":"",I=new RegExp(k+y.replace(d,"\\$&"),"i");let j,u;if(j=I.exec(t),L.requireMatchAll&&j===null)return t="",[];for(;j;){u=j.index;const E=x-C.slice(u,u+x).join("").length,R=u-C.slice(0,u).join("").length,N=[u+R,u+x+R+E];if(N[0]!==N[1]&&s.push(N),t=t.slice(0,u)+new Array(x+1).join(" ")+t.slice(u+x),!L.findAllOccurrences)break;j=I.exec(t)}return s},[]).sort((s,y)=>s[0]-y[0])}},826:o=>{var n={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",Ấ:"A",Ắ:"A",Ẳ:"A",Ẵ:"A",Ặ:"A",Æ:"AE",Ầ:"A",Ằ:"A",Ȃ:"A",Ç:"C",Ḉ:"C",È:"E",É:"E",Ê:"E",Ë:"E",Ế:"E",Ḗ:"E",Ề:"E",Ḕ:"E",Ḝ:"E",Ȇ:"E",Ì:"I",Í:"I",Î:"I",Ï:"I",Ḯ:"I",Ȋ:"I",Ð:"D",Ñ:"N",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",Ố:"O",Ṍ:"O",Ṓ:"O",Ȏ:"O",Ù:"U",Ú:"U",Û:"U",Ü:"U",Ý:"Y",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",ấ:"a",ắ:"a",ẳ:"a",ẵ:"a",ặ:"a",æ:"ae",ầ:"a",ằ:"a",ȃ:"a",ç:"c",ḉ:"c",è:"e",é:"e",ê:"e",ë:"e",ế:"e",ḗ:"e",ề:"e",ḕ:"e",ḝ:"e",ȇ:"e",ì:"i",í:"i",î:"i",ï:"i",ḯ:"i",ȋ:"i",ð:"d",ñ:"n",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",ố:"o",ṍ:"o",ṓ:"o",ȏ:"o",ù:"u",ú:"u",û:"u",ü:"u",ý:"y",ÿ:"y",Ā:"A",ā:"a",Ă:"A",ă:"a",Ą:"A",ą:"a",Ć:"C",ć:"c",Ĉ:"C",ĉ:"c",Ċ:"C",ċ:"c",Č:"C",č:"c",C̆:"C",c̆:"c",Ď:"D",ď:"d",Đ:"D",đ:"d",Ē:"E",ē:"e",Ĕ:"E",ĕ:"e",Ė:"E",ė:"e",Ę:"E",ę:"e",Ě:"E",ě:"e",Ĝ:"G",Ǵ:"G",ĝ:"g",ǵ:"g",Ğ:"G",ğ:"g",Ġ:"G",ġ:"g",Ģ:"G",ģ:"g",Ĥ:"H",ĥ:"h",Ħ:"H",ħ:"h",Ḫ:"H",ḫ:"h",Ĩ:"I",ĩ:"i",Ī:"I",ī:"i",Ĭ:"I",ĭ:"i",Į:"I",į:"i",İ:"I",ı:"i",Ĳ:"IJ",ĳ:"ij",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",Ḱ:"K",ḱ:"k",K̆:"K",k̆:"k",Ĺ:"L",ĺ:"l",Ļ:"L",ļ:"l",Ľ:"L",ľ:"l",Ŀ:"L",ŀ:"l",Ł:"l",ł:"l",Ḿ:"M",ḿ:"m",M̆:"M",m̆:"m",Ń:"N",ń:"n",Ņ:"N",ņ:"n",Ň:"N",ň:"n",ŉ:"n",N̆:"N",n̆:"n",Ō:"O",ō:"o",Ŏ:"O",ŏ:"o",Ő:"O",ő:"o",Œ:"OE",œ:"oe",P̆:"P",p̆:"p",Ŕ:"R",ŕ:"r",Ŗ:"R",ŗ:"r",Ř:"R",ř:"r",R̆:"R",r̆:"r",Ȓ:"R",ȓ:"r",Ś:"S",ś:"s",Ŝ:"S",ŝ:"s",Ş:"S",Ș:"S",ș:"s",ş:"s",Š:"S",š:"s",Ţ:"T",ţ:"t",ț:"t",Ț:"T",Ť:"T",ť:"t",Ŧ:"T",ŧ:"t",T̆:"T",t̆:"t",Ũ:"U",ũ:"u",Ū:"U",ū:"u",Ŭ:"U",ŭ:"u",Ů:"U",ů:"u",Ű:"U",ű:"u",Ų:"U",ų:"u",Ȗ:"U",ȗ:"u",V̆:"V",v̆:"v",Ŵ:"W",ŵ:"w",Ẃ:"W",ẃ:"w",X̆:"X",x̆:"x",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Y̆:"Y",y̆:"y",Ź:"Z",ź:"z",Ż:"Z",ż:"z",Ž:"Z",ž:"z",ſ:"s",ƒ:"f",Ơ:"O",ơ:"o",Ư:"U",ư:"u",Ǎ:"A",ǎ:"a",Ǐ:"I",ǐ:"i",Ǒ:"O",ǒ:"o",Ǔ:"U",ǔ:"u",Ǖ:"U",ǖ:"u",Ǘ:"U",ǘ:"u",Ǚ:"U",ǚ:"u",Ǜ:"U",ǜ:"u",Ứ:"U",ứ:"u",Ṹ:"U",ṹ:"u",Ǻ:"A",ǻ:"a",Ǽ:"AE",ǽ:"ae",Ǿ:"O",ǿ:"o",Þ:"TH",þ:"th",Ṕ:"P",ṕ:"p",Ṥ:"S",ṥ:"s",X́:"X",x́:"x",Ѓ:"Г",ѓ:"г",Ќ:"К",ќ:"к",A̋:"A",a̋:"a",E̋:"E",e̋:"e",I̋:"I",i̋:"i",Ǹ:"N",ǹ:"n",Ồ:"O",ồ:"o",Ṑ:"O",ṑ:"o",Ừ:"U",ừ:"u",Ẁ:"W",ẁ:"w",Ỳ:"Y",ỳ:"y",Ȁ:"A",ȁ:"a",Ȅ:"E",ȅ:"e",Ȉ:"I",ȉ:"i",Ȍ:"O",ȍ:"o",Ȑ:"R",ȑ:"r",Ȕ:"U",ȕ:"u",B̌:"B",b̌:"b",Č̣:"C",č̣:"c",Ê̌:"E",ê̌:"e",F̌:"F",f̌:"f",Ǧ:"G",ǧ:"g",Ȟ:"H",ȟ:"h",J̌:"J",ǰ:"j",Ǩ:"K",ǩ:"k",M̌:"M",m̌:"m",P̌:"P",p̌:"p",Q̌:"Q",q̌:"q",Ř̩:"R",ř̩:"r",Ṧ:"S",ṧ:"s",V̌:"V",v̌:"v",W̌:"W",w̌:"w",X̌:"X",x̌:"x",Y̌:"Y",y̌:"y",A̧:"A",a̧:"a",B̧:"B",b̧:"b",Ḑ:"D",ḑ:"d",Ȩ:"E",ȩ:"e",Ɛ̧:"E",ɛ̧:"e",Ḩ:"H",ḩ:"h",I̧:"I",i̧:"i",Ɨ̧:"I",ɨ̧:"i",M̧:"M",m̧:"m",O̧:"O",o̧:"o",Q̧:"Q",q̧:"q",U̧:"U",u̧:"u",X̧:"X",x̧:"x",Z̧:"Z",z̧:"z"},i=Object.keys(n).join("|"),l=new RegExp(i,"g"),d=new RegExp(i,""),f=function(v){return v.replace(l,function(b){return n[b]})};o.exports=f,o.exports.has=function(v){return!!v.match(d)},o.exports.remove=f}},h={},function o(n){var i=h[n];if(i!==void 0)return i.exports;var l=h[n]={exports:{}};return g[n](l,l.exports,o),l.exports}(772);var g,h})})(V);var He=V.exports;const Ge=Z(He);function Ke({handleChangeLock:r,allEntries:p,disabled:g,reset:h=!1}){const o={maxWidth:700},{isMobile:n}=W(),i=a.useRef(),l=a.useMemo(()=>{let t={},s={};return{allLocks:p==null?void 0:p.sort((x,k)=>{ge(x.belt,k.belt)||_(x,"short").localeCompare(_(k,"short"))}).reduce((x,k)=>{const I=k.version?" - "+k.version:"";return k.makeModels.map(j=>{const u=j.make?j.make:j.model,E=j.make?` ${j.model}`:"",R=`${u}${E}${I}`;x.push({id:k.id,lockName:R,make:u,model:E})}),x},[]).filter(x=>x),lockIds:t,lockNames:s}},[p]),{allLocks:d,lockIds:f,lockNames:v}=l,b=d.filter((t,s)=>d.findIndex(y=>y.lockName===t.lockName)!==s),O=d==null?void 0:d.map(t=>(t.lockName=b.find(s=>s.lockName===t.lockName)?t.lockName+` (${p.find(s=>s.id===t.id).belt})`:t.lockName,t)).map(t=>(f[t.lockName]=t.id,v[t.lockName]=`${t.make}${t.model}`,{label:t.lockName,belt:p.find(s=>s.id===t.id).belt})),L=a.useCallback((t,s)=>{s?O.includes(s.label)&&r({lockFullName:s.label,lockName:v[s.label],lockId:f[s.label]}):r({})},[f,v,O,r]),[m,U]=a.useState(!1),C=a.useCallback(()=>U(!1),[]);return e.jsxs(J.Fragment,{children:[e.jsx(Oe,{disabled:g,selectOnFocus:!0,clearOnEscape:!0,handleHomeEndKeys:!0,fullWidth:!0,style:o,options:O,onChange:L,renderInput:t=>e.jsx(B,{...t,placeholder:"Search Locks",variant:"standard",color:"info",inputRef:i,InputProps:{...t.InputProps,startAdornment:e.jsx(Ue,{position:"start",children:e.jsx(Ae,{})})}}),getOptionLabel:t=>t.label,renderOption:(t,s,{inputValue:y})=>{const{key:x,...k}=t,I=Ge(s.label,y,{insideWords:!0}),j=Ye(s.label,I);return e.jsxs("div",{...k,style:{...t.style,height:30,padding:0,textOverflow:"ellipsis"},children:[e.jsx(Le,{value:s.belt,style:{marginRight:10}}),j.map((u,E)=>e.jsx("span",{style:{fontWeight:u.highlight?700:400},children:u.text},E))]},x)}},h||g),e.jsx(fe,{invisible:!0,open:m&&n,onClick:C})]})}function Xe({profile:r,user:p}){var M,Y,H,G,K,X;const{allEntries:g}=a.useContext(Be),{updateProfileField:h}=a.useContext(je),[o,n]=a.useState({}),[i,l]=a.useState(void 0),[d,f]=a.useState([]),[v,b]=a.useState(void 0),[O,L]=a.useState(!1),[m,U]=a.useState(void 0),[C,t]=a.useState(!1),[s,y]=a.useState(""),[x,k]=a.useState(""),[I,j]=a.useState((r==null?void 0:r.photoCredit)||(r==null?void 0:r.displayName)||""),[u,E]=a.useState(!1),R=be().format("YYYYMMDD-HHMMss"),N=g.find(c=>c.id===(o==null?void 0:o.lockId)),ee=!!(o!=null&&o.lockName)&&!!(o!=null&&o.lockId)&&!!I&&d.length>0,$=`${o.lockName}_${o.lockId}_`.replace("/","+"),F=`${I}`.replace("/","+"),te=d.map(c=>c.name),se=d.length===1?"File":"Files",oe=async c=>{c.preventDefault(),L(!0);const S=`${R}_${$}_${F}`,A=new FormData;d.forEach(w=>{const{base:D,ext:xe}=_e(w.name);A.append("files",w,`${S}/${$}_${D}_${F}.${xe}`)}),A.append("droppedFileNames",te),A.append("lockFullName",o.lockFullName),A.append("lockName",o.lockName),A.append("version",N==null?void 0:N.version),A.append("belt",N==null?void 0:N.belt),A.append("lockId",o.lockId),A.append("photoCredit",I),A.append("displayName",r==null?void 0:r.displayName),A.append("uploadsDir",S),A.append("notes",x);const pe="https://explore.lpubelts.com:8443/upload",ue=!1,he=15e3;try{b(await De({user:p,url:pe,formData:A,snackBars:ue,timeoutDuration:he})),ae(I)}catch(w){U(Pe(w)),n([]),d.forEach(D=>URL.revokeObjectURL(D.preview)),f([])}finally{L(!1)}},ne=a.useCallback(c=>{n(c),l(g.find(S=>S.id===c.lockId))},[g]),ae=a.useCallback(c=>{h("photoCredit",c)},[h]),re=a.useCallback(c=>{const{value:S}=c.target;j(S)},[]),ie=a.useCallback(c=>{const{value:S}=c.target;k(S)},[]),z=a.useCallback(()=>{n({}),l(void 0),d.forEach(c=>URL.revokeObjectURL(c.preview)),f([]),b(void 0),L(!1),U(void 0),t(!1),y(""),k(""),E(!u)},[d,u]),le=a.useCallback(()=>{t(!C),n([])},[C]),ce=a.useCallback(c=>{const{value:S}=c.target;y(S),n({lockFullName:S,lockName:S,lockId:"NOTINLIST"})},[]),de=C?.5:1,{flexStyle:me}=W();return e.jsxs("div",{style:{maxWidth:800,padding:0,marginLeft:"auto",marginRight:"auto",marginTop:16,marginBottom:46,paddingLeft:8},children:[e.jsx("form",{action:null,encType:"multipart/form-data",method:"post",onSubmit:oe,children:e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:500,marginBottom:10},children:"Select Lock"}),e.jsx("div",{style:{opacity:de},children:e.jsx(Ke,{handleChangeLock:ne,allEntries:g,disabled:C,reset:u})}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx(Te,{onChange:le,color:"info",size:"small",id:"notInList",checked:C})," Submit photos for a lock not on the site."]}),e.jsxs(We,{in:C,style:{marginTop:10},children:[e.jsx("span",{style:{fontSize:"0.9rem"},children:"Lock Name"}),e.jsx("br",{}),e.jsx(B,{type:"text",id:"altLockName",name:"altLockName",value:s,style:{width:400},onChange:ce,color:"info"})]}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{style:{display:me},children:[e.jsxs("div",{style:{marginRight:50,width:350},children:[e.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:500,marginBottom:10},children:["Files to Upload",e.jsx("br",{})]}),e.jsx(Re,{files:d,setFiles:f}),i&&e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:500,marginBottom:10,marginTop:20},children:["Existing Images",e.jsx("br",{})]}),i.media?e.jsx("div",{children:e.jsx($e,{sx:{width:350},variant:"masonry",cols:2,gap:8,children:i.media.map(c=>e.jsx(Fe,{children:e.jsx("img",{srcSet:`${c.thumbnailUrl}?w=164&fit=crop&auto=format&dpr=2 2x`,src:`${c.thumbnailUrl}?w=164&fit=crop&auto=format`,alt:c.title,loading:"lazy"})},c.thumbnailUrl))})}):e.jsx("span",{children:"no images"})]})]}),e.jsxs("div",{style:{width:350},children:[e.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:500,marginBottom:10},children:["Details",e.jsx("br",{})]}),o.lockFullName&&e.jsxs("span",{children:[e.jsx("span",{style:{fontSize:"0.9rem"},children:"Lock Name"}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex"},children:[o.lockId!=="NOTINLIST"&&e.jsx(Ee,{value:N==null?void 0:N.belt,style:{marginBottom:-10}}),e.jsx("div",{style:{fontWeight:700,fontSize:"1.2rem",marginLeft:10},children:o.lockFullName})]}),e.jsx("br",{})]}),e.jsx("span",{style:{fontSize:"0.9rem"},children:"Credit to"}),e.jsx("br",{}),e.jsx(B,{type:"text",name:"photoCredit",value:I,style:{width:350},onChange:re,color:"info"}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("span",{style:{fontSize:"0.9rem"},children:"Notes"}),e.jsx("br",{}),e.jsx(B,{type:"text",name:"notes",multiline:!0,fullWidth:!0,rows:3,color:"info",maxLength:1e3,id:"notes",value:x,onChange:ie}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(P,{type:"submit",variant:"contained",color:"info",disabled:!ee||O,children:"Upload"})]})]}),e.jsx("br",{}),e.jsx("br",{})]})}),e.jsx(T,{open:O,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:.7}}},children:e.jsx("div",{style:{width:320,textAlign:"center",padding:30},children:e.jsx(we,{})})}),e.jsx(T,{open:!!v&&!m,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:.7}}},children:e.jsx("div",{style:{display:"flex"},children:e.jsxs("div",{style:{backgroundColor:"#444",marginLeft:"auto",marginRight:"auto",padding:40},children:[e.jsxs("div",{style:{fontSize:"1.7rem",fontWeight:500,marginBottom:60,textAlign:"center"},children:[se," Uploaded Succesfully!"]}),e.jsx("div",{style:{width:"100%",textAlign:"center"},children:e.jsx(P,{onClick:z,variant:"contained",color:"info",style:{marginLeft:"auto",marginRight:"auto"},children:"Submit more photos"})})]})})}),e.jsx(T,{open:!!m,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:.7}}},children:e.jsx("div",{style:{display:"flex"},children:e.jsxs("div",{style:{backgroundColor:"#444",marginLeft:"auto",marginRight:"auto",padding:40},children:[e.jsxs("div",{style:{fontSize:"1.7rem",fontWeight:500,marginBottom:20,textAlign:"center"},children:["Something went wrong.",e.jsx("br",{}),"Please try again later.",e.jsx("br",{})]}),e.jsxs("div",{style:{fontSize:"0.85rem",fontWeight:400,marginBottom:20,textAlign:"center"},children:["Error message: ",((Y=(M=m==null?void 0:m.response)==null?void 0:M.data)==null?void 0:Y.message)||(m==null?void 0:m.message),((G=(H=m==null?void 0:m.response)==null?void 0:H.data)==null?void 0:G.status)&&e.jsxs("span",{children:[" (",(X=(K=m==null?void 0:m.response)==null?void 0:K.data)==null?void 0:X.status,")"]})]}),e.jsx("div",{style:{width:"100%",textAlign:"center"},children:e.jsx(P,{onClick:z,variant:"contained",color:"error",style:{marginLeft:"auto",marginRight:"auto"},children:"OK"})})]})})}),e.jsx(ke,{feature:"uploadPhotos"})]})}function _e(r){const p=r.lastIndexOf(".");return p===-1?{base:r,ext:""}:{base:r.substring(0,p),ext:r.substring(p)}}function Lt(){const{isMobile:r}=W(),{profile:p,user:g}=ve();Se("LPU Belt Explorer - Submit Photos");const h=e.jsx(J.Fragment,{children:!r&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}})});return e.jsx(ye,{children:e.jsxs(ze,{allEntries:Ne,profile:p,children:[e.jsx(Ce,{title:"Submit Photos",extras:h}),p&&!p.photoCredit&&e.jsx("div",{style:{marginTop:20,padding:"0px 0px"},children:e.jsx(Ie,{pageName:"photoUpload",maxWidth:820})}),e.jsx(Xe,{profile:p,user:g})]})})}export{Lt as default};
