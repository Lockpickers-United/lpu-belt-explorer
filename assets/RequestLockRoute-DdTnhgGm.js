import{r as n,u as I,j as e,R as q,ai as ne,B as M,A as oe,b as ie,L as $,a7 as V,T as ae,D as re,bC as le,a8 as de,e as ce,N as me}from"./index-DXvzVRDl.js";import{u as he}from"./usePageTitle-o0J2oB6t.js";import{S as ue,a as z,D as pe}from"./SubNav-BHY9Dll5.js";import{a as ge}from"./filterFields-4n1Ow441.js";import{D as xe}from"./Dropzone-BUMAcYtS.js";import{L as fe}from"./LoadingDisplay-DvkoAoIv.js";import{e as H}from"./entryName-DhP1LeHY.js";import{s as ye,a as je,b as ve}from"./setDeep-J6HEwWhX.js";import{A as ke,I as be,S as Ce}from"./Search-BjLerhsw.js";import{T as v}from"./TextField-G1RXKejN.js";import{D as _}from"./DataContext-CdS9ne4B.js";import{n as we}from"./dataUrls-DVxTtpO-.js";import{p as Be}from"./postData-SODxzjVw.js";import{C as K}from"./Collapse-DlnLVWHP.js";import{C as Se}from"./Checkbox-C2FsMNS2.js";import{D as F}from"./Dialog-Zrrw2PyS.js";import"./index-VRIRMSEY.js";import"./filterEntriesAdvanced-DcgZdZws.js";import"./stringUtils-BsiQ3MZ5.js";import"./Select-585MVDZL.js";import"./useFormControl-DjUHgdiE.js";import"./ToggleButtonGroup-sbSux8oi.js";import"./index-BOn3oFyL.js";import"./Cancel-BrOGWZzs.js";import"./LoadingDisplaySmall-C4W-H-SQ.js";import"./Box-Dln4KeT6.js";import"./CircularProgress-DpiGxZ0-.js";import"./index-B9ygI19o.js";import"./SwitchBase-DyUcQ5Hg.js";function Re({name:o,changeHandler:r,options:d,style:l,disabled:u=!1,reset:D,placeholder:k="Search...",noOptionsMessage:b,noOptionsHandler:g,inputValueHandler:m}){const C=n.useRef(),[x,B]=n.useState(!1),t=n.useCallback(()=>B(!1),[]),{isMobile:j}=I(),[S,U]=n.useState(""),c=b&&g?e.jsx(M,{onClick:g,variant:"contained",color:"success",children:b}):null,T=n.useCallback((p,f)=>{d.includes(f)?r({target:{name:o,value:f}}):r({target:{name:o,value:void 0}})},[d,r,o]),w=(p,f)=>{m&&m(f),U(f)};return e.jsxs(q.Fragment,{children:[e.jsx(ke,{disabled:u,selectOnFocus:!0,clearOnEscape:!0,handleHomeEndKeys:!0,autoHighlight:!0,fullWidth:!0,style:l,options:d,name:o,onChange:T,inputValue:S,onInputChange:w,renderInput:p=>e.jsx(v,{...p,placeholder:k,variant:"outlined",color:"info",inputRef:C,InputProps:{...p.InputProps,startAdornment:e.jsx(be,{position:"start",children:e.jsx(Ce,{})})}}),noOptionsText:c},D||u),e.jsx(ne,{invisible:!0,open:x&&j,onClick:t})]})}function Le(){const{allEntries:o}=n.useContext(_),{user:r}=n.useContext(oe),{profile:d}=n.useContext(_),[l,u]=n.useState([]),[D,k]=n.useState(void 0),[b,g]=n.useState(!1),[m,C]=n.useState(void 0),[x,B]=n.useState(!1),[t,j]=n.useState({id:G(8)}),[S,U]=n.useState(""),c=n.useCallback(s=>{const{name:i,value:h}=s.target;j({...t,[i]:h})},[t]),T=n.useCallback((s,i)=>{u(s)},[]),w=n.useCallback(()=>{B(!x);const s={...t};s.altBrand=!s.altBrand,s.altBrand?(s.newBrand=S,delete s.make):delete s.newBrand,setTimeout(()=>{j(s)},10),setTimeout(()=>{s.altBrand&&(document.getElementById("newBrand").focus(),document.getElementById("newBrand").select())},100)},[x,t,S]),p=n.useMemo(()=>o==null?void 0:o.sort((s,i)=>H(s,"short").localeCompare(H(i,"short"))).reduce((s,i)=>{const h=i.version?i.version:void 0;return i.makeModels.map(y=>{const L=y.make?y.make:y.model;ye(s,["allMakes"],L.trim());const a=y.make?y.model.trim():"Any";je(s,["makeModels",L],{model:a,versionText:h})}),s.lockingMechanisms=s.lockingMechanisms||[],ve(s,["lockingMechanisms"],i.lockingMechanisms?[...new Set([...s.lockingMechanisms,...i.lockingMechanisms,"Multiple"])].sort():s.lockingMechanisms),s},{}),[o]),f=n.useMemo(()=>{var s;return(s=p.allMakes)==null?void 0:s.sort((i,h)=>i.localeCompare(h))},[p]),Y=(t.make||t.newBrand)&&t.model&&t.lockingMechanisms&&t.lockingMechanisms.length>0&&(t.redditUsername||t.discordUsername)&&l.length>0,P=`${t.make||t.newBrand}_${t.model}`.replace("/","+"),E=t.redditUsername&&t.discordUsername?[t.redditUsername,t.discordUsername].join("_").replace("/","+"):`${t.redditUsername||t.discordUsername}`.replace("/","+"),J=async s=>{s.preventDefault(),g(!0);const i={...t,displayName:(d==null?void 0:d.displayName)||"no display name",make:t.make||t.newBrand,droppedFileNames:l.map(a=>a.name),requestStatus:"Submitted"};delete i.altBrand,delete i.newBrand;const h=new FormData;Object.keys(i).forEach(a=>{h.append(a,i[a])});const y=`${P}-${E}`.toLowerCase();l.forEach(a=>{const{base:te,ext:se}=ze(a.name);h.append("files",a,`${y}/${P}_${te}_${E}.${se}`.toLowerCase())});const L=`${we}/request-lock`;try{const a=await Be({user:r,url:L,formData:h,snackBars:!0,timeoutDuration:45e3});k(a)}catch(a){C(a)}finally{l.forEach(a=>URL.revokeObjectURL(a.preview)),u([]),g(!1),j(i)}},Q=n.useCallback(()=>{l.forEach(s=>URL.revokeObjectURL(s.preview)),u([]),B(!x),j({id:G(8)}),k(void 0),g(!1),C(void 0),setTimeout(()=>{window.scrollTo({left:0,top:0,behavior:"smooth"})},100)},[x,l]),X=n.useCallback(()=>{k(void 0),g(!1),C(void 0)},[]),N=n.useMemo(()=>[{label:"Request a Lock",page:"/rankingrequests/submit"},{label:"View Requests",page:"/rankingrequests/view"}],[]),Z=ie(),ee=t.altBrand>0?.5:1,{isMobile:A,flexStyle:R}=I(),O=A?300:660,W=A?8:16;return e.jsxs(q.Fragment,{children:[e.jsx(ue,{options:N,defaultValue:N[0].label}),e.jsxs("div",{style:{maxWidth:720,padding:0,marginLeft:"auto",marginRight:"auto",marginTop:16,marginBottom:46,paddingLeft:8},children:[e.jsxs("div",{style:{marginBottom:30,marginRight:W,lineHeight:"1.5rem"},children:["The lock ranking process for Lockpickers United is a detailed one. It's a community process and identifying new locks for ranking is a big part of it. Use the form below to submit a lock for ranking. A lot of work goes into adding a new lock to the belt rankings, please provide as much information as possible to do your part in the process.",e.jsx("br",{}),e.jsx("br",{}),"Please note that while all requests will be considered, not all locks can be put into the ranking process. Factors include the availability of locks to review, general availability of locks to the community, access to photos and detailed lock information, and the projected value to the community of adding them to the list. Â ",e.jsx($,{onClick:()=>Z("/view?pageId=classificationProcess"),style:{color:"#aaa",cursor:"pointer",fontWeight:700},children:"Click here to learn more"})]}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:500,padding:`10px ${W}px`,backgroundColor:"#222",marginBottom:20},children:"Lock Request Info"}),e.jsxs("form",{action:null,encType:"multipart/form-data",method:"post",onSubmit:J,children:[e.jsxs("div",{style:{paddingLeft:W},children:[e.jsxs("div",{style:{display:R,marginBottom:30},children:[e.jsxs("div",{children:[e.jsx(K,{in:!t.altBrand,children:e.jsxs("div",{style:{marginRight:20},children:[e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:500,marginBottom:5},children:"Choose Brand"}),e.jsx(Re,{changeHandler:c,options:f,name:"make",style:{width:300,opacity:ee},reset:x,disabled:t.altBrand,inputValueHandler:U,noOptionsMessage:"Add a brand",noOptionsHandler:w})]})}),e.jsxs(K,{in:t.altBrand,children:[e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:500,marginBottom:5},children:"Enter New Brand"}),e.jsx(v,{type:"text",id:"newBrand",name:"newBrand",value:t.newBrand||"",style:{width:300,marginBottom:0},onChange:c,color:"info"})]}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx(Se,{onChange:w,id:"altBrand",name:"altBrand",checked:t.altBrand||!1,color:"info",size:"small",inputProps:{tabIndex:-1}}),e.jsx($,{onClick:w,style:{color:"#fff"},children:"Submit a lock for a new brand."})]})]}),e.jsxs("div",{style:{marginTop:0},children:[e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:500,marginBottom:5},children:"Model Name"}),e.jsx(v,{type:"text",name:"model",style:{width:300},onChange:c,value:t.model||"",color:"info"})]})]}),e.jsxs("div",{style:{display:R,marginTop:20},children:[e.jsxs("div",{style:{marginRight:20},children:[e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:500,marginBottom:5},children:"Locking Mechanism"}),e.jsx(z,{changeHandler:c,name:"lockingMechanisms",form:t,optionsList:p.lockingMechanisms,size:"large",width:200,multiple:!1,defaultValue:""})]}),e.jsxs("div",{style:{flexGrow:1,maxWidth:440},children:[e.jsxs("div",{style:{fontSize:"1.1rem"},children:["Notes ",e.jsx("span",{style:{color:"#aaa"},children:"(optional)"})]}),e.jsx(v,{type:"text",name:"notes",multiline:!0,fullWidth:!0,rows:4,color:"info",style:{},value:t.notes||"",maxLength:1200,id:"notes",onChange:c})]})]}),e.jsxs("div",{style:{width:O,marginTop:30},children:[e.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:500,marginBottom:5},children:["Lock Photos (at least 1 required)",e.jsx("br",{}),e.jsx("span",{style:{fontSize:"1.0rem",fontWeight:400},children:"Please include body, key, keyway, and if guttable, pictures of all relevant features."})]}),A&&e.jsx("div",{style:{fontSize:"0.9rem",marginBottom:10,fontStyle:"italic"},children:"Previews may not appear on some mobile devices, but images will be uploaded."}),e.jsx(xe,{files:l||[],otherFiles:[],handleDroppedFiles:T,maxFiles:5,backgroundColor:"#333"})]}),e.jsxs("div",{style:{display:R,marginTop:30,width:O},children:[e.jsxs("div",{style:{marginRight:20},children:[e.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:400,marginBottom:5},children:["Approximate Belt ",e.jsx("span",{style:{color:"#aaa"},children:"(optional)"})]}),e.jsx(z,{changeHandler:c,name:"approxBelt",form:t,optionsList:V,multiple:!1,defaultValue:"",size:"large",width:300})]}),e.jsxs("div",{style:{marginTop:0,width:300},children:[e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:400,marginBottom:5},children:"Can you provide locks for review?"}),e.jsx(z,{changeHandler:c,name:"hazLocc",form:t,optionsList:["Yes","No"],multiple:!1,defaultValue:"",size:"large",width:300})]})]}),e.jsxs("div",{style:{marginTop:30},children:[e.jsx("div",{style:{marginRight:50,width:300},children:e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:500},children:"Contact Info"})}),e.jsxs("div",{style:{display:R},children:[e.jsxs("div",{style:{marginRight:20},children:[e.jsx("div",{style:{fontSize:"1rem"},children:"Discord Username"}),e.jsx(v,{type:"text",name:"discordUsername",style:{width:200},onChange:c,value:t.discordUsername||"",color:"info"})]}),e.jsxs("div",{style:{marginRight:40},children:[e.jsx("div",{style:{fontSize:"1rem"},children:"AND/OR Reddit Username"}),e.jsx(v,{type:"text",name:"redditUsername",style:{width:200},onChange:c,value:t.redditUsername||"",color:"info"})]}),e.jsxs("div",{style:{marginTop:0},children:[e.jsxs("div",{style:{fontSize:"1rem"},children:["Your current belt ",e.jsx("span",{style:{color:"#aaa"},children:"(optional)"})]}),e.jsx(z,{changeHandler:c,name:"userBelt",form:t,optionsList:["Unranked",...V],multiple:!1,defaultValue:"",size:"large",width:200})]})]})]})]}),e.jsx("div",{style:{marginTop:30,width:"100%",display:"flex",justifyContent:"center"},children:e.jsx(M,{type:"submit",variant:"contained",color:"info",disabled:!Y||b,children:"Submit"})})]}),e.jsx(F,{open:b,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:.7}}},children:e.jsx("div",{style:{width:320,textAlign:"center",padding:30},children:e.jsx(fe,{})})}),e.jsx(F,{open:!!D&&!m,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:.7}}},children:e.jsx("div",{style:{display:"flex"},children:e.jsxs("div",{style:{backgroundColor:"#444",marginLeft:"auto",marginRight:"auto",padding:40},children:[e.jsx("div",{style:{fontSize:"1.7rem",fontWeight:500,marginBottom:60,textAlign:"center"},children:"Lock request submitted!"}),e.jsx("div",{style:{width:"100%",textAlign:"center"},children:e.jsx(M,{onClick:Q,variant:"contained",color:"info",style:{marginLeft:"auto",marginRight:"auto"},children:"OK"})})]})})}),e.jsx(F,{open:!!m,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:.7}}},children:e.jsx("div",{style:{display:"flex"},children:e.jsxs("div",{style:{backgroundColor:"#444",marginLeft:"auto",marginRight:"auto",padding:40},children:[e.jsxs("div",{style:{fontSize:"1.7rem",fontWeight:500,marginBottom:20,textAlign:"center"},children:["Something went wrong.",e.jsx("br",{}),"Please try again later.",e.jsx("br",{})]}),e.jsxs("div",{style:{fontSize:"0.95rem",fontWeight:400,marginBottom:20,textAlign:"center"},children:[m==null?void 0:m.message.toString(),e.jsx("br",{}),"(Error code ",m==null?void 0:m.status.toString(),")"]}),e.jsx("div",{style:{width:"100%",textAlign:"center"},children:e.jsx(M,{onClick:X,variant:"contained",color:"error",style:{marginLeft:"auto",marginRight:"auto"},children:"OK"})})]})})}),e.jsx(ae,{feature:"uploadPhotos"})]})]})}function ze(o){const r=o.lastIndexOf(".");return r===-1?{base:o,ext:""}:{base:o.substring(0,r),ext:o.substring(r)}}function G(o){const r="0123456789ABCDEF";let d="";for(let l=0;l<o;++l)d+=r.charAt(Math.floor(Math.random()*r.length));return d.toLowerCase()}function it(){he("Request a Lock");const{lockCollection:o}=n.useContext(re),{isMobile:r}=I(),d=le(),l=de.concat(d),u=e.jsx(q.Fragment,{children:!r&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}})});return e.jsx(ce,{filterFields:ge,children:e.jsxs(pe,{allEntries:l,profile:o,children:[e.jsx(me,{title:"Request a Lock",extras:u}),e.jsx(Le,{})]})})}export{it as default};
