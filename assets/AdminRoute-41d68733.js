import{ad as P,j as e,ae as C,ab as M,r as x,e as z,B as D,a0 as Y,af as A,u as I,R as L,U as G,V as O,W as H}from"./index-f105a28d.js";import{l as E}from"./LPU-c3fa7122.js";import{u as k}from"./useWindowSize-8d217ffe.js";import{c as F,d as V,T as N,a as U,b as S,e as X}from"./TableRow-3f549d40.js";import{B as j,P as B}from"./nivo-bar.es-934705a4.js";import{d as y}from"./dayjs.min-6252e545.js";import{L as $}from"./LinearProgress-5ca93f87.js";const W=P({palette:{mode:"light",text:{primary:"#333333",secondary:"#555555"}}}),q=s=>`
            body {
                margin: 0;
                padding: 0;
                color: #333
            }
            
            a {
                color: ${s.palette.text.icon};
            }
            
            pre{ 
                white-space: pre-wrap; 
                word-break: break-word;
            }
            
            :root {
              color-scheme: dark;
              overflow-y: scroll;
            }
        `,J=q(W),K=({children:s})=>e.jsxs(C,{theme:W,children:[e.jsx("style",{children:J}),s]}),T=({tableData:s,tableWidth:i,fontSize:t})=>{const l={};return e.jsxs("div",{style:{},children:[s.title,e.jsx(F,{id:"dailyAverages",style:{padding:"0px 0px 0px 4px",width:i,marginLeft:"auto",marginRight:"auto"},component:M,elevation:2,children:e.jsxs(V,{size:"small",children:[e.jsx(N,{children:e.jsx(U,{children:s.columns.map((a,o)=>e.jsx(S,{sx:{textAlign:a.align,fontSize:t,lineHeight:"1.1rem",padding:"8px",color:"#fff"},component:"th",scope:"row",children:a.name},o+1))})}),e.jsx(X,{children:s.data.map((a,o)=>e.jsx(U,{index:o,sx:{"&:nth-of-type(even) td, &:nth-of-type(even) th":{backgroundColor:"#111"},"td, th":{padding:"7px 1px",margin:"0px"}},children:s.columns.map((n,d)=>e.jsx(S,{style:l,sx:{textAlign:n.align,fontSize:t,whiteSpace:"nowrap",border:0,color:"#eee"},component:"th",scope:"row",children:a[n.id].toLocaleString()},d+1))},o))})]})})]})},Q=({fullData:s})=>{const i=s.summary,{width:t}=k(),l=t<=360,a=t<=395,o=t<=428,n=t<=560,d=t<=820,c=l?".8rem":a?".85rem":o?".9rem":".95rem",r="100%";return e.jsx(T,{tableData:i,tableWidth:r,fontSize:c})},Z=["#d5d5d5","#d8d801","#ed7d01","#389700","#0090de","#634b9f","#9d5918","#ba0303","#1a1a1a","#373737"],u="#ccc",w={text:{color:u},grid:{line:{strokeWidth:1,stroke:"#ccc"}},tooltip:{container:{backgroundColor:"#222",color:"#ccc",fontSize:13}},axis:{domain:{line:{stroke:u,strokeWidth:1}},ticks:{line:{stroke:u,strokeWidth:1},text:{fill:u,color:u,fontSize:"0.83rem"}},grid:{line:{stroke:"#ccc",strokeWidth:1}},legend:{text:{fill:u,color:u}}}},_=({fullData:s})=>{const i=s.summary.data;let t=[];i.forEach(g=>{let h=new Map;h.id=g.list,h.label=g.list,h.count=g.averageItems,h.value=g.averageItems,t.push(h)});const{width:l}=k(),a=l<=360,o=l<=395,n=l<=428,d=l<=820,c=a?180:o?190:n?200:d?240:250,r={top:0,right:20,bottom:30,left:50},m=["#aeaeae","#0364ac","#0364ac","#0364ac","#0364ac"];return e.jsx("div",{style:{height:c,width:"100%"},children:e.jsx(j,{data:t,margin:r,padding:.15,colors:g=>m[g.index%m.length],animate:!0,enableLabel:!0,axisLeft:{tickSize:5,tickPadding:5,tickRotation:0},enableGridY:!1,theme:w,isInteractive:!1})})},ee=({lineData:s})=>{const i=[s.listUsers],{width:t}=k(),l=t<=360,a=t<=395,o=t<=428,n=t<=560,d=t<=820,c=l||a?200:o?210:d?230:250,r=n?-45:0,m=n?{top:10,right:20,bottom:50,left:50}:{top:10,right:20,bottom:30,left:50};return e.jsx("div",{style:{height:c},children:e.jsx(B,{theme:se,data:i,enableGridX:!1,enableGridY:!1,colors:["#007de2","#16325d"],lineWidth:3,margin:m,height:c,curve:"natural",yScale:{type:"linear",min:0,max:500,stacked:!1,reverse:!1},yFormat:" >-.2f",axisLeft:{tickValues:5,tickSize:5,tickPadding:5,tickRotation:0,format:","},xScale:{type:"time",format:"%Y-%m-%d"},xFormat:"time:%m/%d/%y",axisBottom:{format:"%b %d",tickSize:5,tickPadding:5,tickRotation:r,direction:"row",legendOffset:-12,tickValues:"every week"},legends:[{anchor:"bottom",itemTextColor:"#ddd",direction:"row",justify:!1,translateX:0,translateY:75,itemsSpacing:0,itemWidth:100,itemHeight:20,symbolSize:13,symbolShape:"circle"}],enablePoints:!1,useMesh:!0,isInteractive:!1})})},te={grid:{line:{stroke:"#333",strokeWidth:1}}},se={...w,...te},ae=({lineData:s})=>{const i=[s.ownLocks,s.pickedLocks,s.recordedLocks,s.wishlistLocks],{width:t}=k(),l=t<=360,a=t<=395,o=t<=428,n=t<=560,d=t<=820,c=l?200:a?220:o?230:d?260:290,r=n?-45:0,m={top:10,right:20,bottom:65,left:50},g=["#172072","#2e399b","#444fb2","#5966da"];return e.jsx("div",{style:{height:c,width:"100%"},children:e.jsx(B,{theme:ne,data:i,colors:g,enableArea:!0,areaOpacity:1,lineWidth:2,margin:m,curve:"natural",yScale:{type:"linear",min:0,max:"auto",stacked:!0,reverse:!1},yFormat:" >-.2f",axisLeft:{tickValues:5,tickSize:5,tickPadding:5,tickRotation:0,format:","},xScale:{type:"time",format:"%Y-%m-%d"},xFormat:"time:%m/%d/%y",enableGridX:!1,enableGridY:!1,axisBottom:{format:"%b %d",tickSize:5,tickPadding:5,tickRotation:r,tickValues:"every week"},legends:[{anchor:"bottom",itemTextColor:"#666",direction:"row",justify:!1,translateX:0,translateY:65,itemsSpacing:6,itemWidth:100,itemHeight:20,symbolSize:13,symbolShape:"circle"}],enablePoints:!1,useMesh:!0,isInteractive:!1})})},ie={grid:{line:{stroke:"#333",strokeWidth:1}}},ne={...w,...ie},oe=({fullData:s})=>{const i=s.listSavesByBelt,{width:t}=k(),l=t<=360,a=t<=395,o=t<=428,n=t<=560,d=t<=820,c=l||a||o?200:d?250:290,r=n?1:2,m={top:0,right:20,bottom:30,left:50};return e.jsx("div",{style:{height:c},children:e.jsx(j,{data:i,keys:["White","Yellow","Orange","Green","Blue","Purple","Brown","Red","Black","Unranked"],indexBy:"list",groupMode:"grouped",margin:m,padding:.1,innerPadding:0,borderRadius:r,valueScale:{type:"linear"},indexScale:{type:"band",round:!0},maxValue:"auto",theme:w,colors:Z,animate:!0,enableGridY:!1,enableLabel:!1,axisLeft:{tickSize:5,tickPadding:5,tickRotation:0,format:","},isInteractive:!0})})},re=({fullData:s})=>{const i=s.dailyTableData,t=i.data.map(r=>r.date),a=y(t.reduce((r,m)=>m>r?m:r)).subtract(28,"day"),o=[];i.data.map(r=>{y(r.date).isAfter(a)&&o.push(r)});const n=new Map;n.title="",n.columns=i.columns,n.data=o;const d="100%",c=".83rem";return e.jsx("div",{style:{width:"100%"},children:e.jsx(T,{tableData:n,tableWidth:d,fontSize:c})})},le={updatedDateTime:"",timezone:"EST"},ce={title:"",columns:[{name:"List Name",align:"left",id:"list"},{name:"Total Users",id:"totalUsers",align:"center"},{align:"center",id:"newUsers",name:"New Users"},{id:"listUsers",align:"center",name:"List Users"},{name:"New List Users",align:"center",id:"newListUsers"},{id:"totalSaves",align:"center",name:"Total Saves"},{id:"newSaves",align:"center",name:"New Saves"},{id:"percentListUsers",align:"center",name:"% List Users"},{align:"center",id:"averageItems",name:"Average Items"}],data:[{list:"All Lists",totalUsers:0,listUsers:0,percentListUsers:"--",totalSaves:0,averageItems:0,newListUsers:0,newUsers:0,newSaves:0},{list:"Own",totalUsers:0,listUsers:0,percentListUsers:"--",totalSaves:0,averageItems:0,newListUsers:0,newUsers:0,newSaves:0},{list:"Picked",totalUsers:0,listUsers:0,percentListUsers:"--",totalSaves:0,averageItems:0,newListUsers:0,newUsers:0,newSaves:0},{list:"Recorded",totalUsers:0,listUsers:0,percentListUsers:"--",totalSaves:0,averageItems:0,newListUsers:0,newUsers:0,newSaves:0},{list:"Wishlist",totalUsers:0,listUsers:0,percentListUsers:"--",totalSaves:0,averageItems:0,newListUsers:0,newUsers:0,newSaves:0}]},de={title:"",data:[{listUsers:0,recordedLocks:0,ownLocks:0,totalSaves:0,pickedLocks:0,ownUsers:0,totalUsers:0,wishlistLocks:0,newUsers:0,wishlistUsers:0,pickedUsers:0,date:"2023-11-19",recordedUsers:0},{listUsers:0,recordedLocks:0,ownLocks:0,totalSaves:0,pickedLocks:0,ownUsers:0,totalUsers:0,wishlistLocks:0,newUsers:0,wishlistUsers:0,pickedUsers:0,date:"2023-01-20",recordedUsers:0}],columns:[{id:"date",name:"Date",align:"left"},{name:"Total Users",align:"center",id:"totalUsers"},{id:"listUsers",name:"List Users",align:"center"},{align:"center",name:"Total Saves",id:"totalSaves"},{align:"center",name:"Owned Users",id:"ownUsers"},{id:"ownLocks",align:"center",name:"Owned Locks"},{id:"pickedUsers",align:"center",name:"Picked Users"},{align:"center",name:"Picked Locks",id:"pickedLocks"},{id:"recordedUsers",name:"Rec. Users",align:"center"},{id:"recordedLocks",name:"Rec. Locks",align:"center"},{name:"Wishlist Users",align:"center",id:"wishlistUsers"},{align:"center",name:"Wishlist Locks",id:"wishlistLocks"},{align:"center",name:"New Users",id:"newUsers"}]},me=[{value:0,label:"White",id:"White",count:0},{label:"Yellow",value:0,id:"Yellow",count:0},{count:0,id:"Orange",value:0,label:"Orange"},{count:0,id:"Green",value:0,label:"Green"},{value:0,label:"Blue",id:"Blue",count:0},{label:"Purple",value:0,count:0,id:"Purple"},{count:0,id:"Brown",value:0,label:"Brown"},{label:"Red",value:0,count:0,id:"Red"},{id:"Black",count:0,value:0,label:"Black"},{count:0,id:"Unranked",value:0,label:"Unranked"}],he=[{Brown:0,list:"Own",Purple:0,Unranked:0,Yellow:0,Green:0,Red:0,Black:0,White:0,Blue:0,Orange:0},{Black:0,White:0,Orange:0,Blue:0,Brown:0,list:"Picked",Purple:0,Unranked:0,Yellow:0,Red:0,Green:0},{Unranked:0,Brown:0,list:"Recorded",Purple:0,Yellow:0,Red:0,Green:0,Black:0,Orange:0,Blue:0,White:0},{White:0,Blue:0,Orange:0,Black:0,Red:0,Green:0,Yellow:0,Purple:0,list:"Wishlist",Brown:0,Unranked:0}],ge={metadata:le,summary:ce,dailyTableData:de,savesByBelt:me,listSavesByBelt:he},ue="https://explore.lpubelts.com/data/statsCollectionsFull.json";function pe(){const[s,i]=x.useState({data:[],metadata:{}}),[t,l]=x.useState(!0);x.useEffect(()=>{(async()=>{try{const f=await(await fetch(ue)).json();i(f),l(!1)}catch(p){console.error("Error loading collections data.",p),z("Error loading collections data. Please reload the page.",{autoHideDuration:null,action:e.jsx(D,{color:"secondary",onClick:()=>window.location.reload(),children:"Refresh"})}),l(!1)}})()},[]);const a=t?ge:s,o=t?"--":"(updated: "+y(a.metadata.updatedDateTime).format("MM/DD/YY hh:mm")+` ${a.metadata.timezone})`,n=a.dailyTableData.data,c=["listUsers","wishlistLocks","recordedLocks","pickedLocks","ownLocks"].reduce((b,p)=>{const f=n.map(v=>({x:v.date,y:v[p]}));return b[p]={data:f,id:p},b},{}),{width:r}=k(),g=r<560?"8px 8px 32px 8px":"24px 24px 32px 24px",h={margin:"46px 0px 18px 0px",width:"100%",textAlign:"center",color:"#fff"},R={margin:"0px 0px 36px 0px",width:"100%",textAlign:"center",color:"#fff"};return e.jsxs("div",{style:{minWidth:"320px",maxWidth:900,height:"100%",padding:g,backgroundColor:"#292929",marginLeft:"auto",marginRight:"auto",fontSize:"1.5rem",lineHeight:.8},children:[e.jsxs("div",{style:R,children:["Collections Summary",e.jsx("br",{}),e.jsx("span",{style:{fontSize:"0.7rem"},children:o})]}),e.jsx(Q,{fullData:a}),e.jsx("div",{style:h,children:"List Users"}),e.jsx(ee,{lineData:c}),e.jsx("div",{style:h,children:"List Locks by Date"}),e.jsx(ae,{lineData:c}),e.jsx("div",{style:h,children:"Average Items Per List"}),e.jsx(_,{fullData:a}),e.jsx("div",{style:h,children:"List Saves by Belt Ranking"}),e.jsx(oe,{fullData:a}),e.jsx("div",{style:h,children:"Last 28 Days"}),e.jsx(re,{fullData:a})]})}function Le(){const{authLoaded:s}=x.useContext(Y),{admin:i}=x.useContext(A),t=I();return x.useEffect(()=>{s&&!i&&t("/locks")},[i,s,t]),e.jsxs(L.Fragment,{children:[e.jsx(G,{title:"Admin"}),!s&&e.jsxs(L.Fragment,{children:[e.jsx($,{variant:"indeterminate",color:"secondary"}),e.jsx("img",{alt:"Loading",src:E,style:{marginLeft:"auto",marginRight:"auto",display:"block"}})]}),s&&i&&e.jsx(pe,{}),e.jsx(O,{}),e.jsx(H,{feature:"admin"}),e.jsx(K,{})]})}export{Le as default};
