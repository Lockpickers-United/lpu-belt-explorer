import{r as n,ah as A,Z as d,ag as y,aj as j,an as x,j as U}from"./index-7b1bb14e.js";import{F as D,r as z,f as C,D as I}from"./BeltStripe-3bece4f9.js";function S({children:g,allEntries:l,profile:c}){const{filters:h}=n.useContext(D),{search:u,id:B,tab:F,name:N,sort:o,image:P,...f}=h,m=n.useMemo(()=>l.map(t=>{var r,i,s;return{...t,makes:t.makeModels.map(({make:e})=>e),fuzzy:z(t.makeModels.map(({make:e,model:a})=>[e,a]).flat().filter(e=>e).concat([t.version,t.notes,t.belt]).join(",")),content:[(r=t.media)!=null&&r.some(e=>!e.fullUrl.match(/youtube\.com/))?"Has Images":"No Images",(i=t.media)!=null&&i.some(e=>e.fullUrl.match(/youtube\.com/))?"Has Video":"No Video",((s=t.links)==null?void 0:s.length)>0?"Has Links":"No Links",A[t.belt].danPoints>0?"Worth Dan Points":void 0,d(t.lastUpdated).isAfter(d().subtract(1,"days"))?"Updated Recently":void 0,t.belt.startsWith("Black")?"Is Black":void 0,t.belt!=="Unranked"?"Is Ranked":void 0].flat().filter(e=>e),collection:y.locks.map.map(e=>c&&c[e.key]&&c[e.key].includes(t.id)?e.label:"Not "+e.label),simpleBelt:t.belt.replace(/\s\d/g,"")}}),[l,c]),p=n.useMemo(()=>{const t=Object.keys(f).map(s=>{const e=f[s];return Array.isArray(e)?e.map(a=>({key:s,value:a})):{key:s,value:e}}).flat(),r=m.filter(s=>t.every(({key:e,value:a})=>Array.isArray(s[e])?s[e].includes(a):s[e]===a)),i=u?C.go(z(u),r,{keys:M,threshold:-25e3}).map(s=>({...s.obj,score:s.score})):r;return o?i.sort((s,e)=>{if(o==="popularity")return e.views-s.views;if(o==="recentlyUpdated"){const a=d(s.lastUpdated),v=d(e.lastUpdated);if(a.isAfter(v))return-1;if(v.isAfter(a))return 1}else{if(o==="beltAscending")return j(s.belt,e.belt);if(o==="beltDescending")return x(s.belt,e.belt);if(o==="alphaAscending")return s.fuzzy.localeCompare(e.fuzzy);if(o==="alphaDescending")return e.fuzzy.localeCompare(s.fuzzy)}}):i},[f,m,u,o]),b=n.useCallback(t=>l.find(r=>r.id===t),[l]),k=n.useMemo(()=>({allEntries:l,visibleEntries:p,getEntryFromId:b}),[l,b,p]);return U.jsx(I.Provider,{value:k,children:g})}const M=["fuzzy"];export{S as D};
