import{j as e,R as P,af as A,r as g,a0 as T,a5 as R,a7 as N,J as W,K as I,ag as H,N as U,O as z,P as O,Q as G}from"./index-55f0431c.js";import{D as V,a as Y,l as $}from"./BeltStripe-befd7e96.js";import{S as q,F as J,a as K,l as Q}from"./sortFields-a1452206.js";import{D as X}from"./LockDataProvider-b8c8e016.js";import{L as Z,a as _}from"./LockListContext-78a88ade.js";import{C as ee,E as te,T as ie}from"./ToggleCompactButton-b2258e8d.js";import{L as oe}from"./LoadingDisplay-a692214d.js";import{u as se}from"./useData-6b043aaf.js";import{u as j}from"./useWindowSize-5f4836e8.js";import{N as re}from"./NoProfileData-e036c407.js";import{P as ae,a as ne}from"./ProfileHeader-8bab36ef.js";import{I as de}from"./InlineFilterDisplay-13bc4f8b.js";import{B as E}from"./nivo-bar.es-98a92474.js";import{p as F}from"./chartDefaults-9fc07b21.js";import"./Select-d0af052f.js";import"./LoadingDisplay-9c0d557e.js";import"./Search-d59a720d.js";import"./Sort-558db112.js";import"./TextField-ae88ada6.js";import"./CollectionButton-bfa123d9.js";import"./PhotoCamera-3bfe37a7.js";import"./Dialog-f187bda6.js";import"./Autocomplete-9bf83db1.js";import"./index-7f28d120.js";import"./ListItem-ea1eae19.js";import"./index-df77d72b.js";import"./index-df2c091e.js";import"./LPU-c3fa7122.js";import"./LinearProgress-5fcfe218.js";import"./CopyProfileLinkButton-bc172f75.js";import"./Link-e23f493d.js";import"./ToggleButtonGroup-37d1ada1.js";import"./ImageViewer-95214891.js";import"./nivo-legends.es-9968c9f0.js";function le({lockCollection:s,userText:p,collectionBarHeight:x}){const c=s.own?s.own.length:0,r=s.picked?s.picked.length:0,a=s.recordedLocks?s.recordedLocks.length:0,n=s.wishlist?s.wishlist.length:0,t=c+r+a+n?{own:c,picked:r,recorded:a,wishlist:n}:{own:0,picked:0,recorded:0,wishlist:0},i={own:14,picked:11,recorded:11,wishlist:8},o={own:250,picked:280,recorded:260,wishlist:100},d={own:Math.min(i.own,t.own),picked:Math.min(i.picked,t.picked),recorded:Math.min(i.recorded,t.recorded),wishlist:Math.min(i.wishlist,t.wishlist)},m={own:t.own>i.own?0:i.own-d.own,picked:t.picked>i.picked?0:i.picked-d.picked,recorded:t.recorded>i.recorded?0:i.recorded-d.recorded,wishlist:t.wishlist>i.wishlist?0:i.wishlist-d.wishlist},h={own:2,picked:2,recorded:2,wishlist:2},M={own:Math.max(t.own-(d.own+m.own+h.own),0),picked:Math.max(t.picked-(d.picked+m.picked+h.picked),0),recorded:Math.max(t.recorded-(d.recorded+m.recorded+h.recorded),0),wishlist:Math.max(t.wishlist-(d.wishlist+m.wishlist+h.wishlist),0)},y={own:Math.min(o.own-t.own,o.own-i.own-h.own),picked:Math.min(o.picked-t.picked,o.picked-i.picked-h.picked),recorded:Math.min(o.recorded-t.recorded,o.recorded-i.recorded-h.recorded),wishlist:Math.min(o.wishlist-t.wishlist,o.wishlist-i.wishlist-h.wishlist)},k=["own","picked","recorded","wishlist"],S=k.map((u,f)=>({row:k[f],"Average A":d[u],"Average B":m[u],Average:h[u],USER:M[u],"Top 10":y[u]})),{width:B}=j(),L=B<=560,C=x,D=L?{top:10,right:20,bottom:50,left:55}:{top:10,right:20,bottom:50,left:55},b=["#3c90c5","#aaa","#000","#3c90c5","#aaa"],l=s?[{title:p,color:"#3c90c5",width:"14px"}]:[];l.push({title:"Average",color:"#000",width:"35px"},{title:"Top 10 Average",color:"#aaaaaa",width:"120px"});const v=({items:u})=>e.jsxs("div",{className:"chart-legend",style:{display:"flex",fontSize:".9rem",color:"#ddd",marginTop:13},children:[e.jsx("div",{style:{width:"100%"}}),u.map(f=>e.jsxs("div",{style:{display:"flex",padding:"0px 18px 24px 18px"},children:[e.jsx("div",{style:{backgroundColor:f.color,height:15,width:15,margin:"2px 6px 0px 0px",border:"1px solid #555"}}),e.jsx("div",{style:{textAlign:"left",width:f.width},children:f.title})]},f.title)),e.jsx("div",{style:{width:"100%"}})]});return e.jsxs(P.Fragment,{children:[e.jsx("div",{style:{height:C},children:e.jsx(E,{data:S,keys:["Average A","Average B","Average","USER","Top 10"],theme:F,indexBy:"row",margin:D,padding:.2,valueScale:{type:"linear"},colors:b,enableLabel:!1,axisLeft:{tickSize:5,tickPadding:5,tickRotation:0,tickValues:5,format:"00",legend:"Saves",legendPosition:"middle",legendOffset:-45,legendOpacity:.9},axisBottom:{tickRotation:-45},enableGridY:!1,isInteractive:!1,animate:!1})}),e.jsx(v,{items:l})]})}function ce({beltData:s}){const{width:p}=j(),x=p<=360,c=p<=560,r=175,a=c?{top:15,right:20,bottom:60,left:20}:{top:0,right:10,bottom:60,left:10},n=["#d5d5d5","#d8d801","#ed7d01","#389700","#0090de","#634b9f","#9d5918","#ba0303","#000","#373737"],w=["#000","#000","#000","#000","#000","#000","#000","#000","#ddd","#ddd"];return e.jsxs("div",{style:{height:r,padding:"0px 8px 0px 8px",width:"100%"},children:[e.jsx(E,{data:s,margin:a,padding:.15,colors:t=>n[t.index%n.length],animate:!0,axisBottom:{tickRotation:-45},axisLeft:null,enableGridY:!1,theme:F,isInteractive:!1,enableLabel:!0,label:t=>t.data.count,labelSkipWidth:12,labelSkipHeight:12,labelTextColor:t=>w[t.index%w.length]}),e.jsx("div",{className:"chart-legend",style:{fontSize:".9rem",color:"#ddd",textAlign:"center",width:"100%",marginTop:"3px"},children:"Belt Distribution"})]},"bar")}function pe({profile:s,entries:p}){const{userId:x}=A(),{user:c}=g.useContext(T),r=x===(c==null?void 0:c.uid)?"You":"User",a=g.useMemo(()=>{const D=W.concat("Unranked"),b=p.map(({belt:l})=>l.includes("Black")?"Black":l).reduce((l,v)=>(l[v]||(l[v]=0),l[v]++,l),{});return D.map(l=>({id:l,label:l,count:b[l]||0,value:b[l]||0}))},[p]),{isMobile:n}=j(),w=n?{maxWidth:700,borderRadius:0}:{maxWidth:700,marginLeft:"auto",marginRight:"auto",borderRadius:0},{width:t}=j(),i=t<=360,o=t<=395,d=t<=428,m=t<=560,y={...{width:"100%",padding:"0px",marginBottom:12,alignItems:"center",marginLeft:"auto",marginRight:"auto"},...m?{}:{display:"flex"}},k=m?"100%":"50%",S=m?"100%":"50%",B=i?200:m?210:180,L=m?160:170,C=i?150:170;return e.jsx(R,{style:w,sx:{paddingBottom:5},children:e.jsx(N,{style:{paddingTop:0,paddingLeft:8},children:e.jsx("div",{style:{textAlign:"center"},children:e.jsxs("div",{style:y,children:[e.jsx("div",{style:{width:k,verticalAlign:"top",height:B},children:e.jsx(le,{lockCollection:s,userText:r,collectionBarHeight:L})}),e.jsx("div",{style:{width:S,height:C,marginTop:"0px"},children:e.jsx(ce,{beltData:a})})]})})})})}function me({profile:s}){const{compact:p}=g.useContext(Z),[x,c]=g.useState(!1),{visibleEntries:r=[]}=g.useContext(V),a=g.useDeferredValue(x);return e.jsxs("div",{style:{maxWidth:700,padding:0,backgroundColor:"#222",marginLeft:"auto",marginRight:"auto",marginTop:16},children:[e.jsx(ae,{profile:s,page:"collection"}),e.jsx(de,{profile:s,collectionType:"locks"}),e.jsx(pe,{profile:s,entries:r}),p?e.jsx(ee,{entries:r}):r.map(n=>e.jsx(te,{entry:n,expanded:n.id===a,onExpand:c},n.id))]})}function qe(){const{userId:s}=A(),{getProfile:p}=g.useContext(I),{isMobile:x}=j(),c=g.useCallback(async()=>{try{const o=await p(s);if(o){const d=o.displayName?o.displayName.toLowerCase().endsWith("s")?`${o.displayName}'`:`${o.displayName}'s`:"Anonymous";document.title=`LPU Belt Explorer - ${d} Profile`}return o}catch(o){return console.error("Error loading profile.",o),null}},[p,s]),{data:r={},loading:a,error:n}=se({loadFn:c}),w=g.useMemo(()=>{if(a||!r)return[];const o=new Set(H.locks.getCollected(r));return U.filter(d=>o.has(d.id))},[r,a]),t=e.jsxs(P.Fragment,{children:[e.jsx(q,{label:"Collection"}),e.jsx(J,{}),e.jsx(K,{sortValues:Q}),!x&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}}),e.jsx(ie,{})]}),i=a?"Loading...":"Profile";return e.jsx(Y,{filterFields:$,children:e.jsx(X,{allEntries:w,profile:r,children:e.jsxs(_,{children:[e.jsx(z,{title:i,extras:t}),a&&e.jsx(oe,{}),!a&&r&&!n&&e.jsx(me,{profile:r}),!a&&r&&!n&&w.length===0&&e.jsx(re,{}),!a&&(!r||n)&&e.jsx(ne,{}),e.jsx(O,{}),e.jsx(G,{feature:"profile"})]})})})}export{qe as default};
