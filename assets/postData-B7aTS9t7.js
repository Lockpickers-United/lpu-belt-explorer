import{a as f}from"./index-xsH4HHeE.js";import{X as p}from"./index-B-_98mDc.js";const w=async({user:e,url:a,formData:r,json:o,snackBars:s,timeoutDuration:n=15e3})=>{var m;const c=new AbortController,u=setTimeout(()=>{c.abort()},n),h=Math.floor(Math.random()*1e6),d=e?await e.getIdToken():null,l=o!==void 0&&r===void 0,g={...d&&{Authorization:`Bearer ${d}`},"Content-Type":l?"application/json":"multipart/form-data"},E=l?o:r;try{const t=await f.post(`${a}?${h}`,E,{headers:g,signal:c.signal});return clearTimeout(u),s&&p("Request successful",{variant:"success"}),t.data}catch(t){clearTimeout(u);const i=t.name==="CanceledError"||t.code==="ERR_CANCELED"||((m=t.message)==null?void 0:m.includes("aborted"));throw s&&p(i?"Request timed out. Please try again.":"Error during authentication or server request",{variant:"error",autoHideDuration:i?5e3:3e3}),i?new Error("Request timed out"):(console.error("Error during authentication or server request:",T(t)),new Error("Error during authentication or server request"))}},T=e=>{var a,r,o;if((a=e.response)!=null&&a.data&&typeof e.response.data=="string"){const s=(r=e.message.match(/code (\d+)/))==null?void 0:r[1],n=(o=e.response.data.match(/<pre>([\s\S]*?)<\/pre>/))==null?void 0:o[1];return{response:{data:{status:s,message:n}}}}else return e};export{T as c,w as p};
