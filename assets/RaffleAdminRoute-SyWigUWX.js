import{r as o,d as b,X as U,j as e,W,B as F,U as re,ak as ae,a8 as T,at as Y,a4 as V,D as B,R as w,b8 as de,P as ce,bO as ue,u as H,L as I,b as me,F as Q,Q as J,az as fe,A as pe,N as Z,bb as xe,h as ee,e as he,T as ge}from"./index-BmMTHZKs.js";import{f as te,g as je}from"./filterFields-DUxBx84V.js";import{A as Ce}from"./AdminToolButtons-C2LBHfGd.js";import{R as K}from"./RaffleContext-BszYlyXr.js";import{D as N}from"./DataContext-DiySNKk3.js";import{A as be}from"./AdvancedFilters-D4qeNbiR.js";import{N as ve}from"./NoEntriesCard-B1xJjK2f.js";import{R as Ae}from"./RaffleSearchBar-pYcnSeia.js";import{b as Ee}from"./sortFields-1lK6XsoA.js";import{d as oe,F as X,C as Se}from"./download-BaDtPpz4.js";import{L as ke}from"./List-DjLv99Ni.js";import{C as De}from"./ContentCopy-CXksjYcc.js";import{E as Re}from"./ExpandMore-BfXADf9X.js";import{C as Fe}from"./CopyLinkToRaflPotButton-B5PQ6umJ.js";import{F as _}from"./FieldValue-vVS84hnp.js";import{B as Te}from"./BeltStripe-DFrvBMrN.js";import{D as we}from"./Dialog-pp_ln0Le.js";import{S as le}from"./ScopedDialog-BU_iCS0H.js";import{T as Le}from"./TextField-BlXhM6XW.js";import{B as ye}from"./Box-DuhsjPK-.js";import{A as Ie,a as We,b as Ne}from"./AccordionSummary-n87deie1.js";import{A as Me}from"./AccordionActions-opcCPUfY.js";import{u as ze}from"./usePageTitle-DacakDJi.js";import{R as Be}from"./RaffleEntryForm-CBRN4mhx.js";import{R as se}from"./RaffleHeader-B7p0dSSQ.js";import{L as Oe}from"./LoadingDisplay-Bkp7sbbi.js";import{r as Pe}from"./index-Bk6Ri9Zz.js";import{a as $e,s as ne}from"./setDeep-J6HEwWhX.js";import{s as q}from"./searchEntriesForText-Hc6RBEIP.js";import{f as ie}from"./filterEntriesAdvanced-CmUTxg7_.js";import"./EmojiEvents-Vb0gjAcY.js";import"./useData-Oa7fUtiX.js";import"./dataUrls-1xDVM400.js";import"./ViewFilterButtons-D5lJqANS.js";import"./Sort-ZMg1SDiO.js";import"./Search-BCgYXtAS.js";import"./useFormControl-BS6rUvUx.js";import"./Select-BJU2_LNW.js";import"./FilterAlt-DBf26vbr.js";import"./entryName-CRYwtwha.js";import"./HighlightOff-BE-5YMEu.js";import"./LockListContext-4-fHkmhe.js";import"./ToggleButtonGroup--ranU0Kc.js";import"./AddCircle-CZ8Su0Ug.js";import"./Cancel-CkR2t7UQ.js";import"./ChoiceButtonGroup-BAMvOrC-.js";import"./Collapse-CkQzSC4_.js";import"./SearchBox-CNcqX0I_.js";import"./Link-CqoleYB0.js";import"./Zoom-C7G7iv1R.js";import"./RaffleSubHead-DO7NRcmj.js";import"./RaffleAutocompleteBox-CU6zab3l.js";import"./SignInDetect-Di6pOSdt.js";import"./Cached-LDI57y4R.js";import"./CircularProgress-D6S_02Lv.js";import"./index-C0RmN517.js";import"./stringUtils-BsiQ3MZ5.js";function Ge({text:t}){const[m,f]=o.useState(null),d=!!m,a=o.useCallback(u=>f(u.currentTarget),[]),c=o.useCallback(()=>f(null),[]),C=b().format("YYYY-MM-DD"),{raffleAdminRole:j}=o.useContext(K),{visibleEntries:p=[]}=o.useContext(N),A=o.useCallback(()=>{const u=JSON.stringify(p);c(),oe(`raffleEntries${C}.json`,u),U("Current RAFL entries downloaded as raffleEntries.json")},[C,c,p]),R=o.useCallback(()=>{const k=p.map(l=>{const E=l.pots.filter(x=>l.potsWon.includes(x.itemId)).map(x=>x.itemTitle);return{id:l.id,username:l.username,platform:l.platform,createdAt:l.createdAt,potNames:l.potNames.join(", "),donations:l.donations.map(x=>x.charity.itemTitle).join(", "),totalDonation:l.totalDonation,wonPots:E.join(", ")}}).map(l=>{let E=`${l.username} (${l.platform}) - $${l.totalDonation}
  POTS: ${l.potNames}
  DONATIONS: ${l.donations}
`;return l.wonPots.length>0&&(E+=`  POTS WON: ${l.wonPots}
`),E}).join(`
`);c(),navigator.clipboard.writeText(k).then(()=>{U("Current RAFL entries copied to clipboard.")})},[c,p]),v=o.useCallback(()=>{const u=p.map(x=>{const g=x.pots.filter(h=>x.potsWon.includes(h.itemId)).map(h=>h.itemTitle);return{id:x.id,username:x.username,platform:x.platform,totalDonation:`$${x.totalDonation}`,createdAt:b(x.createdAt).format("MM-DD-YYYY"),potNames:x.potNames.join(", "),donations:x.donations.map(h=>h.charity.itemTitle).join(", "),wonPots:g.join(", ")}}),k=Object.keys(u[0]).join(","),l=u.map(x=>Object.keys(u[0]).map(g=>x[g]).map(g=>{const h=`${g??""}`.replace(/"/g,'""');return/(\s|,|")/.test(h)?`"${h}"`:h}).join(",")).join(`
`),E=`${k}
${l}`;c(),oe("raffleEntries.csv",E),U("Current RAFL entries downloaded as raffleEntries.csv")},[c,p]);return e.jsxs("div",{children:[t?e.jsx(W,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{variant:"outlined",size:"small",onClick:a,style:{color:"#ddd",borderColor:"#aaa"},startIcon:e.jsx(X,{}),children:"Export"})}):e.jsx(W,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(re,{onClick:a,children:e.jsx(X,{})})}),e.jsxs(ae,{anchorEl:m,open:d,onClose:c,children:[!t&&e.jsxs(T,{disabled:!0,children:[e.jsx(Y,{children:e.jsx(X,{fontSize:"small"})}),e.jsx(V,{children:"Export"})]}),e.jsxs(T,{onClick:R,children:[e.jsx(Y,{children:e.jsx(De,{fontSize:"small"})}),e.jsx(V,{children:"Copy to clipboard"})]}),e.jsxs(T,{onClick:v,children:[e.jsx(Y,{children:e.jsx(ke,{fontSize:"small"})}),e.jsx(V,{children:"CSV"})]}),j&&e.jsxs(T,{onClick:A,children:[e.jsx(Y,{children:e.jsx(Se,{fontSize:"small"})}),e.jsx(V,{children:"JSON"})]})]})]})}function Ye({entry:t}){const{updateRaffleEntry:m,deleteRaffleEntry:f}=o.useContext(B),{statusLabels:d}=o.useContext(N),[a,c]=w.useState(null),C=!!a,j=g=>{c(g.currentTarget)},p=()=>{c(null)},A=o.useCallback(g=>{if(!g||g===t.status)return;const h={...t,status:g};g==="approved"?h.approvedAt=b().toISOString():g==="rejected"&&(h.rejectedAt=b().toISOString()),m(h).then(()=>{console.log("Entry status updated to",g)}).catch(L=>{console.error("Error updating entry status:",L)}),p()},[t,m]),R=t.status==="pending",v=t.status==="approved",u=t.status==="issues",k=t.status==="rejected",[l,E]=w.useState(!1),x=()=>{E(!1)};return e.jsxs(w.Fragment,{children:[e.jsx(W,{title:"Change Entry Status",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{variant:"contained",size:"small",endIcon:e.jsx(de,{}),onClick:j,style:{backgroundColor:d[t.status].backgroundColor,marginRight:0},children:t.status})}),e.jsx(ae,{open:C,anchorEl:a,onClose:p,children:e.jsxs(ce,{direction:"column",style:{minWidth:100},children:[e.jsx(T,{style:{color:R?"#fff":d.pending.backgroundColor},onClick:()=>A("pending"),disabled:R,children:"Pending"}),e.jsx(T,{style:{color:v?"#fff":d.approved.backgroundColor},onClick:()=>A("approved"),disabled:v,children:"Approved"}),e.jsx(T,{style:{color:u?"#fff":d.issues.backgroundColor},onClick:()=>A("issues"),disabled:u,children:"Issues"}),e.jsx(T,{style:{color:k?"#fff":d.rejected.backgroundColor},onClick:()=>A("rejected"),disabled:k,children:"Rejected"})]})}),e.jsxs(we,{open:l,onClose:x,children:[e.jsxs("div",{style:{padding:20,textAlign:"center"},children:["You cannot undo delete.",e.jsx("br",{}),"Are you sure?"]}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(F,{style:{marginBottom:10,color:"#000"},variant:"contained",onClick:()=>f(t).then(()=>E(!1)),edge:"start",color:"error",children:"Delete"})})]})]})}function Ve({entry:t,containerRef:m}){const{deleteRaffleEntry:f}=o.useContext(B),[d,a]=o.useState(!1),c=o.useCallback(()=>{a(!1)},[]),C=e.jsxs("div",{style:{textAlign:"center",fontWeight:700,fontSize:"1.1rem",padding:40},children:["You cannot undo delete.",e.jsx("br",{}),"Are you sure?",e.jsx("br",{}),e.jsx("br",{}),e.jsx(F,{style:{marginBottom:10,color:"#111"},variant:"contained",onClick:()=>f(t).then(()=>a(!1)),edge:"start",color:"error",children:"Delete"})]}),{isMobile:j}=ue();return e.jsxs(w.Fragment,{children:[e.jsx(W,{title:"Change Entry Status",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{variant:"text",size:"small",onClick:()=>a(!0),style:{color:"#e50808",margin:"0px 0px 0px 15px"},children:"Delete Entry"})}),e.jsx(le,{open:d,dialogContent:C,handleClose:c,containerRef:m,position:{top:80},centerX:!0,width:j?350:550})]})}function He({entry:t,containerRef:m}){var x;const{updateRaffleEntry:f}=o.useContext(B),[d,a]=o.useState(!1),c=o.useCallback(()=>{a(!0)},[]),C=o.useCallback(()=>{a(!1),p(t.notes||"")},[t.notes]),[j,p]=o.useState(t.notes||"");o.useEffect(()=>{p(t.notes||"")},[t.notes]);const A=g=>{p(g.target.value)},R=o.useCallback(()=>{const g={...t,notes:j||""};f(g,!1).then(()=>{console.log("Notes updated successfully")}).catch(h=>{console.error("Error updating notes:",h)}),C()},[t,C,j,f]),v=o.useCallback(()=>{const g={...t,notes:""};f(g,!1).then(()=>{}).catch(h=>{console.error("Error removing notes:",h)}),C()},[t,C,f]),{isMobile:u}=H(),k={fontSize:"1.0rem",fontWeight:400,marginBottom:5,paddingLeft:2,color:"#fff"},l=u?"0.95rem":"1.0rem",E=e.jsx("div",{style:{display:"flex"},children:e.jsxs("div",{style:{flexGrow:1,maxWidth:550,padding:10},children:[e.jsxs("div",{style:{marginTop:10,display:"flex"},children:[e.jsx("div",{style:{...k,flexGrow:1,fontWeight:700},children:"Entry Notes"}),e.jsxs("div",{style:{...k,color:"#aaa",fontSize:"0.85rem"},children:[j.length||0,"/1200"]})]}),e.jsx(Le,{type:"text",name:"notes",multiline:!0,fullWidth:!0,rows:3,value:j,onChange:A,id:"notes",color:"info",style:{},placeholder:"Add additional notes about this entry",variant:"outlined",autoFocus:!0,InputProps:{style:{fontSize:l}},slotProps:{htmlInput:{maxLength:1200}}}),e.jsxs("div",{style:{flexGrow:1,textAlign:"right",marginTop:8},children:[e.jsx(F,{variant:"text",size:"small",onClick:C,children:"Cancel"}),e.jsx(F,{variant:"text",size:"small",onClick:R,color:"success",children:"Save"})]})]})});return e.jsxs(ye,{sx:{position:"relative",overflow:"hidden",isolation:"isolate"},children:[((x=t.notes)==null?void 0:x.length)>0?e.jsxs("div",{style:{fontWeight:700,marginTop:15},children:[e.jsxs("div",{style:{display:"flex"},children:[e.jsx("span",{style:{marginTop:-.6},children:"Notes  "}),e.jsx(I,{style:{fontWeight:400,color:"#2bb259"},onClick:c,children:"edit"})," • ",e.jsx(I,{style:{fontWeight:400,color:"#2bb259"},onClick:v,children:"remove"})]}),e.jsx("div",{style:{fontSize:l,marginLeft:10,fontWeight:400,fontStyle:"italic"},children:t.notes})]}):e.jsx("div",{style:{fontWeight:700,marginTop:15},children:e.jsx(I,{style:{fontWeight:600,color:"#2bb259"},onClick:c,children:"Add notes"})}),e.jsx(le,{open:d,dialogContent:E,handleClose:C,containerRef:m,position:{top:80},centerX:!0,width:u?350:550})]})}function Ke({entry:t,expanded:m,onExpand:f,setEditEntryId:d}){var z,G;const{raffleAdminRole:a}=o.useContext(K),{expandAll:c,statusLabels:C}=o.useContext(N),{updateRaffleEntry:j}=o.useContext(B),p=me(),{filters:A}=o.useContext(Q),{sort:R}=A||{},[v,u]=o.useState(!1),k={maxWidth:700,marginLeft:"auto",marginRight:"auto"},l=o.useRef(null);o.useEffect(()=>{if(m&&l&&!v&&!c){console.log("entry",t);const i=window.innerWidth<=600?70:74;u(!0),setTimeout(()=>{window.scrollTo({left:0,top:l.current.offsetTop-i,behavior:m?"auto":"smooth"})},m?0:100)}else m||u(!1)},[m,t,v,c]);const E=o.useCallback((s,i)=>{f&&f(i?t==null?void 0:t.id:!1)},[t==null?void 0:t.id,f]),x=b(t==null?void 0:t.updatedAt).valueOf()-b(t==null?void 0:t.createdAt).valueOf()>6e4,g=o.useCallback(s=>{const i=window.open(s,"_blank","noopener,noreferrer");i&&(i.opener=null)},[]),h=o.useCallback(s=>{p(s)},[p]),L=o.useCallback(s=>{if(!a)return;const i=t.donations.map((r,D)=>D===s?{...r,approved:!r.approved}:r),n={...t,donations:i};j(n).then(()=>{console.log("Donation approval toggled")}).catch(r=>{console.error("Error updating donation approval:",r)})},[t,a,j]),{isMobile:S,flexStyle:O}=H(),P=S?"12px 0px 8px 0px":"12px 0px 8px 8px",M=S?"0.95rem":"1.0rem",y=S?2:10,$={no:{backgroundColor:"#333",color:"#aaa"},yes:{backgroundColor:"#aaa",color:"#fff"}};return e.jsxs(Ie,{expanded:m,onChange:E,style:k,ref:l,children:[e.jsxs(We,{expandIcon:e.jsx(Re,{}),sx:{".MuiAccordionSummary-content":{margin:"6px 0px"}},children:[e.jsx(Te,{value:C[t.status].entryColor}),e.jsxs("div",{style:{display:O,alignItems:"center",flexGrow:1},children:[e.jsxs("div",{style:{margin:P,display:"flex",flexGrow:1,fontWeight:600,color:((z=t.potsWon)==null?void 0:z.length)>0?"#2bb259":"#fff"},children:[t==null?void 0:t.username," ",e.jsxs("span",{style:{fontWeight:400,color:"#777",marginLeft:8},children:["(",t.platform.toLowerCase(),")"]}),((G=t.potsWon)==null?void 0:G.length)>0&&e.jsx("span",{style:{fontWeight:600,color:"#2bb259",marginLeft:12},children:"Winner"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[e.jsx(_,{name:"Submitted",value:e.jsx(J,{style:{fontSize:"0.95rem",lineHeight:1.25},children:b(t==null?void 0:t.createdAt).format("MMM DD")}),style:{marginRight:20}}),R==="updatedAt"&&e.jsx(_,{name:"Updated",value:e.jsx(J,{style:{fontSize:"0.95rem",lineHeight:1.25},children:b(t==null?void 0:t.updatedAt).format("MMM DD")}),textStyle:x?{}:{color:"#777"},style:{marginRight:30}}),e.jsx(_,{name:"Donations",value:e.jsxs(J,{style:{fontSize:"0.95rem",lineHeight:1.25},children:["$ ",Intl.NumberFormat().format(t.totalDonation)]}),textStyle:t.totalDonation!==t.allocatedTickets?{color:"#f33"}:{},style:{marginRight:20}})]})]})]}),m&&e.jsxs(w.Fragment,{children:[e.jsxs(Ne,{sx:{padding:"0px 16px 0px 16px",margin:"0px 10px"},children:[e.jsxs("div",{style:{textAlign:"right",margin:"0px 0px 10px 0px",fontWeight:700},children:["Entry Status  ",e.jsx(Ye,{entry:t})]}),e.jsx("div",{style:{fontWeight:500,fontSize:"0.8rem"},children:"DONATIONS"}),t.donations.map((s,i)=>{var n,r;return e.jsxs("div",{style:{display:"flex",flexGrow:1,alignItems:"center",fontSize:M,marginLeft:y,marginBottom:4},children:[e.jsx("div",{style:{fontWeight:500,flexGrow:1},children:((n=s.charity)==null?void 0:n.itemFullTitle)||((r=s.charity)==null?void 0:r.itemTitle)||"No Charity Selected"}),S?e.jsx(W,{title:"My Collection",arrow:!0,disableFocusListener:!0,children:e.jsx(re,{variant:"outlined",color:"inherit",onClick:()=>g(s.receipt),style:{marginRight:10},children:e.jsx(fe,{fontSize:"small"})})}):e.jsxs("div",{style:{display:"flex"},children:[s.receipt&&e.jsxs("span",{children:["Receipt: ",e.jsx(I,{style:{color:"#ccc",textDecoration:"underline",cursor:"pointer"},onClick:()=>g(s.receipt),children:(s.receipt.match(/^(?:https?:\/\/)?([^/?#]+)/i)||[])[1]}),"  "]}),s.amount>0&&e.jsxs("span",{style:{marginRight:6},children:["Donation: $ ",Intl.NumberFormat().format(s.amount)]})]}),e.jsx(F,{style:{minWidth:20,padding:"0px 5px",...$[s.approved?"yes":"no"]},onClick:()=>L(i),variant:"contained",children:"OK"})]},i)}),e.jsx("div",{style:{fontWeight:500,fontSize:"0.8rem",marginTop:10},children:"POTS"}),t.pots.map((s,i)=>e.jsxs("div",{style:{display:"flex",flexGrow:1,fontSize:M,marginLeft:10},children:[e.jsxs("div",{style:{fontWeight:500,marginBottom:4,flexGrow:1},children:[e.jsx(I,{style:{color:"#fff",textDecoration:"none",cursor:"pointer"},onClick:()=>h(`/rafl/?id=${s.itemId}`),children:(s==null?void 0:s.itemFullTitle)||(s==null?void 0:s.itemTitle)||"No Pot Selected"}),s.winner&&e.jsx(I,{style:{color:"#2bb259",fontWeight:700,marginLeft:12},onClick:()=>h(`/rafl/?id=${s.itemId}`),children:"Winner"})]}),e.jsx("div",{style:{marginBottom:4},children:(s==null?void 0:s.tickets)>0&&e.jsxs("span",{style:{marginRight:12},children:["Tickets: ",Intl.NumberFormat().format(s.tickets)]})})]},i)),e.jsx(He,{entry:t,containerRef:l}),e.jsxs("div",{style:{fontSize:"0.9rem",fontWeight:400,marginTop:10,textAlign:"right"},children:["Last updated: ",b(t==null?void 0:t.updatedAt).format("MMM DD")]}),e.jsx("div",{style:{textAlign:"center",margin:"15px 0px 5px 0px"},children:e.jsx(W,{title:"Edit Entry",arrow:!0,disableFocusListener:!0,children:e.jsx(F,{variant:"contained",size:"small",onClick:()=>{d(t.id)},style:{backgroundColor:"#2bb259",color:"#000",padding:"6px 14px"},children:"EDIT ENTRY"})})})]}),e.jsxs(Me,{disableSpacing:!0,children:[e.jsx("div",{style:{display:"flex",flexGrow:1},children:e.jsx(Ve,{entry:t,containerRef:l})}),e.jsx(Fe,{entry:t})]})]})]})}const Ue=w.memo(Ke,(t,m)=>{const f=Object.keys(t.entry),d=Object.keys(m.entry);if(f.length!==d.length)return!1;for(let a=0;a<f.length;a++)if(f[a]!==d[a]||t.entry[f[a]]!==m.entry[d[a]])return!1;return t.expanded===m.expanded&&t.onExpand===m.onExpand});function Je({editEntryId:t,setEditEntryId:m}){const{filters:f}=o.useContext(Q),[d,a]=o.useState(f.id),{visibleEntries:c,expandAll:C}=o.useContext(N);ze("RAFL Admin - Submitted Entries");const j=o.useDeferredValue(d),p=o.useCallback(v=>{a(v)},[]),{isMobile:A}=H(),R=A?{maxWidth:700,marginLeft:"auto",marginRight:"auto",padding:8}:{maxWidth:700,marginLeft:"auto",marginRight:"auto",padding:"12px 12px 12px 12px"};return e.jsxs("div",{style:{paddingBottom:32},children:[e.jsx("div",{style:{...R,paddingBottom:0,backgroundColor:"#333"},children:e.jsx("div",{style:{padding:"4px 4px 4px 4px"},children:e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:500,marginTop:1,marginBottom:0},children:"Submitted RAFL Entries"})})}),e.jsx(Ae,{label:"Raffle Entries",sortValues:Ee,entryCount:c.length}),e.jsx(be,{}),c.length===0&&e.jsx(ve,{label:"Rafl Entries"}),c.map(v=>e.jsx(Ue,{entry:v,onExpand:p,expanded:v.id===j||!!C,editId:t,setEditEntryId:m},v.id)),e.jsx("div",{style:{marginLeft:"auto",marginRight:"auto",textAlign:"center",justifyItems:"center",marginTop:30},children:e.jsx(Ge,{text:!0})})]})}function Xe({children:t}){const m=o.useContext(N),{entriesLoaded:f,allRaffleEntries:d,winnerData:a}=o.useContext(B),{allPots:c}=o.useContext(K),{filters:C,advancedFilterGroups:j}=o.useContext(Q),{search:p,id:A,tab:R,name:v,sort:u,image:k,preview:l,single:E,expandAll:x,...g}=C||{},h=o.useMemo(()=>Object.keys(a).reduce((s,i)=>(a[i].map(n=>{$e(s,[n.entryId],i)}),s),{}),[a]),L=.3,S=o.useMemo(()=>{let s={},i={};return d==null||d.forEach(n=>{n.donations.forEach(r=>{ne(s,[n.id],r.charity.itemFullTitle)},[]),n.pots.forEach(r=>{var D;ne(i,[n.id],r.itemTitle),(D=h[n.id])!=null&&D.includes(r.itemId)&&(r.winner=!0)},[])},{}),d.map(n=>{var r;return{...n,charities:s[n.id]||[],potNames:i[n.id]||[],content:[n.notes&&n.notes.length>0&&"Has Notes",n.donations.every(D=>D.approved)?"All Donations OK":"Donations not OK"].filter(Boolean),potsWon:h[n.id]||[],potWinner:((r=h[n.id])==null?void 0:r.length)>0?"Won Pots":"No Wins",fuzzy:Pe([n.username,...s[n.id],...i[n.id]].join(","))}})},[d,h]),O=o.useMemo(()=>S.reduce((s,i)=>(i.pots.forEach(n=>{s.push({username:i.username,entryId:i.id,platform:i.platform,potId:n.itemId,potTickets:n.tickets})}),s),[]),[S]),P=o.useMemo(()=>q(p,[...S],L),[S,p]),M=o.useMemo(()=>{if(!f)return[];const s=ie({advancedFilterGroups:j(),entries:S}),i=q(p,[...s],L);return u?i.sort((n,r)=>{var D;return u==="updatedAt"?b(n.updatedAt).isBefore(b(r.updatedAt))?1:-1:u==="status"?te(n.status,r.status):u==="username"?(D=n.username)==null?void 0:D.localeCompare(r.username):u==="totalDonation"?r.totalDonation-n.totalDonation:b(n.createdAt).isBefore(b(r.createdAt))?1:-1}):i.sort((n,r)=>b(n.createdAt).isBefore(b(r.createdAt))?1:-1)},[j,f,S,p,u]),y=o.useMemo(()=>c.map(s=>{const i=O.filter(n=>n.potId===s.id);return i.length>0&&(s.entrants=i),s},[]),[c,O]),$=o.useMemo(()=>{const s=ie({advancedFilterGroups:j(),entries:S}),i=q(p,[...s],L);return u?i.sort((n,r)=>{var D;return u==="updatedAt"?b(n.updatedAt).isBefore(b(r.updatedAt))?1:-1:u==="status"?te(n.status,r.status):u==="username"?(D=n.username)==null?void 0:D.localeCompare(r.username):u==="totalDonation"?r.totalDonation-n.totalDonation:b(n.createdAt).isBefore(b(r.createdAt))?1:-1}):i.sort((n,r)=>n.potNumber-r.potNumber)},[j,S,p,u]),z=o.useCallback(s=>y.find(i=>i.id===s),[y]),G=o.useMemo(()=>({...m,allEntries:d,searchedEntries:P,visibleEntries:M,mappedPotEntries:y,visiblePotEntries:$,getPotFromId:z,expandAll:x,statusLabels:_e}),[m,d,P,M,y,$,z,x]);return e.jsx(N.Provider,{value:G,children:t})}const _e={pending:{entryColor:"Blue",backgroundColor:"#3e71bd",textColor:"#fff"},approved:{entryColor:"Green",backgroundColor:"#34732f",textColor:"#fff"},issues:{entryColor:"Orange",backgroundColor:"#e16936",textColor:"#fff"},rejected:{entryColor:"Red",backgroundColor:"#c52323",textColor:"#fff"}};function eo(){const{raffleAdmin:t,setRaffleAdminRole:m}=o.useContext(K),{authLoaded:f,isLoggedIn:d}=o.useContext(pe);o.useEffect(()=>{t&&m(!0)});const{isMobile:a}=H(),[c,C]=o.useState(null),j=e.jsxs(w.Fragment,{children:[!a&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}}),e.jsx(Ce,{})]});if(!f)return e.jsx(Oe,{message:"Loading..."});if(f&&!t)return e.jsxs(w.Fragment,{children:[e.jsx(Z,{title:"RAFL Admin",extras:j}),e.jsx(se,{page:"RAFL Admin"}),e.jsxs("div",{style:{padding:20},children:[!d&&e.jsx("div",{children:"Please log in to access this page."}),d&&!t&&e.jsx("div",{children:"Sorry, you do not have access to this page."}),e.jsx("div",{children:e.jsx(xe,{})})]}),e.jsx(ee,{})]});const p=a?8:0,A={maxWidth:700,marginLeft:"auto",marginRight:"auto",paddingLeft:p,paddingRight:p};return e.jsx(he,{filterFields:je,children:e.jsx(Xe,{children:e.jsxs("div",{style:A,children:[e.jsx(Z,{title:"RAFL Admin",extras:j}),e.jsx(se,{page:"entries"}),t&&!c&&e.jsx(Je,{editEntryId:c,setEditEntryId:C}),t&&!!c&&e.jsx(Be,{editEntryId:c,setEditEntryId:C}),e.jsx(ee,{}),e.jsx(ge,{feature:"raflAdmin"})]})})})}export{eo as default};
