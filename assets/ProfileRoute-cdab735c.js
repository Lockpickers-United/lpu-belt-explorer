import{j as e,R as P,af as A,r as u,U as F,V as R,W,J as N,K as I,ag as H,N as U,O as z,H as O,P as V}from"./index-293be1ac.js";import{D as G,a as Y,l as $}from"./index-48bb39fc.js";import{S as q,F as J,a as K,l as Q}from"./sortFields-9c3b9dec.js";import{D as X}from"./LockDataProvider-b19af0b1.js";import{L as Z,a as _}from"./LockListContext-30382c81.js";import{C as ee,E as te,T as ie}from"./ToggleCompactButton-95d34a2c.js";import{L as oe}from"./LoadingDisplay-63aadae7.js";import{u as se}from"./useData-fb32821a.js";import{u as j}from"./useWindowSize-d3ee98d3.js";import{N as re}from"./NoProfileData-2a0d3cbc.js";import{P as ae}from"./ProfileNotFound-901e540f.js";import{I as ne}from"./InlineFilterDisplay-e5f8469d.js";import{B as E}from"./nivo-bar.es-dcb35ce0.js";import{p as T}from"./chartDefaults-9fc07b21.js";import{P as de}from"./ProfileHeader-5d83c520.js";import"./Select-2d4941c8.js";import"./Box-6034a772.js";import"./Search-c1c643b0.js";import"./Sort-e5f5c30b.js";import"./TextField-2b309090.js";import"./entryName-192dc334.js";import"./BeltStripe-0cd90d17.js";import"./CollectionButton-044292df.js";import"./PhotoCamera-e05f9fee.js";import"./Launch-0b0e5421.js";import"./LoadingDisplay-f9ff9081.js";import"./FieldValue-c610d157.js";import"./Autocomplete-721a1c84.js";import"./index-69660ef2.js";import"./Dialog-63f91994.js";import"./ListItem-68ba8ab9.js";import"./AccordionSummary-c352edb4.js";import"./index-a2797a69.js";import"./index-54f98964.js";import"./AccordionActions-5ede6bee.js";import"./LPU-c3fa7122.js";import"./LinearProgress-225c00fc.js";import"./mycollection-0ec86312.js";import"./ImageViewer-fd0f2738.js";import"./Link-64e9153f.js";import"./ContentCopy-f8d779de.js";import"./nivo-legends.es-128e555c.js";import"./CopyProfileLinkButton-1831112c.js";import"./ToggleButtonGroup-a0db729d.js";import"./Link-cf979514.js";function le({lockCollection:s,userText:l,collectionBarHeight:h}){const c=s.own?s.own.length:0,x=s.picked?s.picked.length:0,r=s.recordedLocks?s.recordedLocks.length:0,a=s.wishlist?s.wishlist.length:0,t=c+x+r+a?{own:c,picked:x,recorded:r,wishlist:a}:{own:0,picked:0,recorded:0,wishlist:0},o={own:14,picked:11,recorded:11,wishlist:8},m={own:250,picked:280,recorded:260,wishlist:100},i={own:Math.min(o.own,t.own),picked:Math.min(o.picked,t.picked),recorded:Math.min(o.recorded,t.recorded),wishlist:Math.min(o.wishlist,t.wishlist)},n={own:t.own>o.own?0:o.own-i.own,picked:t.picked>o.picked?0:o.picked-i.picked,recorded:t.recorded>o.recorded?0:o.recorded-i.recorded,wishlist:t.wishlist>o.wishlist?0:o.wishlist-i.wishlist},g={own:2,picked:2,recorded:2,wishlist:2},M={own:Math.max(t.own-(i.own+n.own+g.own),0),picked:Math.max(t.picked-(i.picked+n.picked+g.picked),0),recorded:Math.max(t.recorded-(i.recorded+n.recorded+g.recorded),0),wishlist:Math.max(t.wishlist-(i.wishlist+n.wishlist+g.wishlist),0)},y={own:Math.min(m.own-t.own,m.own-o.own-g.own),picked:Math.min(m.picked-t.picked,m.picked-o.picked-g.picked),recorded:Math.min(m.recorded-t.recorded,m.recorded-o.recorded-g.recorded),wishlist:Math.min(m.wishlist-t.wishlist,m.wishlist-o.wishlist-g.wishlist)},k=["own","picked","recorded","wishlist"],S=k.map((w,f)=>({row:k[f],"Average A":i[w],"Average B":n[w],Average:g[w],USER:M[w],"Top 10":y[w]})),{width:B}=j(),L=B<=560,C=h,D=L?{top:10,right:20,bottom:50,left:55}:{top:10,right:20,bottom:50,left:55},b=["#3c90c5","#aaa","#000","#3c90c5","#aaa"],d=s?[{title:l,color:"#3c90c5",width:"14px"}]:[];d.push({title:"Average",color:"#000",width:"35px"},{title:"Top 10 Average",color:"#aaaaaa",width:"120px"});const v=({items:w})=>e.jsxs("div",{className:"chart-legend",style:{display:"flex",fontSize:".9rem",color:"#ddd",marginTop:13},children:[e.jsx("div",{style:{width:"100%"}}),w.map(f=>e.jsxs("div",{style:{display:"flex",padding:"0px 18px 24px 18px"},children:[e.jsx("div",{style:{backgroundColor:f.color,height:15,width:15,margin:"2px 6px 0px 0px",border:"1px solid #555"}}),e.jsx("div",{style:{textAlign:"left",width:f.width},children:f.title})]},f.title)),e.jsx("div",{style:{width:"100%"}})]});return e.jsxs(P.Fragment,{children:[e.jsx("div",{style:{height:C},children:e.jsx(E,{data:S,keys:["Average A","Average B","Average","USER","Top 10"],theme:T,indexBy:"row",margin:D,padding:.2,valueScale:{type:"linear"},colors:b,enableLabel:!1,axisLeft:{tickSize:5,tickPadding:5,tickRotation:0,tickValues:5,format:"00",legend:"Saves",legendPosition:"middle",legendOffset:-45,legendOpacity:.9},axisBottom:{tickRotation:-45},enableGridY:!1,isInteractive:!1,animate:!1})}),e.jsx(v,{items:d})]})}function ce({beltData:s}){const{width:l}=j(),h=l<=360,c=l<=560,x=175,r=c?{top:15,right:20,bottom:60,left:20}:{top:0,right:10,bottom:60,left:10},a=["#d5d5d5","#d8d801","#ed7d01","#389700","#0090de","#634b9f","#9d5918","#ba0303","#000","#373737"],p=["#000","#000","#000","#000","#000","#000","#000","#000","#ddd","#ddd"];return e.jsxs("div",{style:{height:x,padding:"0px 8px 0px 8px",width:"100%"},children:[e.jsx(E,{data:s,margin:r,padding:.15,colors:t=>a[t.index%a.length],animate:!0,axisBottom:{tickRotation:-45},axisLeft:null,enableGridY:!1,theme:T,isInteractive:!1,enableLabel:!0,label:t=>t.data.count,labelSkipWidth:12,labelSkipHeight:12,labelTextColor:t=>p[t.index%p.length]}),e.jsx("div",{className:"chart-legend",style:{fontSize:".9rem",color:"#ddd",textAlign:"center",width:"100%",marginTop:"3px"},children:"Belt Distribution"})]},"bar")}function pe({profile:s,entries:l}){const{userId:h}=A(),{user:c}=u.useContext(F),x=h===(c==null?void 0:c.uid)?"You":"User",r=u.useMemo(()=>{const D=N.concat("Unranked"),b=l.map(({belt:d})=>d.includes("Black")?"Black":d).reduce((d,v)=>(d[v]||(d[v]=0),d[v]++,d),{});return D.map(d=>({id:d,label:d,count:b[d]||0,value:b[d]||0}))},[l]),{isMobile:a}=j(),p=a?{maxWidth:700,borderRadius:0}:{maxWidth:700,marginLeft:"auto",marginRight:"auto",borderRadius:0},{width:t}=j(),o=t<=360,m=t<=395,i=t<=428,n=t<=560,y={...{width:"100%",padding:"0px",marginBottom:12,alignItems:"center",marginLeft:"auto",marginRight:"auto"},...n?{}:{display:"flex"}},k=n?"100%":"50%",S=n?"100%":"50%",B=o?200:n?210:180,L=n?160:170,C=o?150:170;return e.jsx(R,{style:p,sx:{paddingBottom:5},children:e.jsx(W,{style:{paddingTop:0,paddingLeft:8},children:e.jsx("div",{style:{textAlign:"center"},children:e.jsxs("div",{style:y,children:[e.jsx("div",{style:{width:k,verticalAlign:"top",height:B},children:e.jsx(le,{lockCollection:s,userText:x,collectionBarHeight:L})}),e.jsx("div",{style:{width:S,height:C,marginTop:"0px"},children:e.jsx(ce,{beltData:r})})]})})})})}function me({profile:s,owner:l}){const{compact:h}=u.useContext(Z),[c,x]=u.useState(!1),{visibleEntries:r=[]}=u.useContext(G),a=u.useDeferredValue(c);return e.jsx(P.Fragment,{children:e.jsxs("div",{style:{maxWidth:700,padding:0,backgroundColor:"#222",marginLeft:"auto",marginRight:"auto",marginTop:16},children:[e.jsx(de,{profile:s,page:"collection",owner:l}),e.jsx(ne,{profile:s,collectionType:"locks"}),e.jsx(pe,{profile:s,entries:r}),h?e.jsx(ee,{entries:r}):r.map(p=>e.jsx(te,{entry:p,expanded:p.id===a,onExpand:x},p.id))]})})}function st(){const{user:s}=u.useContext(F),{userId:l}=A(),{getProfile:h}=u.useContext(I),{isMobile:c}=j(),x=u.useCallback(async()=>{try{const i=await h(l);if(i){const n=i.displayName?i.displayName.toLowerCase().endsWith("s")?`${i.displayName}'`:`${i.displayName}'s`:"Anonymous";document.title=`LPU Belt Explorer - ${n} Profile`}return i}catch(i){return console.error("Error loading profile.",i),null}},[h,l]),{data:r={},loading:a,error:p}=se({loadFn:x}),t=u.useMemo(()=>{if(a||!r)return[];const i=new Set(H.locks.getCollected(r));return U.filter(n=>i.has(n.id))},[r,a]),o=e.jsxs(P.Fragment,{children:[e.jsx(q,{label:"Collection"}),e.jsx(J,{}),e.jsx(K,{sortValues:Q}),!c&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}}),e.jsx(ie,{})]}),m=a?"Loading...":"Profile";return e.jsx(Y,{filterFields:$,children:e.jsx(X,{allEntries:t,profile:r,children:e.jsxs(_,{children:[e.jsx(z,{title:m,extras:o}),a&&e.jsx(oe,{}),!a&&r&&!p&&e.jsx(me,{profile:r,owner:s&&s.uid===l}),!a&&r&&!p&&t.length===0&&e.jsx(re,{}),!a&&(!r||p)&&e.jsx(ae,{}),e.jsx(O,{}),e.jsx(V,{feature:"profile"})]})})})}export{st as default};
