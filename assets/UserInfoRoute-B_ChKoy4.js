import{r as l,A as _,D as tt,F as ct,S as ot,ao as ht,aE as xt,j as t,d as jt,B as Y,h as ut,e as yt,N as mt}from"./index-vdXsU-gu.js";import{c as gt}from"./dataUrls-DVxTtpO-.js";import{a as kt,b as Ct}from"./ScorecardListContext-4oHhwCgE.js";import{L as et}from"./LoadingDisplay-DOkW9b6R.js";import{u as Z}from"./useData-K1mXcoyJ.js";import{L as vt,A as pt}from"./LocalizationProvider-CIEQ4kYa.js";import{T as ft}from"./TextField-DWcMNEPy.js";import{M as Lt}from"./MustBeLoggedIn-eVsvFMua.js";import"./filterEntriesAdvanced-D7ipahm-.js";import"./DataContext-CNYiouxs.js";import"./index-GwAjqjc_.js";import"./Box-DXAA_9n6.js";import"./CircularProgress-CCSxTfDQ.js";import"./Select-B2EjZX8a.js";import"./useFormControl-C0dQnbkd.js";function bt(){var q,M,$,K,V,G,H,J,Q,X;const{user:s,userClaims:j}=l.useContext(_),{getProfile:u,getPickerActivity:o,adminRole:h}=l.useContext(tt),{filters:st={},addFilters:a}=l.useContext(ct),{uid:x,name:k}=st,{scoredActivity:D,bbCount:A,danPoints:I,eligibleDan:w,nextDanPoints:B,nextDanLocks:U,uniqueLocks:S,maxBelt:N}=l.useContext(ot),[c,C]=l.useState(s==null?void 0:s.uid),[v,p]=l.useState(x||(s==null?void 0:s.uid)||"");l.useEffect(()=>{const d=h?x||(s==null?void 0:s.uid)||"":(s==null?void 0:s.uid)||"";p(d),d!==c&&C(d)},[h,x,s,c]);const nt=l.useCallback(async()=>{var d;try{const i=await u(c);if(i){const b=i.displayName&&!i.privacyAnonymous?(d=i==null?void 0:i.displayName)!=null&&d.toLowerCase().endsWith("s")?`${i.displayName}'`:`${i.displayName}'s`:"Anonymous";document.title=`LPU Belt Explorer - ${b} User Info`}if((s==null?void 0:s.uid)!==c){const b=await o(c);return{profile:i,...ht(b)}}else return{profile:i,scoredActivity:D,bbCount:A,danPoints:I,eligibleDan:w,nextDanPoints:B,nextDanLocks:U,uniqueLocks:S,maxBelt:N}}catch(i){return console.error("Error loading profile and activity.",i),null}},[u,c,s,o,D,A,I,w,B,U,S,N]),{data:r={},loading:y,error:f}=Z({loadFn:nt}),e=l.useMemo(()=>r?r.profile:{},[r]);l.useEffect(()=>{s&&!x&&a([{key:"uid",value:s.uid}],!0)},[a,x,s]),l.useEffect(()=>{e&&(!k||e.displayName&&k!==e.displayName)&&a([{key:"name",value:encodeURIComponent(e==null?void 0:e.displayName)}],!0)},[a,k,e]);const dt=r?r.scoredActivity:[],P=r?r.bbCount:0,E=r?r.danPoints:0,R=r?r.eligibleDan:0,F=r?r.nextDanPoints:0,W=r?r.nextDanLocks:0,O=r?r.uniqueLocks:0,z=r?r.scoredActivity.filter(d=>d.collectionDB==="awards").map(d=>xt[d.matchId]).filter(d=>d.awardType==="belt").sort((d,i)=>d.rank-i.rank):[],m=r?z[z.length-1]:{},g=Z({url:gt}),rt=g.data?g.data.blackBeltOnly.listStats.recordedLocks.topItems:[],it=g.data?g.data.allUsers.listStats.recordedLocks.topItems:[],lt=void 0,L={fontWeight:700,backgroundColor:"#333",padding:2,textAlign:"left",marginTop:10},n={fontWeight:700,paddingRight:10},T=l.useCallback(()=>{const i=(v||"").trim()||(s==null?void 0:s.uid)||"";a([{key:"uid",value:i},{key:"name",value:void 0}],!0),C(i)},[v,a,s]),at=l.useCallback(()=>{const d=(s==null?void 0:s.uid)||"";p(d),a([{key:"uid",value:d},{key:"name",value:void 0}],!0),C(d)},[a,s]);return y||f?null:t.jsx(kt,{cardActivity:dt,cardBBCount:P,cardDanPoints:E,cardEligibleDan:R,cardNextDanPoints:F,cardNextDanLocks:W,cardUniqueLocks:O,cardMaxBelt:m,popularLocks:it,popularLocksBB:rt,children:t.jsx(Ct,{children:t.jsxs(vt,{adapterLocale:jt.locale(),dateAdapter:pt,children:[y&&t.jsx(et,{}),!y&&r&&!f&&t.jsxs("div",{style:{minWidth:"320px",height:"100%",padding:20,backgroundColor:"#000",marginLeft:"auto",marginRight:"auto",justifyItems:"center",fontSize:"0.95rem"},children:[h&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[t.jsx(ft,{label:"View user by UID",variant:"outlined",size:"small",value:v,onChange:d=>p(d.target.value),onKeyDown:d=>{d.key==="Enter"&&T()},style:{flex:1,minWidth:360}}),t.jsx(Y,{variant:"contained",color:"secondary",size:"small",onClick:T,children:"Load"}),t.jsx(Y,{variant:"text",color:"inherit",size:"small",onClick:at,children:"Reset to me"})]}),t.jsxs("table",{id:"userInfo",children:[t.jsx("thead",{children:t.jsxs("tr",{style:L,children:[t.jsx("th",{children:"Parameter"}),t.jsx("th",{children:"Value"})]})}),t.jsxs("tbody",{children:[t.jsx("tr",{style:{height:10}}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"display name"}),t.jsx("td",{children:e==null?void 0:e.displayName})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"user id"}),t.jsx("td",{children:c})]}),(s==null?void 0:s.uid)===c&&t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"user claims"}),t.jsx("td",{children:j.join(", ")})]}),(e==null?void 0:e.admin)&&t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"profile.admin"}),t.jsx("td",{children:"true"})]}),t.jsx("tr",{style:{height:10}}),t.jsx("tr",{children:t.jsx("td",{style:L,colSpan:2,children:"SCORECARD"})}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"blackBeltAwarded"}),t.jsx("td",{children:e!=null&&e.blackBeltAwardedAt?"true":""})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"cardMaxBelt"}),t.jsx("td",{children:m==null?void 0:m.name})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"cardBBCount"}),t.jsx("td",{children:P})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"cardDanPoints"}),t.jsx("td",{children:E})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"cardEligibleDan"}),t.jsx("td",{children:R})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"cardNextDanPoints"}),t.jsx("td",{children:F})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"cardNextDanLocks"}),t.jsx("td",{children:W})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"cardUniqueLocks"}),t.jsx("td",{children:O})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"projects"}),t.jsx("td",{children:(q=e==null?void 0:e.projects)==null?void 0:q.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"tabClaimed"}),t.jsx("td",{children:e==null?void 0:e.tabClaimed})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"redditUsername"}),t.jsx("td",{children:e==null?void 0:e.redditUsername})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"discordUsername"}),t.jsx("td",{children:e==null?void 0:e.discordUsername})]}),t.jsx("tr",{style:{height:10}}),t.jsx("tr",{children:t.jsx("td",{style:L,colSpan:2,children:"LOCK COLLECTION"})}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"any"}),t.jsx("td",{children:(M=e==null?void 0:e.any)==null?void 0:M.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"own"}),t.jsx("td",{children:($=e==null?void 0:e.own)==null?void 0:$.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"picked"}),t.jsx("td",{children:(K=e==null?void 0:e.picked)==null?void 0:K.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"recorded"}),t.jsx("td",{children:(V=e==null?void 0:e.recorded)==null?void 0:V.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"wishlist"}),t.jsx("td",{children:(G=e==null?void 0:e.wishlist)==null?void 0:G.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"safelocksAny"}),t.jsx("td",{children:(H=e==null?void 0:e.safelocksAny)==null?void 0:H.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"safelocksCracked"}),t.jsx("td",{children:(J=e==null?void 0:e.safelocksCracked)==null?void 0:J.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"safelocksOwn"}),t.jsx("td",{children:(Q=e==null?void 0:e.safelocksOwn)==null?void 0:Q.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:n,children:"safelocksWishlist"}),t.jsx("td",{children:(X=e==null?void 0:e.safelocksWishlist)==null?void 0:X.length})]})]})]})]}),!y&&(!r||f)&&t.jsx("div",{style:{minWidth:"320px",height:"100%",padding:20,backgroundColor:"#000",marginLeft:"auto",marginRight:"auto",justifyItems:"center",fontSize:"0.95rem",textalign:"center"},children:"no user"}),t.jsx(ut,{before:lt})]})})})}function Tt(){const{authLoaded:s,isLoggedIn:j,user:u}=l.useContext(_),{dbLoaded:o}=l.useContext(tt),h=!s||!o?"Loading...":"User Info";return t.jsxs(yt,{filterFields:[],children:[t.jsx(mt,{title:h}),(!s||!o)&&t.jsx(et,{}),s&&!j&&t.jsx(Lt,{actionText:"view user information"}),s&&j&&o&&t.jsx(bt,{user:u})]})}export{Tt as default};
