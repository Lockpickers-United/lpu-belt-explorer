import{b as $,r as m,j as t,u as D,d as w,R as N,N as P,F as B,T as H}from"./index-c91c6dc7.js";import{D as M,a as E,r as Y}from"./filterFields-135bc320.js";import{R as G,A as V}from"./AdminRoleButton-d11a84c3.js";import{R as _}from"./RaffleDataProvider-f7d2bc0f.js";import{a as W}from"./RaffleContext-ef40e372.js";import{R as q}from"./RaffleHeader-4fa0bdc1.js";import{L as J}from"./LoadingDisplay-b7a726a6.js";import{u as K}from"./useData-220526a2.js";import{u as O}from"./usePageTitle-2c3fef25.js";import{s as Q,i as U}from"./dataUrls-b0d1ea1b.js";import{A as z}from"./AdminStatsTableSort-4927ada5.js";import{L as X}from"./Link-c9403dd1.js";import{R as Z}from"./RaffleStatsHeader-d19c4b28.js";import{R as tt}from"./RaffleSubHead-6c4a8987.js";import{R as et}from"./RaffleNotLiveDialog-e7336c93.js";import"./index-e752dc85.js";import"./LPU-c3fa7122.js";import"./LinearProgress-252a1cb9.js";import"./useDocumentTitle-0e09eb5d.js";import"./TableRow-653fbca3.js";import"./Dialog-cee44008.js";const st=({data:f,tableWidth:l,nameLength:d})=>{const i=$(),{potViewsById:x}=f,{getPotFromId:r}=m.useContext(M),S=[{id:"title",align:"left",name:"Title"},{id:"donors",name:"Donors",align:"center"},{id:"tickets",name:"Tickets",align:"center"}],h=!0,[a,g]=m.useState("title"),[j,R]=m.useState(!0),y=x.data.map(n=>{var C;const e=r(n.id);if(!e)return null;let c=e!=null&&e.title?e.title.substring(0,d):`unknown (${n.id})`;return c=((C=e==null?void 0:e.title)==null?void 0:C.length)<d||!(e!=null&&e.title)?c:c+"...",{...n,...e,title:c}}).filter(n=>n).sort((n,e)=>{switch(a){case"title":return n[a].localeCompare(e[a]);case"donors":return parseInt(e[a])-parseInt(n[a])||n.title.localeCompare(e.title);case"tickets":return parseInt(e[a])-parseInt(n[a])||n.views-e.views;default:return parseInt(e[a])-parseInt(n[a])||n.title.localeCompare(e.title)}}),p=(j?y:y.reverse()||[]).map(n=>n.donors&&n.donors>0?{...n}:{...n,donors:0,tickets:0}),b={columns:S,data:p},k=m.useCallback((n,e)=>{const c=y.find(L=>L.title===e),C=c==null?void 0:c.title.replace(/[\s/]/g,"_").replace(/\W/g,"");return n==="title"?t.jsx(X,{onClick:()=>i(`/rafl/?id=${c.id}&name=${C}`),style:{color:"#fff"},children:e}):e},[i,y]),{width:u}=D(),F=u<=360,T=u<=395,A=u<=428,s=u<=560,o=u<=820,v=F||T?".8rem":A?".9rem":".95rem";return t.jsx("div",{children:t.jsx(z,{tableData:b,tableWidth:l,fontSize:v,sortable:h,sort:a,setSort:g,ascending:j,setAscending:R,linkFunction:k})})},nt=({tableWidth:f,nameLength:l})=>{const{allCharities:d}=m.useContext(W),i=[{id:"displayName",align:"left",name:"Charity Name"},{id:"donors",name:"Donors",align:"center"},{id:"donations",name:"Raised",align:"center"}],x=!0,[r,S]=m.useState("name"),[h,a]=m.useState(!0),g=d.sort((s,o)=>{switch(r){case"name":return s.name.localeCompare(o.name);case"donors":return o[r]-s[r];case"donations":return o[r]-s[r];default:return s.name.localeCompare(o.name)}}),R=(h?g:g.reverse()).map(s=>{var v;let o=s!=null&&s.name?s==null?void 0:s.name.substring(0,l):"unknown";return o=((v=s==null?void 0:s.name)==null?void 0:v.length)<l?o:o+"...",s.donations&&s.donations>0?{...s,donations:`$${s.donations}`,displayName:o}:{...s,displayName:o}}),y={columns:i,data:R},I=m.useCallback((s,o)=>o,[]),{width:p}=D(),b=p<=360,k=p<=395,u=p<=428,F=p<=560,T=p<=820,A=b?".8rem":k?".85rem":u?".9rem":".95rem";return t.jsxs("div",{children:[t.jsx("div",{style:{justifyItems:"center",marginBottom:20},children:t.jsx("div",{style:{width:400}})}),t.jsx(z,{tableData:y,tableWidth:f,fontSize:A,sortable:x,sort:r,setSort:S,ascending:h,setAscending:a,linkFunction:I})]})};function at(){O("RAFL Report");const{data:f,loading:l,error:d}=K({urls:ot}),{siteFullNew:i}=f||{},{width:x,isMobile:r}=D(),S=l?"--":"(updated: "+w(i==null?void 0:i.metadata.updatedDateTime).format("MM/DD/YY hh:mm")+` ${i==null?void 0:i.metadata.timezone})`,h={margin:"26px 0px 18px 0px",width:"100%",textAlign:"center",color:"#fff",fontSize:"1.3rem",fontWeight:700},a={margin:"46px 0px 18px 0px",width:"100%",textAlign:"center",color:"#fff",fontSize:"1.3rem",fontWeight:700},g=r?"8px 8px 32px 8px":"24px 24px 32px 24px",j=x<=560?x-20:650,R=r?24:48;return l?t.jsx(J,{}):d?null:t.jsxs("div",{style:{minWidth:"320px",maxWidth:700,height:"100%",padding:g,backgroundColor:"#292929",marginLeft:"auto",marginRight:"auto"},children:[t.jsx(Z,{}),t.jsx("div",{style:{width:"100%",textAlign:"center",color:"#fff"},children:t.jsx("span",{style:{fontSize:"0.8rem",marginTop:10},children:S})}),t.jsx("div",{style:h,children:"Pots"}),t.jsx(st,{data:i,tableWidth:j,nameLength:R}),t.jsx("div",{style:a,children:"Charities"}),t.jsx(nt,{data:i,tableWidth:j,nameLength:R})]})}const ot={siteFullNew:Q,raflResponseDetails:U};function Ft(){const{isMobile:f}=D(),{allPots:l}=m.useContext(W),d=t.jsxs(N.Fragment,{children:[!f&&t.jsx("div",{style:{flexGrow:1,minWidth:"10px"}}),t.jsx(G,{active:!0}),t.jsx(V,{})]});return t.jsx(E,{filterFields:Y,children:t.jsx(_,{allEntries:l,children:t.jsxs(N.Fragment,{children:[t.jsx(P,{title:"RAFL Stats",extras:d}),t.jsx(q,{page:"stats"}),t.jsx(tt,{text:"Stats!"}),t.jsx(at,{}),t.jsx(B,{}),t.jsx(H,{feature:"raflStats"}),t.jsx(et,{})]})})})}export{Ft as default};
