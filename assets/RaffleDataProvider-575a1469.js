import{r as a,ao as N,j}from"./index-80de3ed1.js";import{F as k,r as b,f as y,D as A}from"./filterFields-e5401cd8.js";import{a as I}from"./RaffleContext-52da1787.js";function O({children:v,allEntries:i,profile:c}){const{filters:x}=a.useContext(k),{search:l,id:h,tab:F,name:R,sort:n,image:B,preview:D,single:M,...p}=x,{potSummaryStats:s}=a.useContext(I),m=a.useMemo(()=>i.map(r=>({...r,fuzzy:b([r.title,r.winner,r.description,r.potContents].join(",")),collection:N.raffle.map.map(o=>c&&c[o.key]&&c[o.key].includes(r.id)?"In "+o.label:"Not in "+o.label),tickets:s&&s[r.id]?s[r.id].tickets:0,donors:s&&s[r.id]?s[r.id].donors:0})),[i,s,c]),d=a.useMemo(()=>{const r=Object.keys(p).map(e=>{const t=p[e];return Array.isArray(t)?t.map(u=>({key:e,value:u})):{key:e,value:t}}).flat(),o=m.filter(e=>r.every(({key:t,value:u})=>Array.isArray(e[t])?e[t].includes(u):e[t]===u)).sort((e,t)=>e.potNumber-t.potNumber),C=l?y.go(b(l),o,{keys:g,threshold:-25e3}).map(e=>({...e.obj,score:e.score})):o;return n?C.sort((e,t)=>n==="potName"?e.title.localeCompare(t.title):n==="contributedBy"?e.contributedBy[0].localeCompare(t.contributedBy[0]):n==="tickets"?parseInt(t.tickets)-parseInt(e.tickets):n==="donors"?parseInt(t.donors)-parseInt(e.donors):e.potNumber<t.potNumber||e.title.localeCompare(t.title)):C.sort((e,t)=>e.potNumber<t.potNumber||e.title.localeCompare(t.title))},[p,m,l,n]),f=a.useCallback(r=>i.find(o=>o.id===r),[i]),z=a.useMemo(()=>({allEntries:i,visibleEntries:d,getPotFromId:f}),[i,d,f]);return j.jsx(A.Provider,{value:z,children:v})}const g=["fuzzy"];export{O as R};
