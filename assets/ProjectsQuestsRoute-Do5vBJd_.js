import{d as j,r as s,F as S,j as e,R as b,au as k,W as F,U as z,u as A,N as B,h as I,T as W,D as O,e as R}from"./index-PLA41_BS.js";import{p as Y}from"./filterFields-yaNMnY70.js";import{u as L}from"./usePageTitle-Bi5MC1gE.js";import{D as M}from"./DataContext-BHefM3Vy.js";import{r as V}from"./index-CMrSNRfS.js";import{u as Q}from"./useData-B7gjucbx.js";import{a as _}from"./dataUrls-DVxTtpO-.js";import{f as G}from"./filterEntriesAdvanced-CmVJR_VK.js";import{e as H}from"./entryName-D5ePebnU.js";import{s as E}from"./searchEntriesForText-CQZfAYyH.js";import{D as U}from"./DataTableSort-DRO6yaZd.js";import{E as q}from"./ExportButton-eBBmrHoa.js";import{S as J}from"./SearchBox-NHcTgigP.js";import{V as K}from"./ViewFilterButtons-CaUk4OqQ.js";import{p as X}from"./sortFields-UrZb0N2z.js";import{A as Z}from"./AdvancedFilters-CBUVodVd.js";import{E as P,S as $,Y as ee,a as te}from"./ErrorOutline-DKuLVMHX.js";import{P as re}from"./PhotoCamera-D8gcIM4G.js";import"./stringUtils-BsiQ3MZ5.js";import"./ArrowDropDown-CuvqbtKQ.js";import"./TableRow-BQHhfha_.js";import"./download-C7Jsb3t2.js";import"./List-C4HS8qnK.js";import"./ContentCopy-BFFPV97y.js";import"./Search-Dqsw77Nr.js";import"./useFormControl-DcRE6Uii.js";import"./Select-xWDYGIup.js";import"./Sort-BiuhJcN6.js";import"./TextField-ajiKBIJE.js";import"./FilterAlt-sQLzyHr_.js";import"./HighlightOff-CbD7nQtz.js";import"./Box-CkuAZpUK.js";import"./LockListContext-DFY50Ein.js";import"./ToggleButtonGroup-BXc36foY.js";import"./setDeep-J6HEwWhX.js";import"./AddCircle-DMPGXh5a.js";import"./Cancel-CTH78YMZ.js";import"./ChoiceButtonGroup-Ske9G5Gu.js";import"./Collapse-7wRpaB0N.js";function oe({children:t,profile:f}){var D;const{data:i,loading:h,error:n,_errorMessage:g}=Q({urls:se}),d=j((D=i==null?void 0:i.metadata)==null?void 0:D.updatedDateTime).format("MM/DD/YY HH:mm"),{filters:T,advancedFilterGroups:w}=s.useContext(S),{search:v,sort:l,expandAll:y}=T,a=s.useMemo(()=>{var r;return i&&!h&&!n?(r=i==null?void 0:i.allProjectsEvidence)==null?void 0:r.evidence:[]},[i,n,h]),u=s.useMemo(()=>a==null?void 0:a.map(r=>{let p;try{p=new URL(r.evidenceUrl).hostname}catch{}return{...r,pickerName:r.displayName||r.tabName,tierName:ie[r.tier],dateText:j(r.date).format("MM/DD/YY"),source:r.unclaimed?"Dan Sheet":"Scorecard",envidenceHost:p,fuzzy:V([H(r,"long")].concat([r.discipline,r.displayName,r.tabName]).join(",")),score:1}}),[a]),x=E(v,[...u]),c=s.useMemo(()=>{const r=G({advancedFilterGroups:w(),entries:u}),p=E(v,[...r]);return l?p.sort((o,m)=>{if(l==="popularity")return m.collectionSaves-o.collectionSaves||m.views-o.views||o.fuzzy.localeCompare(m.fuzzy);if(l==="alphaAscending")return o.fuzzy.localeCompare(m.fuzzy);if(l==="alphaDescending")return m.fuzzy.localeCompare(o.fuzzy);if(l==="recentlyUpdated")return Math.floor(j(m.lastUpdated).valueOf()/3600)-Math.floor(j(o.lastUpdated).valueOf()/3600)||o.fuzzy.localeCompare(m.fuzzy);if(l==="dateAdded")return Math.floor(j(m.dateAdded).valueOf()/3600*24)-Math.floor(j(o.dateAdded).valueOf()/3600*24)||o.fuzzy.localeCompare(m.fuzzy)}):p},[w,u,v,l]);console.log("visibleEntries",c);const C=s.useCallback(r=>a.find(p=>p.id===r),[a]),N=s.useMemo(()=>({allEntries:a,mappedEntries:u,visibleEntries:c,searchedEntries:x,getEntryFromId:C,expandAll:y,profile:f,updateTime:d}),[a,u,c,x,C,y,f,d]);return e.jsx(M.Provider,{value:N,children:t})}const se={allProjectsEvidence:_},ie={T1:"Tier 1",T2:"Tier 2",T3:"Tier 3",T4:"Tier 4",T5:"Tier 5"};function ae({evidenceUrl:t,handleChange:f=()=>{},owner:i=!1}){const h=s.useCallback(g=>{g.preventDefault(),g.stopPropagation();const d=window.open(t,"_blank","noopener,noreferrer");d&&(d.opener=null)},[t]);let n=e.jsx($,{style:{width:20,height:20}});return t.match(/(https|http):\/\/.*(youtu.be|youtube.com)/)?n=e.jsx(ee,{style:{width:20,height:20}}):t.match(/(https|http):\/\/.*discord.com/)?n=e.jsx(te,{style:{width:20,height:20}}):t.match(/(https|http):\/\/.*imgur.com/)&&(n=e.jsx(re,{style:{width:20,height:20}})),e.jsxs(b.Fragment,{children:[k(t)&&e.jsx(F,{title:"View Documentation",arrow:!0,disableFocusListener:!0,children:e.jsx(z,{style:{width:40,height:40},onClick:h,children:n})}),!!t&&!k(t)&&e.jsx(F,{title:"Documentation link is not valid",arrow:!0,disableFocusListener:!0,children:e.jsx(z,{style:{width:40,height:40},onClick:f,children:e.jsx(P,{style:{width:22,height:22,color:"#c07b32"}})})}),!t&&e.jsx(F,{title:"Documentation link is missing",arrow:!0,disableFocusListener:!0,children:e.jsx(z,{style:{width:40,height:40},onClick:f,children:e.jsx(P,{style:{width:22,height:22,color:"#e55940"}})})})]})}function ne(){const{visibleEntries:t=[],expandAll:f,updateTime:i}=s.useContext(M),{isMobile:h}=A(),n=s.useCallback(x=>{const c=window.open(x,"_blank","noopener,noreferrer");c&&(c.opener=null)},[]),g=[...t],d=[{id:"pickerName",align:"left",name:"Picker Name"},{id:"discipline",align:"left",name:"Discipline"},{id:"tier",align:"left",name:"Tier"},{id:"dateText",align:"left",name:"Date"},{id:"source",align:"left",name:"Source"},{id:"evidenceUrl",align:"center",name:"Evidence"}],T="pickerName",w="100%",v={columns:d,rows:g,defaultSort:T,sortable:!0,wrap:!1},l=s.useCallback((x,c)=>x==="evidenceUrl"?e.jsx(ae,{evidenceUrl:c}):c,[n,t]),y=e.jsxs(b.Fragment,{children:[e.jsx(J,{label:"Projects",extraFilters:[{key:"tab",value:"search"}],keepOpen:!1,entryCount:t.length}),e.jsx(K,{sortValues:X,advancedEnabled:!0,extraFilters:[],entryType:"Project",compactMode:!1,resetAll:!0,expandAll:!1}),!h&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}})]}),a=e.jsx("div",{style:{margin:"30px 0px"},children:e.jsx(q,{text:!0,entries:t,advancedEnabled:!0})}),u={maxWidth:700,marginLeft:"auto",marginRight:"auto"};return e.jsxs(b.Fragment,{children:[e.jsx(B,{title:"Projects",extras:y}),e.jsxs("div",{style:{margin:8,paddingBottom:32},children:[e.jsx(Z,{}),e.jsx("div",{style:u,children:e.jsx(U,{tableData:v,tableWidth:w,linkFunction:l})})]}),e.jsx(I,{extras:void 0,before:a}),e.jsx(W,{feature:"projectsQuests"})]})}function Ue(){const{lockCollection:t}=s.useContext(O);return L("Projects & Quests"),e.jsx(R,{filterFields:Y,children:e.jsx(oe,{profile:t,children:e.jsx(ne,{})})})}export{Ue as default};
