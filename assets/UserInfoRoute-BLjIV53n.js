import{r as c,A as H,D as J,F as st,S as et,ao as nt,aE as dt,j as t,d as rt,h as it,e as ct,N as lt}from"./index-Cgfn-mCc.js";import{c as at}from"./dataUrls-DkJe4Pqg.js";import{a as ot,b as ht}from"./ScorecardListContext-uE4Fti7U.js";import{L as Q}from"./LoadingDisplay-CTaY_75H.js";import{u as G}from"./useData-p_x7laOI.js";import{L as xt,A as jt}from"./LocalizationProvider-BNjh6kQi.js";import{M as ut}from"./MustBeLoggedIn-CzbxJouO.js";import"./DataContext-bhTao4M0.js";import"./index-Cf-HLik8.js";import"./filterEntriesAdvanced-B_LinbMH.js";import"./Box-cNlZz2mk.js";import"./CircularProgress-DAtJ7LuB.js";function yt(){var R,O,W,q,M,T,z,$,K,V;const{user:d,userClaims:a}=c.useContext(H),{getProfile:o,getPickerActivity:l}=c.useContext(J),{filters:h={},addFilters:C}=c.useContext(st),{uid:L}=h,{scoredActivity:b,bbCount:D,danPoints:p,eligibleDan:A,nextDanPoints:v,nextDanLocks:f,uniqueLocks:w,maxBelt:B}=c.useContext(et),x=d==null?void 0:d.uid,X=c.useCallback(async()=>{var i;try{const r=await o(x);if(r){const k=r.displayName&&!r.privacyAnonymous?(i=r==null?void 0:r.displayName)!=null&&i.toLowerCase().endsWith("s")?`${r.displayName}'`:`${r.displayName}'s`:"Anonymous";document.title=`LPU Belt Explorer - ${k} User Info`}if((d==null?void 0:d.uid)!==x){const k=await l(x);return{profile:r,...nt(k)}}else return{profile:r,scoredActivity:b,bbCount:D,danPoints:p,eligibleDan:A,nextDanPoints:v,nextDanLocks:f,uniqueLocks:w,maxBelt:B}}catch(r){return console.error("Error loading profile and activity.",r),null}},[o,x,d,l,b,D,p,A,v,f,w,B]),{data:n={},loading:j,error:m}=G({loadFn:X}),s=c.useMemo(()=>n?n.profile:{},[n]);c.useEffect(()=>{d&&!L&&C([{key:"uid",value:d.uid},{key:"name",value:encodeURIComponent(s==null?void 0:s.displayName)}],!0)},[C,h,s,L,d]);const Y=n?n.scoredActivity:[],P=n?n.bbCount:0,S=n?n.danPoints:0,I=n?n.eligibleDan:0,N=n?n.nextDanPoints:0,U=n?n.nextDanLocks:0,E=n?n.uniqueLocks:0,F=n?n.scoredActivity.filter(i=>i.collectionDB==="awards").map(i=>dt[i.matchId]).filter(i=>i.awardType==="belt").sort((i,r)=>i.rank-r.rank):[],u=n?F[F.length-1]:{},y=G({url:at}),Z=y.data?y.data.blackBeltOnly.listStats.recordedLocks.topItems:[],_=y.data?y.data.allUsers.listStats.recordedLocks.topItems:[],tt=void 0;if(j||m)return null;const g={fontWeight:700,backgroundColor:"#333",padding:2,textAlign:"left",marginTop:10},e={fontWeight:700,paddingRight:10};return t.jsx(ot,{cardActivity:Y,cardBBCount:P,cardDanPoints:S,cardEligibleDan:I,cardNextDanPoints:N,cardNextDanLocks:U,cardUniqueLocks:E,cardMaxBelt:u,popularLocks:_,popularLocksBB:Z,children:t.jsx(ht,{children:t.jsxs(xt,{adapterLocale:rt.locale(),dateAdapter:jt,children:[j&&t.jsx(Q,{}),!j&&n&&!m&&t.jsx("div",{style:{minWidth:"320px",height:"100%",padding:20,backgroundColor:"#000",marginLeft:"auto",marginRight:"auto",justifyItems:"center",fontSize:"0.95rem"},children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{style:g,children:[t.jsx("th",{children:"Parameter"}),t.jsx("th",{children:"Value"})]})}),t.jsxs("tbody",{children:[t.jsx("tr",{style:{height:10}}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"display name"}),t.jsx("td",{children:s==null?void 0:s.displayName})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"user id"}),t.jsx("td",{children:d.uid})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"user claims"}),t.jsx("td",{children:a.join(", ")})]}),(s==null?void 0:s.admin)&&t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"profile.admin"}),t.jsx("td",{children:"true"})]}),t.jsx("tr",{style:{height:10}}),t.jsx("tr",{children:t.jsx("td",{style:g,colSpan:2,children:"SCORECARD"})}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"blackBeltAwarded"}),t.jsx("td",{children:s!=null&&s.blackBeltAwardedAt?"true":""})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"cardMaxBelt"}),t.jsx("td",{children:u==null?void 0:u.name})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"cardBBCount"}),t.jsx("td",{children:P})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"cardDanPoints"}),t.jsx("td",{children:S})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"cardEligibleDan"}),t.jsx("td",{children:I})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"cardNextDanPoints"}),t.jsx("td",{children:N})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"cardNextDanLocks"}),t.jsx("td",{children:U})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"cardUniqueLocks"}),t.jsx("td",{children:E})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"projects"}),t.jsx("td",{children:(R=s==null?void 0:s.projects)==null?void 0:R.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"tabClaimed"}),t.jsx("td",{children:s==null?void 0:s.tabClaimed})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"redditUsername"}),t.jsx("td",{children:s==null?void 0:s.redditUsername})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"discordUsername"}),t.jsx("td",{children:s==null?void 0:s.discordUsername})]}),t.jsx("tr",{style:{height:10}}),t.jsx("tr",{children:t.jsx("td",{style:g,colSpan:2,children:"LOCK COLLECTION"})}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"any"}),t.jsx("td",{children:(O=s==null?void 0:s.any)==null?void 0:O.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"own"}),t.jsx("td",{children:(W=s==null?void 0:s.own)==null?void 0:W.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"picked"}),t.jsx("td",{children:(q=s==null?void 0:s.picked)==null?void 0:q.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"recorded"}),t.jsx("td",{children:(M=s==null?void 0:s.recorded)==null?void 0:M.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"wishlist"}),t.jsx("td",{children:(T=s==null?void 0:s.wishlist)==null?void 0:T.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"safelocksAny"}),t.jsx("td",{children:(z=s==null?void 0:s.safelocksAny)==null?void 0:z.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"safelocksCracked"}),t.jsx("td",{children:($=s==null?void 0:s.safelocksCracked)==null?void 0:$.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"safelocksOwn"}),t.jsx("td",{children:(K=s==null?void 0:s.safelocksOwn)==null?void 0:K.length})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e,children:"safelocksWishlist"}),t.jsx("td",{children:(V=s==null?void 0:s.safelocksWishlist)==null?void 0:V.length})]})]})]})}),!j&&(!n||m)&&t.jsx("div",{style:{minWidth:"320px",height:"100%",padding:20,backgroundColor:"#000",marginLeft:"auto",marginRight:"auto",justifyItems:"center",fontSize:"0.95rem",textalign:"center"},children:"no user"}),t.jsx(it,{before:tt})]})})})}function Bt(){const{authLoaded:d,isLoggedIn:a,user:o}=c.useContext(H),{dbLoaded:l}=c.useContext(J),h=!d||!l?"Loading...":"User Info";return t.jsxs(ct,{filterFields:[],children:[t.jsx(lt,{title:h}),(!d||!l)&&t.jsx(Q,{}),d&&!a&&t.jsx(ut,{actionText:"view user information"}),d&&a&&l&&t.jsx(yt,{user:o})]})}export{Bt as default};
