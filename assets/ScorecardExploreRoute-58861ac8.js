import{r as l,F as M,au as O,j as e,u as te,R as W,b as me,$ as he,J as $,I as G,ac as fe,aj as xe,d as _,as as be,bN as ke,bO as ge,D as ye,N as je,e as Be,a0 as Ce,h as ve,T as Se}from"./index-429be980.js";import{L as Ae}from"./LoadingDisplay-3743c0a9.js";import{u as De}from"./useData-28090655.js";import{u as we}from"./usePageTitle-d2c3b15c.js";import{_ as Pe,d as Le,a as Ue,l as ze}from"./lockStats-3bd568ae.js";import{b as Ee,c as Fe,p as Ie,a as Te,s as Oe,d as Re,k as Me,m as We}from"./dataUrls-fb4714fd.js";import{E as Ne}from"./ErrorMessage-44668393.js";import{b as R,a as He}from"./chartDefaults-270235e0.js";import{L as I}from"./Link-bf2f9a97.js";import{D as se,f as Ve}from"./DataContext-9a7e89b1.js";import{r as q}from"./index-f0ff01e4.js";import{e as Y}from"./entryName-b751bf89.js";import{B as $e}from"./BeltStripeMini-1c55bd56.js";import{a as re,b as T,c as J,d as K,T as Ge,e as Q}from"./TableRow-f064ad33.js";import{V as _e}from"./ViewFilterButtons-6635cd13.js";import{b as qe}from"./sortFields-b1bde6f9.js";import{F as Ye,I as Je,S as Ke}from"./Select-463748e5.js";import{C as Qe}from"./Collapse-2dd0c61f.js";import{b as Xe}from"./filterFields-e2cdf910.js";import{c as Ze}from"./collectionStatsById-8def94ca.js";import"./LPU-c3fa7122.js";import"./LinearProgress-e6e8cfd9.js";import"./useDocumentTitle-5ab4ef5a.js";import"./nivo-legends.es-99889400.js";import"./index-b11b0852.js";import"./line-93c4746c.js";import"./Sort-37c3c2f0.js";import"./Chip-e421fa9d.js";import"./FilterAlt-4ff895ef.js";import"./Box-11caeba2.js";import"./LockListContext-a874384a.js";import"./ToggleButtonGroup-e26bcfe4.js";import"./Cancel-b78b360f.js";import"./rankingRequestData-d3ef79e5.js";const et={White:340,Yellow:681,Orange:1182,Green:668,Blue:269,Purple:150,Brown:91,Red:74,Black:159,Total:3614},tt={White:1232,Yellow:2166,Orange:2842,Green:1121,Blue:328,Purple:147,Brown:88,Red:62,Black:134,Total:8120},F={discord:et,reddit:tt};function st({data:i}){const{scorecardStats:h,discordRoleCounts:c}=i,{userCounts:o}=h,{filters:x,addFilter:m,removeFilters:S}=l.useContext(M),[P,y]=l.useState(!1),B=x!=null&&x.dataset?x==null?void 0:x.dataset:"pickerData",[k,b]=l.useState(B),A=l.useCallback(u=>{m("dataset",u,!0),b(u)},[m]),C=F.reddit.Total-o.totalUsers,p=l.useMemo(()=>{const u={data:[{id:"LPUbelts Users",label:"LPUbelts Users",value:o.totalUsers},{id:"Other LPU Pickers",label:"Other LPU Pickers (approx)",value:C}],colors:["#37bd17","#17561b"],description:"Click chart for details",startAngle:-65},j={parent:"pickerData",data:[{id:"Scorecard Users",label:"Scorecard Users",value:o.scorecardUsers},{id:"Other LPUbelts Users",label:"Other LPUbelts Users",value:o.totalUsers-o.scorecardUsers}],colors:["#d2bc18","#444"],description:"LPUbelts Scorecard Usage",startAngle:-35},E={parent:"LPUbelts Users",data:[{id:"Imported Belts",label:"Imported Belts",value:o.beltedUsers},{id:"Other Scorecard Users",label:"Other Scorecard Users",value:o.scorecardUsers-o.beltedUsers}],colors:["#189ad2","#444"],description:"Scorecard Belt Imports",startAngle:-120},H={parent:"Scorecard Users",data:Object.keys(o.belts).sort((s,f)=>O(s,f)).map(s=>({id:s,label:s,value:o.belts[s]})),colors:R,description:"Imported Belt Breakdown (click Black for Dan breakdown)",startAngle:-10},ne={parent:"Imported Belts",data:Object.keys(o.dans).sort((s,f)=>parseInt(s)-parseInt(f)).map(s=>({id:X(s),label:X(s),value:o.dans[s]})),colors:Z,description:"Dan Breakdown"},ie={parent:"pickerData",data:[{id:"Discord",label:"Discord",value:F.discord.Total},{id:"Reddit",label:"Reddit",value:F.reddit.Total}],colors:["#a981ec","#7833e3"],description:"Platforms users overlap, numbers shown for relative size"},V=Object.keys(c).reduce((s,f)=>{const pe=f.replace(" Belt","").trim();return s[pe]=c[f],s},{}),ce={parent:"Other LPU Pickers",data:Object.keys(V).filter(s=>!s.includes("Dan")).sort((s,f)=>O(s,f)).map(s=>{const f=s==="Black"?"Black Belt":s;return{id:f,label:f,value:V[s]}}),colors:R,description:e.jsxs("span",{children:["Discord Belt Breakdown | ",e.jsx(I,{onClick:()=>A("Reddit"),style:{color:"#189dea",textDecoration:"none",cursor:"pointer"},children:"Reddit"})]}),startAngle:-15},de={parent:"Discord",data:Object.keys(c).filter(s=>s.includes("Dan")).sort((s,f)=>parseInt(s)-parseInt(f)).map(s=>({id:s,label:s,value:c[s]})),colors:Z,description:"Discord Dan Breakdown"},ue={parent:"Other LPU Pickers",data:Object.keys(F.reddit).filter(s=>s!=="Total").sort((s,f)=>O(s,f)).map(s=>{const f=s==="Black"?"Black Belts":s;return{id:f,label:f,value:F.reddit[s]}}),colors:R,description:e.jsxs("span",{children:["Reddit Belt Breakdown | ",e.jsx(I,{onClick:()=>A("Discord"),style:{color:"#189dea",textDecoration:"none",cursor:"pointer"},children:"Discord"})]}),startAngle:-25};return{pickerData:u,"LPUbelts Users":j,"Scorecard Users":E,"Imported Belts":H,Black:ne,"Other LPU Pickers":ie,Discord:ce,"Black Belt":de,Reddit:ue}},[c,A,C,o]),v=p[k].data,D=p[k].data.reduce((u,j)=>u+j.value,0),L=l.useCallback((u,j)=>{const E=j==null?void 0:j.nativeEvent;typeof TouchEvent<"u"&&E instanceof TouchEvent&&y(!0),p[u.id]&&(document.getElementById("chartDescription").style.opacity="0.2",setTimeout(()=>{document.getElementById("chartDescription").style.opacity="1",A(u.id)},200))},[A,p]),z=l.useCallback(()=>{p[p[k].parent].parent?m("dataset",p[k].parent,!0):S(["dataset"]),b(p[k].parent)},[m,p,k,S]),g=l.useCallback((u,j)=>{p[u.id]&&(j.currentTarget.style.cursor="pointer")},[p]),{width:a}=te(),n=a<=360,d=a<=395,r=a<=428,t=a<=560,w={top:30,right:0,bottom:30,left:0};let U=320;n?U=175:d?U=190:r?U=230:t&&(U=240);const oe="1.0rem",N=t?5:4,ae=t?10:8,le=t?0:8;return e.jsxs(W.Fragment,{children:[e.jsx("div",{style:{fontSize:"0.95rem",fontWeight:500,width:"100%",textAlign:"center",marginBottom:4,opacity:1,transitionProperty:"opacity, left, top, height",transitionDuration:"0.1s, 0.1s"},id:"chartDescription",children:p[k].description}),e.jsxs("div",{style:{height:U,margin:"0px 8px 0px 8px",width:"100%",position:"relative"},children:[e.jsx("div",{style:{width:"100%",height:"100%",position:"absolute",top:0,left:0},children:e.jsx(Pe,{data:v,theme:He,colors:p[k].colors,margin:w,startAngle:p[k].startAngle||-40,endAngle:360,innerRadius:.5,padAngle:.7,cornerRadius:3,activeOuterRadiusOffset:0,arcLinkLabelsSkipAngle:N,arcLinkLabelsTextColor:"#ccc",arcLinkLabelsThickness:2,arcLinkLabelsColor:{from:"color"},arcLinkLabel:u=>u.label+": "+Math.round(u.value/D*100)+"%",arcLinkLabelsDiagonalLength:14,arcLinkLabelsStraightLength:le,enableArcLabels:!1,arcLabelsRadiusOffset:.5,arcLabelsSkipAngle:ae,arcLabelsTextColor:"#111",isInteractive:!0,transitionMode:"startAngle",motionConfig:"slow",sortByValue:!1,onClick:u=>{L(u)},onMouseEnter:(u,j)=>{g(u,j)},tooltip:u=>{const j=(u.datum.arc.angleDeg>N,u.datum.label+": "),E=u.datum.value;return e.jsx("div",{style:{fontSize:"0.8rem",background:"#555",padding:"3px 4px",color:"#ddd",borderRadius:"5px",display:t||P?"none":"block"},children:e.jsxs("div",{children:[j,E]})})}})}),e.jsx("div",{style:{width:"100%",position:"absolute",top:U/2-14,left:0,display:"flex",justifyContent:"center",fontSize:"1.1rem"},children:p[k].parent&&e.jsx(I,{onClick:z,style:{color:"#ccc",cursor:"pointer",fontSize:oe},children:"back"})})]},"pickPie")]})}function X(i){const h=["st","nd","rd","th"];return i+""+h[Math.min(4,parseInt(i))-1]}const Z=["#222222","#2E2E2E","#3A3A3A","#464646","#525252","#5E5E5E","#6A6A6A","#767676","#828282","#8E8E8E","#9A9A9A","#A6A6A6","#B2B2B2","#BEBEBE","#CACACA","#D6D6D6","#E2E2E2","#EFEFEF","#FAFAFA","#FFFFFF"];function ee({entry:i,index:h,collapse:c=!1}){const o=me(),m=Y(i).replace(/[\s/]/g,"_").replace(/\W/g,""),S=l.useCallback(y=>{const B=`/locks?tab=search&search=${y.id}&id=${y.id}&name=${m}`;o(B)},[o,m]),P=i.belt==="Unranked"?"#bbb":"#fff";return e.jsxs(re,{sx:{"&:nth-of-type(odd) td, &:nth-of-type(odd) th":{backgroundColor:"#000"},"td, th":{padding:0,border:0}},style:{display:"table-row"},children:[e.jsx(T,{align:"left",style:{borderBottom:"1px solid #000",width:4,marginLeft:5,height:40,paddingBottom:1},children:e.jsx($e,{value:i.belt})}),e.jsx(T,{align:"left",style:{alignItems:"center"},children:e.jsx("div",{style:{fontWeight:500,marginLeft:10,fontSize:"0.9rem"},children:e.jsx(I,{onClick:()=>S(i),style:{color:P},children:Y(i)})})}),e.jsx(T,{align:"center",style:{fontWeight:500,fontSize:"0.9rem",paddingRight:5},children:i.currentPicks})]},h)}function rt(){var a;const{visibleEntries:i=[]}=l.useContext(se),{filters:h,addFilter:c}=l.useContext(M),{userBelt:o="All Belts",sort:x}=h,[m,S]=l.useState(x);l.useEffect(()=>{S(!!x)},[x]);const P=60;let y=((a=i.find(n=>n.displayRank===P))==null?void 0:a.currentPicks)||0;y=y>2?y:0;const B=l.useMemo(()=>i.filter(n=>n.currentPicks>=y),[i,y]),k=l.useMemo(()=>i.filter(n=>n.currentPicks<y),[i,y]),b=l.useMemo(()=>["All Belts",...he],[]),A=l.useCallback(()=>{const n=b.findIndex(r=>r===o),d=n<b.length-1?n+1:0;c("userBelt",b[d],!0)},[c,b,o]),C=l.useCallback(()=>{const n=b.findIndex(r=>r===o),d=n>0?n-1:b.length-1;c("userBelt",b[d],!0)},[c,b,o]),[p,v]=l.useState(!1),D=l.useCallback(()=>v(!1),[]),L=l.useCallback(()=>v(!0),[]),z=l.useCallback(n=>{c("userBelt",n.target.value,!0),D()},[c,D]),g=l.useCallback(()=>{S(!m)},[m]);return e.jsxs(W.Fragment,{children:[e.jsx("div",{style:{marginBottom:10,display:"flex",justifyContent:"center"},children:e.jsxs("div",{style:{padding:"0px",width:220,display:"flex",justifyContent:"center",alignItems:"center"},children:[e.jsx($,{title:"Previous Belt",arrow:!0,disableFocusListener:!0,children:e.jsx(G,{onClick:C,style:{backgroundColor:"#bbb",color:"#000",height:24,width:24},children:e.jsx(Le,{})})}),e.jsx("div",{style:{padding:"0px",display:"flex",justifyContent:"center",flexGrow:1,alignItems:"center"},children:e.jsxs(Ye,{id:"beltPulldown",size:"small",variant:"outlined",style:{marginBottom:0,width:140},children:[e.jsx(Je,{style:{color:"#bbb"},children:"User Belt"}),e.jsx(Ke,{id:"beltSelect",value:o||"All Belts",label:"Brand",open:p,onClose:D,onOpen:L,onChange:z,style:{fontWeight:700,color:"#eee",fontSize:"1.1rem"},children:b.map((n,d)=>e.jsx(fe,{value:b[d],children:b[d]},d))})]})}),e.jsx($,{title:"Next Belt",arrow:!0,disableFocusListener:!0,children:e.jsx(G,{onClick:A,style:{backgroundColor:"#bbb",color:"#000",height:24,width:24},children:e.jsx(Ue,{})})})]})}),e.jsx(_e,{sortValues:qe,extraFilters:[{key:"tab",value:"search"}],compactMode:!1,resetAll:!0,expandAll:!1,style:{marginBottom:10}}),e.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center"},children:e.jsxs("div",{style:{border:"4px solid #1c1c1c",width:"100%",maxWidth:600},children:[e.jsx(J,{sx:{backgroundColor:"#111",width:"100%"},children:e.jsxs(K,{style:{backgroundColor:"#1c1c1c"},children:[e.jsx(Ge,{children:e.jsxs(re,{style:{padding:"0px",fontWeight:700},children:[e.jsx(T,{colSpan:"2",style:{padding:1,fontWeight:700,fontSize:"1.05rem"},children:"Lock"}),e.jsx(T,{style:{padding:1,fontWeight:700,fontSize:"1.05rem",paddingRight:5},children:"Picks"})]})}),e.jsx(Q,{children:B.map((n,d)=>e.jsx(ee,{entry:n,index:d},d))})]})}),e.jsx(Qe,{in:!!m,timeout:"auto",unmountOnExit:!0,children:e.jsx(J,{sx:{backgroundColor:"#111",width:"100%"},children:e.jsx(K,{style:{backgroundColor:"#1c1c1c"},children:e.jsx(Q,{children:k.map((n,d)=>e.jsx(ee,{entry:n,index:d},d))})})})})]})}),k.length>0&&e.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center"},children:e.jsx("div",{style:{border:"4px solid #1c1c1c",width:"100%",maxWidth:600,textAlign:"center"},children:e.jsx(I,{onClick:g,style:{color:"#fff",fontSize:"1.0rem",cursor:"pointer"},children:!m&&"Show More"||"Show Less"})})})]})}function ot({data:i}){const{width:h}=te(),o=h<560?"8px 8px 32px 8px":"24px 24px 32px 24px",x={margin:"46px 0px 26px 0px",width:"100%",backgroundColor:"#000",textAlign:"center"},m={margin:"0px 0px 14px 0px",width:"100%",backgroundColor:"#000",textAlign:"center"};return e.jsxs("div",{style:{minWidth:"320px",maxWidth:720,height:"100%",padding:o,backgroundColor:"#000",marginLeft:"auto",marginRight:"auto",fontSize:"1.5rem",fontWeight:600},children:[e.jsx("div",{style:m,children:"User Drilldown"}),e.jsx(st,{data:i}),e.jsx("div",{style:x,children:"Scorecard Locks"}),e.jsx(rt,{data:i})]})}function at({children:i,allEntries:h,scorecardEntries:c,profile:o}){const{filters:x}=l.useContext(M),{search:m,id:S,tab:P,name:y,sort:B,image:k,expandAll:b,dataset:A,...C}=x,{userBelt:p}=C,v=l.useCallback(g=>h.find(a=>a.id===g),[h]),D=l.useMemo(()=>Object.keys(c).map(g=>{var n,d,r;const a=v(g);return a?{...c[g],userBelt:Object.keys(c[g].scorecardPicks),currentPicks:c[g].scorecardPicks[p||"All Belts"],...a,makes:a.makeModels[0].make?a.makeModels.map(({make:t})=>t):a.makeModels[0].model,fuzzy:q(a.makeModels.map(({make:t,model:w})=>[t,w]).flat().filter(t=>t).concat([a.version,a.notes,a.belt]).join(",")),content:[(n=a.media)!=null&&n.some(t=>!t.fullUrl.match(/youtube\.com/))?"Has Images":"No Images",(d=a.media)!=null&&d.some(t=>t.fullUrl.match(/youtube\.com/))?"Has Video":"No Video",((r=a.links)==null?void 0:r.length)>0?"Has Links":"No Links",xe[a.belt].danPoints>0?"Worth Dan Points":void 0,_(a.lastUpdated).isAfter(_().subtract(1,"days"))?"Updated Recently":void 0,a.belt.startsWith("Black")?"Is Black":void 0,a.belt!=="Unranked"?"Is Ranked":void 0].flat().filter(t=>t),collection:be.locks.map.map(t=>o&&o[t.key]&&o[t.key].includes(a.id)?t.label:"Not "+t.label),collectionSaves:Ze[a.id]||0,simpleBelt:a.belt.replace(/\s\d/g,"")}:null}).filter(g=>g),[v,o,c,p]),L=l.useMemo(()=>{const g=Object.keys(C).map(r=>{const t=C[r];return Array.isArray(t)?t.map(w=>({key:r,value:w})):{key:r,value:t}}).flat(),a=D.filter(r=>g.every(({key:t,value:w})=>Array.isArray(r[t])?r[t].includes(w):r[t]===w)),n=m&&a.find(r=>r.id===m);let d=a;return n?d=[n]:m&&(d=Ve.go(q(m),a,{keys:lt,threshold:-25e3}).map(r=>({...r.obj,score:r.score}))),B?d.sort((r,t)=>{if(B==="beltAscending")return ke(r.belt,t.belt)||t.currentPicks-r.currentPicks||r.fuzzy.localeCompare(t.fuzzy);if(B==="beltDescending")return ge(r.belt,t.belt)||t.currentPicks-r.currentPicks||r.fuzzy.localeCompare(t.fuzzy);if(B==="alphaAscending")return r.fuzzy.localeCompare(t.fuzzy);if(B==="alphaDescending")return t.fuzzy.localeCompare(r.fuzzy)}):d.sort((r,t)=>t.currentPicks-r.currentPicks||r.fuzzy.localeCompare(t.fuzzy)).map((r,t)=>({...r,displayRank:t+1}))},[C,D,m,B]),z=l.useMemo(()=>({allEntries:h,visibleEntries:L,getEntryFromId:v,expandAll:b,profile:o}),[h,v,L,b,o]);return e.jsx(se.Provider,{value:z,children:i})}const lt=["fuzzy"];function Ht(){const{lockCollection:i}=l.useContext(ye);we("Explore Scorecard");const{data:h,loading:c,error:o,errorMessage:x}=De({urls:nt});return e.jsxs(W.Fragment,{children:[e.jsx(je,{title:"Explore Scorecard"}),o&&e.jsx(Ne,{errorMessage:x}),c&&e.jsx(Ae,{}),!c&&!o&&!!h&&e.jsx(Be,{filterFields:Xe,children:e.jsx(at,{allEntries:Ce,scorecardEntries:h.scorecardStats.lockCountsByUserBelt,profile:i,children:e.jsx(ot,{data:{...h,lockStats:ze}})})}),e.jsx(ve,{}),e.jsx(Se,{feature:"stats"})]})}const nt={brandDistribution:Ee,collectionsStatsCurrent:Fe,popularAreas:Ie,redditGrowth:Te,siteFullNew:Oe,pickStatsData:Re,scorecardStats:Me,discordRoleCounts:We};export{Ht as default};
