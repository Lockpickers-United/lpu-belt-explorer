import{r as t,j as o,D as f,A as $,d as C,bJ as O,bG as F,bI as m,bK as A,bH as E,X as L,B as w,aa as M}from"./index-gb-s2aXP.js";import{R as W,a as z}from"./RaffleContext-BNsMSRNN.js";import{A as G}from"./AdminToolsButton-D76Cw689.js";import{D as Y}from"./Dialog-BzxYdq3e.js";import{B as q}from"./Box-DM1r7bTL.js";import"./useData-D1smxrTu.js";import"./dataUrls-CThgH6Wi.js";import"./index-EhRL9D6S.js";import"./setDeep-J6HEwWhX.js";import"./EmojiEvents-BvaUz-e_.js";const J="/assets/hello-my-name-is-RAFL-2026s-CTaRzepe.png";function K(){const{raffleAdminRole:c,raflState:s}=t.useContext(W);return o.jsx(Y,{open:s==="setup"&&!c,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:1}}},sx:{".MuiDialog-paper":{backgroundColor:"#000",opacity:1,backgroundImage:"none"}},children:o.jsxs("div",{style:{textAlign:"center",padding:20,maxWidth:400},children:[o.jsx(q,{component:"img",alt:"Lock Pickers United",src:J,style:{marginLeft:"auto",marginRight:"auto",display:"block",width:"100%",margin:"30px 0px 30px"}}),o.jsx("br",{}),o.jsx("div",{style:{fontSize:"1.2rem",marginBottom:150},children:"Stay tuned!"}),o.jsx("br",{}),o.jsx(G,{})]})})}function N({children:c}){const s=t.useContext(f),{authLoaded:p,isLoggedIn:i,user:x}=t.useContext($),{profile:b}=t.useContext(f),[l,g]=t.useState(null),[h,y]=t.useState(!1),D=t.useCallback(async n=>{if(l||!i)return"error";try{const e=Object.fromEntries(Object.entries(n||{}).filter(([,a])=>a!==void 0));e.pots=(e.pots||[]).reduce((a,u)=>{const d=a.find(H=>H.itemId===u.itemId);return d?d.tickets=(d.tickets||0)+(u.tickets||0):a.push({...u}),a},[]),e.createdAt||(e.createdAt=C().toISOString()),e.updatedAt=C().toISOString(),e.raflYear=2026;const r=await O(F(m,"raffle-entries"),e);return console.log("Created Raffle Entry",e),r.id}catch(e){throw console.error("Error creating raffle entry:",e),e}},[l,i]),[R,B]=t.useState({}),[j,I]=t.useState(!1);t.useEffect(()=>{const n=A(m,"data-cache","raffle-entries-summary"),e=E(n,r=>{const a=r.exists()?r.data():null;B(a||{}),I(!0),y(!0),console.log("DB, raffle summary loaded")},r=>{console.error("Error listening to DB:",r),g(!0),L("There was a problem reading raffle data. It will be unavailable until you refresh the page. ",{autoHideDuration:null,action:o.jsx(w,{color:"secondary",onClick:()=>location.reload(),children:"Refresh"})})});return()=>e()},[p,i,x]);const[S,v]=t.useState({}),[k,P]=t.useState(!1);t.useEffect(()=>{const n=A(m,"data-cache","raffle-winners"),e=E(n,r=>{const a=r.exists()?r.data():null;v(a||{}),P(!0),y(!0),console.log("DB, raffle winners loaded")},r=>{console.error("Error listening to DB:",r),g(!0),L("There was a problem reading raffle data. It will be unavailable until you refresh the page. ",{autoHideDuration:null,action:o.jsx(w,{color:"secondary",onClick:()=>location.reload(),children:"Refresh"})})});return()=>e()},[p,i,x]);const T=t.useMemo(()=>({...s,testEntry:U,createRaffleEntry:D,dbLoaded:h,profile:b,summaryData:R,summaryLoaded:j,winnerData:S,winnersLoaded:k,dbError:l}),[s,D,h,b,R,j,S,k,l]);return o.jsx(f.Provider,{value:T,children:c})}const U={platform:"Discord",username:"MacGuffin Security",belt:"Yellow",donations:[{amount:123,receipt:"https://lpubelts.com/",charity:{itemFullTitle:"American Humane",itemTitle:"American Humane",itemId:"ch_AmHum"}}],pots:[{tickets:123,itemFullTitle:"Pot 1 - $$$ of Locc",itemTitle:"$$$ of Locc",itemId:"2025-025",itemPotNumber:"1",itemIndex:0}],totalDonation:123,allocatedTickets:123,status:"pending",dev:!0,adminEntry:!0};function ne(){return console.log("RaffleParentRoute"),o.jsx(N,{children:o.jsxs(z,{children:[o.jsx(M,{}),o.jsx(K,{})]})})}export{ne as default};
