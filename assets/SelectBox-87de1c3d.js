import{r as n,d as l,j as C,aa as R}from"./index-a9bb63ec.js";import{F as A,f as k,D as F}from"./DataContext-15e88187.js";import{r as M}from"./index-4e2db8de.js";import{s as I}from"./rankingRequestData-d3ef79e5.js";import{F as D,I as P,S as U}from"./Select-0e2bc70a.js";function N({children:q,allEntries:u,profile:c}){const{filters:i}=n.useContext(A),{search:f,id:O,tab:S,name:x,sort:a,image:j,expandAll:y,...m}=i,z=n.useMemo(()=>u.map(s=>{var r,p;return{...s,originalEntry:s,makes:s.makeModels[0].make?s.makeModels.map(({make:o})=>o):s.makeModels[0].model,requestCount:(r=s.requestedBy)==null?void 0:r.length,danPoints:0,fuzzy:M(s.makeModels.map(({make:o,model:e})=>[o,e]).flat().filter(o=>o).concat([s.version,s.notes,s.belt]).join(",")),content:[(p=s.media)!=null&&p.some(o=>!o.fullUrl.match(/youtube\.com/))?"Has Images":"No Images",l(s.dateRequested).isAfter(l().subtract(1,"days"))?"Requested Recently":void 0].flat().filter(o=>o)}}),[u]),d=n.useMemo(()=>{const s=Object.keys(m).map(e=>{const t=m[e];return Array.isArray(t)?t.map(v=>({key:e,value:v})):{key:e,value:t}}).flat(),r=z.filter(e=>s.every(({key:t,value:v})=>Array.isArray(e[t])?e[t].includes(v):e[t]===v)),p=f&&r.find(e=>e.id===f);let o=r;return p?o=[p]:f&&(o=k.go(M(f),r,{keys:B,threshold:-25e3}).map(e=>({...e.obj,score:e.score}))),a?o.sort((e,t)=>a==="alphaAscending"?e.fuzzy.localeCompare(t.fuzzy):a==="alphaDescending"?t.fuzzy.localeCompare(e.fuzzy):a==="requestStatus"?I(e.requestStatus,t.requestStatus)||e.fuzzy.localeCompare(t.fuzzy):a==="requestCount"?t.requestCount-e.requestCount||e.fuzzy.localeCompare(t.fuzzy):a==="recentlyUpdated"?Math.floor(l(t.lastUpdated).valueOf()/3600)-Math.floor(l(e.lastUpdated).valueOf()/3600)||e.fuzzy.localeCompare(t.fuzzy):a==="dateRequested"?l(t.dateRequested).valueOf()-l(e.dateRequested).valueOf()||e.fuzzy.localeCompare(t.fuzzy):l(t.dateRequested).valueOf()-l(e.dateRequested).valueOf()||e.fuzzy.localeCompare(t.fuzzy)):o.sort((e,t)=>l(t.dateRequested).valueOf()-l(e.dateRequested).valueOf()||e.fuzzy.localeCompare(t.fuzzy))},[m,z,f,a]),h=n.useCallback(s=>u.find(r=>r.id===s),[u]),g=n.useMemo(()=>({allEntries:u,visibleEntries:d,getEntryFromId:h,expandAll:y,profile:c}),[u,d,h,y,c]);return C.jsx(F.Provider,{value:g,children:q})}const B=["fuzzy"];function W({form:q,name:u,optionsList:c,label:i=null,variant:f="outlined",size:O="small",width:S=350,changeHandler:x,multiple:a=!1,defaultValue:j,placeholder:y="Please Choose"}){const[m,z]=n.useState(!1),d=n.useCallback(()=>z(!1),[]),h=n.useCallback(()=>z(!0),[]),g=n.useCallback(s=>{x(s),!a&&d()},[x,d,a]);return C.jsxs(D,{id:`${u}FormControl`,size:O,color:"info",variant:f,style:{marginBottom:0,width:S||"auto"},children:[i&&C.jsx(P,{style:{color:"#bbb"},children:i}),C.jsx(U,{id:`${u}Select`,value:q[u]||j,multiple:a,name:u,label:i,open:m,onClose:d,onOpen:h,onChange:g,placeholder:y,style:{fontWeight:400,color:"#eee",fontSize:"1.1rem"},children:c.map((s,r)=>C.jsx(R,{value:c[r],children:c[r]},r))})]})}export{N as D,W as S};
