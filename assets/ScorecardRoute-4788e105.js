import{ac as R,r as t,J as M,p as K,j as e,R as I,t as b,A as Q,C as X,a1 as L,a2 as pe,v as q,T as ue,I as Z,a9 as G,ai as me,M as he,U as ge,aj as je,ak as ye,N as ve,O as fe,P as Ce}from"./index-4b188d3e.js";import{u as be}from"./useData-08889d22.js";import{I as J,S as Y,a as ke}from"./ScorecardDanStats-6d3beab1.js";import{D as Se,F as De,a as Ee,s as Ae}from"./index-bad2caa2.js";import{S as we,a as Ie,b as Pe}from"./ScorecardListContext-3eef104e.js";import{u as H}from"./useWindowSize-f849c51d.js";import{L as ee}from"./LoadingDisplay-501f80df.js";import{L as Le}from"./Link-697d218a.js";import{T as Fe}from"./TextField-eb1ae80d.js";import{L as te,A as se,D as Be,E as Te}from"./CollectionButton-ad0e1bd2.js";import{P as Re}from"./ProfileHeader-029e56a7.js";import{B as Ne}from"./BeltStripe-551c31d1.js";import{F as Me,d as He}from"./FieldValue-0bc2a12f.js";import{A as re,a as ae,b as ne}from"./AccordionSummary-85a47a09.js";import{N as _e,E as ze}from"./ScorecardExportButton-0eaa1a8d.js";import{I as Oe}from"./IntroCopy-eb223ecc.js";import{L as Ue}from"./LoadingDisplay-c9b9de48.js";import{P as $e}from"./ProfileNotFound-c6cc3dcf.js";import{S as We,a as Ve,s as qe,F as Ge}from"./sortFields-f5c50c67.js";import{S as Je}from"./SystemMessage-057bff72.js";import"./Link-93d234fa.js";import"./chartDefaults-9fc07b21.js";import"./nivo-bar.es-3015ecee.js";import"./nivo-legends.es-5b5cc803.js";import"./index-510f16ea.js";import"./Box-5b62049c.js";import"./Select-6ce324fb.js";import"./PhotoCamera-5a71ef71.js";import"./Launch-37670ae8.js";import"./Autocomplete-a1f2ddac.js";import"./Search-1fea117e.js";import"./Dialog-9767886d.js";import"./ListItem-1fc52e69.js";import"./CopyProfileLinkButton-72c59c31.js";import"./ToggleButtonGroup-9773ca87.js";import"./mycollection-0ec86312.js";import"./download-a43c861b.js";import"./ContentCopy-54909ca0.js";import"./LPU-c3fa7122.js";import"./LinearProgress-adbd3566.js";import"./Sort-ebddd4b4.js";function Ye({setControlsExpanded:a,adminAction:s}){const{userId:o}=R(),{importUnclaimedEvidence:l}=t.useContext(M),{isMobile:n}=H(),[c,i]=t.useState(!1),d=K(),[x,m]=t.useState(""),[g,j]=t.useState(null),S=t.useCallback(async()=>{i(!0);const y=await l(o,x);i(!1),y?(m(""),a(!1),s()):j("Cannot find dan sheet tab")},[l,o,x,a,s]),D=n?"block":"flex";return e.jsx(I.Fragment,{children:e.jsx("div",{style:{placeItems:"center",display:D},children:c?e.jsx(ee,{}):e.jsx(I.Fragment,{children:e.jsxs("div",{style:{padding:20},children:[e.jsx("strong",{children:"For Black Belt pickers only."}),e.jsx("br",{}),"Black Belt pickers currently use another scorecard system known as the Dan Sheet. This import allows them to bring their picking history over to the site. If you do not already have a tab in the Dan sheet, this import will not work for you. For those that do, specify the name of your tab in the sheet to import your history into your Scorecard. Please note that tab names are case sensitive. ",e.jsx(Le,{onClick:()=>{d("/profile/scorecard/howto")},style:{color:"#bbb",cursor:"pointer"},children:"Click here to learn more."}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("div",{style:{padding:"0px",alignItems:"center"},children:e.jsxs("div",{style:{padding:"0px",display:"flex"},children:[e.jsx("div",{style:{flexGrow:1}}),e.jsx(Fe,{id:"tab-to-import",label:"Tab to Import",value:x,size:"small",error:!!g,helperText:g,margin:"dense",color:"secondary",onChange:y=>{m(y.target.value)}}),e.jsx(b,{style:{color:"#000",padding:0,lineHeight:"1rem",height:40,marginTop:8,marginLeft:10},variant:"contained",onClick:S,edge:"start",color:"secondary",children:"Import"})]})})]})})})})}var O={},Ke=X;Object.defineProperty(O,"__esModule",{value:!0});var oe=O.default=void 0,Qe=Ke(Q()),Xe=e;oe=O.default=(0,Qe.default)((0,Xe.jsx)("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3m-3 11H8v-5h8zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m-1-9H6v4h12z"}),"Print");L.extend(pe);function Ze({owner:a,date:s}){const{userId:o}=R(),{updateProfileBlackBeltAwardedAt:l}=t.useContext(M),[n,c]=t.useState(!1),[i,d]=t.useState(!1),[x,m]=t.useState(L.utc(s)),g=K(),j=t.useCallback((h,E)=>{a&&c(E)},[a]),S=t.useCallback(()=>{m(L.utc(s)),d(!1)},[s]),D=t.useCallback(async()=>{try{l(o,x),q("Profile updated"),d(!1)}catch(h){console.error("Error while updating profile",h),q("Error while updating profile")}},[o,x,l]),y=t.useCallback(h=>{h.preventDefault(),h.stopPropagation(),g("/award")},[g]);let r=s?L.utc(s).format("L"):"(no date)";r=r.replace("/202","/2"),r=r.replace("/201","/1");const v={maxWidth:700,marginLeft:"auto",marginRight:"auto",display:"flex",placeItems:"center"},f=a?{}:{cursor:"default"},A=a?e.jsx(He,{}):null,{isMobile:k}=H(),F=k?"block":"flex",P=k?"65%":"56%",C=k?{display:"block",marginLeft:0,placeItems:"center"}:{display:"flex",margin:"0px 0px 0px 20px"},w=i?"#fff":"#555",B=i?"#e15c07":"#555";return e.jsxs(I.Fragment,{children:[e.jsxs(re,{expanded:n,onChange:j,children:[e.jsxs(ae,{expandIcon:A,style:{...v,...f},children:[e.jsx(Ne,{value:"Black"}),e.jsx("div",{style:{margin:"4px 0px 0px 8px",width:P,flexShrink:0,flexDirection:"column"},children:e.jsx(Me,{value:"Black Belt Awarded",textStyle:{marginLeft:"0px",fontWeight:700},style:{marginBottom:"2px"}})}),e.jsxs("div",{style:{display:F,placeItems:"center",marginLeft:10},children:[e.jsx("div",{style:{display:"flex",width:76}}),e.jsx("div",{style:C,children:e.jsx("div",{style:{margin:"4px 0px 0px 10px"},children:r})}),a&&e.jsx(ue,{title:"Print Certificate",arrow:!0,disableFocusListener:!0,children:e.jsx(Z,{onClick:y,style:{marginLeft:30},children:e.jsx(oe,{})})})]})]}),n&&e.jsx(ne,{sx:{padding:"4px 16px 0px 26px"},children:e.jsx(te,{adapterLocale:L.locale(),dateAdapter:se,children:e.jsx(I.Fragment,{children:e.jsxs("div",{style:{display:"flex",width:"100%",marginBottom:20},children:[e.jsx(Be,{label:"Awarded date",value:x,onChange:h=>{m(h),d(!0)},sx:{width:400},disableFuture:!0}),e.jsxs("div",{style:{width:"100%",textAlign:"right",position:"relative",top:"30px",padding:"0px 12px 8px 0px"},children:[e.jsx(b,{style:{marginRight:10,color:B},onClick:S,disabled:!i,children:"Cancel"}),e.jsx(b,{style:{marginRight:0,color:w},onClick:D,disabled:!i,children:"Save"})]})]})})})})]}),e.jsx(G,{}),e.jsx(G,{})]})}function et({owner:a,profile:s,adminAction:o}){const{isMobile:l}=H(),{userId:n}=R(),{visibleEntries:c=[],cardEvidence:i}=t.useContext(Se),{expanded:d}=t.useContext(we),{filters:x,removeFilters:m}=t.useContext(De),{createEvidenceForEntries:g,removeEvidence:j,removeProfileBlackBeltAwarded:S,updateUserStatistics:D}=t.useContext(M),{admin:y}=t.useContext(me),[r,v]=t.useState(d),[f,A]=t.useState(!1),[k,F]=t.useState("import"),[P,C]=t.useState(!1);d&&d!==r&&v(d);const w=t.useMemo(()=>{if(s&&s.recorded){const p=i.map(z=>z.matchId);return s.recorded.filter(z=>!p.includes(z))}else return[]},[s,i]),B=t.useCallback(p=>{x.id&&m(["id"]),v(p)},[x,m]),h=t.useCallback(async()=>{C(!0),await g(n,w),A(!1),C(!1),o()},[g,n,w,o]),E=t.useCallback(p=>{F(p),A(!f)},[f]),[N,u]=t.useState(null),T=!!N,le=t.useCallback(p=>{p.preventDefault(),p.stopPropagation(),u(p.currentTarget)},[]),_=t.useCallback(()=>u(null),[]),ce=t.useCallback(async()=>{C(!0),await D(n),C(!1)},[D,n]),de=t.useCallback(async()=>{C(!0),await j(i),await S(n),_(),C(!1),o()},[i,j,_,o,S,n]),$=l?10:40,W=l?"block":"flex",V=(s==null?void 0:s.blackBeltAwardedAt)>0,xe=V?"100%":"50%";return e.jsxs("div",{style:{maxWidth:700,padding:0,backgroundColor:"#222",marginLeft:"auto",marginRight:"auto",marginTop:16},children:[e.jsx(Re,{profile:s,page:"scorecard",owner:a}),a&&c.length>0&&!s.tabClaimed&&e.jsx("div",{style:{margin:8,padding:"0px 0px"},children:e.jsx(Oe,{pageName:"scorecard"})}),c.length>0&&e.jsx(I.Fragment,{children:l?e.jsxs("div",{style:{display:W,padding:"0px 8px 0px 16px"},children:[s.danLevel>0&&e.jsx(Y,{profile:s,owner:a}),e.jsx("div",{style:{marginRight:0,width:"95%"},children:e.jsx(J,{profile:s,entries:c})})]}):e.jsxs("div",{style:{display:W,padding:"10px 8px 0px 16px"},children:[e.jsx("div",{style:{marginRight:0,width:380},children:e.jsx(J,{profile:s,entries:c})}),s.danLevel>0&&e.jsx("div",{style:{flexGrow:1,marginRight:0},children:e.jsx(Y,{profile:s,owner:a})})]})}),(a||y)&&e.jsxs(re,{expanded:f,disableGutters:!0,children:[e.jsx(ae,{style:{paddingLeft:$,paddingRight:$,placeItems:"center",width:"100%"},children:e.jsxs("div",{style:{width:"100%",placeItems:"center",textAlign:"center"},children:[e.jsxs("div",{style:{display:"flex",width:"100%",placeItems:"center",textAlign:"center"},children:[!V&&e.jsx("div",{style:{width:"50%",textAlign:"center"},children:e.jsx(b,{variant:"contained",color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:()=>E("import"),children:"IMPORT DAN SHEET"})}),e.jsx("div",{style:{width:xe,textAlign:"center"},children:e.jsx(b,{variant:"outlined",color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:()=>E("project"),children:f&&k==="project"?"CANCEL ADD PROJECT":"ADD PROJECT"})})]}),P&&e.jsx(ee,{}),y&&!P&&e.jsx("div",{style:{backgroundColor:"#700",padding:5,marginTop:20},children:e.jsxs("div",{style:{display:"flex"},children:[e.jsx("div",{style:{width:"10%",textAlign:"center"},children:"admin"}),e.jsx("div",{style:{width:"20%",textAlign:"center"},children:e.jsx(b,{color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:()=>E("import"),children:"IMPORT DAN SHEET"})}),e.jsx("div",{style:{width:"20%",textAlign:"center"},children:e.jsx(b,{color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:ce,children:"UPDATE STATS"})}),e.jsx("div",{style:{width:"20%",textAlign:"center"},children:e.jsxs(b,{color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:h,children:["MERGE RECORDEDÂ (",w.length,")"]})}),e.jsxs("div",{style:{width:"20%",textAlign:"center"},children:[e.jsx(b,{color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:le,children:"DELETE SCORECARD"}),e.jsxs(he,{anchorEl:N,open:T,onClose:_,children:[e.jsxs("div",{style:{padding:20,textAlign:"center"},children:["You cannot undo delete.",e.jsx("br",{}),"Are you sure?"]}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(b,{style:{marginBottom:10,color:"#000"},variant:"contained",onClick:de,edge:"start",color:"error",children:"Delete"})})]})]})]})})]})}),e.jsxs(ne,{style:{backgroundColor:"#333"},children:[k==="import"&&e.jsx(Ye,{setControlsExpanded:A,adminAction:o}),k==="project"&&e.jsx(Te,{evid:null,handleUpdate:E,addProject:!0})]})]}),c.length===0&&e.jsx(_e,{}),s&&s.blackBeltAwardedAt&&e.jsx(Ze,{owner:a,date:s.blackBeltAwardedAt.toDate().toJSON()}),e.jsx("div",{children:c.map(p=>e.jsx(ke,{owner:a,evid:p,expanded:p.id===r,onExpand:B,merged:s.blackBeltAwardedAt>0},p.id))})]})}var U={},tt=X;Object.defineProperty(U,"__esModule",{value:!0});var ie=U.default=void 0,st=tt(Q()),rt=e;ie=U.default=(0,st.default)((0,rt.jsx)("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"}),"LaunchOutlined");function at(){const{userId:a}=R(),s=`https://lpubelts.com/#/profile/${a}/scorecard/no-tracking`,o=t.useCallback(l=>{const n=window.open(l,"_blank","noopener,noreferrer");n&&(n.opener=null)},[]);return e.jsx(Z,{onClick:()=>o(s),children:e.jsx(ie,{fontSize:"small"})})}function qt(){const{userId:a}=R(),{user:s}=t.useContext(ge),{getProfile:o,getEvidence:l}=t.useContext(M),{scoredEvidence:n,bbCount:c,danPoints:i,eligibleDan:d,nextDanPoints:x,nextDanLocks:m}=t.useContext(je),{isMobile:g}=H(),[j,S]=t.useState(!1),D=t.useCallback(()=>{S(!j)},[j]),y=t.useCallback(async()=>{try{const u=await o(a);if(u){const T=u.displayName?u.displayName.toLowerCase().endsWith("s")?`${u.displayName}'`:`${u.displayName}'s`:"Anonymous";document.title=`LPU Belt Explorer - ${T} Scorecard`}if((s==null?void 0:s.uid)!==a){const T=await l(a);return{profile:u,...ye(T)}}else return{profile:u,scoredEvidence:n,bbCount:c,danPoints:i,eligibleDan:d,nextDanPoints:x,nextDanLocks:m}}catch(u){return console.error("Error loading profile and evidence.",u),null}},[j,s,a,o,l,n,c,i,d,x,m]),{data:r={},loading:v,error:f}=be({loadFn:y}),A=r?r.profile:{},k=r?r.scoredEvidence:[],F=r?r.bbCount:0,P=r?r.danPoints:0,C=r?r.eligibleDan:0,w=r?r.nextDanPoints:0,B=r?r.nextDanLocks:0,h=e.jsxs(I.Fragment,{children:[e.jsx(We,{label:"Scorecard",extraFilters:[{key:"tab",value:"search"}]}),e.jsx(Ve,{sortValues:qe}),e.jsx(Ge,{extraFilters:[{key:"tab",value:"search"}]}),!g&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}})]}),E=e.jsxs(I.Fragment,{children:[e.jsx("br",{}),e.jsx(ze,{}),e.jsx(at,{})]}),N=v?"Loading...":"Profile";return v||f?null:e.jsx(Ee,{filterFields:Ae,children:e.jsx(Ie,{cardEvidence:k,cardBBCount:F,cardDanPoints:P,cardEligibleDan:C,cardNextDanPoints:w,cardNextDanLocks:B,children:e.jsxs(Pe,{children:[e.jsxs(te,{adapterLocale:L.locale(),dateAdapter:se,children:[e.jsx(ve,{title:N,extras:h}),e.jsx(Je,{}),v&&e.jsx(Ue,{}),!v&&r&&!f&&e.jsx(et,{owner:s&&s.uid===a,profile:A,adminAction:D}),!v&&(!r||f)&&e.jsx($e,{}),e.jsx(fe,{extras:E})]}),e.jsx(Ce,{feature:"scorecard"})]})})})}export{qt as default};
