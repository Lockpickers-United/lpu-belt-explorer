import{a0 as Se}from"./index-DMiwPlZn.js";var te={exports:{}},Le=te.exports,xe;function Ie(){return xe||(xe=1,(function(Z){((P,T)=>{Z.exports?Z.exports=T():P.fuzzysort=T()})(Le,P=>{var T=(r,e)=>{if(!r||!e)return b;var a=ee(r);J(e)||(e=M(e));var f=a.bitflags;return(f&e._bitflags)!==f?b:E(a,e)},p=(r,e,a)=>{if(!r)return a!=null&&a.all?se(e,a):_e;var f=ee(r),t=f.bitflags,i=f.containsSpace,n=q((a==null?void 0:a.threshold)||0),v=(a==null?void 0:a.limit)||oe,s=0,o=0,u=e.length;function A(Q){s<v?(ie.add(Q),++s):(++o,Q._score>ie.peek()._score&&ie.replaceTop(Q))}if(a!=null&&a.key)for(var y=a.key,_=0;_<u;++_){var L=e[_],g=ne(L,y);if(g&&(J(g)||(g=M(g)),(t&g._bitflags)===t)){var d=E(f,g);d!==b&&(d._score<n||(d.obj=L,A(d)))}}else if(a!=null&&a.keys){var $=a.keys,z=$.length;e:for(var _=0;_<u;++_){var L=e[_];{for(var S=0,c=0;c<z;++c){var y=$[c],g=ne(L,y);if(!g){ce[c]=R;continue}J(g)||(g=M(g)),ce[c]=g,S|=g._bitflags}if((t&S)!==t)continue}if(i)for(let h=0;h<f.spaceSearches.length;h++)O[h]=B;for(var c=0;c<z;++c){if(g=ce[c],g===R){X[c]=R;continue}if(X[c]=E(f,g,!1,i),X[c]===b){X[c]=R;continue}if(i)for(let x=0;x<f.spaceSearches.length;x++){if(H[x]>-1e3&&O[x]>B){var m=(O[x]+H[x])/4;m>O[x]&&(O[x]=m)}H[x]>O[x]&&(O[x]=H[x])}}if(i){for(let h=0;h<f.spaceSearches.length;h++)if(O[h]===B)continue e}else{var l=!1;for(let h=0;h<z;h++)if(X[h]._score!==B){l=!0;break}if(!l)continue}var C=new N(z);for(let h=0;h<z;h++)C[h]=X[h];if(i){var w=0;for(let h=0;h<f.spaceSearches.length;h++)w+=O[h]}else{var w=B;for(let x=0;x<z;x++){var d=C[x];if(d._score>-1e3&&w>B){var m=(w+d._score)/4;m>w&&(w=m)}d._score>w&&(w=d._score)}}if(C.obj=L,C._score=w,a!=null&&a.scoreFn){if(w=a.scoreFn(C),!w)continue;w=q(w),C._score=w}w<n||A(C)}}else for(var _=0;_<u;++_){var g=e[_];if(g&&(J(g)||(g=M(g)),(t&g._bitflags)===t)){var d=E(f,g);d!==b&&(d._score<n||A(d))}}if(s===0)return _e;for(var K=new Array(s),_=s-1;_>=0;--_)K[_]=ie.poll();return K.total=s+o,K},j=(r,e="<b>",a="</b>")=>{for(var f=typeof e=="function"?e:void 0,t=r.target,i=t.length,n=r.indexes,v="",s=0,o=0,u=!1,A=[],y=0;y<i;++y){var _=t[y];if(n[o]===y){if(++o,u||(u=!0,f?(A.push(v),v=""):v+=e),o===n.length){f?(v+=_,A.push(f(v,s++)),v="",A.push(t.substr(y+1))):v+=_+a+t.substr(y+1);break}}else u&&(u=!1,f?(A.push(f(v,s++)),v=""):v+=a);v+=_}return f?A:v},U=r=>{typeof r=="number"?r=""+r:typeof r!="string"&&(r="");var e=ve(r);return V(r,{_targetLower:e._lower,_targetLowerCodes:e.lowerCodes,_bitflags:e.bitflags})},k=()=>{le.clear(),ue.clear()};class I{get indexes(){return this._indexes.slice(0,this._indexes.len).sort((e,a)=>e-a)}set indexes(e){return this._indexes=e}highlight(e,a){return j(this,e,a)}get score(){return W(this._score)}set score(e){this._score=q(e)}}class N extends Array{get score(){return W(this._score)}set score(e){this._score=q(e)}}var V=(r,e)=>{const a=new I;return a.target=r,a.obj=e.obj??b,a._score=e._score??B,a._indexes=e._indexes??[],a._targetLower=e._targetLower??"",a._targetLowerCodes=e._targetLowerCodes??b,a._nextBeginningIndexes=e._nextBeginningIndexes??b,a._bitflags=e._bitflags??0,a},W=r=>r===B?0:r>1?r:Math.E**(((-r+1)**.04307-1)*-2),q=r=>r===0?B:r>1?r:1-Math.pow(Math.log(r)/-2+1,1/.04307),F=r=>{typeof r=="number"?r=""+r:typeof r!="string"&&(r=""),r=r.trim();var e=ve(r),a=[];if(e.containsSpace){var f=r.split(/\s+/);f=[...new Set(f)];for(var t=0;t<f.length;t++)if(f[t]!==""){var i=ve(f[t]);a.push({lowerCodes:i.lowerCodes,_lower:f[t].toLowerCase(),containsSpace:!1})}}return{lowerCodes:e.lowerCodes,_lower:e._lower,containsSpace:e.containsSpace,bitflags:e.bitflags,spaceSearches:a}},M=r=>{if(r.length>999)return U(r);var e=le.get(r);return e!==void 0||(e=U(r),le.set(r,e)),e},ee=r=>{if(r.length>999)return F(r);var e=ue.get(r);return e!==void 0||(e=F(r),ue.set(r,e)),e},se=(r,e)=>{var a=[];a.total=r.length;var f=(e==null?void 0:e.limit)||oe;if(e!=null&&e.key)for(var t=0;t<r.length;t++){var i=r[t],n=ne(i,e.key);if(n!=b){J(n)||(n=M(n));var v=V(n.target,{_score:n._score,obj:i});if(a.push(v),a.length>=f)return a}}else if(e!=null&&e.keys)for(var t=0;t<r.length;t++){for(var i=r[t],s=new N(e.keys.length),o=e.keys.length-1;o>=0;--o){var n=ne(i,e.keys[o]);if(!n){s[o]=R;continue}J(n)||(n=M(n)),n._score=B,n._indexes.len=0,s[o]=n}if(s.obj=i,s._score=B,a.push(s),a.length>=f)return a}else for(var t=0;t<r.length;t++){var n=r[t];if(n!=b&&(J(n)||(n=M(n)),n._score=B,n._indexes.len=0,a.push(n),a.length>=f))return a}return a},E=(r,e,a=!1,f=!1)=>{if(a===!1&&r.containsSpace)return Y(r,e,f);for(var t=r._lower,i=r.lowerCodes,n=i[0],v=e._targetLowerCodes,s=i.length,o=v.length,_=0,u=0,A=0;;){var y=n===v[u];if(y){if(D[A++]=u,++_,_===s)break;n=i[_]}if(++u,u>=o)return b}var _=0,L=!1,g=0,d=e._nextBeginningIndexes;d===b&&(d=e._nextBeginningIndexes=be(e.target)),u=D[0]===0?0:d[D[0]-1];var $=0;if(u!==o)for(;;)if(u>=o){if(_<=0||(++$,$>200))break;--_;var z=re[--g];u=d[z]}else{var y=i[_]===v[u];if(y){if(re[g++]=u,++_,_===s){L=!0;break}++u}else u=d[u]}var S=s<=1?-1:e._targetLower.indexOf(t,D[0]),c=!!~S,m=c?S===0||e._nextBeginningIndexes[S-1]===S:!1;if(c&&!m){for(var l=0;l<d.length;l=d[l])if(!(l<=S)){for(var C=0;C<s&&i[C]===e._targetLowerCodes[l+C];C++);if(C===s){S=l,m=!0;break}}}var w=h=>{for(var x=0,de=0,G=1;G<s;++G)h[G]-h[G-1]!==1&&(x-=h[G],++de);var ye=h[s-1]-h[0]-(s-1);if(x-=(12+ye)*de,h[0]!==0&&(x-=h[0]*h[0]*.2),!L)x*=1e3;else{for(var ge=1,G=d[0];G<o;G=d[G])++ge;ge>24&&(x*=(ge-24)*10)}return x-=(o-s)/2,c&&(x/=1+s*s*1),m&&(x/=1+s*s*1),x-=(o-s)/2,x};if(L)if(m){for(var l=0;l<s;++l)D[l]=S+l;var K=D,Q=w(D)}else var K=re,Q=w(re);else{if(c)for(var l=0;l<s;++l)D[l]=S+l;var K=D,Q=w(K)}e._score=Q;for(var l=0;l<s;++l)e._indexes[l]=K[l];e._indexes.len=s;const fe=new I;return fe.target=e.target,fe._score=e._score,fe._indexes=e._indexes,fe},Y=(r,e,a)=>{for(var f=new Set,t=0,i=b,n=0,v=r.spaceSearches,s=v.length,o=0,u=()=>{for(let m=o-1;m>=0;m--)e._nextBeginningIndexes[ae[m*2+0]]=ae[m*2+1]},A=!1,c=0;c<s;++c){H[c]=B;var y=v[c];if(i=E(y,e),a){if(i===b)continue;A=!0}else if(i===b)return u(),b;var _=c===s-1;if(!_){var L=i._indexes,g=!0;for(let l=0;l<L.len-1;l++)if(L[l+1]-L[l]!==1){g=!1;break}if(g){var d=L[L.len-1]+1,$=e._nextBeginningIndexes[d-1];for(let l=d-1;l>=0&&$===e._nextBeginningIndexes[l];l--)e._nextBeginningIndexes[l]=d,ae[o*2+0]=l,ae[o*2+1]=$,o++}}t+=i._score/s,H[c]=i._score/s,i._indexes[0]<n&&(t-=(n-i._indexes[0])*2),n=i._indexes[0];for(var z=0;z<i._indexes.len;++z)f.add(i._indexes[z])}if(a&&!A)return b;u();var S=E(r,e,!0);if(S!==b&&S._score>t){if(a)for(var c=0;c<s;++c)H[c]=S._score/s;return S}a&&(i=e),i._score=t;var c=0;for(let m of f)i._indexes[c++]=m;return i._indexes.len=c,i},he=r=>r.replace(new RegExp("\\p{Script=Latin}+","gu"),e=>e.normalize("NFD")).replace(/[\u0300-\u036f]/g,""),ve=r=>{r=he(r);for(var e=r.length,a=r.toLowerCase(),f=[],t=0,i=!1,n=0;n<e;++n){var v=f[n]=a.charCodeAt(n);if(v===32){i=!0;continue}var s=v>=97&&v<=122?v-97:v>=48&&v<=57?26:v<=127?30:31;t|=1<<s}return{lowerCodes:f,bitflags:t,containsSpace:i,_lower:a}},we=r=>{for(var e=r.length,a=[],f=0,t=!1,i=!1,n=0;n<e;++n){var v=r.charCodeAt(n),s=v>=65&&v<=90,o=s||v>=97&&v<=122||v>=48&&v<=57,u=s&&!t||!i||!o;t=s,i=o,u&&(a[f++]=n)}return a},be=r=>{r=he(r);for(var e=r.length,a=we(r),f=[],t=a[0],i=0,n=0;n<e;++n)t>n?f[n]=t:(t=a[++i],f[n]=t===void 0?e:t);return f},le=new Map,ue=new Map,D=[],re=[],ae=[],O=[],H=[],ce=[],X=[],ne=(r,e)=>{var a=r[e];if(a!==void 0)return a;if(typeof e=="function")return e(r);var f=e;Array.isArray(e)||(f=e.split("."));for(var t=f.length,i=-1;r&&++i<t;)r=r[f[i]];return r},J=r=>typeof r=="object"&&typeof r._bitflags=="number",oe=1/0,B=-oe,_e=[];_e.total=0;var b=null,R=U(""),me=r=>{var e=[],a=0,f={},t=i=>{for(var n=0,v=e[n],s=1;s<a;){var o=s+1;n=s,o<a&&e[o]._score<e[s]._score&&(n=o),e[n-1>>1]=e[n],s=1+(n<<1)}for(var u=n-1>>1;n>0&&v._score<e[u]._score;u=(n=u)-1>>1)e[n]=e[u];e[n]=v};return f.add=(i=>{var n=a;e[a++]=i;for(var v=n-1>>1;n>0&&i._score<e[v]._score;v=(n=v)-1>>1)e[n]=e[v];e[n]=i}),f.poll=(i=>{if(a!==0){var n=e[0];return e[0]=e[--a],t(),n}}),f.peek=(i=>{if(a!==0)return e[0]}),f.replaceTop=(i=>{e[0]=i,t()}),f},ie=me();return{single:T,go:p,prepare:U,cleanup:k}})})(te)),te.exports}var Ae=Ie();const Ce=Se(Ae),Ne=({advancedFilterGroups:Z,entries:P,groupIndex:T,valueIndex:p})=>{if(!P||P.length===0)return[];const j=Array.isArray(Z)?Z:[];if(j.length===0||T<0)return P;const U=I=>{if(!I||!I.fieldName)return null;const N=I.fieldName,V=Array.isArray(I.values)?I.values.filter(F=>F!=null&&String(F).length):[];if(V.length===0)return null;const W=(I.operator||"AND").toUpperCase()==="OR"?"OR":"AND",q=(I.matchType||"Is").toLowerCase()==="is not";return{fieldName:N,values:V,operator:W,negative:q}};let k=j.map(U).filter(Boolean);if(k.length===0)return P;if(Number.isFinite(T)&&T>=0&&(k=k.slice(0,Math.min(T+1,k.length))),k.length>0&&Number.isFinite(p)&&p>=0){const I=k.length-1,N=k[I];Array.isArray(N.values)&&N.values.length>0&&(N.values=N.values.slice(0,Math.min(p+1,N.values.length)))}return P.filter(I=>k.every(({fieldName:N,values:V,operator:W,negative:q})=>{const F=I[N],M=Y=>Array.isArray(F)?F.includes(Y):F===Y,ee=V.some(Y=>M(Y)),se=V.every(Y=>M(Y)),E=W==="OR"?ee:se;return q?!E:E}))};export{Ce as a,Ne as f};
