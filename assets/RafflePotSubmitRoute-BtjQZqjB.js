import{r as t,u as w,b as K,j as e,L as N,B as C,X as W,D as G,A as M,R as X,e as _,N as J,h as Q}from"./index-CKCuSFBF.js";import{u as V}from"./usePageTitle-NIfOajWs.js";import{L as Z}from"./LoadingDisplay-CNBA6kz3.js";import{p as ee,c as te}from"./postData-DsGi8Z_8.js";import{n as ne}from"./dataUrls-CThgH6Wi.js";import{R as oe}from"./RaflPotSearchBox-CrIqCmiJ.js";import{R as ie}from"./RaffleContext-BGObfoXU.js";import{C as se}from"./Checkbox-YD60C-WE.js";import{C as ae}from"./Collapse-DpE3h3uU.js";import{T as a}from"./TextField-BQksFVeJ.js";import{D as k}from"./Dialog-DVt8eqDH.js";import{A as le}from"./AdminToolButtons-CHeJ8Yeq.js";import"./Box-WUD-gb6M.js";import"./CircularProgress-CTLr7fKa.js";import"./index-xsH4HHeE.js";import"./Search-CFyiAWIi.js";import"./useFormControl-BLzBee5U.js";import"./Select-DgsBUf3p.js";import"./Chip-CgE5m0CA.js";import"./useData-Cf4MysK_.js";import"./index-X7fHUEzD.js";import"./setDeep-J6HEwWhX.js";import"./SwitchBase-CWpLqJ3D.js";import"./EmojiEvents-DE88vqoA.js";function re({profile:d,user:f}){const{allPots:m=[]}=t.useContext(ie),[h,u]=t.useState(void 0),[y,x]=t.useState(!1),[r,j]=t.useState(void 0),[n,v]=t.useState({}),[b,g]=t.useState({}),[p,P]=t.useState(!1),[D,A]=t.useState(""),[S,T]=t.useState(!1),[B,z]=t.useState(!1),s=t.useCallback(i=>{const{name:o,value:l}=i.target;v({...n,[o]:l}),z(!0)},[n]),I=t.useCallback(i=>{g(i);const o=m.find(l=>l.id===i.lockId);s({target:{name:"contributedBy",value:(o==null?void 0:o.contributedBy.join(", "))||""}})},[m,s]),U=async i=>{i.preventDefault(),x(!0);const o={...n,displayName:n.discordUsername||n.redditUsername||(d==null?void 0:d.displayName)||"unknown"},l=new FormData;Object.keys(o).forEach(c=>{l.append(c,o[c])}),l.append("subjectText",`Pot info submitted for ${b.lockFullName} by ${o.displayName||"unknown"}`),l.append("potName",b.lockFullName),l.append("potId",b.lockId);const H=`${ne}/email-form`;try{const c=await ee({user:f,url:H,formData:l,snackBars:!1,timeoutDuration:2e4});W("Submit successful",{variant:"success"}),u(c)}catch(c){j(te(c)),W(`Error creating request: ${c}`,{variant:"error",autoHideDuration:3e3})}finally{x(!1),v(o)}},F=t.useCallback(()=>{v({}),g({}),T(!S),x(!1),u(void 0),j(void 0)},[S]),O=t.useCallback(()=>{x(!1),u(void 0),j(void 0)},[]),E=t.useCallback(()=>{P(!p),g([])},[p]),Y=t.useCallback(i=>{const{value:o}=i.target;A(o),g({lockFullName:o,lockName:o,lockId:"NOTINLIST"})},[]),$=p?.5:1,{flexStyle:q}=w(),R={color:"#bbb",textDecoration:"underline",cursor:"pointer",fontWeight:500,"&:hover":{color:"#fff"}},L=K();return e.jsxs("div",{style:{maxWidth:800,padding:0,marginLeft:"auto",marginRight:"auto",marginTop:16,marginBottom:46,paddingLeft:8},children:[e.jsxs("div",{style:{fontSize:"1.7rem",fontWeight:600,marginBottom:20},children:["Pot Info |  ",e.jsx(N,{onClick:()=>L("/rafl/photos"),sx:R,children:"Photos"})," |  ",e.jsx(N,{onClick:()=>L("/rafl/potpreview"),sx:R,children:"Preview"})]}),e.jsx("form",{action:null,encType:"multipart/form-data",method:"post",onSubmit:U,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16,width:500},children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:500,margin:"0px 0px 0px"},children:"Select Pot"}),e.jsx("div",{style:{opacity:$},children:e.jsx(oe,{handleChangeLock:I,allEntries:m,disabled:p,reset:S})}),e.jsxs("div",{style:{marginTop:0},children:[e.jsx(se,{onChange:E,color:"info",size:"small",id:"notInList",checked:p})," Submit photos for a pot not on the site."]}),e.jsxs(ae,{in:p,style:{},children:[e.jsx("span",{style:{fontSize:"0.9rem"},children:"Pot Name"}),e.jsx("br",{}),e.jsx(a,{type:"text",id:"altLockName",name:"altLockName",value:D,style:{width:400,marginBottom:25},onChange:Y,color:"info"})]}),e.jsx(a,{label:"Contributed by",name:"contributedBy",value:n.contributedBy||"",onChange:s,color:"info",fullWidth:!0}),e.jsx(a,{label:"Title",name:"title",value:n.title||"",onChange:s,color:"info",fullWidth:!0}),e.jsx(a,{label:"Pot contents",name:"potContents",value:n.potContents||"",onChange:s,fullWidth:!0,multiline:!0,color:"info",minRows:5}),e.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[e.jsx("div",{style:{minWidth:220},children:e.jsxs(a,{label:"Number of winners",name:"numberOfWinners",value:n.numberOfWinners||"",onChange:s,fullWidth:!0,select:!0,color:"info",SelectProps:{native:!0},children:[e.jsx("option",{"aria-label":"None",value:""}),Array.from({length:20},(i,o)=>o+1).map(i=>e.jsx("option",{value:i,children:i},i))]})}),e.jsx(a,{label:"Country",name:"country",value:n.country||"",onChange:s,fullWidth:!0,color:"info",style:{minWidth:260}})]}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:500,marginTop:10},children:"Shipping Info"}),e.jsxs(a,{label:"Shipping type",name:"shippingType",value:n.shippingType||"",onChange:s,fullWidth:!0,select:!0,color:"info",SelectProps:{native:!0},children:[e.jsx("option",{"aria-label":"None",value:""}),e.jsx("option",{value:"Digital prize",children:"Digital prize"}),e.jsx("option",{value:"International shipping included",children:"International shipping included"}),e.jsx("option",{value:"Split international shipping",children:"Split international shipping"}),e.jsx("option",{value:"Domestic only",children:"Domestic only"}),e.jsx("option",{value:"Winner pays international shipping",children:"Winner pays international shipping"})]}),n.shippingType==="Split international shipping"&&e.jsx(a,{label:"How much will you contribute to intl shipping?",name:"splitShippingAmount",value:n.splitShippingAmount||"",onChange:s,color:"info",style:{width:360}}),e.jsxs(a,{label:"Ships to US?",name:"shipsToUS",value:n.shipsToUS||"",onChange:s,fullWidth:!0,select:!0,color:"info",SelectProps:{native:!0},children:[e.jsx("option",{"aria-label":"None",value:""}),e.jsx("option",{value:"Yes",children:"Yes"}),e.jsx("option",{value:"Yes, buyer pays duties & fees",children:"Yes, buyer pays duties & fees"}),e.jsx("option",{value:"No",children:"No"})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("div",{style:{marginRight:50,width:300},children:e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:600},children:"Contact Info"})}),e.jsxs("div",{style:{display:q},children:[e.jsxs("div",{style:{marginRight:20},children:[e.jsx("div",{style:{fontSize:"1rem"},children:"Discord Username"}),e.jsx(a,{type:"text",name:"discordUsername",style:{width:200},onChange:s,value:n.discordUsername||"",color:"info"})]}),e.jsxs("div",{style:{marginRight:40},children:[e.jsx("div",{style:{fontSize:"1rem"},children:"AND/OR Reddit Username"}),e.jsx(a,{type:"text",name:"redditUsername",style:{width:200},onChange:s,value:n.redditUsername||"",color:"info"})]})]})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:e.jsx(C,{disabled:!B,type:"submit",variant:"contained",color:"success",children:"Submit"})})]})}),e.jsx(k,{open:y,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:.7}}},children:e.jsx("div",{style:{width:320,textAlign:"center",padding:30},children:e.jsx(Z,{})})}),e.jsx(k,{open:!!h&&!r,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:.7}}},children:e.jsx("div",{style:{display:"flex"},children:e.jsxs("div",{style:{backgroundColor:"#444",marginLeft:"auto",marginRight:"auto",padding:40},children:[e.jsx("div",{style:{fontSize:"1.7rem",fontWeight:500,marginBottom:10,textAlign:"center"},children:"Submitted Successfully!"}),e.jsx("div",{style:{width:"100%",textAlign:"center"},children:e.jsx(C,{onClick:F,variant:"contained",color:"info",style:{marginLeft:"auto",marginRight:"auto"},children:"OK"})})]})})}),e.jsx(k,{open:!!r,componentsProps:{backdrop:{style:{backgroundColor:"#000",opacity:.7}}},children:e.jsx("div",{style:{display:"flex"},children:e.jsxs("div",{style:{backgroundColor:"#444",marginLeft:"auto",marginRight:"auto",padding:40},children:[e.jsxs("div",{style:{fontSize:"1.7rem",fontWeight:500,marginBottom:20,textAlign:"center"},children:["Something went wrong.",e.jsx("br",{}),"Please try again later.",e.jsx("br",{})]}),e.jsxs("div",{style:{fontSize:"0.95rem",fontWeight:400,marginBottom:20,textAlign:"center"},children:[r==null?void 0:r.message,e.jsx("br",{}),"(Error code ",r==null?void 0:r.status,")"]}),e.jsx("div",{style:{width:"100%",textAlign:"center"},children:e.jsx(C,{onClick:O,variant:"contained",color:"error",style:{marginLeft:"auto",marginRight:"auto"},children:"OK"})})]})})})]})}function Te(){const{isMobile:d}=w(),{lockCollection:f}=t.useContext(G),{user:m}=t.useContext(M);V("RAFL Pot Info");const h=d?8:0,u={maxWidth:700,marginLeft:"auto",marginRight:"auto",paddingLeft:h,paddingRight:h},y=e.jsxs(X.Fragment,{children:[!d&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}}),e.jsx(le,{})]});return e.jsx(_,{children:e.jsxs("div",{style:u,children:[e.jsx(J,{title:"RAFL Pot Info",extras:y}),e.jsx(re,{profile:f,user:m}),e.jsx(Q,{})]})})}export{Te as default};
