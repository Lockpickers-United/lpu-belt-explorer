import{h as R,i as k,j as e,r as a,Q as x,u as E,a0 as f,e as p,C as h,a3 as m,T as F,I as S,c as g,b as j,R as u,U as T,V as _,W as w}from"./index-a7c4be15.js";import{C as D,l as I}from"./CopyProfileLinkButton-1f69f938.js";import{T as N}from"./TextField-01929736.js";import{L as q}from"./LinearProgress-f78073f1.js";import"./Link-e24de637.js";import"./InputLabel-1f2a6eeb.js";var c={},B=k;Object.defineProperty(c,"__esModule",{value:!0});var v=c.default=void 0,V=B(R()),W=e;v=c.default=(0,V.default)((0,W.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save");function z(){const{lockCollection:r,updateProfileVisibility:o}=a.useContext(x),[t,i]=a.useState(""),d=E(),{user:n}=a.useContext(f);a.useEffect(()=>{i(r.displayName)},[r.displayName]);const b=a.useCallback(s=>{const{value:P}=s.target;i(P)},[]),C=a.useCallback(s=>s.target.select(),[]),y=a.useCallback(()=>{try{t?o(!0,t):o(!1,""),p("Updated profile."),d(`/profile/${n.uid}`)}catch(s){console.error("Error while updating profile",s),p("Error while updating profile.")}},[d,t,o,n==null?void 0:n.uid]),l=!A.test(t),L=l?"Display name must only include A-Z, 0-9, _ and -.":(t==null?void 0:t.length)>0?`Your profile will be public, as ${t}.`:"Your profile will be private";return e.jsxs(h,{style:{maxWidth:350,marginLeft:"auto",marginRight:"auto",marginTop:16,marginButtom:16},children:[e.jsx(m,{title:"Edit Profile",action:e.jsx(F,{title:"Save",arrow:!0,disableFocusListener:!0,children:e.jsx(S,{onClick:y,disabled:l,children:e.jsx(v,{color:l?void 0:"success"})})})}),e.jsxs(g,{children:[e.jsx(j,{children:"Set a display name for your profile. Public profiles can be shared and show nicknames on the leaderboard."}),e.jsx("br",{}),e.jsx(N,{error:l,fullWidth:!0,variant:"outlined",color:"secondary",label:"Display Name",helperText:L,value:t||"",onChange:b,onFocus:C,inputProps:{maxLength:32}})]})]})}const A=/^[\sa-zA-Z0-9_-]{0,32}$/;function H(){const r={marginTop:16,maxWidth:350,marginLeft:"auto",marginRight:"auto",borderRadius:0};return e.jsxs(h,{style:r,children:[e.jsx(m,{title:"Log In!"}),e.jsx(g,{children:e.jsx(j,{variant:"h6",align:"center",children:"You must be logged in to edit your profile."})})]})}function Q(){const{authLoaded:r,isLoggedIn:o}=a.useContext(f),{dbLoaded:t}=a.useContext(x),i=e.jsx(u.Fragment,{children:e.jsx(D,{})});return e.jsxs(u.Fragment,{children:[e.jsx(T,{title:"Edit Profile",extras:i}),(!r||!t)&&e.jsxs(u.Fragment,{children:[e.jsx(q,{variant:"indeterminate",color:"secondary"}),e.jsx("img",{alt:"Loading",src:I,style:{marginLeft:"auto",marginRight:"auto",display:"block"}})]}),r&&!o&&e.jsx(H,{}),o&&t&&e.jsx(z,{}),e.jsx(_,{}),e.jsx(w,{feature:"editprofile"})]})}export{Q as default};
