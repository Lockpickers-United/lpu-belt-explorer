import{af as M,r as t,K as _,p as G,j as e,R as w,t as C,C as ye,D as ve,Z as L,$ as fe,v as R,T as se,I as ae,a9 as Q,w as Ce,a0 as re,a5 as be,a7 as ke,x as Se,a8 as Ee,al as De,M as ne,y as H,z as O,A as $,am as we,an as Ae,O as Ie,P as Le,Q as Te}from"./index-bde07d58.js";import{u as Pe}from"./useData-74353818.js";import{S as Be,I as Y,a as Z,b as Fe,c as Re,d as Me}from"./ScorecardDanStats-63dd4ef2.js";import{B as Ne,D as oe,F as ze,e as X,a as He,s as Oe}from"./BeltStripe-50eb71e5.js";import{u as N}from"./useWindowSize-caaac8c8.js";import{L as ie,B as $e}from"./LoadingDisplay-84ecf1d4.js";import{L as _e}from"./Link-2e03c2c9.js";import{T as We}from"./TextField-60801456.js";import{L as le,A as ce,D as Ue,E as Ge}from"./CollectionButton-92e1119e.js";import{m as Je,P as qe}from"./ProfileHeader-8d387c8a.js";import{b as Ve,S as Ke,a as Qe,s as Ye,F as Ze}from"./sortFields-6b301123.js";import{A as de,a as xe,b as pe}from"./Sort-8cea6bef.js";import{I as Xe}from"./IntroCopy-29755745.js";import{L as et}from"./LoadingDisplay-88a01664.js";import{P as tt}from"./ProfileNotFound-610f0ef9.js";import{d as ee,a as te,b as st,c as at}from"./download-1c53ae68.js";import{d as rt}from"./ContentCopy-9bb0c637.js";import"./Link-bf678839.js";import"./chartDefaults-9fc07b21.js";import"./nivo-bar.es-5d88077a.js";import"./nivo-legends.es-d70c3278.js";import"./index-cd3d8ca9.js";import"./Select-6a6ba3c0.js";import"./PhotoCamera-3c1560cf.js";import"./Dialog-fad2626f.js";import"./Autocomplete-ce1ee87e.js";import"./Search-c36bce2a.js";import"./ListItem-a23d0635.js";import"./CopyProfileLinkButton-3942e680.js";import"./ToggleButtonGroup-b8c20126.js";import"./LPU-c3fa7122.js";import"./LinearProgress-dde370be.js";function nt({setControlsExpanded:r,adminAction:s}){const{userId:x}=M(),{importUnclaimedEvidence:p}=t.useContext(_),{isMobile:n}=N(),[l,d]=t.useState(!1),h=G(),[m,c]=t.useState(""),[u,o]=t.useState(null),j=t.useCallback(async()=>{d(!0);const i=await p(x,m);d(!1),i?(c(""),r(!1),s()):o("Cannot find dan sheet tab")},[p,x,m,r,s]),b=n?"block":"flex";return e.jsx(w.Fragment,{children:e.jsx("div",{style:{placeItems:"center",display:b},children:l?e.jsx(ie,{}):e.jsx(w.Fragment,{children:e.jsxs("div",{style:{padding:20},children:[e.jsx("strong",{children:"For Black Belt pickers only."}),e.jsx("br",{}),"Black Belt pickers currently use another scorecard system known as the Dan Sheet. This import allows them to bring their picking history over to the site. If you do not already have a tab in the Dan sheet, this import will not work for you. For those that do, specify the name of your tab in the sheet to import your history into your Scorecard. Please note that tab names are case sensitive. ",e.jsx(_e,{onClick:()=>{h("/profile/scorecard/howto")},style:{color:"#bbb",cursor:"pointer"},children:"Click here to learn more."}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("div",{style:{padding:"0px",alignItems:"center"},children:e.jsxs("div",{style:{padding:"0px",display:"flex"},children:[e.jsx("div",{style:{flexGrow:1}}),e.jsx(We,{id:"tab-to-import",label:"Tab to Import",value:m,size:"small",error:!!u,helperText:u,margin:"dense",color:"secondary",onChange:i=>{c(i.target.value)}}),e.jsx(C,{style:{color:"#000",padding:0,lineHeight:"1rem",height:40,marginTop:8,marginLeft:10},variant:"contained",onClick:j,edge:"start",color:"secondary",children:"Import"})]})})]})})})})}var J={},ot=ve;Object.defineProperty(J,"__esModule",{value:!0});var he=J.default=void 0,it=ot(ye()),lt=e;he=J.default=(0,it.default)((0,lt.jsx)("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3m-3 11H8v-5h8zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m-1-9H6v4h12z"}),"Print");L.extend(fe);function ct({owner:r,date:s}){const{userId:x}=M(),{updateProfileBlackBeltAwardedAt:p}=t.useContext(_),[n,l]=t.useState(!1),[d,h]=t.useState(!1),[m,c]=t.useState(L.utc(s)),u=G(),o=t.useCallback((f,D)=>{r&&l(D)},[r]),j=t.useCallback(()=>{c(L.utc(s)),h(!1)},[s]),b=t.useCallback(async()=>{try{p(x,m),R("Profile updated"),h(!1)}catch(f){console.error("Error while updating profile",f),R("Error while updating profile")}},[x,m,p]),i=t.useCallback(f=>{f.preventDefault(),f.stopPropagation(),u("/award")},[u]);let a=s?L.utc(s).format("L"):"(no date)";a=a.replace("/202","/2"),a=a.replace("/201","/1");const g={maxWidth:700,marginLeft:"auto",marginRight:"auto",display:"flex",placeItems:"center"},k=r?{}:{cursor:"default"},A=r?e.jsx(Ce,{}):null,{isMobile:E}=N(),P=E?"block":"flex",T=E?"65%":"56%",S=E?{display:"block",marginLeft:0,placeItems:"center"}:{display:"flex",margin:"0px 0px 0px 20px"},I=d?"#fff":"#555",B=d?"#e15c07":"#555";return e.jsxs(w.Fragment,{children:[e.jsxs(de,{expanded:n,onChange:o,children:[e.jsxs(xe,{expandIcon:A,style:{...g,...k},children:[e.jsx(Ne,{value:"Black"}),e.jsx("div",{style:{margin:"4px 0px 0px 8px",width:T,flexShrink:0,flexDirection:"column"},children:e.jsx(Ve,{value:"Black Belt Awarded",textStyle:{marginLeft:"0px",fontWeight:700},style:{marginBottom:"2px"}})}),e.jsxs("div",{style:{display:P,placeItems:"center",marginLeft:10},children:[e.jsx("div",{style:{display:"flex",width:76}}),e.jsx("div",{style:S,children:e.jsx("div",{style:{margin:"4px 0px 0px 10px"},children:a})}),r&&e.jsx(se,{title:"Print Certificate",arrow:!0,disableFocusListener:!0,children:e.jsx(ae,{onClick:i,style:{marginLeft:30},children:e.jsx(he,{})})})]})]}),n&&e.jsx(pe,{sx:{padding:"4px 16px 0px 26px"},children:e.jsx(le,{adapterLocale:L.locale(),dateAdapter:ce,children:e.jsx(w.Fragment,{children:e.jsxs("div",{style:{display:"flex",width:"100%",marginBottom:20},children:[e.jsx(Ue,{label:"Awarded date",value:m,onChange:f=>{c(f),h(!0)},sx:{width:400},disableFuture:!0}),e.jsxs("div",{style:{width:"100%",textAlign:"right",position:"relative",top:"30px",padding:"0px 12px 8px 0px"},children:[e.jsx(C,{style:{marginRight:10,color:B},onClick:j,disabled:!d,children:"Cancel"}),e.jsx(C,{style:{marginRight:0,color:I},onClick:b,disabled:!d,children:"Save"})]})]})})})})]}),e.jsx(Q,{}),e.jsx(Q,{})]})}function dt({collectionType:r}){const{user:s}=t.useContext(re),{userId:x}=M(),p=G(),{isMobile:n}=N(),l=n?{marginTop:20,maxWidth:700,marginLeft:8,marginRight:8,borderRadius:0}:{marginTop:20,maxWidth:700,marginLeft:"auto",marginRight:"auto",borderRadius:0},d=x===(s==null?void 0:s.uid),h=d?e.jsx("div",{style:{width:"100%",display:"flex",placeItems:"center"},children:e.jsxs("div",{style:{fontSize:"1.0rem",fontWeight:400,width:400,marginLeft:"auto",marginRight:"auto"},children:[e.jsx("strong",{children:"There are no locks in your Scorecard."}),e.jsx("br",{}),'Browse the site and use the "My Collection" button to track locks that you have picked and recorded.',e.jsx("br",{}),e.jsx("br",{}),e.jsx("img",{alt:"My Collection",src:Je})]})}):"There are no locks in this collection.",m=d?r==="safelocks"?"Explore Safe Locks":"Explore Locks":"Go Home",c=t.useCallback(()=>{p(r==="safelocks"?"/safelocks":"/locks")},[p,r]);return e.jsx($e,{alignContent:"center",children:e.jsxs(be,{style:l,children:[e.jsx(ke,{children:e.jsx(Se,{variant:"h6",align:"center",children:h})}),e.jsxs(Ee,{children:[e.jsx("div",{style:{width:"100%"}}),e.jsx(C,{variant:"outlined",color:"secondary",onClick:c,style:{whiteSpace:"nowrap",padding:"10px 30px",margin:10},children:m})]})]})})}function xt({owner:r,profile:s,adminAction:x}){const{isMobile:p}=N(),{userId:n}=M(),{visibleEntries:l=[],cardEvidence:d}=t.useContext(oe),{expanded:h}=t.useContext(Be),{filters:m,removeFilters:c}=t.useContext(ze),{createEvidenceForEntries:u,removeEvidence:o,removeProfileBlackBeltAwarded:j,updateUserStatistics:b}=t.useContext(_),{admin:i}=t.useContext(De),[a,g]=t.useState(h),[k,A]=t.useState(!1),[E,P]=t.useState("import"),[T,S]=t.useState(!1);h&&h!==a&&g(h);const I=t.useMemo(()=>{if(s&&s.recorded){const y=d.map(U=>U.matchId);return s.recorded.filter(U=>!y.includes(U))}else return[]},[s,d]),B=t.useCallback(y=>{m.id&&c(["id"]),g(y)},[m,c]),f=t.useCallback(async()=>{S(!0),await u(n,I),A(!1),S(!1),x()},[u,n,I,x]),D=t.useCallback(y=>{P(y),A(!k)},[k]),[z,v]=t.useState(null),F=!!z,me=t.useCallback(y=>{y.preventDefault(),y.stopPropagation(),v(y.currentTarget)},[]),W=t.useCallback(()=>v(null),[]),ue=t.useCallback(async()=>{S(!0),await b(n),S(!1)},[b,n]),je=t.useCallback(async()=>{S(!0),await o(d),await j(n),W(),S(!1),x()},[d,o,W,x,j,n]),q=p?10:40,V=p?"block":"flex",K=(s==null?void 0:s.blackBeltAwardedAt)>0,ge=K?"100%":"50%";return e.jsxs("div",{style:{maxWidth:700,padding:0,backgroundColor:"#222",marginLeft:"auto",marginRight:"auto",marginTop:16},children:[e.jsx(qe,{profile:s,page:"scorecard"}),r&&l.length>0&&!s.tabClaimed&&e.jsx("div",{style:{margin:8,padding:"0px 0px"},children:e.jsx(Xe,{pageName:"scorecard"})}),l.length>0&&e.jsx(w.Fragment,{children:p?e.jsxs("div",{style:{display:V,padding:"0px 8px 0px 16px"},children:[s.danLevel>0&&e.jsx(Z,{}),e.jsx("div",{style:{marginRight:0,width:"95%"},children:e.jsx(Y,{profile:s,entries:l})})]}):e.jsxs("div",{style:{display:V,padding:"10px 8px 0px 16px"},children:[e.jsx("div",{style:{marginRight:0,width:380},children:e.jsx(Y,{profile:s,entries:l})}),s.danLevel>0&&e.jsx("div",{style:{flexGrow:1,marginRight:0},children:e.jsx(Z,{})})]})}),(r||i)&&e.jsxs(de,{expanded:k,disableGutters:!0,children:[e.jsx(xe,{style:{paddingLeft:q,paddingRight:q,placeItems:"center",width:"100%"},children:e.jsxs("div",{style:{width:"100%",placeItems:"center",textAlign:"center"},children:[e.jsxs("div",{style:{display:"flex",width:"100%",placeItems:"center",textAlign:"center"},children:[!K&&e.jsx("div",{style:{width:"50%",textAlign:"center"},children:e.jsx(C,{variant:"contained",color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:()=>D("import"),children:"IMPORT DAN SHEET"})}),e.jsx("div",{style:{width:ge,textAlign:"center"},children:e.jsx(C,{variant:"outlined",color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:()=>D("project"),children:k&&E==="project"?"CANCEL ADD PROJECT":"ADD PROJECT"})})]}),T&&e.jsx(ie,{}),i&&!T&&e.jsx("div",{style:{backgroundColor:"#700",padding:5,marginTop:20},children:e.jsxs("div",{style:{display:"flex"},children:[e.jsx("div",{style:{width:"10%",textAlign:"center"},children:"admin"}),e.jsx("div",{style:{width:"20%",textAlign:"center"},children:e.jsx(C,{color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:()=>D("import"),children:"IMPORT DAN SHEET"})}),e.jsx("div",{style:{width:"20%",textAlign:"center"},children:e.jsx(C,{color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:ue,children:"UPDATE STATS"})}),e.jsx("div",{style:{width:"20%",textAlign:"center"},children:e.jsxs(C,{color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:f,children:["MERGE RECORDED (",I.length,")"]})}),e.jsxs("div",{style:{width:"20%",textAlign:"center"},children:[e.jsx(C,{color:"secondary",size:"small",style:{lineHeight:"1rem"},onClick:me,children:"DELETE SCORECARD"}),e.jsxs(ne,{anchorEl:z,open:F,onClose:W,children:[e.jsxs("div",{style:{padding:20,textAlign:"center"},children:["You cannot undo delete.",e.jsx("br",{}),"Are you sure?"]}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(C,{style:{marginBottom:10,color:"#000"},variant:"contained",onClick:je,edge:"start",color:"error",children:"Delete"})})]})]})]})})]})}),e.jsxs(pe,{style:{backgroundColor:"#333"},children:[E==="import"&&e.jsx(nt,{setControlsExpanded:A,adminAction:x}),E==="project"&&e.jsx(Ge,{evid:null,handleUpdate:D,addProject:!0})]})]}),l.length===0&&e.jsx(dt,{}),s&&s.blackBeltAwardedAt&&e.jsx(ct,{owner:r,date:s.blackBeltAwardedAt.toDate().toJSON()}),e.jsx("div",{children:l.map(y=>e.jsx(Fe,{owner:r,evid:y,expanded:y.id===a,onExpand:B,merged:s.blackBeltAwardedAt>0},y.id))})]})}function pt(){const[r,s]=t.useState(null),x=!!r,p=t.useCallback(c=>s(c.currentTarget),[]),n=t.useCallback(()=>s(null),[]),{visibleEntries:l=[]}=t.useContext(oe),d=t.useCallback(()=>{const c=JSON.stringify(l);n(),ee("scorecardData.json",c),R("Current Scorecard entries downloaded as scorecardData.json")},[n,l]),h=t.useCallback(()=>{const u=l.map(o=>({id:o.id,make:o.makeModels.map(j=>j.make).join(","),model:o.makeModels.map(j=>j.model).join(","),version:o.version,belt:o.belt,name:X(o),versionText:o.version?" ("+o.version+")":""})).map(o=>"* "+o.name+o.versionText).join(`
`);n(),navigator.clipboard.writeText(u),R("Current scorecard entries copied to clipboard.")},[n,l]),m=t.useCallback(()=>{const c=["id","name","version","belt","modifier","points","date","link"],u=l.map(i=>({id:i.matchId,make:i.makeModels.map(a=>a.make).join(","),model:i.makeModels.map(a=>a.model).join(","),version:i.version,belt:i.belt,link:i.link,modifier:i.modifier,points:i.points,date:i.date?L(i.date).format("L"):"",name:X(i)})),o=c.join(","),j=u.map(i=>c.map(a=>i[a]).map(a=>{const g=`${a??""}`.replace(/"/g,'""');return/(\s|,|")/.test(g)?`"${g}"`:g}).join(",")).join(`
`),b=`${o}
${j}`;n(),ee("scorecardData.csv",b),R("Current Scorecard entries downloaded as scorecardData.csv")},[n,l]);return e.jsxs(w.Fragment,{children:[e.jsx(se,{title:"Export",arrow:!0,disableFocusListener:!0,children:e.jsx(ae,{onClick:p,children:e.jsx(te,{})})}),e.jsxs(ne,{anchorEl:r,open:x,onClose:n,children:[e.jsxs(H,{disabled:!0,children:[e.jsx(O,{children:e.jsx(te,{fontSize:"small"})}),e.jsx($,{children:"Export"})]}),e.jsxs(H,{onClick:h,children:[e.jsx(O,{children:e.jsx(rt,{fontSize:"small"})}),e.jsx($,{children:"Copy to clipboard"})]}),e.jsxs(H,{onClick:m,children:[e.jsx(O,{children:e.jsx(st,{fontSize:"small"})}),e.jsx($,{children:"CSV"})]}),e.jsxs(H,{onClick:d,children:[e.jsx(O,{children:e.jsx(at,{fontSize:"small"})}),e.jsx($,{children:"JSON"})]})]})]})}function Gt(){const{userId:r}=M(),{user:s}=t.useContext(re),{getProfile:x,getEvidence:p}=t.useContext(_),{scoredEvidence:n,bbCount:l,danPoints:d,eligibleDan:h,nextDanPoints:m,nextDanLocks:c}=t.useContext(we),{isMobile:u}=N(),[o,j]=t.useState(!1),b=t.useCallback(()=>{j(!o)},[o]),i=t.useCallback(async()=>{try{const v=await x(r);if(v){const F=v.displayName?v.displayName.toLowerCase().endsWith("s")?`${v.displayName}'`:`${v.displayName}'s`:"Anonymous";document.title=`LPU Belt Explorer - ${F} Scorecard`}if((s==null?void 0:s.uid)!==r){const F=await p(r);return{profile:v,...Ae(F)}}else return{profile:v,scoredEvidence:n,bbCount:l,danPoints:d,eligibleDan:h,nextDanPoints:m,nextDanLocks:c}}catch(v){return console.error("Error loading profile and evidence.",v),null}},[o,s,r,x,p,n,l,d,h,m,c]),{data:a={},loading:g,error:k}=Pe({loadFn:i}),A=a?a.profile:{},E=a?a.scoredEvidence:[],P=a?a.bbCount:0,T=a?a.danPoints:0,S=a?a.eligibleDan:0,I=a?a.nextDanPoints:0,B=a?a.nextDanLocks:0,f=e.jsxs(w.Fragment,{children:[e.jsx(Ke,{label:"Scorecard",extraFilters:[{key:"tab",value:"search"}]}),e.jsx(Qe,{sortValues:Ye}),e.jsx(Ze,{extraFilters:[{key:"tab",value:"search"}]}),!u&&e.jsx("div",{style:{flexGrow:1,minWidth:"10px"}})]}),D=e.jsxs(w.Fragment,{children:[e.jsx("br",{}),e.jsx(pt,{})]}),z=g?"Loading...":"Profile";return g||k?null:e.jsx(He,{filterFields:Oe,children:e.jsx(Re,{cardEvidence:E,cardBBCount:P,cardDanPoints:T,cardEligibleDan:S,cardNextDanPoints:I,cardNextDanLocks:B,children:e.jsxs(Me,{children:[e.jsxs(le,{adapterLocale:L.locale(),dateAdapter:ce,children:[e.jsx(Ie,{title:z,extras:f}),g&&e.jsx(et,{}),!g&&a&&!k&&e.jsx(xt,{owner:s&&s.uid===r,profile:A,adminAction:b}),!g&&(!a||k)&&e.jsx(tt,{}),e.jsx(Le,{extras:D})]}),e.jsx(Te,{feature:"scorecard"})]})})})}export{Gt as default};
