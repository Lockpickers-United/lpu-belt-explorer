import{r as e,A as L,j as t,D as I,F as S,d as h,R as j,u as M,N as P,bb as T,h as D,e as B,T as G}from"./index-CmPzIQE-.js";import{A as W}from"./AdminToolButtons-BdwSRdBx.js";import{R as b}from"./RaffleContext-Ba3Cu3E2.js";import{L as N}from"./LoadingDisplay-GwTws0Ah.js";import{R as z}from"./RaffleEntries-C5d_ohgC.js";import{D as C}from"./DataContext-Dd8JsLji.js";import{f as H,e as O}from"./filterFields-C5q_XQWq.js";import{f as U}from"./filterEntriesAdvanced-DQX9hzmL.js";import"./index-BDAs7fkS.js";import{s as w}from"./searchEntriesForText-D7buBYvy.js";import"./EmojiEvents-CnEE5Vd_.js";import"./useData-CrQ79n8b.js";import"./dataUrls-1xDVM400.js";import"./setDeep-J6HEwWhX.js";import"./Box-CCWEFohU.js";import"./CircularProgress-DkGpO_c_.js";import"./NoEntriesCard-vFszz9XV.js";import"./LockListContext-BzWbRxdn.js";import"./entryName-zlAxtUwp.js";import"./RaffleExportButton-DJCrK0gA.js";import"./ExpandMore-CifiCXHz.js";import"./CopyLinkToRaflPotButton-zyhvQ9SQ.js";import"./Link-B8cnEfSV.js";import"./FieldValue-Ca1n8npp.js";import"./FilterChip-BwRHNhry.js";import"./glossary-B-_vYIGQ.js";import"./Chip-BFu_0DGM.js";import"./ImageGallery-GPLM1TvH.js";import"./ImageViewer-9QUyjhNX.js";import"./Launch-CgcKSROS.js";import"./Dialog-CLh2F_wV.js";import"./LinearProgress-rFYiNuvq.js";import"./DialogContent-CKDzNJfM.js";import"./ImageListItem-Cc652zBG.js";import"./ContentCopy-EDowJ09w.js";import"./ScopedDialog-Dp6z82i-.js";import"./Cancel-CrIjPlYm.js";import"./Zoom-C6qePYBv.js";import"./LoadingDisplaySmall-BtdH5J5P.js";import"./AccordionSummary-BK1ND2rN.js";import"./Collapse-CzSPkfOn.js";import"./index-B4sn-Gu9.js";import"./index-BhHGfGaK.js";import"./AccordionActions-DCGynxk3.js";import"./download-CdQP6aXV.js";import"./List-BTDt8oNn.js";import"./RaffleSearchBar-DwkyhkVT.js";import"./SearchBox-BqlNbnS5.js";import"./Search-oMtw5Ff0.js";import"./useFormControl-DjHrJWVw.js";import"./Select-B7FYXOC4.js";import"./Sort-DteJIP_D.js";import"./TextField-DR3ffBvb.js";import"./ViewFilterButtons-4iImMYEX.js";import"./FilterAlt-C_rIUh8I.js";import"./HighlightOff-C4QsF7oP.js";import"./ToggleButtonGroup-B8R68a3p.js";import"./AddCircle-Ci9o3BJb.js";import"./sortFields-1lK6XsoA.js";import"./AdvancedFilters-BHAS0li-.js";import"./ChoiceButtonGroup-BRdUDKfX.js";import"./stringUtils-BsiQ3MZ5.js";function Z(){const{lockCollection:s}=e.useContext(L),{visiblePotEntries:r}=e.useContext(C);console.log("RaffleDrawingEntries visiblePotEntries",r);const d=e.useMemo(()=>r==null?void 0:r.filter(n=>{var p;return((p=n.entrants)==null?void 0:p.length)>0}),[r]);return console.log("RaffleDrawingEntries drawPots",d),t.jsx(z,{profile:s,allPots:d,drawing:!0})}function q({children:s,drawing:r}){const d=e.useContext(C),{allPots:n}=e.useContext(b),{allRaffleEntries:p}=e.useContext(I);console.log("RaffleAdminDataProviderPots",n);const{filters:x,advancedFilterGroups:g}=e.useContext(S),{search:u,id:K,tab:Q,name:V,sort:c,image:X,preview:Y,single:_,expandAll:R,...$}=x||{},v=e.useMemo(()=>p.filter(o=>o.status==="approved").reduce((o,i)=>(i.pots.forEach(f=>{o.push({username:i.username,entryId:i.id,platform:i.platform,potId:f.itemId,potTickets:f.tickets})}),o),[]),[p]),l=e.useMemo(()=>n.map(o=>{const i=v.filter(f=>f.potId===o.id);return i.length>0&&(o.entrants=i),o},[]),[n,v]);console.log("mappedPotEntries",l);const A=.3;e.useMemo(()=>w(u,[...l],A),[l,u]);const F=e.useMemo(()=>{const o=U({advancedFilterGroups:g(),entries:l}),i=w(u,[...o],A);let f=c?i.sort((m,a)=>c==="updatedAt"?h(m.updatedAt).isBefore(h(a.updatedAt))?1:-1:c==="status"?H(m.status,a.status):c==="username"?m.username.localeCompare(a.username):c==="totalDonation"?a.totalDonation-m.totalDonation:h(m.createdAt).isBefore(h(a.createdAt))?1:-1):i.sort((m,a)=>m.potNumber-a.potNumber);return r&&(f=f.filter(m=>{var a;return((a=m.entrants)==null?void 0:a.length)>0})),f},[r,l,u,c]),E=e.useCallback(o=>l.find(i=>i.id===o),[l]),k=e.useMemo(()=>({...d,allEntries:n,visibleEntries:F,mappedPotEntries:l,getPotFromId:E,expandAll:R,statusLabels:J}),[d,n,F,l,E,R]);return t.jsx(C.Provider,{value:k,children:s})}const J={pending:{entryColor:"Blue",backgroundColor:"#3e71bd",textColor:"#fff"},approved:{entryColor:"Green",backgroundColor:"#34732f",textColor:"#fff"},issues:{entryColor:"Orange",backgroundColor:"#e16936",textColor:"#fff"},rejected:{entryColor:"Red",backgroundColor:"#c52323",textColor:"#fff"}};function y({width:s=700}){const r={maxWidth:s,marginLeft:"auto",marginRight:"auto",marginTop:10,fontWeight:700,display:"flex",flexDirection:"row"};return t.jsx(j.Fragment,{children:t.jsxs("div",{style:r,children:[t.jsx("div",{style:{flexGrow:1,fontSize:"1.7rem",margin:0},children:"LPU Raffle"}),t.jsx("div",{style:{fontSize:"1.4rem",marginTop:"0.3rem"},children:"PRIZE DRAWING"})]})})}function le(){const{raffleAdmin:s,setRaffleAdminRole:r}=e.useContext(b),{authLoaded:d,isLoggedIn:n}=e.useContext(L);e.useEffect(()=>{s&&r(!0)});const{isMobile:p}=M(),x=t.jsxs(j.Fragment,{children:[!p&&t.jsx("div",{style:{flexGrow:1,minWidth:"10px"}}),t.jsx(W,{})]});if(!d)return t.jsx(N,{message:"Loading..."});if(d&&!s)return t.jsxs(j.Fragment,{children:[t.jsx(P,{title:"RAFL Admin",extras:x}),t.jsx(y,{page:"drawing"}),t.jsxs("div",{style:{padding:20},children:[!n&&t.jsx("div",{children:"Please log in to access this page."}),n&&!s&&t.jsx("div",{children:"Sorry, you do not have access to this page."}),t.jsx("div",{children:t.jsx(T,{})})]}),t.jsx(D,{})]});const g=p?8:0,u={maxWidth:700,marginLeft:"auto",marginRight:"auto",paddingLeft:g,paddingRight:g};return t.jsx(B,{filterFields:O,children:t.jsx(q,{drawing:!0,children:t.jsxs("div",{style:u,children:[t.jsx(P,{title:"RAFL 2026",extras:x}),t.jsx(y,{page:"drawing"}),s&&t.jsx(Z,{}),t.jsx(D,{}),t.jsx(G,{feature:"raflAdmin"})]})})})}export{le as default};
